(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function dS(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var o1={exports:{}},vm={};var gb;function zC(){if(gb)return vm;gb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,i,a){var l=null;if(a!==void 0&&(l=""+a),i.key!==void 0&&(l=""+i.key),"key"in i){a={};for(var u in i)u!=="key"&&(a[u]=i[u])}else a=i;return i=a.ref,{$$typeof:s,type:n,key:l,ref:i!==void 0?i:null,props:a}}return vm.Fragment=e,vm.jsx=t,vm.jsxs=t,vm}var vb;function IC(){return vb||(vb=1,o1.exports=zC()),o1.exports}var Lt=IC(),l1={exports:{}},hn={};var yb;function BC(){if(yb)return hn;yb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),_=Symbol.iterator;function x(H){return H===null||typeof H!="object"?null:(H=_&&H[_]||H["@@iterator"],typeof H=="function"?H:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,T={};function E(H,W,re){this.props=H,this.context=W,this.refs=T,this.updater=re||b}E.prototype.isReactComponent={},E.prototype.setState=function(H,W){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,W,"setState")},E.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function w(){}w.prototype=E.prototype;function D(H,W,re){this.props=H,this.context=W,this.refs=T,this.updater=re||b}var U=D.prototype=new w;U.constructor=D,R(U,E.prototype),U.isPureReactComponent=!0;var I=Array.isArray;function O(){}var P={H:null,A:null,T:null,S:null},B=Object.prototype.hasOwnProperty;function N(H,W,re){var de=re.ref;return{$$typeof:s,type:H,key:W,ref:de!==void 0?de:null,props:re}}function z(H,W){return N(H.type,W,H.props)}function q(H){return typeof H=="object"&&H!==null&&H.$$typeof===s}function Y(H){var W={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(re){return W[re]})}var Q=/\/+/g;function Z(H,W){return typeof H=="object"&&H!==null&&H.key!=null?Y(""+H.key):W.toString(36)}function ae(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(O,O):(H.status="pending",H.then(function(W){H.status==="pending"&&(H.status="fulfilled",H.value=W)},function(W){H.status==="pending"&&(H.status="rejected",H.reason=W)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function G(H,W,re,de,ge){var oe=typeof H;(oe==="undefined"||oe==="boolean")&&(H=null);var he=!1;if(H===null)he=!0;else switch(oe){case"bigint":case"string":case"number":he=!0;break;case"object":switch(H.$$typeof){case s:case e:he=!0;break;case m:return he=H._init,G(he(H._payload),W,re,de,ge)}}if(he)return ge=ge(H),he=de===""?"."+Z(H,0):de,I(ge)?(re="",he!=null&&(re=he.replace(Q,"$&/")+"/"),G(ge,W,re,"",function(rt){return rt})):ge!=null&&(q(ge)&&(ge=z(ge,re+(ge.key==null||H&&H.key===ge.key?"":(""+ge.key).replace(Q,"$&/")+"/")+he)),W.push(ge)),1;he=0;var Ee=de===""?".":de+":";if(I(H))for(var We=0;We<H.length;We++)de=H[We],oe=Ee+Z(de,We),he+=G(de,W,re,oe,ge);else if(We=x(H),typeof We=="function")for(H=We.call(H),We=0;!(de=H.next()).done;)de=de.value,oe=Ee+Z(de,We++),he+=G(de,W,re,oe,ge);else if(oe==="object"){if(typeof H.then=="function")return G(ae(H),W,re,de,ge);throw W=String(H),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return he}function ee(H,W,re){if(H==null)return H;var de=[],ge=0;return G(H,de,"","",function(oe){return W.call(re,oe,ge++)}),de}function ie(H){if(H._status===-1){var W=H._result;W=W(),W.then(function(re){(H._status===0||H._status===-1)&&(H._status=1,H._result=re)},function(re){(H._status===0||H._status===-1)&&(H._status=2,H._result=re)}),H._status===-1&&(H._status=0,H._result=W)}if(H._status===1)return H._result.default;throw H._result}var fe=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)},ce={map:ee,forEach:function(H,W,re){ee(H,function(){W.apply(this,arguments)},re)},count:function(H){var W=0;return ee(H,function(){W++}),W},toArray:function(H){return ee(H,function(W){return W})||[]},only:function(H){if(!q(H))throw Error("React.Children.only expected to receive a single React element child.");return H}};return hn.Activity=v,hn.Children=ce,hn.Component=E,hn.Fragment=t,hn.Profiler=i,hn.PureComponent=D,hn.StrictMode=n,hn.Suspense=f,hn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,hn.__COMPILER_RUNTIME={__proto__:null,c:function(H){return P.H.useMemoCache(H)}},hn.cache=function(H){return function(){return H.apply(null,arguments)}},hn.cacheSignal=function(){return null},hn.cloneElement=function(H,W,re){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var de=R({},H.props),ge=H.key;if(W!=null)for(oe in W.key!==void 0&&(ge=""+W.key),W)!B.call(W,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&W.ref===void 0||(de[oe]=W[oe]);var oe=arguments.length-2;if(oe===1)de.children=re;else if(1<oe){for(var he=Array(oe),Ee=0;Ee<oe;Ee++)he[Ee]=arguments[Ee+2];de.children=he}return N(H.type,ge,de)},hn.createContext=function(H){return H={$$typeof:l,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:a,_context:H},H},hn.createElement=function(H,W,re){var de,ge={},oe=null;if(W!=null)for(de in W.key!==void 0&&(oe=""+W.key),W)B.call(W,de)&&de!=="key"&&de!=="__self"&&de!=="__source"&&(ge[de]=W[de]);var he=arguments.length-2;if(he===1)ge.children=re;else if(1<he){for(var Ee=Array(he),We=0;We<he;We++)Ee[We]=arguments[We+2];ge.children=Ee}if(H&&H.defaultProps)for(de in he=H.defaultProps,he)ge[de]===void 0&&(ge[de]=he[de]);return N(H,oe,ge)},hn.createRef=function(){return{current:null}},hn.forwardRef=function(H){return{$$typeof:u,render:H}},hn.isValidElement=q,hn.lazy=function(H){return{$$typeof:m,_payload:{_status:-1,_result:H},_init:ie}},hn.memo=function(H,W){return{$$typeof:p,type:H,compare:W===void 0?null:W}},hn.startTransition=function(H){var W=P.T,re={};P.T=re;try{var de=H(),ge=P.S;ge!==null&&ge(re,de),typeof de=="object"&&de!==null&&typeof de.then=="function"&&de.then(O,fe)}catch(oe){fe(oe)}finally{W!==null&&re.types!==null&&(W.types=re.types),P.T=W}},hn.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},hn.use=function(H){return P.H.use(H)},hn.useActionState=function(H,W,re){return P.H.useActionState(H,W,re)},hn.useCallback=function(H,W){return P.H.useCallback(H,W)},hn.useContext=function(H){return P.H.useContext(H)},hn.useDebugValue=function(){},hn.useDeferredValue=function(H,W){return P.H.useDeferredValue(H,W)},hn.useEffect=function(H,W){return P.H.useEffect(H,W)},hn.useEffectEvent=function(H){return P.H.useEffectEvent(H)},hn.useId=function(){return P.H.useId()},hn.useImperativeHandle=function(H,W,re){return P.H.useImperativeHandle(H,W,re)},hn.useInsertionEffect=function(H,W){return P.H.useInsertionEffect(H,W)},hn.useLayoutEffect=function(H,W){return P.H.useLayoutEffect(H,W)},hn.useMemo=function(H,W){return P.H.useMemo(H,W)},hn.useOptimistic=function(H,W){return P.H.useOptimistic(H,W)},hn.useReducer=function(H,W,re){return P.H.useReducer(H,W,re)},hn.useRef=function(H){return P.H.useRef(H)},hn.useState=function(H){return P.H.useState(H)},hn.useSyncExternalStore=function(H,W,re){return P.H.useSyncExternalStore(H,W,re)},hn.useTransition=function(){return P.H.useTransition()},hn.version="19.2.3",hn}var _b;function Wf(){return _b||(_b=1,l1.exports=BC()),l1.exports}var Ye=Wf();const PC=dS(Ye);var u1={exports:{}},ym={},c1={exports:{}},f1={};var xb;function FC(){return xb||(xb=1,(function(s){function e(G,ee){var ie=G.length;G.push(ee);e:for(;0<ie;){var fe=ie-1>>>1,ce=G[fe];if(0<i(ce,ee))G[fe]=ee,G[ie]=ce,ie=fe;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var ee=G[0],ie=G.pop();if(ie!==ee){G[0]=ie;e:for(var fe=0,ce=G.length,H=ce>>>1;fe<H;){var W=2*(fe+1)-1,re=G[W],de=W+1,ge=G[de];if(0>i(re,ie))de<ce&&0>i(ge,re)?(G[fe]=ge,G[de]=ie,fe=de):(G[fe]=re,G[W]=ie,fe=W);else if(de<ce&&0>i(ge,ie))G[fe]=ge,G[de]=ie,fe=de;else break e}}return ee}function i(G,ee){var ie=G.sortIndex-ee.sortIndex;return ie!==0?ie:G.id-ee.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;s.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();s.unstable_now=function(){return l.now()-u}}var f=[],p=[],m=1,v=null,_=3,x=!1,b=!1,R=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function U(G){for(var ee=t(p);ee!==null;){if(ee.callback===null)n(p);else if(ee.startTime<=G)n(p),ee.sortIndex=ee.expirationTime,e(f,ee);else break;ee=t(p)}}function I(G){if(R=!1,U(G),!b)if(t(f)!==null)b=!0,O||(O=!0,Y());else{var ee=t(p);ee!==null&&ae(I,ee.startTime-G)}}var O=!1,P=-1,B=5,N=-1;function z(){return T?!0:!(s.unstable_now()-N<B)}function q(){if(T=!1,O){var G=s.unstable_now();N=G;var ee=!0;try{e:{b=!1,R&&(R=!1,w(P),P=-1),x=!0;var ie=_;try{t:{for(U(G),v=t(f);v!==null&&!(v.expirationTime>G&&z());){var fe=v.callback;if(typeof fe=="function"){v.callback=null,_=v.priorityLevel;var ce=fe(v.expirationTime<=G);if(G=s.unstable_now(),typeof ce=="function"){v.callback=ce,U(G),ee=!0;break t}v===t(f)&&n(f),U(G)}else n(f);v=t(f)}if(v!==null)ee=!0;else{var H=t(p);H!==null&&ae(I,H.startTime-G),ee=!1}}break e}finally{v=null,_=ie,x=!1}ee=void 0}}finally{ee?Y():O=!1}}}var Y;if(typeof D=="function")Y=function(){D(q)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,Z=Q.port2;Q.port1.onmessage=q,Y=function(){Z.postMessage(null)}}else Y=function(){E(q,0)};function ae(G,ee){P=E(function(){G(s.unstable_now())},ee)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(G){G.callback=null},s.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<G?Math.floor(1e3/G):5},s.unstable_getCurrentPriorityLevel=function(){return _},s.unstable_next=function(G){switch(_){case 1:case 2:case 3:var ee=3;break;default:ee=_}var ie=_;_=ee;try{return G()}finally{_=ie}},s.unstable_requestPaint=function(){T=!0},s.unstable_runWithPriority=function(G,ee){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ie=_;_=G;try{return ee()}finally{_=ie}},s.unstable_scheduleCallback=function(G,ee,ie){var fe=s.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?fe+ie:fe):ie=fe,G){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=ie+ce,G={id:m++,callback:ee,priorityLevel:G,startTime:ie,expirationTime:ce,sortIndex:-1},ie>fe?(G.sortIndex=ie,e(p,G),t(f)===null&&G===t(p)&&(R?(w(P),P=-1):R=!0,ae(I,ie-fe))):(G.sortIndex=ce,e(f,G),b||x||(b=!0,O||(O=!0,Y()))),G},s.unstable_shouldYield=z,s.unstable_wrapCallback=function(G){var ee=_;return function(){var ie=_;_=ee;try{return G.apply(this,arguments)}finally{_=ie}}}})(f1)),f1}var Sb;function HC(){return Sb||(Sb=1,c1.exports=FC()),c1.exports}var h1={exports:{}},rr={};var Mb;function GC(){if(Mb)return rr;Mb=1;var s=Wf();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)p+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(f,p,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:v==null?null:""+v,children:f,containerInfo:p,implementation:m}}var l=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return rr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,rr.createPortal=function(f,p){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return a(f,p,null,m)},rr.flushSync=function(f){var p=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=p,n.p=m,n.d.f()}},rr.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,n.d.C(f,p))},rr.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},rr.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var m=p.as,v=u(m,p.crossOrigin),_=typeof p.integrity=="string"?p.integrity:void 0,x=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;m==="style"?n.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:x}):m==="script"&&n.d.X(f,{crossOrigin:v,integrity:_,fetchPriority:x,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},rr.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var m=u(p.as,p.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&n.d.M(f)},rr.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var m=p.as,v=u(m,p.crossOrigin);n.d.L(f,m,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},rr.preloadModule=function(f,p){if(typeof f=="string")if(p){var m=u(p.as,p.crossOrigin);n.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else n.d.m(f)},rr.requestFormReset=function(f){n.d.r(f)},rr.unstable_batchedUpdates=function(f,p){return f(p)},rr.useFormState=function(f,p,m){return l.H.useFormState(f,p,m)},rr.useFormStatus=function(){return l.H.useHostTransitionStatus()},rr.version="19.2.3",rr}var bb;function VC(){if(bb)return h1.exports;bb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),h1.exports=GC(),h1.exports}var Eb;function kC(){if(Eb)return ym;Eb=1;var s=HC(),e=Wf(),t=VC();function n(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,d=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(d=o.return),r=o.return;while(r)}return o.tag===3?d:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function u(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function f(r){if(a(r)!==r)throw Error(n(188))}function p(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(n(188));return o!==r?null:r}for(var d=r,g=o;;){var S=d.return;if(S===null)break;var A=S.alternate;if(A===null){if(g=S.return,g!==null){d=g;continue}break}if(S.child===A.child){for(A=S.child;A;){if(A===d)return f(S),r;if(A===g)return f(S),o;A=A.sibling}throw Error(n(188))}if(d.return!==g.return)d=S,g=A;else{for(var F=!1,K=S.child;K;){if(K===d){F=!0,d=S,g=A;break}if(K===g){F=!0,g=S,d=A;break}K=K.sibling}if(!F){for(K=A.child;K;){if(K===d){F=!0,d=A,g=S;break}if(K===g){F=!0,g=A,d=S;break}K=K.sibling}if(!F)throw Error(n(189))}}if(d.alternate!==g)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?r:o}function m(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=m(r),o!==null)return o;r=r.sibling}return null}var v=Object.assign,_=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),D=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function Y(r){return r===null||typeof r!="object"?null:(r=q&&r[q]||r["@@iterator"],typeof r=="function"?r:null)}var Q=Symbol.for("react.client.reference");function Z(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Q?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case R:return"Fragment";case E:return"Profiler";case T:return"StrictMode";case I:return"Suspense";case O:return"SuspenseList";case N:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case b:return"Portal";case D:return r.displayName||"Context";case w:return(r._context.displayName||"Context")+".Consumer";case U:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case P:return o=r.displayName||null,o!==null?o:Z(r.type)||"Memo";case B:o=r._payload,r=r._init;try{return Z(r(o))}catch{}}return null}var ae=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie={pending:!1,data:null,method:null,action:null},fe=[],ce=-1;function H(r){return{current:r}}function W(r){0>ce||(r.current=fe[ce],fe[ce]=null,ce--)}function re(r,o){ce++,fe[ce]=r.current,r.current=o}var de=H(null),ge=H(null),oe=H(null),he=H(null);function Ee(r,o){switch(re(oe,o),re(ge,r),re(de,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?FM(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=FM(o),r=HM(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}W(de),re(de,r)}function We(){W(de),W(ge),W(oe)}function rt(r){r.memoizedState!==null&&re(he,r);var o=de.current,d=HM(o,r.type);o!==d&&(re(ge,r),re(de,d))}function st(r){ge.current===r&&(W(de),W(ge)),he.current===r&&(W(he),dm._currentValue=ie)}var et,se;function Ie(r){if(et===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);et=o&&o[1]||"",se=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+et+r+se}var Oe=!1;function Ue(r,o){if(!r||Oe)return"";Oe=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(o){var vt=function(){throw Error()};if(Object.defineProperty(vt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(vt,[])}catch(nt){var Ze=nt}Reflect.construct(r,[],vt)}else{try{vt.call()}catch(nt){Ze=nt}r.call(vt.prototype)}}else{try{throw Error()}catch(nt){Ze=nt}(vt=r())&&typeof vt.catch=="function"&&vt.catch(function(){})}}catch(nt){if(nt&&Ze&&typeof nt.stack=="string")return[nt.stack,Ze.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=g.DetermineComponentFrameRoot(),F=A[0],K=A[1];if(F&&K){var Se=F.split(`
`),Ve=K.split(`
`);for(S=g=0;g<Se.length&&!Se[g].includes("DetermineComponentFrameRoot");)g++;for(;S<Ve.length&&!Ve[S].includes("DetermineComponentFrameRoot");)S++;if(g===Se.length||S===Ve.length)for(g=Se.length-1,S=Ve.length-1;1<=g&&0<=S&&Se[g]!==Ve[S];)S--;for(;1<=g&&0<=S;g--,S--)if(Se[g]!==Ve[S]){if(g!==1||S!==1)do if(g--,S--,0>S||Se[g]!==Ve[S]){var ft=`
`+Se[g].replace(" at new "," at ");return r.displayName&&ft.includes("<anonymous>")&&(ft=ft.replace("<anonymous>",r.displayName)),ft}while(1<=g&&0<=S);break}}}finally{Oe=!1,Error.prepareStackTrace=d}return(d=r?r.displayName||r.name:"")?Ie(d):""}function Le(r,o){switch(r.tag){case 26:case 27:case 5:return Ie(r.type);case 16:return Ie("Lazy");case 13:return r.child!==o&&o!==null?Ie("Suspense Fallback"):Ie("Suspense");case 19:return Ie("SuspenseList");case 0:case 15:return Ue(r.type,!1);case 11:return Ue(r.type.render,!1);case 1:return Ue(r.type,!0);case 31:return Ie("Activity");default:return""}}function ze(r){try{var o="",d=null;do o+=Le(r,d),d=r,r=r.return;while(r);return o}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Pe=Object.prototype.hasOwnProperty,Fe=s.unstable_scheduleCallback,Ne=s.unstable_cancelCallback,yt=s.unstable_shouldYield,j=s.unstable_requestPaint,V=s.unstable_now,ve=s.unstable_getCurrentPriorityLevel,Be=s.unstable_ImmediatePriority,De=s.unstable_UserBlockingPriority,Ae=s.unstable_NormalPriority,gt=s.unstable_LowPriority,ct=s.unstable_IdlePriority,_t=s.log,bt=s.unstable_setDisableYieldValue,ke=null,Xe=null;function lt(r){if(typeof _t=="function"&&bt(r),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(ke,r)}catch{}}var le=Math.clz32?Math.clz32:pe,Te=Math.log,ut=Math.LN2;function pe(r){return r>>>=0,r===0?32:31-(Te(r)/ut|0)|0}var _e=256,at=262144,Tt=4194304;function it(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Ge(r,o,d){var g=r.pendingLanes;if(g===0)return 0;var S=0,A=r.suspendedLanes,F=r.pingedLanes;r=r.warmLanes;var K=g&134217727;return K!==0?(g=K&~A,g!==0?S=it(g):(F&=K,F!==0?S=it(F):d||(d=K&~r,d!==0&&(S=it(d))))):(K=g&~A,K!==0?S=it(K):F!==0?S=it(F):d||(d=g&~r,d!==0&&(S=it(d)))),S===0?0:o!==0&&o!==S&&(o&A)===0&&(A=S&-S,d=o&-o,A>=d||A===32&&(d&4194048)!==0)?o:S}function xt(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function wt(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ut(){var r=Tt;return Tt<<=1,(Tt&62914560)===0&&(Tt=4194304),r}function Pt(r){for(var o=[],d=0;31>d;d++)o.push(r);return o}function yn(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function An(r,o,d,g,S,A){var F=r.pendingLanes;r.pendingLanes=d,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=d,r.entangledLanes&=d,r.errorRecoveryDisabledLanes&=d,r.shellSuspendCounter=0;var K=r.entanglements,Se=r.expirationTimes,Ve=r.hiddenUpdates;for(d=F&~d;0<d;){var ft=31-le(d),vt=1<<ft;K[ft]=0,Se[ft]=-1;var Ze=Ve[ft];if(Ze!==null)for(Ve[ft]=null,ft=0;ft<Ze.length;ft++){var nt=Ze[ft];nt!==null&&(nt.lane&=-536870913)}d&=~vt}g!==0&&ai(r,g,0),A!==0&&S===0&&r.tag!==0&&(r.suspendedLanes|=A&~(F&~o))}function ai(r,o,d){r.pendingLanes|=o,r.suspendedLanes&=~o;var g=31-le(o);r.entangledLanes|=o,r.entanglements[g]=r.entanglements[g]|1073741824|d&261930}function ci(r,o){var d=r.entangledLanes|=o;for(r=r.entanglements;d;){var g=31-le(d),S=1<<g;S&o|r[g]&o&&(r[g]|=o),d&=~S}}function Ti(r,o){var d=o&-o;return d=(d&42)!==0?1:mi(d),(d&(r.suspendedLanes|o))!==0?0:d}function mi(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Ai(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function ri(){var r=ee.p;return r!==0?r:(r=window.event,r===void 0?32:ub(r.type))}function Xt(r,o){var d=ee.p;try{return ee.p=r,o()}finally{ee.p=d}}var Un=Math.random().toString(36).slice(2),Jt="__reactFiber$"+Un,k="__reactProps$"+Un,$="__reactContainer$"+Un,Me="__reactEvents$"+Un,qe="__reactListeners$"+Un,tt="__reactHandles$"+Un,$e="__reactResources$"+Un,Mt="__reactMarker$"+Un;function X(r){delete r[Jt],delete r[k],delete r[Me],delete r[qe],delete r[tt]}function ue(r){var o=r[Jt];if(o)return o;for(var d=r.parentNode;d;){if(o=d[$]||d[Jt]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(r=WM(r);r!==null;){if(d=r[Jt])return d;r=WM(r)}return o}r=d,d=r.parentNode}return null}function me(r){if(r=r[Jt]||r[$]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function ye(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(n(33))}function te(r){var o=r[$e];return o||(o=r[$e]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Je(r){r[Mt]=!0}var Qe=new Set,ot={};function dt(r,o){St(r,o),St(r+"Capture",o)}function St(r,o){for(ot[r]=o,r=0;r<o.length;r++)Qe.add(o[r])}var Dt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),At={},Ht={};function $t(r){return Pe.call(Ht,r)?!0:Pe.call(At,r)?!1:Dt.test(r)?Ht[r]=!0:(At[r]=!0,!1)}function kt(r,o,d){if($t(o))if(d===null)r.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var g=o.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+d)}}function sn(r,o,d){if(d===null)r.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+d)}}function Ft(r,o,d,g){if(g===null)r.removeAttribute(d);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(d);return}r.setAttributeNS(o,d,""+g)}}function Ct(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function cn(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function on(r,o,d){var g=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var S=g.get,A=g.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return S.call(this)},set:function(F){d=""+F,A.call(this,F)}}),Object.defineProperty(r,o,{enumerable:g.enumerable}),{getValue:function(){return d},setValue:function(F){d=""+F},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function En(r){if(!r._valueTracker){var o=cn(r)?"checked":"value";r._valueTracker=on(r,o,""+r[o])}}function fn(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var d=o.getValue(),g="";return r&&(g=cn(r)?r.checked?"true":"false":r.value),r=g,r!==d?(o.setValue(r),!0):!1}function pn(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Rn=/[\n"\\]/g;function Ot(r){return r.replace(Rn,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Yn(r,o,d,g,S,A,F,K){r.name="",F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?r.type=F:r.removeAttribute("type"),o!=null?F==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+Ct(o)):r.value!==""+Ct(o)&&(r.value=""+Ct(o)):F!=="submit"&&F!=="reset"||r.removeAttribute("value"),o!=null?_n(r,F,Ct(o)):d!=null?_n(r,F,Ct(d)):g!=null&&r.removeAttribute("value"),S==null&&A!=null&&(r.defaultChecked=!!A),S!=null&&(r.checked=S&&typeof S!="function"&&typeof S!="symbol"),K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"?r.name=""+Ct(K):r.removeAttribute("name")}function ti(r,o,d,g,S,A,F,K){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(r.type=A),o!=null||d!=null){if(!(A!=="submit"&&A!=="reset"||o!=null)){En(r);return}d=d!=null?""+Ct(d):"",o=o!=null?""+Ct(o):d,K||o===r.value||(r.value=o),r.defaultValue=o}g=g??S,g=typeof g!="function"&&typeof g!="symbol"&&!!g,r.checked=K?r.checked:!!g,r.defaultChecked=!!g,F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"&&(r.name=F),En(r)}function _n(r,o,d){o==="number"&&pn(r.ownerDocument)===r||r.defaultValue===""+d||(r.defaultValue=""+d)}function Pn(r,o,d,g){if(r=r.options,o){o={};for(var S=0;S<d.length;S++)o["$"+d[S]]=!0;for(d=0;d<r.length;d++)S=o.hasOwnProperty("$"+r[d].value),r[d].selected!==S&&(r[d].selected=S),S&&g&&(r[d].defaultSelected=!0)}else{for(d=""+Ct(d),o=null,S=0;S<r.length;S++){if(r[S].value===d){r[S].selected=!0,g&&(r[S].defaultSelected=!0);return}o!==null||r[S].disabled||(o=r[S])}o!==null&&(o.selected=!0)}}function Hr(r,o,d){if(o!=null&&(o=""+Ct(o),o!==r.value&&(r.value=o),d==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=d!=null?""+Ct(d):""}function ki(r,o,d,g){if(o==null){if(g!=null){if(d!=null)throw Error(n(92));if(ae(g)){if(1<g.length)throw Error(n(93));g=g[0]}d=g}d==null&&(d=""),o=d}d=Ct(o),r.defaultValue=d,g=r.textContent,g===d&&g!==""&&g!==null&&(r.value=g),En(r)}function is(r,o){if(o){var d=r.firstChild;if(d&&d===r.lastChild&&d.nodeType===3){d.nodeValue=o;return}}r.textContent=o}var El=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Io(r,o,d){var g=o.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?g?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":g?r.setProperty(o,d):typeof d!="number"||d===0||El.has(o)?o==="float"?r.cssFloat=d:r[o]=(""+d).trim():r[o]=d+"px"}function Tl(r,o,d){if(o!=null&&typeof o!="object")throw Error(n(62));if(r=r.style,d!=null){for(var g in d)!d.hasOwnProperty(g)||o!=null&&o.hasOwnProperty(g)||(g.indexOf("--")===0?r.setProperty(g,""):g==="float"?r.cssFloat="":r[g]="");for(var S in o)g=o[S],o.hasOwnProperty(S)&&d[S]!==g&&Io(r,S,g)}else for(var A in o)o.hasOwnProperty(A)&&Io(r,A,o[A])}function as(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ec=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Al=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Gr(r){return Al.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function ha(){}var rs=null;function Rl(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var hr=null,Vr=null;function Cl(r){var o=me(r);if(o&&(r=o.stateNode)){var d=r[k]||null;e:switch(r=o.stateNode,o.type){case"input":if(Yn(r,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),o=d.name,d.type==="radio"&&o!=null){for(d=r;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+Ot(""+o)+'"][type="radio"]'),o=0;o<d.length;o++){var g=d[o];if(g!==r&&g.form===r.form){var S=g[k]||null;if(!S)throw Error(n(90));Yn(g,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(o=0;o<d.length;o++)g=d[o],g.form===r.form&&fn(g)}break e;case"textarea":Hr(r,d.value,d.defaultValue);break e;case"select":o=d.value,o!=null&&Pn(r,!!d.multiple,o,!1)}}}var wl=!1;function Bo(r,o,d){if(wl)return r(o,d);wl=!0;try{var g=r(o);return g}finally{if(wl=!1,(hr!==null||Vr!==null)&&(J(),hr&&(o=hr,r=Vr,Vr=hr=null,Cl(o),r)))for(o=0;o<r.length;o++)Cl(r[o])}}function ss(r,o){var d=r.stateNode;if(d===null)return null;var g=d[k]||null;if(g===null)return null;d=g[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(r=r.type,g=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!g;break e;default:r=!1}if(r)return null;if(d&&typeof d!="function")throw Error(n(231,o,typeof d));return d}var dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Aa=!1;if(dr)try{var $s={};Object.defineProperty($s,"passive",{get:function(){Aa=!0}}),window.addEventListener("test",$s,$s),window.removeEventListener("test",$s,$s)}catch{Aa=!1}var os=null,Ul=null,kr=null;function Dl(){if(kr)return kr;var r,o=Ul,d=o.length,g,S="value"in os?os.value:os.textContent,A=S.length;for(r=0;r<d&&o[r]===S[r];r++);var F=d-r;for(g=1;g<=F&&o[d-g]===S[A-g];g++);return kr=S.slice(r,1<g?1-g:void 0)}function As(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function ls(){return!0}function eo(){return!1}function gi(r){function o(d,g,S,A,F){this._reactName=d,this._targetInst=S,this.type=g,this.nativeEvent=A,this.target=F,this.currentTarget=null;for(var K in r)r.hasOwnProperty(K)&&(d=r[K],this[K]=d?d(A):A[K]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?ls:eo,this.isPropagationStopped=eo,this}return v(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=ls)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=ls)},persist:function(){},isPersistent:ls}),o}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},to=gi(us),Ba=v({},us,{view:0,detail:0}),Rs=gi(Ba),Nl,cs,Cs,Ki=v({},Ba,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rc,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Cs&&(Cs&&r.type==="mousemove"?(Nl=r.screenX-Cs.screenX,cs=r.screenY-Cs.screenY):cs=Nl=0,Cs=r),Nl)},movementY:function(r){return"movementY"in r?r.movementY:cs}}),Jf=gi(Ki),Ri=v({},Ki,{dataTransfer:0}),Ol=gi(Ri),Tc=v({},Ba,{relatedTarget:0}),_u=gi(Tc),da=v({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),Wa=gi(da),Xi=v({},us,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Xr=gi(Xi),Ac=v({},us,{data:0}),Jd=gi(Ac),Rg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$d={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ep={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cg(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=ep[r])?!!o[r]:!1}function Rc(){return Cg}var tp=v({},Ba,{key:function(r){if(r.key){var o=Rg[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=As(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?$d[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rc,charCode:function(r){return r.type==="keypress"?As(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?As(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),np=gi(tp),wg=v({},Ki,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$f=gi(wg),Ug=v({},Ba,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rc}),no=gi(Ug),ip=v({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),A_=gi(ip),Dg=v({},Ki,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Po=gi(Dg),io=v({},us,{newState:0,oldState:0}),ap=gi(io),rp=[9,13,27,32],Ll=dr&&"CompositionEvent"in window,Fo=null;dr&&"documentMode"in document&&(Fo=document.documentMode);var zl=dr&&"TextEvent"in window&&!Fo,pa=dr&&(!Ll||Fo&&8<Fo&&11>=Fo),Cc=" ",sp=!1;function eh(r,o){switch(r){case"keyup":return rp.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xu(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ho=!1;function th(r,o){switch(r){case"compositionend":return xu(o);case"keypress":return o.which!==32?null:(sp=!0,Cc);case"textInput":return r=o.data,r===Cc&&sp?null:r;default:return null}}function Ng(r,o){if(Ho)return r==="compositionend"||!Ll&&eh(r,o)?(r=Dl(),kr=Ul=os=null,Ho=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return pa&&o.locale!=="ko"?null:o.data;default:return null}}var pr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function op(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!pr[r.type]:o==="textarea"}function nh(r,o,d,g){hr?Vr?Vr.push(g):Vr=[g]:hr=g,o=b0(o,"onChange"),0<o.length&&(d=new to("onChange","change",null,d,g),r.push({event:d,listeners:o}))}var Su=null,Mu=null;function lp(r){OM(r,0)}function bu(r){var o=ye(r);if(fn(o))return r}function up(r,o){if(r==="change")return o}var wc=!1;if(dr){var Il;if(dr){var vi="oninput"in document;if(!vi){var Og=document.createElement("div");Og.setAttribute("oninput","return;"),vi=typeof Og.oninput=="function"}Il=vi}else Il=!1;wc=Il&&(!document.documentMode||9<document.documentMode)}function Lg(){Su&&(Su.detachEvent("onpropertychange",cp),Mu=Su=null)}function cp(r){if(r.propertyName==="value"&&bu(Mu)){var o=[];nh(o,Mu,r,Rl(r)),Bo(lp,o)}}function Uc(r,o,d){r==="focusin"?(Lg(),Su=o,Mu=d,Su.attachEvent("onpropertychange",cp)):r==="focusout"&&Lg()}function Go(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return bu(Mu)}function zg(r,o){if(r==="click")return bu(o)}function Ig(r,o){if(r==="input"||r==="change")return bu(o)}function Bl(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var yi=typeof Object.is=="function"?Object.is:Bl;function Eu(r,o){if(yi(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var d=Object.keys(r),g=Object.keys(o);if(d.length!==g.length)return!1;for(g=0;g<d.length;g++){var S=d[g];if(!Pe.call(o,S)||!yi(r[S],o[S]))return!1}return!0}function fp(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function hp(r,o){var d=fp(r);r=0;for(var g;d;){if(d.nodeType===3){if(g=r+d.textContent.length,r<=o&&g>=o)return{node:d,offset:o-r};r=g}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=fp(d)}}function ih(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?ih(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function ah(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=pn(r.document);o instanceof r.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)r=o.contentWindow;else break;o=pn(r.document)}return o}function Tu(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var Bg=dr&&"documentMode"in document&&11>=document.documentMode,Au=null,rh=null,Ru=null,mr=!1;function sh(r,o,d){var g=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;mr||Au==null||Au!==pn(g)||(g=Au,"selectionStart"in g&&Tu(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Ru&&Eu(Ru,g)||(Ru=g,g=b0(rh,"onSelect"),0<g.length&&(o=new to("onSelect","select",null,o,d),r.push({event:o,listeners:g}),o.target=Au)))}function Vo(r,o){var d={};return d[r.toLowerCase()]=o.toLowerCase(),d["Webkit"+r]="webkit"+o,d["Moz"+r]="moz"+o,d}var Cu={animationend:Vo("Animation","AnimationEnd"),animationiteration:Vo("Animation","AnimationIteration"),animationstart:Vo("Animation","AnimationStart"),transitionrun:Vo("Transition","TransitionRun"),transitionstart:Vo("Transition","TransitionStart"),transitioncancel:Vo("Transition","TransitionCancel"),transitionend:Vo("Transition","TransitionEnd")},Dc={},Pa={};dr&&(Pa=document.createElement("div").style,"AnimationEvent"in window||(delete Cu.animationend.animation,delete Cu.animationiteration.animation,delete Cu.animationstart.animation),"TransitionEvent"in window||delete Cu.transitionend.transition);function ko(r){if(Dc[r])return Dc[r];if(!Cu[r])return r;var o=Cu[r],d;for(d in o)if(o.hasOwnProperty(d)&&d in Pa)return Dc[r]=o[d];return r}var ja=ko("animationend"),dp=ko("animationiteration"),ws=ko("animationstart"),wu=ko("transitionrun"),Xo=ko("transitionstart"),pp=ko("transitioncancel"),oh=ko("transitionend"),ao=new Map,lh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");lh.push("scrollEnd");function Ra(r,o){ao.set(r,o),dt(o,[r])}var Yo=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},ia=[],Pl=0,uh=0;function qo(){for(var r=Pl,o=uh=Pl=0;o<r;){var d=ia[o];ia[o++]=null;var g=ia[o];ia[o++]=null;var S=ia[o];ia[o++]=null;var A=ia[o];if(ia[o++]=null,g!==null&&S!==null){var F=g.pending;F===null?S.next=S:(S.next=F.next,F.next=S),g.pending=S}A!==0&&ch(d,S,A)}}function Nc(r,o,d,g){ia[Pl++]=r,ia[Pl++]=o,ia[Pl++]=d,ia[Pl++]=g,uh|=g,r.lanes|=g,r=r.alternate,r!==null&&(r.lanes|=g)}function Uu(r,o,d,g){return Nc(r,o,d,g),Du(r)}function Wo(r,o){return Nc(r,null,null,o),Du(r)}function ch(r,o,d){r.lanes|=d;var g=r.alternate;g!==null&&(g.lanes|=d);for(var S=!1,A=r.return;A!==null;)A.childLanes|=d,g=A.alternate,g!==null&&(g.childLanes|=d),A.tag===22&&(r=A.stateNode,r===null||r._visibility&1||(S=!0)),r=A,A=A.return;return r.tag===3?(A=r.stateNode,S&&o!==null&&(S=31-le(d),r=A.hiddenUpdates,g=r[S],g===null?r[S]=[o]:g.push(o),o.lane=d|536870912),A):null}function Du(r){if(50<tu)throw tu=0,nu=null,Error(n(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var jo={};function Pg(r,o,d,g){this.tag=r,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fa(r,o,d,g){return new Pg(r,o,d,g)}function Ha(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Us(r,o){var d=r.alternate;return d===null?(d=Fa(r.tag,o,r.key,r.mode),d.elementType=r.elementType,d.type=r.type,d.stateNode=r.stateNode,d.alternate=r,r.alternate=d):(d.pendingProps=o,d.type=r.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=r.flags&65011712,d.childLanes=r.childLanes,d.lanes=r.lanes,d.child=r.child,d.memoizedProps=r.memoizedProps,d.memoizedState=r.memoizedState,d.updateQueue=r.updateQueue,o=r.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=r.sibling,d.index=r.index,d.ref=r.ref,d.refCleanup=r.refCleanup,d}function Ca(r,o){r.flags&=65011714;var d=r.alternate;return d===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=d.childLanes,r.lanes=d.lanes,r.child=d.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=d.memoizedProps,r.memoizedState=d.memoizedState,r.updateQueue=d.updateQueue,r.type=d.type,o=d.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function Oc(r,o,d,g,S,A){var F=0;if(g=r,typeof r=="function")Ha(r)&&(F=1);else if(typeof r=="string")F=bC(r,d,de.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case N:return r=Fa(31,d,o,S),r.elementType=N,r.lanes=A,r;case R:return ro(d.children,S,A,o);case T:F=8,S|=24;break;case E:return r=Fa(12,d,o,S|2),r.elementType=E,r.lanes=A,r;case I:return r=Fa(13,d,o,S),r.elementType=I,r.lanes=A,r;case O:return r=Fa(19,d,o,S),r.elementType=O,r.lanes=A,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case D:F=10;break e;case w:F=9;break e;case U:F=11;break e;case P:F=14;break e;case B:F=16,g=null;break e}F=29,d=Error(n(130,r===null?"null":typeof r,"")),g=null}return o=Fa(F,d,o,S),o.elementType=r,o.type=g,o.lanes=A,o}function ro(r,o,d,g){return r=Fa(7,r,g,o),r.lanes=d,r}function fh(r,o,d){return r=Fa(6,r,null,o),r.lanes=d,r}function Fg(r){var o=Fa(18,null,null,0);return o.stateNode=r,o}function fs(r,o,d){return o=Fa(4,r.children!==null?r.children:[],r.key,o),o.lanes=d,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var mp=new WeakMap;function Za(r,o){if(typeof r=="object"&&r!==null){var d=mp.get(r);return d!==void 0?d:(o={value:r,source:o,stack:ze(o)},mp.set(r,o),o)}return{value:r,source:o,stack:ze(o)}}var hs=[],Fl=0,Lc=null,Nu=0,gr=[],Ka=0,Ds=null,Ns=1,Os="";function so(r,o){hs[Fl++]=Nu,hs[Fl++]=Lc,Lc=r,Nu=o}function gp(r,o,d){gr[Ka++]=Ns,gr[Ka++]=Os,gr[Ka++]=Ds,Ds=r;var g=Ns;r=Os;var S=32-le(g)-1;g&=~(1<<S),d+=1;var A=32-le(o)+S;if(30<A){var F=S-S%5;A=(g&(1<<F)-1).toString(32),g>>=F,S-=F,Ns=1<<32-le(o)+S|d<<S|g,Os=A+r}else Ns=1<<A|d<<S|g,Os=r}function hh(r){r.return!==null&&(so(r,1),gp(r,1,0))}function Zo(r){for(;r===Lc;)Lc=hs[--Fl],hs[Fl]=null,Nu=hs[--Fl],hs[Fl]=null;for(;r===Ds;)Ds=gr[--Ka],gr[Ka]=null,Os=gr[--Ka],gr[Ka]=null,Ns=gr[--Ka],gr[Ka]=null}function zc(r,o){gr[Ka++]=Ns,gr[Ka++]=Os,gr[Ka++]=Ds,Ns=o.id,Os=o.overflow,Ds=r}var aa=null,fi=null,Dn=!1,oo=null,ra=!1,dh=Error(n(519));function Cn(r){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ic(Za(o,r)),dh}function ph(r){var o=r.stateNode,d=r.type,g=r.memoizedProps;switch(o[Jt]=r,o[k]=g,d){case"dialog":Nn("cancel",o),Nn("close",o);break;case"iframe":case"object":case"embed":Nn("load",o);break;case"video":case"audio":for(d=0;d<lm.length;d++)Nn(lm[d],o);break;case"source":Nn("error",o);break;case"img":case"image":case"link":Nn("error",o),Nn("load",o);break;case"details":Nn("toggle",o);break;case"input":Nn("invalid",o),ti(o,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":Nn("invalid",o);break;case"textarea":Nn("invalid",o),ki(o,g.value,g.defaultValue,g.children)}d=g.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||o.textContent===""+d||g.suppressHydrationWarning===!0||BM(o.textContent,d)?(g.popover!=null&&(Nn("beforetoggle",o),Nn("toggle",o)),g.onScroll!=null&&Nn("scroll",o),g.onScrollEnd!=null&&Nn("scrollend",o),g.onClick!=null&&(o.onclick=ha),o=!0):o=!1,o||Cn(r,!0)}function Hg(r){for(aa=r.return;aa;)switch(aa.tag){case 5:case 31:case 13:ra=!1;return;case 27:case 3:ra=!0;return;default:aa=aa.return}}function Hl(r){if(r!==aa)return!1;if(!Dn)return Hg(r),Dn=!0,!1;var o=r.tag,d;if((d=o!==3&&o!==27)&&((d=o===5)&&(d=r.type,d=!(d!=="form"&&d!=="button")||q_(r.type,r.memoizedProps)),d=!d),d&&fi&&Cn(r),Hg(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));fi=qM(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));fi=qM(r)}else o===27?(o=fi,Qu(r.type)?(r=Q_,Q_=null,fi=r):fi=o):fi=aa?Xs(r.stateNode.nextSibling):null;return!0}function Gl(){fi=aa=null,Dn=!1}function vp(){var r=oo;return r!==null&&(La===null?La=r:La.push.apply(La,r),oo=null),r}function Ic(r){oo===null?oo=[r]:oo.push(r)}var yp=H(null),lo=null,wa=null;function uo(r,o,d){re(yp,o._currentValue),o._currentValue=d}function Yr(r){r._currentValue=yp.current,W(yp)}function co(r,o,d){for(;r!==null;){var g=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,g!==null&&(g.childLanes|=o)):g!==null&&(g.childLanes&o)!==o&&(g.childLanes|=o),r===d)break;r=r.return}}function mh(r,o,d,g){var S=r.child;for(S!==null&&(S.return=r);S!==null;){var A=S.dependencies;if(A!==null){var F=S.child;A=A.firstContext;e:for(;A!==null;){var K=A;A=S;for(var Se=0;Se<o.length;Se++)if(K.context===o[Se]){A.lanes|=d,K=A.alternate,K!==null&&(K.lanes|=d),co(A.return,d,r),g||(F=null);break e}A=K.next}}else if(S.tag===18){if(F=S.return,F===null)throw Error(n(341));F.lanes|=d,A=F.alternate,A!==null&&(A.lanes|=d),co(F,d,r),F=null}else F=S.child;if(F!==null)F.return=S;else for(F=S;F!==null;){if(F===r){F=null;break}if(S=F.sibling,S!==null){S.return=F.return,F=S;break}F=F.return}S=F}}function Ko(r,o,d,g){r=null;for(var S=o,A=!1;S!==null;){if(!A){if((S.flags&524288)!==0)A=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var F=S.alternate;if(F===null)throw Error(n(387));if(F=F.memoizedProps,F!==null){var K=S.type;yi(S.pendingProps.value,F.value)||(r!==null?r.push(K):r=[K])}}else if(S===he.current){if(F=S.alternate,F===null)throw Error(n(387));F.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(r!==null?r.push(dm):r=[dm])}S=S.return}r!==null&&mh(o,r,d,g),o.flags|=262144}function Ou(r){for(r=r.firstContext;r!==null;){if(!yi(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Vl(r){lo=r,wa=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function sa(r){return _p(lo,r)}function Bc(r,o){return lo===null&&Vl(r),_p(r,o)}function _p(r,o){var d=o._currentValue;if(o={context:o,memoizedValue:d,next:null},wa===null){if(r===null)throw Error(n(308));wa=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else wa=wa.next=o;return d}var Gg=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(d,g){r.push(g)}};this.abort=function(){o.aborted=!0,r.forEach(function(d){return d()})}},Vg=s.unstable_scheduleCallback,xp=s.unstable_NormalPriority,Wt={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Sp(){return{controller:new Gg,data:new Map,refCount:0}}function ma(r){r.refCount--,r.refCount===0&&Vg(xp,function(){r.controller.abort()})}var kl=null,Mp=0,fo=0,ds=null;function Lu(r,o){if(kl===null){var d=kl=[];Mp=0,fo=B_(),ds={status:"pending",value:void 0,then:function(g){d.push(g)}}}return Mp++,o.then(bp,bp),o}function bp(){if(--Mp===0&&kl!==null){ds!==null&&(ds.status="fulfilled");var r=kl;kl=null,fo=0,ds=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function Ep(r,o){var d=[],g={status:"pending",value:null,reason:null,then:function(S){d.push(S)}};return r.then(function(){g.status="fulfilled",g.value=o;for(var S=0;S<d.length;S++)(0,d[S])(o)},function(S){for(g.status="rejected",g.reason=S,S=0;S<d.length;S++)(0,d[S])(void 0)}),g}var kg=G.S;G.S=function(r,o){ju=V(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&Lu(r,o),kg!==null&&kg(r,o)};var Qo=H(null);function Ls(){var r=Qo.current;return r!==null?r:Qn.pooledCache}function zu(r,o){o===null?re(Qo,Qo.current):re(Qo,o.pool)}function gh(){var r=Ls();return r===null?null:{parent:Wt._currentValue,pool:r}}var Jo=Error(n(460)),Pc=Error(n(474)),ps=Error(n(542)),Fc={then:function(){}};function Xg(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Tp(r,o,d){switch(d=r[d],d===void 0?r.push(o):d!==o&&(o.then(ha,ha),o=d),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,Ap(r),r;default:if(typeof o.status=="string")o.then(ha,ha);else{if(r=Qn,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=o,r.status="pending",r.then(function(g){if(o.status==="pending"){var S=o;S.status="fulfilled",S.value=g}},function(g){if(o.status==="pending"){var S=o;S.status="rejected",S.reason=g}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,Ap(r),r}throw Kt=o,Jo}}function Xl(r){try{var o=r._init;return o(r._payload)}catch(d){throw d!==null&&typeof d=="object"&&typeof d.then=="function"?(Kt=d,Jo):d}}var Kt=null;function vh(){if(Kt===null)throw Error(n(459));var r=Kt;return Kt=null,r}function Ap(r){if(r===Jo||r===ps)throw Error(n(483))}var $o=null,el=0;function yh(r){var o=el;return el+=1,$o===null&&($o=[]),Tp($o,r,o)}function Hc(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function Gc(r,o){throw o.$$typeof===_?Error(n(525)):(r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function Iu(r){function o(Ce,be){if(r){var He=Ce.deletions;He===null?(Ce.deletions=[be],Ce.flags|=16):He.push(be)}}function d(Ce,be){if(!r)return null;for(;be!==null;)o(Ce,be),be=be.sibling;return null}function g(Ce){for(var be=new Map;Ce!==null;)Ce.key!==null?be.set(Ce.key,Ce):be.set(Ce.index,Ce),Ce=Ce.sibling;return be}function S(Ce,be){return Ce=Us(Ce,be),Ce.index=0,Ce.sibling=null,Ce}function A(Ce,be,He){return Ce.index=He,r?(He=Ce.alternate,He!==null?(He=He.index,He<be?(Ce.flags|=67108866,be):He):(Ce.flags|=67108866,be)):(Ce.flags|=1048576,be)}function F(Ce){return r&&Ce.alternate===null&&(Ce.flags|=67108866),Ce}function K(Ce,be,He,mt){return be===null||be.tag!==6?(be=fh(He,Ce.mode,mt),be.return=Ce,be):(be=S(be,He),be.return=Ce,be)}function Se(Ce,be,He,mt){var Zt=He.type;return Zt===R?ft(Ce,be,He.props.children,mt,He.key):be!==null&&(be.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===B&&Xl(Zt)===be.type)?(be=S(be,He.props),Hc(be,He),be.return=Ce,be):(be=Oc(He.type,He.key,He.props,null,Ce.mode,mt),Hc(be,He),be.return=Ce,be)}function Ve(Ce,be,He,mt){return be===null||be.tag!==4||be.stateNode.containerInfo!==He.containerInfo||be.stateNode.implementation!==He.implementation?(be=fs(He,Ce.mode,mt),be.return=Ce,be):(be=S(be,He.children||[]),be.return=Ce,be)}function ft(Ce,be,He,mt,Zt){return be===null||be.tag!==7?(be=ro(He,Ce.mode,mt,Zt),be.return=Ce,be):(be=S(be,He),be.return=Ce,be)}function vt(Ce,be,He){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return be=fh(""+be,Ce.mode,He),be.return=Ce,be;if(typeof be=="object"&&be!==null){switch(be.$$typeof){case x:return He=Oc(be.type,be.key,be.props,null,Ce.mode,He),Hc(He,be),He.return=Ce,He;case b:return be=fs(be,Ce.mode,He),be.return=Ce,be;case B:return be=Xl(be),vt(Ce,be,He)}if(ae(be)||Y(be))return be=ro(be,Ce.mode,He,null),be.return=Ce,be;if(typeof be.then=="function")return vt(Ce,yh(be),He);if(be.$$typeof===D)return vt(Ce,Bc(Ce,be),He);Gc(Ce,be)}return null}function Ze(Ce,be,He,mt){var Zt=be!==null?be.key:null;if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return Zt!==null?null:K(Ce,be,""+He,mt);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case x:return He.key===Zt?Se(Ce,be,He,mt):null;case b:return He.key===Zt?Ve(Ce,be,He,mt):null;case B:return He=Xl(He),Ze(Ce,be,He,mt)}if(ae(He)||Y(He))return Zt!==null?null:ft(Ce,be,He,mt,null);if(typeof He.then=="function")return Ze(Ce,be,yh(He),mt);if(He.$$typeof===D)return Ze(Ce,be,Bc(Ce,He),mt);Gc(Ce,He)}return null}function nt(Ce,be,He,mt,Zt){if(typeof mt=="string"&&mt!==""||typeof mt=="number"||typeof mt=="bigint")return Ce=Ce.get(He)||null,K(be,Ce,""+mt,Zt);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case x:return Ce=Ce.get(mt.key===null?He:mt.key)||null,Se(be,Ce,mt,Zt);case b:return Ce=Ce.get(mt.key===null?He:mt.key)||null,Ve(be,Ce,mt,Zt);case B:return mt=Xl(mt),nt(Ce,be,He,mt,Zt)}if(ae(mt)||Y(mt))return Ce=Ce.get(He)||null,ft(be,Ce,mt,Zt,null);if(typeof mt.then=="function")return nt(Ce,be,He,yh(mt),Zt);if(mt.$$typeof===D)return nt(Ce,be,He,Bc(be,mt),Zt);Gc(be,mt)}return null}function Gt(Ce,be,He,mt){for(var Zt=null,$n=null,Yt=be,bn=be=0,Bn=null;Yt!==null&&bn<He.length;bn++){Yt.index>bn?(Bn=Yt,Yt=null):Bn=Yt.sibling;var ei=Ze(Ce,Yt,He[bn],mt);if(ei===null){Yt===null&&(Yt=Bn);break}r&&Yt&&ei.alternate===null&&o(Ce,Yt),be=A(ei,be,bn),$n===null?Zt=ei:$n.sibling=ei,$n=ei,Yt=Bn}if(bn===He.length)return d(Ce,Yt),Dn&&so(Ce,bn),Zt;if(Yt===null){for(;bn<He.length;bn++)Yt=vt(Ce,He[bn],mt),Yt!==null&&(be=A(Yt,be,bn),$n===null?Zt=Yt:$n.sibling=Yt,$n=Yt);return Dn&&so(Ce,bn),Zt}for(Yt=g(Yt);bn<He.length;bn++)Bn=nt(Yt,Ce,bn,He[bn],mt),Bn!==null&&(r&&Bn.alternate!==null&&Yt.delete(Bn.key===null?bn:Bn.key),be=A(Bn,be,bn),$n===null?Zt=Bn:$n.sibling=Bn,$n=Bn);return r&&Yt.forEach(function(nc){return o(Ce,nc)}),Dn&&so(Ce,bn),Zt}function tn(Ce,be,He,mt){if(He==null)throw Error(n(151));for(var Zt=null,$n=null,Yt=be,bn=be=0,Bn=null,ei=He.next();Yt!==null&&!ei.done;bn++,ei=He.next()){Yt.index>bn?(Bn=Yt,Yt=null):Bn=Yt.sibling;var nc=Ze(Ce,Yt,ei.value,mt);if(nc===null){Yt===null&&(Yt=Bn);break}r&&Yt&&nc.alternate===null&&o(Ce,Yt),be=A(nc,be,bn),$n===null?Zt=nc:$n.sibling=nc,$n=nc,Yt=Bn}if(ei.done)return d(Ce,Yt),Dn&&so(Ce,bn),Zt;if(Yt===null){for(;!ei.done;bn++,ei=He.next())ei=vt(Ce,ei.value,mt),ei!==null&&(be=A(ei,be,bn),$n===null?Zt=ei:$n.sibling=ei,$n=ei);return Dn&&so(Ce,bn),Zt}for(Yt=g(Yt);!ei.done;bn++,ei=He.next())ei=nt(Yt,Ce,bn,ei.value,mt),ei!==null&&(r&&ei.alternate!==null&&Yt.delete(ei.key===null?bn:ei.key),be=A(ei,be,bn),$n===null?Zt=ei:$n.sibling=ei,$n=ei);return r&&Yt.forEach(function(LC){return o(Ce,LC)}),Dn&&so(Ce,bn),Zt}function pi(Ce,be,He,mt){if(typeof He=="object"&&He!==null&&He.type===R&&He.key===null&&(He=He.props.children),typeof He=="object"&&He!==null){switch(He.$$typeof){case x:e:{for(var Zt=He.key;be!==null;){if(be.key===Zt){if(Zt=He.type,Zt===R){if(be.tag===7){d(Ce,be.sibling),mt=S(be,He.props.children),mt.return=Ce,Ce=mt;break e}}else if(be.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===B&&Xl(Zt)===be.type){d(Ce,be.sibling),mt=S(be,He.props),Hc(mt,He),mt.return=Ce,Ce=mt;break e}d(Ce,be);break}else o(Ce,be);be=be.sibling}He.type===R?(mt=ro(He.props.children,Ce.mode,mt,He.key),mt.return=Ce,Ce=mt):(mt=Oc(He.type,He.key,He.props,null,Ce.mode,mt),Hc(mt,He),mt.return=Ce,Ce=mt)}return F(Ce);case b:e:{for(Zt=He.key;be!==null;){if(be.key===Zt)if(be.tag===4&&be.stateNode.containerInfo===He.containerInfo&&be.stateNode.implementation===He.implementation){d(Ce,be.sibling),mt=S(be,He.children||[]),mt.return=Ce,Ce=mt;break e}else{d(Ce,be);break}else o(Ce,be);be=be.sibling}mt=fs(He,Ce.mode,mt),mt.return=Ce,Ce=mt}return F(Ce);case B:return He=Xl(He),pi(Ce,be,He,mt)}if(ae(He))return Gt(Ce,be,He,mt);if(Y(He)){if(Zt=Y(He),typeof Zt!="function")throw Error(n(150));return He=Zt.call(He),tn(Ce,be,He,mt)}if(typeof He.then=="function")return pi(Ce,be,yh(He),mt);if(He.$$typeof===D)return pi(Ce,be,Bc(Ce,He),mt);Gc(Ce,He)}return typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint"?(He=""+He,be!==null&&be.tag===6?(d(Ce,be.sibling),mt=S(be,He),mt.return=Ce,Ce=mt):(d(Ce,be),mt=fh(He,Ce.mode,mt),mt.return=Ce,Ce=mt),F(Ce)):d(Ce,be)}return function(Ce,be,He,mt){try{el=0;var Zt=pi(Ce,be,He,mt);return $o=null,Zt}catch(Yt){if(Yt===Jo||Yt===ps)throw Yt;var $n=Fa(29,Yt,null,Ce.mode);return $n.lanes=mt,$n.return=Ce,$n}}}var Yl=Iu(!0),Yg=Iu(!1),tl=!1;function Rp(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Cp(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function zs(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ho(r,o,d){var g=r.updateQueue;if(g===null)return null;if(g=g.shared,(zn&2)!==0){var S=g.pending;return S===null?o.next=o:(o.next=S.next,S.next=o),g.pending=o,o=Du(r),ch(r,null,d),o}return Nc(r,g,o,d),Du(r)}function nl(r,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194048)!==0)){var g=o.lanes;g&=r.pendingLanes,d|=g,o.lanes=d,ci(r,d)}}function _h(r,o){var d=r.updateQueue,g=r.alternate;if(g!==null&&(g=g.updateQueue,d===g)){var S=null,A=null;if(d=d.firstBaseUpdate,d!==null){do{var F={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};A===null?S=A=F:A=A.next=F,d=d.next}while(d!==null);A===null?S=A=o:A=A.next=o}else S=A=o;d={baseState:g.baseState,firstBaseUpdate:S,lastBaseUpdate:A,shared:g.shared,callbacks:g.callbacks},r.updateQueue=d;return}r=d.lastBaseUpdate,r===null?d.firstBaseUpdate=o:r.next=o,d.lastBaseUpdate=o}var wp=!1;function Vc(){if(wp){var r=ds;if(r!==null)throw r}}function ql(r,o,d,g){wp=!1;var S=r.updateQueue;tl=!1;var A=S.firstBaseUpdate,F=S.lastBaseUpdate,K=S.shared.pending;if(K!==null){S.shared.pending=null;var Se=K,Ve=Se.next;Se.next=null,F===null?A=Ve:F.next=Ve,F=Se;var ft=r.alternate;ft!==null&&(ft=ft.updateQueue,K=ft.lastBaseUpdate,K!==F&&(K===null?ft.firstBaseUpdate=Ve:K.next=Ve,ft.lastBaseUpdate=Se))}if(A!==null){var vt=S.baseState;F=0,ft=Ve=Se=null,K=A;do{var Ze=K.lane&-536870913,nt=Ze!==K.lane;if(nt?(wn&Ze)===Ze:(g&Ze)===Ze){Ze!==0&&Ze===fo&&(wp=!0),ft!==null&&(ft=ft.next={lane:0,tag:K.tag,payload:K.payload,callback:null,next:null});e:{var Gt=r,tn=K;Ze=o;var pi=d;switch(tn.tag){case 1:if(Gt=tn.payload,typeof Gt=="function"){vt=Gt.call(pi,vt,Ze);break e}vt=Gt;break e;case 3:Gt.flags=Gt.flags&-65537|128;case 0:if(Gt=tn.payload,Ze=typeof Gt=="function"?Gt.call(pi,vt,Ze):Gt,Ze==null)break e;vt=v({},vt,Ze);break e;case 2:tl=!0}}Ze=K.callback,Ze!==null&&(r.flags|=64,nt&&(r.flags|=8192),nt=S.callbacks,nt===null?S.callbacks=[Ze]:nt.push(Ze))}else nt={lane:Ze,tag:K.tag,payload:K.payload,callback:K.callback,next:null},ft===null?(Ve=ft=nt,Se=vt):ft=ft.next=nt,F|=Ze;if(K=K.next,K===null){if(K=S.shared.pending,K===null)break;nt=K,K=nt.next,nt.next=null,S.lastBaseUpdate=nt,S.shared.pending=null}}while(!0);ft===null&&(Se=vt),S.baseState=Se,S.firstBaseUpdate=Ve,S.lastBaseUpdate=ft,A===null&&(S.shared.lanes=0),Rr|=F,r.lanes=F,r.memoizedState=vt}}function Is(r,o){if(typeof r!="function")throw Error(n(191,r));r.call(o)}function ga(r,o){var d=r.callbacks;if(d!==null)for(r.callbacks=null,r=0;r<d.length;r++)Is(d[r],o)}var vr=H(null),Ga=H(0);function Up(r,o){r=Hi,re(Ga,r),re(vr,o),Hi=r|o.baseLanes}function Dp(){re(Ga,Hi),re(vr,vr.current)}function Ua(){Hi=Ga.current,W(vr),W(Ga)}var Qi=H(null),qr=null;function il(r){var o=r.alternate;re(Ci,Ci.current&1),re(Qi,r),qr===null&&(o===null||vr.current!==null||o.memoizedState!==null)&&(qr=r)}function Np(r){re(Ci,Ci.current),re(Qi,r),qr===null&&(qr=r)}function qg(r){r.tag===22?(re(Ci,Ci.current),re(Qi,r),qr===null&&(qr=r)):po()}function po(){re(Ci,Ci.current),re(Qi,Qi.current)}function yr(r){W(Qi),qr===r&&(qr=null),W(Ci)}var Ci=H(0);function xh(r){for(var o=r;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||Z_(d)||K_(d)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Qa=0,nn=null,si=null,Yi=null,Sh=!1,Bs=!1,Wl=!1,Mh=0,kc=0,Ps=null,R_=0;function wi(){throw Error(n(321))}function Op(r,o){if(o===null)return!1;for(var d=0;d<o.length&&d<r.length;d++)if(!yi(r[d],o[d]))return!1;return!0}function Lp(r,o,d,g,S,A){return Qa=A,nn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,G.H=r===null||r.memoizedState===null?h0:Fu,Wl=!1,A=d(g,S),Wl=!1,Bs&&(A=jg(o,d,g,S)),Wg(r),A}function Wg(r){G.H=jc;var o=si!==null&&si.next!==null;if(Qa=0,Yi=si=nn=null,Sh=!1,kc=0,Ps=null,o)throw Error(n(300));r===null||_i||(r=r.dependencies,r!==null&&Ou(r)&&(_i=!0))}function jg(r,o,d,g){nn=r;var S=0;do{if(Bs&&(Ps=null),kc=0,Bs=!1,25<=S)throw Error(n(301));if(S+=1,Yi=si=null,r.updateQueue!=null){var A=r.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}G.H=Zc,A=o(d,g)}while(Bs);return A}function C_(){var r=G.H,o=r.useState()[0];return o=typeof o.then=="function"?Yc(o):o,r=r.useState()[0],(si!==null?si.memoizedState:null)!==r&&(nn.flags|=1024),o}function zp(){var r=Mh!==0;return Mh=0,r}function Ip(r,o,d){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~d}function Bp(r){if(Sh){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Sh=!1}Qa=0,Yi=si=nn=null,Bs=!1,kc=Mh=0,Ps=null}function Va(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yi===null?nn.memoizedState=Yi=r:Yi=Yi.next=r,Yi}function Ii(){if(si===null){var r=nn.alternate;r=r!==null?r.memoizedState:null}else r=si.next;var o=Yi===null?nn.memoizedState:Yi.next;if(o!==null)Yi=o,si=r;else{if(r===null)throw nn.alternate===null?Error(n(467)):Error(n(310));si=r,r={memoizedState:si.memoizedState,baseState:si.baseState,baseQueue:si.baseQueue,queue:si.queue,next:null},Yi===null?nn.memoizedState=Yi=r:Yi=Yi.next=r}return Yi}function Xc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yc(r){var o=kc;return kc+=1,Ps===null&&(Ps=[]),r=Tp(Ps,r,o),o=nn,(Yi===null?o.memoizedState:Yi.next)===null&&(o=o.alternate,G.H=o===null||o.memoizedState===null?h0:Fu),r}function bh(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Yc(r);if(r.$$typeof===D)return sa(r)}throw Error(n(438,String(r)))}function Pp(r){var o=null,d=nn.updateQueue;if(d!==null&&(o=d.memoCache),o==null){var g=nn.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(o={data:g.data.map(function(S){return S.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),d===null&&(d=Xc(),nn.updateQueue=d),d.memoCache=o,d=o.data[o.index],d===void 0)for(d=o.data[o.index]=Array(r),g=0;g<r;g++)d[g]=z;return o.index++,d}function mo(r,o){return typeof o=="function"?o(r):o}function Eh(r){var o=Ii();return Fp(o,si,r)}function Fp(r,o,d){var g=r.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=d;var S=r.baseQueue,A=g.pending;if(A!==null){if(S!==null){var F=S.next;S.next=A.next,A.next=F}o.baseQueue=S=A,g.pending=null}if(A=r.baseState,S===null)r.memoizedState=A;else{o=S.next;var K=F=null,Se=null,Ve=o,ft=!1;do{var vt=Ve.lane&-536870913;if(vt!==Ve.lane?(wn&vt)===vt:(Qa&vt)===vt){var Ze=Ve.revertLane;if(Ze===0)Se!==null&&(Se=Se.next={lane:0,revertLane:0,gesture:null,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null}),vt===fo&&(ft=!0);else if((Qa&Ze)===Ze){Ve=Ve.next,Ze===fo&&(ft=!0);continue}else vt={lane:0,revertLane:Ve.revertLane,gesture:null,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null},Se===null?(K=Se=vt,F=A):Se=Se.next=vt,nn.lanes|=Ze,Rr|=Ze;vt=Ve.action,Wl&&d(A,vt),A=Ve.hasEagerState?Ve.eagerState:d(A,vt)}else Ze={lane:vt,revertLane:Ve.revertLane,gesture:Ve.gesture,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null},Se===null?(K=Se=Ze,F=A):Se=Se.next=Ze,nn.lanes|=vt,Rr|=vt;Ve=Ve.next}while(Ve!==null&&Ve!==o);if(Se===null?F=A:Se.next=K,!yi(A,r.memoizedState)&&(_i=!0,ft&&(d=ds,d!==null)))throw d;r.memoizedState=A,r.baseState=F,r.baseQueue=Se,g.lastRenderedState=A}return S===null&&(g.lanes=0),[r.memoizedState,g.dispatch]}function Th(r){var o=Ii(),d=o.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=r;var g=d.dispatch,S=d.pending,A=o.memoizedState;if(S!==null){d.pending=null;var F=S=S.next;do A=r(A,F.action),F=F.next;while(F!==S);yi(A,o.memoizedState)||(_i=!0),o.memoizedState=A,o.baseQueue===null&&(o.baseState=A),d.lastRenderedState=A}return[A,g]}function Hp(r,o,d){var g=nn,S=Ii(),A=Dn;if(A){if(d===void 0)throw Error(n(407));d=d()}else d=o();var F=!yi((si||S).memoizedState,d);if(F&&(S.memoizedState=d,_i=!0),S=S.queue,Yp(Vp.bind(null,g,S,r),[r]),S.getSnapshot!==o||F||Yi!==null&&Yi.memoizedState.tag&1){if(g.flags|=2048,Bu(9,{destroy:void 0},Gp.bind(null,g,S,d,o),null),Qn===null)throw Error(n(349));A||(Qa&127)!==0||Zg(g,o,d)}return d}function Zg(r,o,d){r.flags|=16384,r={getSnapshot:o,value:d},o=nn.updateQueue,o===null?(o=Xc(),nn.updateQueue=o,o.stores=[r]):(d=o.stores,d===null?o.stores=[r]:d.push(r))}function Gp(r,o,d,g){o.value=d,o.getSnapshot=g,kp(o)&&Ah(r)}function Vp(r,o,d){return d(function(){kp(o)&&Ah(r)})}function kp(r){var o=r.getSnapshot;r=r.value;try{var d=o();return!yi(r,d)}catch{return!0}}function Ah(r){var o=Wo(r,2);o!==null&&h(o,r,2)}function qc(r){var o=Va();if(typeof r=="function"){var d=r;if(r=d(),Wl){lt(!0);try{d()}finally{lt(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:r},o}function Kg(r,o,d,g){return r.baseState=d,Fp(r,si,typeof g=="function"?g:mo)}function w_(r,o,d,g,S){if(go(r))throw Error(n(485));if(r=o.action,r!==null){var A={payload:S,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(F){A.listeners.push(F)}};G.T!==null?d(!0):A.isTransition=!1,g(A),d=o.pending,d===null?(A.next=o.pending=A,Qg(o,A)):(A.next=d.next,o.pending=d.next=A)}}function Qg(r,o){var d=o.action,g=o.payload,S=r.state;if(o.isTransition){var A=G.T,F={};G.T=F;try{var K=d(S,g),Se=G.S;Se!==null&&Se(F,K),Jg(r,o,K)}catch(Ve){Rh(r,o,Ve)}finally{A!==null&&F.types!==null&&(A.types=F.types),G.T=A}}else try{A=d(S,g),Jg(r,o,A)}catch(Ve){Rh(r,o,Ve)}}function Jg(r,o,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(g){Xp(r,o,g)},function(g){return Rh(r,o,g)}):Xp(r,o,d)}function Xp(r,o,d){o.status="fulfilled",o.value=d,$g(o),r.state=d,o=r.pending,o!==null&&(d=o.next,d===o?r.pending=null:(d=d.next,o.next=d,Qg(r,d)))}function Rh(r,o,d){var g=r.pending;if(r.pending=null,g!==null){g=g.next;do o.status="rejected",o.reason=d,$g(o),o=o.next;while(o!==g)}r.action=null}function $g(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function e0(r,o){return o}function t0(r,o){if(Dn){var d=Qn.formState;if(d!==null){e:{var g=nn;if(Dn){if(fi){t:{for(var S=fi,A=ra;S.nodeType!==8;){if(!A){S=null;break t}if(S=Xs(S.nextSibling),S===null){S=null;break t}}A=S.data,S=A==="F!"||A==="F"?S:null}if(S){fi=Xs(S.nextSibling),g=S.data==="F!";break e}}Cn(g)}g=!1}g&&(o=d[0])}}return d=Va(),d.memoizedState=d.baseState=o,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e0,lastRenderedState:o},d.queue=g,d=f0.bind(null,nn,g),g.dispatch=d,g=qc(!1),A=Wc.bind(null,nn,!1,g.queue),g=Va(),S={state:o,dispatch:null,action:r,pending:null},g.queue=S,d=w_.bind(null,nn,S,A,d),S.dispatch=d,g.memoizedState=r,[o,d,!1]}function n0(r){var o=Ii();return i0(o,si,r)}function i0(r,o,d){if(o=Fp(r,o,e0)[0],r=Eh(mo)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var g=Yc(o)}catch(F){throw F===Jo?ps:F}else g=o;o=Ii();var S=o.queue,A=S.dispatch;return d!==o.memoizedState&&(nn.flags|=2048,Bu(9,{destroy:void 0},U_.bind(null,S,d),null)),[g,A,r]}function U_(r,o){r.action=o}function a0(r){var o=Ii(),d=si;if(d!==null)return i0(o,d,r);Ii(),o=o.memoizedState,d=Ii();var g=d.queue.dispatch;return d.memoizedState=r,[o,g,!1]}function Bu(r,o,d,g){return r={tag:r,create:d,deps:g,inst:o,next:null},o=nn.updateQueue,o===null&&(o=Xc(),nn.updateQueue=o),d=o.lastEffect,d===null?o.lastEffect=r.next=r:(g=d.next,d.next=r,r.next=g,o.lastEffect=r),r}function r0(){return Ii().memoizedState}function Ch(r,o,d,g){var S=Va();nn.flags|=r,S.memoizedState=Bu(1|o,{destroy:void 0},d,g===void 0?null:g)}function wh(r,o,d,g){var S=Ii();g=g===void 0?null:g;var A=S.memoizedState.inst;si!==null&&g!==null&&Op(g,si.memoizedState.deps)?S.memoizedState=Bu(o,A,d,g):(nn.flags|=r,S.memoizedState=Bu(1|o,A,d,g))}function s0(r,o){Ch(8390656,8,r,o)}function Yp(r,o){wh(2048,8,r,o)}function o0(r){nn.flags|=4;var o=nn.updateQueue;if(o===null)o=Xc(),nn.updateQueue=o,o.events=[r];else{var d=o.events;d===null?o.events=[r]:d.push(r)}}function l0(r){var o=Ii().memoizedState;return o0({ref:o,nextImpl:r}),function(){if((zn&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function u0(r,o){return wh(4,2,r,o)}function _r(r,o){return wh(4,4,r,o)}function qp(r,o){if(typeof o=="function"){r=r();var d=o(r);return function(){typeof d=="function"?d():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function Uh(r,o,d){d=d!=null?d.concat([r]):null,wh(4,4,qp.bind(null,o,r),d)}function Dh(){}function Wp(r,o){var d=Ii();o=o===void 0?null:o;var g=d.memoizedState;return o!==null&&Op(o,g[1])?g[0]:(d.memoizedState=[r,o],r)}function jp(r,o){var d=Ii();o=o===void 0?null:o;var g=d.memoizedState;if(o!==null&&Op(o,g[1]))return g[0];if(g=r(),Wl){lt(!0);try{r()}finally{lt(!1)}}return d.memoizedState=[g,o],g}function Zp(r,o,d){return d===void 0||(Qa&1073741824)!==0&&(wn&261930)===0?r.memoizedState=o:(r.memoizedState=d,r=c(),nn.lanes|=r,Rr|=r,d)}function Kp(r,o,d,g){return yi(d,o)?d:vr.current!==null?(r=Zp(r,d,g),yi(r,o)||(_i=!0),r):(Qa&42)===0||(Qa&1073741824)!==0&&(wn&261930)===0?(_i=!0,r.memoizedState=d):(r=c(),nn.lanes|=r,Rr|=r,o)}function Qp(r,o,d,g,S){var A=ee.p;ee.p=A!==0&&8>A?A:8;var F=G.T,K={};G.T=K,Wc(r,!1,o,d);try{var Se=S(),Ve=G.S;if(Ve!==null&&Ve(K,Se),Se!==null&&typeof Se=="object"&&typeof Se.then=="function"){var ft=Ep(Se,g);Pu(r,o,ft,Xa(r))}else Pu(r,o,g,Xa(r))}catch(vt){Pu(r,o,{then:function(){},status:"rejected",reason:vt},Xa())}finally{ee.p=A,F!==null&&K.types!==null&&(F.types=K.types),G.T=F}}function D_(){}function Jp(r,o,d,g){if(r.tag!==5)throw Error(n(476));var S=c0(r).queue;Qp(r,S,o,ie,d===null?D_:function(){return $p(r),d(g)})}function c0(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:ie,baseState:ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:ie},next:null};var d={};return o.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:d},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function $p(r){var o=c0(r);o.next===null&&(o=r.alternate.memoizedState),Pu(r,o.next.queue,{},Xa())}function em(){return sa(dm)}function va(){return Ii().memoizedState}function tm(){return Ii().memoizedState}function N_(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var d=Xa();r=zs(d);var g=ho(o,r,d);g!==null&&(h(g,o,d),nl(g,o,d)),o={cache:Sp()},r.payload=o;return}o=o.return}}function O_(r,o,d){var g=Xa();d={lane:g,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},go(r)?jl(o,d):(d=Uu(r,o,d,g),d!==null&&(h(d,r,g),Ja(d,o,g)))}function f0(r,o,d){var g=Xa();Pu(r,o,d,g)}function Pu(r,o,d,g){var S={lane:g,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null};if(go(r))jl(o,S);else{var A=r.alternate;if(r.lanes===0&&(A===null||A.lanes===0)&&(A=o.lastRenderedReducer,A!==null))try{var F=o.lastRenderedState,K=A(F,d);if(S.hasEagerState=!0,S.eagerState=K,yi(K,F))return Nc(r,o,S,0),Qn===null&&qo(),!1}catch{}if(d=Uu(r,o,S,g),d!==null)return h(d,r,g),Ja(d,o,g),!0}return!1}function Wc(r,o,d,g){if(g={lane:2,revertLane:B_(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},go(r)){if(o)throw Error(n(479))}else o=Uu(r,d,g,2),o!==null&&h(o,r,2)}function go(r){var o=r.alternate;return r===nn||o!==null&&o===nn}function jl(r,o){Bs=Sh=!0;var d=r.pending;d===null?o.next=o:(o.next=d.next,d.next=o),r.pending=o}function Ja(r,o,d){if((d&4194048)!==0){var g=o.lanes;g&=r.pendingLanes,d|=g,o.lanes=d,ci(r,d)}}var jc={readContext:sa,use:bh,useCallback:wi,useContext:wi,useEffect:wi,useImperativeHandle:wi,useLayoutEffect:wi,useInsertionEffect:wi,useMemo:wi,useReducer:wi,useRef:wi,useState:wi,useDebugValue:wi,useDeferredValue:wi,useTransition:wi,useSyncExternalStore:wi,useId:wi,useHostTransitionStatus:wi,useFormState:wi,useActionState:wi,useOptimistic:wi,useMemoCache:wi,useCacheRefresh:wi};jc.useEffectEvent=wi;var h0={readContext:sa,use:bh,useCallback:function(r,o){return Va().memoizedState=[r,o===void 0?null:o],r},useContext:sa,useEffect:s0,useImperativeHandle:function(r,o,d){d=d!=null?d.concat([r]):null,Ch(4194308,4,qp.bind(null,o,r),d)},useLayoutEffect:function(r,o){return Ch(4194308,4,r,o)},useInsertionEffect:function(r,o){Ch(4,2,r,o)},useMemo:function(r,o){var d=Va();o=o===void 0?null:o;var g=r();if(Wl){lt(!0);try{r()}finally{lt(!1)}}return d.memoizedState=[g,o],g},useReducer:function(r,o,d){var g=Va();if(d!==void 0){var S=d(o);if(Wl){lt(!0);try{d(o)}finally{lt(!1)}}}else S=o;return g.memoizedState=g.baseState=S,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:S},g.queue=r,r=r.dispatch=O_.bind(null,nn,r),[g.memoizedState,r]},useRef:function(r){var o=Va();return r={current:r},o.memoizedState=r},useState:function(r){r=qc(r);var o=r.queue,d=f0.bind(null,nn,o);return o.dispatch=d,[r.memoizedState,d]},useDebugValue:Dh,useDeferredValue:function(r,o){var d=Va();return Zp(d,r,o)},useTransition:function(){var r=qc(!1);return r=Qp.bind(null,nn,r.queue,!0,!1),Va().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,d){var g=nn,S=Va();if(Dn){if(d===void 0)throw Error(n(407));d=d()}else{if(d=o(),Qn===null)throw Error(n(349));(wn&127)!==0||Zg(g,o,d)}S.memoizedState=d;var A={value:d,getSnapshot:o};return S.queue=A,s0(Vp.bind(null,g,A,r),[r]),g.flags|=2048,Bu(9,{destroy:void 0},Gp.bind(null,g,A,d,o),null),d},useId:function(){var r=Va(),o=Qn.identifierPrefix;if(Dn){var d=Os,g=Ns;d=(g&~(1<<32-le(g)-1)).toString(32)+d,o="_"+o+"R_"+d,d=Mh++,0<d&&(o+="H"+d.toString(32)),o+="_"}else d=R_++,o="_"+o+"r_"+d.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:em,useFormState:t0,useActionState:t0,useOptimistic:function(r){var o=Va();o.memoizedState=o.baseState=r;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=d,o=Wc.bind(null,nn,!0,d),d.dispatch=o,[r,o]},useMemoCache:Pp,useCacheRefresh:function(){return Va().memoizedState=N_.bind(null,nn)},useEffectEvent:function(r){var o=Va(),d={impl:r};return o.memoizedState=d,function(){if((zn&2)!==0)throw Error(n(440));return d.impl.apply(void 0,arguments)}}},Fu={readContext:sa,use:bh,useCallback:Wp,useContext:sa,useEffect:Yp,useImperativeHandle:Uh,useInsertionEffect:u0,useLayoutEffect:_r,useMemo:jp,useReducer:Eh,useRef:r0,useState:function(){return Eh(mo)},useDebugValue:Dh,useDeferredValue:function(r,o){var d=Ii();return Kp(d,si.memoizedState,r,o)},useTransition:function(){var r=Eh(mo)[0],o=Ii().memoizedState;return[typeof r=="boolean"?r:Yc(r),o]},useSyncExternalStore:Hp,useId:va,useHostTransitionStatus:em,useFormState:n0,useActionState:n0,useOptimistic:function(r,o){var d=Ii();return Kg(d,si,r,o)},useMemoCache:Pp,useCacheRefresh:tm};Fu.useEffectEvent=l0;var Zc={readContext:sa,use:bh,useCallback:Wp,useContext:sa,useEffect:Yp,useImperativeHandle:Uh,useInsertionEffect:u0,useLayoutEffect:_r,useMemo:jp,useReducer:Th,useRef:r0,useState:function(){return Th(mo)},useDebugValue:Dh,useDeferredValue:function(r,o){var d=Ii();return si===null?Zp(d,r,o):Kp(d,si.memoizedState,r,o)},useTransition:function(){var r=Th(mo)[0],o=Ii().memoizedState;return[typeof r=="boolean"?r:Yc(r),o]},useSyncExternalStore:Hp,useId:va,useHostTransitionStatus:em,useFormState:a0,useActionState:a0,useOptimistic:function(r,o){var d=Ii();return si!==null?Kg(d,si,r,o):(d.baseState=r,[r,d.queue.dispatch])},useMemoCache:Pp,useCacheRefresh:tm};Zc.useEffectEvent=l0;function Hu(r,o,d,g){o=r.memoizedState,d=d(g,o),d=d==null?o:v({},o,d),r.memoizedState=d,r.lanes===0&&(r.updateQueue.baseState=d)}var Kc={enqueueSetState:function(r,o,d){r=r._reactInternals;var g=Xa(),S=zs(g);S.payload=o,d!=null&&(S.callback=d),o=ho(r,S,g),o!==null&&(h(o,r,g),nl(o,r,g))},enqueueReplaceState:function(r,o,d){r=r._reactInternals;var g=Xa(),S=zs(g);S.tag=1,S.payload=o,d!=null&&(S.callback=d),o=ho(r,S,g),o!==null&&(h(o,r,g),nl(o,r,g))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var d=Xa(),g=zs(d);g.tag=2,o!=null&&(g.callback=o),o=ho(r,g,d),o!==null&&(h(o,r,d),nl(o,r,d))}};function d0(r,o,d,g,S,A,F){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(g,A,F):o.prototype&&o.prototype.isPureReactComponent?!Eu(d,g)||!Eu(S,A):!0}function p0(r,o,d,g){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,g),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,g),o.state!==r&&Kc.enqueueReplaceState(o,o.state,null)}function ya(r,o){var d=o;if("ref"in o){d={};for(var g in o)g!=="ref"&&(d[g]=o[g])}if(r=r.defaultProps){d===o&&(d=v({},d));for(var S in r)d[S]===void 0&&(d[S]=r[S])}return d}function nm(r){Yo(r)}function m0(r){console.error(r)}function Nh(r){Yo(r)}function Oh(r,o){try{var d=r.onUncaughtError;d(o.value,{componentStack:o.stack})}catch(g){setTimeout(function(){throw g})}}function g0(r,o,d){try{var g=r.onCaughtError;g(d.value,{componentStack:d.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function im(r,o,d){return d=zs(d),d.tag=3,d.payload={element:null},d.callback=function(){Oh(r,o)},d}function Gu(r){return r=zs(r),r.tag=3,r}function $a(r,o,d,g){var S=d.type.getDerivedStateFromError;if(typeof S=="function"){var A=g.value;r.payload=function(){return S(A)},r.callback=function(){g0(o,d,g)}}var F=d.stateNode;F!==null&&typeof F.componentDidCatch=="function"&&(r.callback=function(){g0(o,d,g),typeof S!="function"&&(ks===null?ks=new Set([this]):ks.add(this));var K=g.stack;this.componentDidCatch(g.value,{componentStack:K!==null?K:""})})}function xr(r,o,d,g,S){if(d.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(o=d.alternate,o!==null&&Ko(o,d,S,!0),d=Qi.current,d!==null){switch(d.tag){case 31:case 13:return qr===null?ln():d.alternate===null&&Jn===0&&(Jn=3),d.flags&=-257,d.flags|=65536,d.lanes=S,g===Fc?d.flags|=16384:(o=d.updateQueue,o===null?d.updateQueue=new Set([g]):o.add(g),L_(r,g,S)),!1;case 22:return d.flags|=65536,g===Fc?d.flags|=16384:(o=d.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([g])},d.updateQueue=o):(d=o.retryQueue,d===null?o.retryQueue=new Set([g]):d.add(g)),L_(r,g,S)),!1}throw Error(n(435,d.tag))}return L_(r,g,S),ln(),!1}if(Dn)return o=Qi.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=S,g!==dh&&(r=Error(n(422),{cause:g}),Ic(Za(r,d)))):(g!==dh&&(o=Error(n(423),{cause:g}),Ic(Za(o,d))),r=r.current.alternate,r.flags|=65536,S&=-S,r.lanes|=S,g=Za(g,d),S=im(r.stateNode,g,S),_h(r,S),Jn!==4&&(Jn=2)),!1;var A=Error(n(520),{cause:g});if(A=Za(A,d),_s===null?_s=[A]:_s.push(A),Jn!==4&&(Jn=2),o===null)return!0;g=Za(g,d),d=o;do{switch(d.tag){case 3:return d.flags|=65536,r=S&-S,d.lanes|=r,r=im(d.stateNode,g,r),_h(d,r),!1;case 1:if(o=d.type,A=d.stateNode,(d.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(ks===null||!ks.has(A))))return d.flags|=65536,S&=-S,d.lanes|=S,S=Gu(S),$a(S,r,d,g),_h(d,S),!1}d=d.return}while(d!==null);return!1}var Lh=Error(n(461)),_i=!1;function Ui(r,o,d,g){o.child=r===null?Yg(o,null,d,g):Yl(o,r.child,d,g)}function Qc(r,o,d,g,S){d=d.render;var A=o.ref;if("ref"in g){var F={};for(var K in g)K!=="ref"&&(F[K]=g[K])}else F=g;return Vl(o),g=Lp(r,o,d,F,A,S),K=zp(),r!==null&&!_i?(Ip(r,o,S),vs(r,o,S)):(Dn&&K&&hh(o),o.flags|=1,Ui(r,o,g,S),o.child)}function Jc(r,o,d,g,S){if(r===null){var A=d.type;return typeof A=="function"&&!Ha(A)&&A.defaultProps===void 0&&d.compare===null?(o.tag=15,o.type=A,Sr(r,o,A,g,S)):(r=Oc(d.type,null,g,o,o.mode,S),r.ref=o.ref,r.return=o,o.child=r)}if(A=r.child,!rl(r,S)){var F=A.memoizedProps;if(d=d.compare,d=d!==null?d:Eu,d(F,g)&&r.ref===o.ref)return vs(r,o,S)}return o.flags|=1,r=Us(A,g),r.ref=o.ref,r.return=o,o.child=r}function Sr(r,o,d,g,S){if(r!==null){var A=r.memoizedProps;if(Eu(A,g)&&r.ref===o.ref)if(_i=!1,o.pendingProps=g=A,rl(r,S))(r.flags&131072)!==0&&(_i=!0);else return o.lanes=r.lanes,vs(r,o,S)}return Vu(r,o,d,g,S)}function Mr(r,o,d,g){var S=g.children,A=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((o.flags&128)!==0){if(A=A!==null?A.baseLanes|d:d,r!==null){for(g=o.child=r.child,S=0;g!==null;)S=S|g.lanes|g.childLanes,g=g.sibling;g=S&~A}else g=0,o.child=null;return Fs(r,o,A,d,g)}if((d&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&zu(o,A!==null?A.cachePool:null),A!==null?Up(o,A):Dp(),qg(o);else return g=o.lanes=536870912,Fs(r,o,A!==null?A.baseLanes|d:d,d,g)}else A!==null?(zu(o,A.cachePool),Up(o,A),po(),o.memoizedState=null):(r!==null&&zu(o,null),Dp(),po());return Ui(r,o,S,d),o.child}function ms(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function Fs(r,o,d,g,S){var A=Ls();return A=A===null?null:{parent:Wt._currentValue,pool:A},o.memoizedState={baseLanes:d,cachePool:A},r!==null&&zu(o,null),Dp(),qg(o),r!==null&&Ko(r,o,g,!0),o.childLanes=S,null}function Wr(r,o){return o=ku({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function oa(r,o,d){return Yl(o,r.child,null,d),r=Wr(o,o.pendingProps),r.flags|=2,yr(o),o.memoizedState=null,r}function $c(r,o,d){var g=o.pendingProps,S=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(Dn){if(g.mode==="hidden")return r=Wr(o,g),o.lanes=536870912,ms(null,r);if(Np(o),(r=fi)?(r=YM(r,ra),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Ds!==null?{id:Ns,overflow:Os}:null,retryLane:536870912,hydrationErrors:null},d=Fg(r),d.return=o,o.child=d,aa=o,fi=null)):r=null,r===null)throw Cn(o);return o.lanes=536870912,null}return Wr(o,g)}var A=r.memoizedState;if(A!==null){var F=A.dehydrated;if(Np(o),S)if(o.flags&256)o.flags&=-257,o=oa(r,o,d);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(n(558));else if(_i||Ko(r,o,d,!1),S=(d&r.childLanes)!==0,_i||S){if(g=Qn,g!==null&&(F=Ti(g,d),F!==0&&F!==A.retryLane))throw A.retryLane=F,Wo(r,F),h(g,r,F),Lh;ln(),o=oa(r,o,d)}else r=A.treeContext,fi=Xs(F.nextSibling),aa=o,Dn=!0,oo=null,ra=!1,r!==null&&zc(o,r),o=Wr(o,g),o.flags|=4096;return o}return r=Us(r.child,{mode:g.mode,children:g.children}),r.ref=o.ref,o.child=r,r.return=o,r}function gs(r,o){var d=o.ref;if(d===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(n(284));(r===null||r.ref!==d)&&(o.flags|=4194816)}}function Vu(r,o,d,g,S){return Vl(o),d=Lp(r,o,d,g,void 0,S),g=zp(),r!==null&&!_i?(Ip(r,o,S),vs(r,o,S)):(Dn&&g&&hh(o),o.flags|=1,Ui(r,o,d,S),o.child)}function Da(r,o,d,g,S,A){return Vl(o),o.updateQueue=null,d=jg(o,g,d,S),Wg(r),g=zp(),r!==null&&!_i?(Ip(r,o,A),vs(r,o,A)):(Dn&&g&&hh(o),o.flags|=1,Ui(r,o,d,A),o.child)}function _a(r,o,d,g,S){if(Vl(o),o.stateNode===null){var A=jo,F=d.contextType;typeof F=="object"&&F!==null&&(A=sa(F)),A=new d(g,A),o.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=Kc,o.stateNode=A,A._reactInternals=o,A=o.stateNode,A.props=g,A.state=o.memoizedState,A.refs={},Rp(o),F=d.contextType,A.context=typeof F=="object"&&F!==null?sa(F):jo,A.state=o.memoizedState,F=d.getDerivedStateFromProps,typeof F=="function"&&(Hu(o,d,F,g),A.state=o.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(F=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),F!==A.state&&Kc.enqueueReplaceState(A,A.state,null),ql(o,g,A,S),Vc(),A.state=o.memoizedState),typeof A.componentDidMount=="function"&&(o.flags|=4194308),g=!0}else if(r===null){A=o.stateNode;var K=o.memoizedProps,Se=ya(d,K);A.props=Se;var Ve=A.context,ft=d.contextType;F=jo,typeof ft=="object"&&ft!==null&&(F=sa(ft));var vt=d.getDerivedStateFromProps;ft=typeof vt=="function"||typeof A.getSnapshotBeforeUpdate=="function",K=o.pendingProps!==K,ft||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(K||Ve!==F)&&p0(o,A,g,F),tl=!1;var Ze=o.memoizedState;A.state=Ze,ql(o,g,A,S),Vc(),Ve=o.memoizedState,K||Ze!==Ve||tl?(typeof vt=="function"&&(Hu(o,d,vt,g),Ve=o.memoizedState),(Se=tl||d0(o,d,Se,g,Ze,Ve,F))?(ft||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(o.flags|=4194308)):(typeof A.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=g,o.memoizedState=Ve),A.props=g,A.state=Ve,A.context=F,g=Se):(typeof A.componentDidMount=="function"&&(o.flags|=4194308),g=!1)}else{A=o.stateNode,Cp(r,o),F=o.memoizedProps,ft=ya(d,F),A.props=ft,vt=o.pendingProps,Ze=A.context,Ve=d.contextType,Se=jo,typeof Ve=="object"&&Ve!==null&&(Se=sa(Ve)),K=d.getDerivedStateFromProps,(Ve=typeof K=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(F!==vt||Ze!==Se)&&p0(o,A,g,Se),tl=!1,Ze=o.memoizedState,A.state=Ze,ql(o,g,A,S),Vc();var nt=o.memoizedState;F!==vt||Ze!==nt||tl||r!==null&&r.dependencies!==null&&Ou(r.dependencies)?(typeof K=="function"&&(Hu(o,d,K,g),nt=o.memoizedState),(ft=tl||d0(o,d,ft,g,Ze,nt,Se)||r!==null&&r.dependencies!==null&&Ou(r.dependencies))?(Ve||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(g,nt,Se),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(g,nt,Se)),typeof A.componentDidUpdate=="function"&&(o.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof A.componentDidUpdate!="function"||F===r.memoizedProps&&Ze===r.memoizedState||(o.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||F===r.memoizedProps&&Ze===r.memoizedState||(o.flags|=1024),o.memoizedProps=g,o.memoizedState=nt),A.props=g,A.state=nt,A.context=Se,g=ft):(typeof A.componentDidUpdate!="function"||F===r.memoizedProps&&Ze===r.memoizedState||(o.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||F===r.memoizedProps&&Ze===r.memoizedState||(o.flags|=1024),g=!1)}return A=g,gs(r,o),g=(o.flags&128)!==0,A||g?(A=o.stateNode,d=g&&typeof d.getDerivedStateFromError!="function"?null:A.render(),o.flags|=1,r!==null&&g?(o.child=Yl(o,r.child,null,S),o.child=Yl(o,null,d,S)):Ui(r,o,d,S),o.memoizedState=A.state,r=o.child):r=vs(r,o,S),r}function Fn(r,o,d,g){return Gl(),o.flags|=256,Ui(r,o,d,g),o.child}var br={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function jr(r){return{baseLanes:r,cachePool:gh()}}function ef(r,o,d){return r=r!==null?r.childLanes&~d:0,o&&(r|=In),r}function Er(r,o,d){var g=o.pendingProps,S=!1,A=(o.flags&128)!==0,F;if((F=A)||(F=r!==null&&r.memoizedState===null?!1:(Ci.current&2)!==0),F&&(S=!0,o.flags&=-129),F=(o.flags&32)!==0,o.flags&=-33,r===null){if(Dn){if(S?il(o):po(),(r=fi)?(r=YM(r,ra),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Ds!==null?{id:Ns,overflow:Os}:null,retryLane:536870912,hydrationErrors:null},d=Fg(r),d.return=o,o.child=d,aa=o,fi=null)):r=null,r===null)throw Cn(o);return K_(r)?o.lanes=32:o.lanes=536870912,null}var K=g.children;return g=g.fallback,S?(po(),S=o.mode,K=ku({mode:"hidden",children:K},S),g=ro(g,S,d,null),K.return=o,g.return=o,K.sibling=g,o.child=K,g=o.child,g.memoizedState=jr(d),g.childLanes=ef(r,F,d),o.memoizedState=br,ms(null,g)):(il(o),al(o,K))}var Se=r.memoizedState;if(Se!==null&&(K=Se.dehydrated,K!==null)){if(A)o.flags&256?(il(o),o.flags&=-257,o=Xu(r,o,d)):o.memoizedState!==null?(po(),o.child=r.child,o.flags|=128,o=null):(po(),K=g.fallback,S=o.mode,g=ku({mode:"visible",children:g.children},S),K=ro(K,S,d,null),K.flags|=2,g.return=o,K.return=o,g.sibling=K,o.child=g,Yl(o,r.child,null,d),g=o.child,g.memoizedState=jr(d),g.childLanes=ef(r,F,d),o.memoizedState=br,o=ms(null,g));else if(il(o),K_(K)){if(F=K.nextSibling&&K.nextSibling.dataset,F)var Ve=F.dgst;F=Ve,g=Error(n(419)),g.stack="",g.digest=F,Ic({value:g,source:null,stack:null}),o=Xu(r,o,d)}else if(_i||Ko(r,o,d,!1),F=(d&r.childLanes)!==0,_i||F){if(F=Qn,F!==null&&(g=Ti(F,d),g!==0&&g!==Se.retryLane))throw Se.retryLane=g,Wo(r,g),h(F,r,g),Lh;Z_(K)||ln(),o=Xu(r,o,d)}else Z_(K)?(o.flags|=192,o.child=r.child,o=null):(r=Se.treeContext,fi=Xs(K.nextSibling),aa=o,Dn=!0,oo=null,ra=!1,r!==null&&zc(o,r),o=al(o,g.children),o.flags|=4096);return o}return S?(po(),K=g.fallback,S=o.mode,Se=r.child,Ve=Se.sibling,g=Us(Se,{mode:"hidden",children:g.children}),g.subtreeFlags=Se.subtreeFlags&65011712,Ve!==null?K=Us(Ve,K):(K=ro(K,S,d,null),K.flags|=2),K.return=o,g.return=o,g.sibling=K,o.child=g,ms(null,g),g=o.child,K=r.child.memoizedState,K===null?K=jr(d):(S=K.cachePool,S!==null?(Se=Wt._currentValue,S=S.parent!==Se?{parent:Se,pool:Se}:S):S=gh(),K={baseLanes:K.baseLanes|d,cachePool:S}),g.memoizedState=K,g.childLanes=ef(r,F,d),o.memoizedState=br,ms(r.child,g)):(il(o),d=r.child,r=d.sibling,d=Us(d,{mode:"visible",children:g.children}),d.return=o,d.sibling=null,r!==null&&(F=o.deletions,F===null?(o.deletions=[r],o.flags|=16):F.push(r)),o.child=d,o.memoizedState=null,d)}function al(r,o){return o=ku({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function ku(r,o){return r=Fa(22,r,null,o),r.lanes=0,r}function Xu(r,o,d){return Yl(o,r.child,null,d),r=al(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function Zl(r,o,d){r.lanes|=o;var g=r.alternate;g!==null&&(g.lanes|=o),co(r.return,o,d)}function tf(r,o,d,g,S,A){var F=r.memoizedState;F===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:g,tail:d,tailMode:S,treeForkCount:A}:(F.isBackwards=o,F.rendering=null,F.renderingStartTime=0,F.last=g,F.tail=d,F.tailMode=S,F.treeForkCount=A)}function nf(r,o,d){var g=o.pendingProps,S=g.revealOrder,A=g.tail;g=g.children;var F=Ci.current,K=(F&2)!==0;if(K?(F=F&1|2,o.flags|=128):F&=1,re(Ci,F),Ui(r,o,g,d),g=Dn?Nu:0,!K&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Zl(r,d,o);else if(r.tag===19)Zl(r,d,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(S){case"forwards":for(d=o.child,S=null;d!==null;)r=d.alternate,r!==null&&xh(r)===null&&(S=d),d=d.sibling;d=S,d===null?(S=o.child,o.child=null):(S=d.sibling,d.sibling=null),tf(o,!1,S,d,A,g);break;case"backwards":case"unstable_legacy-backwards":for(d=null,S=o.child,o.child=null;S!==null;){if(r=S.alternate,r!==null&&xh(r)===null){o.child=S;break}r=S.sibling,S.sibling=d,d=S,S=r}tf(o,!0,d,null,A,g);break;case"together":tf(o,!1,null,null,void 0,g);break;default:o.memoizedState=null}return o.child}function vs(r,o,d){if(r!==null&&(o.dependencies=r.dependencies),Rr|=o.lanes,(d&o.childLanes)===0)if(r!==null){if(Ko(r,o,d,!1),(d&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,d=Us(r,r.pendingProps),o.child=d,d.return=o;r.sibling!==null;)r=r.sibling,d=d.sibling=Us(r,r.pendingProps),d.return=o;d.sibling=null}return o.child}function rl(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&Ou(r)))}function af(r,o,d){switch(o.tag){case 3:Ee(o,o.stateNode.containerInfo),uo(o,Wt,r.memoizedState.cache),Gl();break;case 27:case 5:rt(o);break;case 4:Ee(o,o.stateNode.containerInfo);break;case 10:uo(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Np(o),null;break;case 13:var g=o.memoizedState;if(g!==null)return g.dehydrated!==null?(il(o),o.flags|=128,null):(d&o.child.childLanes)!==0?Er(r,o,d):(il(o),r=vs(r,o,d),r!==null?r.sibling:null);il(o);break;case 19:var S=(r.flags&128)!==0;if(g=(d&o.childLanes)!==0,g||(Ko(r,o,d,!1),g=(d&o.childLanes)!==0),S){if(g)return nf(r,o,d);o.flags|=128}if(S=o.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),re(Ci,Ci.current),g)break;return null;case 22:return o.lanes=0,Mr(r,o,d,o.pendingProps);case 24:uo(o,Wt,r.memoizedState.cache)}return vs(r,o,d)}function zh(r,o,d){if(r!==null)if(r.memoizedProps!==o.pendingProps)_i=!0;else{if(!rl(r,d)&&(o.flags&128)===0)return _i=!1,af(r,o,d);_i=(r.flags&131072)!==0}else _i=!1,Dn&&(o.flags&1048576)!==0&&gp(o,Nu,o.index);switch(o.lanes=0,o.tag){case 16:e:{var g=o.pendingProps;if(r=Xl(o.elementType),o.type=r,typeof r=="function")Ha(r)?(g=ya(r,g),o.tag=1,o=_a(null,o,r,g,d)):(o.tag=0,o=Vu(null,o,r,g,d));else{if(r!=null){var S=r.$$typeof;if(S===U){o.tag=11,o=Qc(null,o,r,g,d);break e}else if(S===P){o.tag=14,o=Jc(null,o,r,g,d);break e}}throw o=Z(r)||r,Error(n(306,o,""))}}return o;case 0:return Vu(r,o,o.type,o.pendingProps,d);case 1:return g=o.type,S=ya(g,o.pendingProps),_a(r,o,g,S,d);case 3:e:{if(Ee(o,o.stateNode.containerInfo),r===null)throw Error(n(387));g=o.pendingProps;var A=o.memoizedState;S=A.element,Cp(r,o),ql(o,g,null,d);var F=o.memoizedState;if(g=F.cache,uo(o,Wt,g),g!==A.cache&&mh(o,[Wt],d,!0),Vc(),g=F.element,A.isDehydrated)if(A={element:g,isDehydrated:!1,cache:F.cache},o.updateQueue.baseState=A,o.memoizedState=A,o.flags&256){o=Fn(r,o,g,d);break e}else if(g!==S){S=Za(Error(n(424)),o),Ic(S),o=Fn(r,o,g,d);break e}else for(r=o.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,fi=Xs(r.firstChild),aa=o,Dn=!0,oo=null,ra=!0,d=Yg(o,null,g,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Gl(),g===S){o=vs(r,o,d);break e}Ui(r,o,g,d)}o=o.child}return o;case 26:return gs(r,o),r===null?(d=QM(o.type,null,o.pendingProps,null))?o.memoizedState=d:Dn||(d=o.type,r=o.pendingProps,g=E0(oe.current).createElement(d),g[Jt]=o,g[k]=r,Ya(g,d,r),Je(g),o.stateNode=g):o.memoizedState=QM(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return rt(o),r===null&&Dn&&(g=o.stateNode=jM(o.type,o.pendingProps,oe.current),aa=o,ra=!0,S=fi,Qu(o.type)?(Q_=S,fi=Xs(g.firstChild)):fi=S),Ui(r,o,o.pendingProps.children,d),gs(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&Dn&&((S=g=fi)&&(g=cC(g,o.type,o.pendingProps,ra),g!==null?(o.stateNode=g,aa=o,fi=Xs(g.firstChild),ra=!1,S=!0):S=!1),S||Cn(o)),rt(o),S=o.type,A=o.pendingProps,F=r!==null?r.memoizedProps:null,g=A.children,q_(S,A)?g=null:F!==null&&q_(S,F)&&(o.flags|=32),o.memoizedState!==null&&(S=Lp(r,o,C_,null,null,d),dm._currentValue=S),gs(r,o),Ui(r,o,g,d),o.child;case 6:return r===null&&Dn&&((r=d=fi)&&(d=fC(d,o.pendingProps,ra),d!==null?(o.stateNode=d,aa=o,fi=null,r=!0):r=!1),r||Cn(o)),null;case 13:return Er(r,o,d);case 4:return Ee(o,o.stateNode.containerInfo),g=o.pendingProps,r===null?o.child=Yl(o,null,g,d):Ui(r,o,g,d),o.child;case 11:return Qc(r,o,o.type,o.pendingProps,d);case 7:return Ui(r,o,o.pendingProps,d),o.child;case 8:return Ui(r,o,o.pendingProps.children,d),o.child;case 12:return Ui(r,o,o.pendingProps.children,d),o.child;case 10:return g=o.pendingProps,uo(o,o.type,g.value),Ui(r,o,g.children,d),o.child;case 9:return S=o.type._context,g=o.pendingProps.children,Vl(o),S=sa(S),g=g(S),o.flags|=1,Ui(r,o,g,d),o.child;case 14:return Jc(r,o,o.type,o.pendingProps,d);case 15:return Sr(r,o,o.type,o.pendingProps,d);case 19:return nf(r,o,d);case 31:return $c(r,o,d);case 22:return Mr(r,o,d,o.pendingProps);case 24:return Vl(o),g=sa(Wt),r===null?(S=Ls(),S===null&&(S=Qn,A=Sp(),S.pooledCache=A,A.refCount++,A!==null&&(S.pooledCacheLanes|=d),S=A),o.memoizedState={parent:g,cache:S},Rp(o),uo(o,Wt,S)):((r.lanes&d)!==0&&(Cp(r,o),ql(o,null,null,d),Vc()),S=r.memoizedState,A=o.memoizedState,S.parent!==g?(S={parent:g,cache:g},o.memoizedState=S,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=S),uo(o,Wt,g)):(g=A.cache,uo(o,Wt,g),g!==S.cache&&mh(o,[Wt],d,!0))),Ui(r,o,o.pendingProps.children,d),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function er(r){r.flags|=4}function sl(r,o,d,g,S){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(S&335544128)===S)if(r.stateNode.complete)r.flags|=8192;else if(Rt())r.flags|=8192;else throw Kt=Fc,Pc}else r.flags&=-16777217}function vo(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!nb(o))if(Rt())r.flags|=8192;else throw Kt=Fc,Pc}function Yu(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?Ut():536870912,r.lanes|=o,Cr|=o)}function rf(r,o){if(!Dn)switch(r.tailMode){case"hidden":o=r.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?r.tail=null:d.sibling=null;break;case"collapsed":d=r.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:g.sibling=null}}function ni(r){var o=r.alternate!==null&&r.alternate.child===r.child,d=0,g=0;if(o)for(var S=r.child;S!==null;)d|=S.lanes|S.childLanes,g|=S.subtreeFlags&65011712,g|=S.flags&65011712,S.return=r,S=S.sibling;else for(S=r.child;S!==null;)d|=S.lanes|S.childLanes,g|=S.subtreeFlags,g|=S.flags,S.return=r,S=S.sibling;return r.subtreeFlags|=g,r.childLanes=d,o}function am(r,o,d){var g=o.pendingProps;switch(Zo(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ni(o),null;case 1:return ni(o),null;case 3:return d=o.stateNode,g=null,r!==null&&(g=r.memoizedState.cache),o.memoizedState.cache!==g&&(o.flags|=2048),Yr(Wt),We(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(r===null||r.child===null)&&(Hl(o)?er(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,vp())),ni(o),null;case 26:var S=o.type,A=o.memoizedState;return r===null?(er(o),A!==null?(ni(o),vo(o,A)):(ni(o),sl(o,S,null,g,d))):A?A!==r.memoizedState?(er(o),ni(o),vo(o,A)):(ni(o),o.flags&=-16777217):(r=r.memoizedProps,r!==g&&er(o),ni(o),sl(o,S,r,g,d)),null;case 27:if(st(o),d=oe.current,S=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==g&&er(o);else{if(!g){if(o.stateNode===null)throw Error(n(166));return ni(o),null}r=de.current,Hl(o)?ph(o):(r=jM(S,g,d),o.stateNode=r,er(o))}return ni(o),null;case 5:if(st(o),S=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==g&&er(o);else{if(!g){if(o.stateNode===null)throw Error(n(166));return ni(o),null}if(A=de.current,Hl(o))ph(o);else{var F=E0(oe.current);switch(A){case 1:A=F.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:A=F.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":A=F.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":A=F.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":A=F.createElement("div"),A.innerHTML="<script><\/script>",A=A.removeChild(A.firstChild);break;case"select":A=typeof g.is=="string"?F.createElement("select",{is:g.is}):F.createElement("select"),g.multiple?A.multiple=!0:g.size&&(A.size=g.size);break;default:A=typeof g.is=="string"?F.createElement(S,{is:g.is}):F.createElement(S)}}A[Jt]=o,A[k]=g;e:for(F=o.child;F!==null;){if(F.tag===5||F.tag===6)A.appendChild(F.stateNode);else if(F.tag!==4&&F.tag!==27&&F.child!==null){F.child.return=F,F=F.child;continue}if(F===o)break e;for(;F.sibling===null;){if(F.return===null||F.return===o)break e;F=F.return}F.sibling.return=F.return,F=F.sibling}o.stateNode=A;e:switch(Ya(A,S,g),S){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&er(o)}}return ni(o),sl(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,d),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==g&&er(o);else{if(typeof g!="string"&&o.stateNode===null)throw Error(n(166));if(r=oe.current,Hl(o)){if(r=o.stateNode,d=o.memoizedProps,g=null,S=aa,S!==null)switch(S.tag){case 27:case 5:g=S.memoizedProps}r[Jt]=o,r=!!(r.nodeValue===d||g!==null&&g.suppressHydrationWarning===!0||BM(r.nodeValue,d)),r||Cn(o,!0)}else r=E0(r).createTextNode(g),r[Jt]=o,o.stateNode=r}return ni(o),null;case 31:if(d=o.memoizedState,r===null||r.memoizedState!==null){if(g=Hl(o),d!==null){if(r===null){if(!g)throw Error(n(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[Jt]=o}else Gl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ni(o),r=!1}else d=vp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=d),r=!0;if(!r)return o.flags&256?(yr(o),o):(yr(o),null);if((o.flags&128)!==0)throw Error(n(558))}return ni(o),null;case 13:if(g=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(S=Hl(o),g!==null&&g.dehydrated!==null){if(r===null){if(!S)throw Error(n(318));if(S=o.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[Jt]=o}else Gl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ni(o),S=!1}else S=vp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=S),S=!0;if(!S)return o.flags&256?(yr(o),o):(yr(o),null)}return yr(o),(o.flags&128)!==0?(o.lanes=d,o):(d=g!==null,r=r!==null&&r.memoizedState!==null,d&&(g=o.child,S=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(S=g.alternate.memoizedState.cachePool.pool),A=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(A=g.memoizedState.cachePool.pool),A!==S&&(g.flags|=2048)),d!==r&&d&&(o.child.flags|=8192),Yu(o,o.updateQueue),ni(o),null);case 4:return We(),r===null&&G_(o.stateNode.containerInfo),ni(o),null;case 10:return Yr(o.type),ni(o),null;case 19:if(W(Ci),g=o.memoizedState,g===null)return ni(o),null;if(S=(o.flags&128)!==0,A=g.rendering,A===null)if(S)rf(g,!1);else{if(Jn!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(A=xh(r),A!==null){for(o.flags|=128,rf(g,!1),r=A.updateQueue,o.updateQueue=r,Yu(o,r),o.subtreeFlags=0,r=d,d=o.child;d!==null;)Ca(d,r),d=d.sibling;return re(Ci,Ci.current&1|2),Dn&&so(o,g.treeForkCount),o.child}r=r.sibling}g.tail!==null&&V()>wr&&(o.flags|=128,S=!0,rf(g,!1),o.lanes=4194304)}else{if(!S)if(r=xh(A),r!==null){if(o.flags|=128,S=!0,r=r.updateQueue,o.updateQueue=r,Yu(o,r),rf(g,!0),g.tail===null&&g.tailMode==="hidden"&&!A.alternate&&!Dn)return ni(o),null}else 2*V()-g.renderingStartTime>wr&&d!==536870912&&(o.flags|=128,S=!0,rf(g,!1),o.lanes=4194304);g.isBackwards?(A.sibling=o.child,o.child=A):(r=g.last,r!==null?r.sibling=A:o.child=A,g.last=A)}return g.tail!==null?(r=g.tail,g.rendering=r,g.tail=r.sibling,g.renderingStartTime=V(),r.sibling=null,d=Ci.current,re(Ci,S?d&1|2:d&1),Dn&&so(o,g.treeForkCount),r):(ni(o),null);case 22:case 23:return yr(o),Ua(),g=o.memoizedState!==null,r!==null?r.memoizedState!==null!==g&&(o.flags|=8192):g&&(o.flags|=8192),g?(d&536870912)!==0&&(o.flags&128)===0&&(ni(o),o.subtreeFlags&6&&(o.flags|=8192)):ni(o),d=o.updateQueue,d!==null&&Yu(o,d.retryQueue),d=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(d=r.memoizedState.cachePool.pool),g=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),g!==d&&(o.flags|=2048),r!==null&&W(Qo),null;case 24:return d=null,r!==null&&(d=r.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),Yr(Wt),ni(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function Ih(r,o){switch(Zo(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Yr(Wt),We(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return st(o),null;case 31:if(o.memoizedState!==null){if(yr(o),o.alternate===null)throw Error(n(340));Gl()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(yr(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Gl()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return W(Ci),null;case 4:return We(),null;case 10:return Yr(o.type),null;case 22:case 23:return yr(o),Ua(),r!==null&&W(Qo),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return Yr(Wt),null;case 25:return null;default:return null}}function Kl(r,o){switch(Zo(o),o.tag){case 3:Yr(Wt),We();break;case 26:case 27:case 5:st(o);break;case 4:We();break;case 31:o.memoizedState!==null&&yr(o);break;case 13:yr(o);break;case 19:W(Ci);break;case 10:Yr(o.type);break;case 22:case 23:yr(o),Ua(),r!==null&&W(Qo);break;case 24:Yr(Wt)}}function Hs(r,o){try{var d=o.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var S=g.next;d=S;do{if((d.tag&r)===r){g=void 0;var A=d.create,F=d.inst;g=A(),F.destroy=g}d=d.next}while(d!==S)}}catch(K){li(o,o.return,K)}}function Zr(r,o,d){try{var g=o.updateQueue,S=g!==null?g.lastEffect:null;if(S!==null){var A=S.next;g=A;do{if((g.tag&r)===r){var F=g.inst,K=F.destroy;if(K!==void 0){F.destroy=void 0,S=o;var Se=d,Ve=K;try{Ve()}catch(ft){li(S,Se,ft)}}}g=g.next}while(g!==A)}}catch(ft){li(o,o.return,ft)}}function ol(r){var o=r.updateQueue;if(o!==null){var d=r.stateNode;try{ga(o,d)}catch(g){li(r,r.return,g)}}}function rm(r,o,d){d.props=ya(r.type,r.memoizedProps),d.state=r.memoizedState;try{d.componentWillUnmount()}catch(g){li(r,o,g)}}function Gs(r,o){try{var d=r.ref;if(d!==null){switch(r.tag){case 26:case 27:case 5:var g=r.stateNode;break;case 30:g=r.stateNode;break;default:g=r.stateNode}typeof d=="function"?r.refCleanup=d(g):d.current=g}}catch(S){li(r,o,S)}}function Tr(r,o){var d=r.ref,g=r.refCleanup;if(d!==null)if(typeof g=="function")try{g()}catch(S){li(r,o,S)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(S){li(r,o,S)}else d.current=null}function Ar(r){var o=r.type,d=r.memoizedProps,g=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":d.autoFocus&&g.focus();break e;case"img":d.src?g.src=d.src:d.srcSet&&(g.srcset=d.srcSet)}}catch(S){li(r,r.return,S)}}function Kr(r,o,d){try{var g=r.stateNode;aC(g,r.type,d,o),g[k]=o}catch(S){li(r,r.return,S)}}function qi(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Qu(r.type)||r.tag===4}function Vs(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||qi(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Qu(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function mn(r,o,d){var g=r.tag;if(g===5||g===6)r=r.stateNode,o?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(r,o):(o=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,o.appendChild(r),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=ha));else if(g!==4&&(g===27&&Qu(r.type)&&(d=r.stateNode,o=null),r=r.child,r!==null))for(mn(r,o,d),r=r.sibling;r!==null;)mn(r,o,d),r=r.sibling}function jn(r,o,d){var g=r.tag;if(g===5||g===6)r=r.stateNode,o?d.insertBefore(r,o):d.appendChild(r);else if(g!==4&&(g===27&&Qu(r.type)&&(d=r.stateNode),r=r.child,r!==null))for(jn(r,o,d),r=r.sibling;r!==null;)jn(r,o,d),r=r.sibling}function Bi(r){var o=r.stateNode,d=r.memoizedProps;try{for(var g=r.type,S=o.attributes;S.length;)o.removeAttributeNode(S[0]);Ya(o,g,d),o[Jt]=r,o[k]=d}catch(A){li(r,r.return,A)}}var Qr=!1,xi=!1,yo=!1,sf=typeof WeakSet=="function"?WeakSet:Set,Di=null;function qu(r,o){if(r=r.containerInfo,X_=D0,r=ah(r),Tu(r)){if("selectionStart"in r)var d={start:r.selectionStart,end:r.selectionEnd};else e:{d=(d=r.ownerDocument)&&d.defaultView||window;var g=d.getSelection&&d.getSelection();if(g&&g.rangeCount!==0){d=g.anchorNode;var S=g.anchorOffset,A=g.focusNode;g=g.focusOffset;try{d.nodeType,A.nodeType}catch{d=null;break e}var F=0,K=-1,Se=-1,Ve=0,ft=0,vt=r,Ze=null;t:for(;;){for(var nt;vt!==d||S!==0&&vt.nodeType!==3||(K=F+S),vt!==A||g!==0&&vt.nodeType!==3||(Se=F+g),vt.nodeType===3&&(F+=vt.nodeValue.length),(nt=vt.firstChild)!==null;)Ze=vt,vt=nt;for(;;){if(vt===r)break t;if(Ze===d&&++Ve===S&&(K=F),Ze===A&&++ft===g&&(Se=F),(nt=vt.nextSibling)!==null)break;vt=Ze,Ze=vt.parentNode}vt=nt}d=K===-1||Se===-1?null:{start:K,end:Se}}else d=null}d=d||{start:0,end:0}}else d=null;for(Y_={focusedElem:r,selectionRange:d},D0=!1,Di=o;Di!==null;)if(o=Di,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Di=r;else for(;Di!==null;){switch(o=Di,A=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(d=0;d<r.length;d++)S=r[d],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&A!==null){r=void 0,d=o,S=A.memoizedProps,A=A.memoizedState,g=d.stateNode;try{var Gt=ya(d.type,S);r=g.getSnapshotBeforeUpdate(Gt,A),g.__reactInternalSnapshotBeforeUpdate=r}catch(tn){li(d,d.return,tn)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,d=r.nodeType,d===9)j_(r);else if(d===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":j_(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=o.sibling,r!==null){r.return=o.return,Di=r;break}Di=o.return}}function v0(r,o,d){var g=d.flags;switch(d.tag){case 0:case 11:case 15:_o(r,d),g&4&&Hs(5,d);break;case 1:if(_o(r,d),g&4)if(r=d.stateNode,o===null)try{r.componentDidMount()}catch(F){li(d,d.return,F)}else{var S=ya(d.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(S,o,r.__reactInternalSnapshotBeforeUpdate)}catch(F){li(d,d.return,F)}}g&64&&ol(d),g&512&&Gs(d,d.return);break;case 3:if(_o(r,d),g&64&&(r=d.updateQueue,r!==null)){if(o=null,d.child!==null)switch(d.child.tag){case 27:case 5:o=d.child.stateNode;break;case 1:o=d.child.stateNode}try{ga(r,o)}catch(F){li(d,d.return,F)}}break;case 27:o===null&&g&4&&Bi(d);case 26:case 5:_o(r,d),o===null&&g&4&&Ar(d),g&512&&Gs(d,d.return);break;case 12:_o(r,d);break;case 31:_o(r,d),g&4&&Ph(r,d);break;case 13:_o(r,d),g&4&&sm(r,d),g&64&&(r=d.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(d=qR.bind(null,d),hC(r,d))));break;case 22:if(g=d.memoizedState!==null||Qr,!g){o=o!==null&&o.memoizedState!==null||xi,S=Qr;var A=xi;Qr=g,(xi=o)&&!A?Kn(r,d,(d.subtreeFlags&8772)!==0):_o(r,d),Qr=S,xi=A}break;case 30:break;default:_o(r,d)}}function Bh(r){var o=r.alternate;o!==null&&(r.alternate=null,Bh(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&X(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Hn=null,Wi=!1;function Na(r,o,d){for(d=d.child;d!==null;)ll(r,o,d),d=d.sibling}function ll(r,o,d){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(ke,d)}catch{}switch(d.tag){case 26:xi||Tr(d,o),Na(r,o,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:xi||Tr(d,o);var g=Hn,S=Wi;Qu(d.type)&&(Hn=d.stateNode,Wi=!1),Na(r,o,d),cm(d.stateNode),Hn=g,Wi=S;break;case 5:xi||Tr(d,o);case 6:if(g=Hn,S=Wi,Hn=null,Na(r,o,d),Hn=g,Wi=S,Hn!==null)if(Wi)try{(Hn.nodeType===9?Hn.body:Hn.nodeName==="HTML"?Hn.ownerDocument.body:Hn).removeChild(d.stateNode)}catch(A){li(d,o,A)}else try{Hn.removeChild(d.stateNode)}catch(A){li(d,o,A)}break;case 18:Hn!==null&&(Wi?(r=Hn,kM(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,d.stateNode),Zh(r)):kM(Hn,d.stateNode));break;case 4:g=Hn,S=Wi,Hn=d.stateNode.containerInfo,Wi=!0,Na(r,o,d),Hn=g,Wi=S;break;case 0:case 11:case 14:case 15:Zr(2,d,o),xi||Zr(4,d,o),Na(r,o,d);break;case 1:xi||(Tr(d,o),g=d.stateNode,typeof g.componentWillUnmount=="function"&&rm(d,o,g)),Na(r,o,d);break;case 21:Na(r,o,d);break;case 22:xi=(g=xi)||d.memoizedState!==null,Na(r,o,d),xi=g;break;default:Na(r,o,d)}}function Ph(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Zh(r)}catch(d){li(o,o.return,d)}}}function sm(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Zh(r)}catch(d){li(o,o.return,d)}}function y0(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new sf),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new sf),o;default:throw Error(n(435,r.tag))}}function Pi(r,o){var d=y0(r);o.forEach(function(g){if(!d.has(g)){d.add(g);var S=WR.bind(null,r,g);g.then(S,S)}})}function Oa(r,o){var d=o.deletions;if(d!==null)for(var g=0;g<d.length;g++){var S=d[g],A=r,F=o,K=F;e:for(;K!==null;){switch(K.tag){case 27:if(Qu(K.type)){Hn=K.stateNode,Wi=!1;break e}break;case 5:Hn=K.stateNode,Wi=!1;break e;case 3:case 4:Hn=K.stateNode.containerInfo,Wi=!0;break e}K=K.return}if(Hn===null)throw Error(n(160));ll(A,F,S),Hn=null,Wi=!1,A=S.alternate,A!==null&&(A.return=null),S.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)ul(o,r),o=o.sibling}var tr=null;function ul(r,o){var d=r.alternate,g=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Oa(o,r),Ni(r),g&4&&(Zr(3,r,r.return),Hs(3,r),Zr(5,r,r.return));break;case 1:Oa(o,r),Ni(r),g&512&&(xi||d===null||Tr(d,d.return)),g&64&&Qr&&(r=r.updateQueue,r!==null&&(g=r.callbacks,g!==null&&(d=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=d===null?g:d.concat(g))));break;case 26:var S=tr;if(Oa(o,r),Ni(r),g&512&&(xi||d===null||Tr(d,d.return)),g&4){var A=d!==null?d.memoizedState:null;if(g=r.memoizedState,d===null)if(g===null)if(r.stateNode===null){e:{g=r.type,d=r.memoizedProps,S=S.ownerDocument||S;t:switch(g){case"title":A=S.getElementsByTagName("title")[0],(!A||A[Mt]||A[Jt]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=S.createElement(g),S.head.insertBefore(A,S.querySelector("head > title"))),Ya(A,g,d),A[Jt]=r,Je(A),g=A;break e;case"link":var F=eb("link","href",S).get(g+(d.href||""));if(F){for(var K=0;K<F.length;K++)if(A=F[K],A.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&A.getAttribute("rel")===(d.rel==null?null:d.rel)&&A.getAttribute("title")===(d.title==null?null:d.title)&&A.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){F.splice(K,1);break t}}A=S.createElement(g),Ya(A,g,d),S.head.appendChild(A);break;case"meta":if(F=eb("meta","content",S).get(g+(d.content||""))){for(K=0;K<F.length;K++)if(A=F[K],A.getAttribute("content")===(d.content==null?null:""+d.content)&&A.getAttribute("name")===(d.name==null?null:d.name)&&A.getAttribute("property")===(d.property==null?null:d.property)&&A.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&A.getAttribute("charset")===(d.charSet==null?null:d.charSet)){F.splice(K,1);break t}}A=S.createElement(g),Ya(A,g,d),S.head.appendChild(A);break;default:throw Error(n(468,g))}A[Jt]=r,Je(A),g=A}r.stateNode=g}else tb(S,r.type,r.stateNode);else r.stateNode=$M(S,g,r.memoizedProps);else A!==g?(A===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):A.count--,g===null?tb(S,r.type,r.stateNode):$M(S,g,r.memoizedProps)):g===null&&r.stateNode!==null&&Kr(r,r.memoizedProps,d.memoizedProps)}break;case 27:Oa(o,r),Ni(r),g&512&&(xi||d===null||Tr(d,d.return)),d!==null&&g&4&&Kr(r,r.memoizedProps,d.memoizedProps);break;case 5:if(Oa(o,r),Ni(r),g&512&&(xi||d===null||Tr(d,d.return)),r.flags&32){S=r.stateNode;try{is(S,"")}catch(Gt){li(r,r.return,Gt)}}g&4&&r.stateNode!=null&&(S=r.memoizedProps,Kr(r,S,d!==null?d.memoizedProps:S)),g&1024&&(yo=!0);break;case 6:if(Oa(o,r),Ni(r),g&4){if(r.stateNode===null)throw Error(n(162));g=r.memoizedProps,d=r.stateNode;try{d.nodeValue=g}catch(Gt){li(r,r.return,Gt)}}break;case 3:if(R0=null,S=tr,tr=T0(o.containerInfo),Oa(o,r),tr=S,Ni(r),g&4&&d!==null&&d.memoizedState.isDehydrated)try{Zh(o.containerInfo)}catch(Gt){li(r,r.return,Gt)}yo&&(yo=!1,_0(r));break;case 4:g=tr,tr=T0(r.stateNode.containerInfo),Oa(o,r),Ni(r),tr=g;break;case 12:Oa(o,r),Ni(r);break;case 31:Oa(o,r),Ni(r),g&4&&(g=r.updateQueue,g!==null&&(r.updateQueue=null,Pi(r,g)));break;case 13:Oa(o,r),Ni(r),r.child.flags&8192&&r.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(Mo=V()),g&4&&(g=r.updateQueue,g!==null&&(r.updateQueue=null,Pi(r,g)));break;case 22:S=r.memoizedState!==null;var Se=d!==null&&d.memoizedState!==null,Ve=Qr,ft=xi;if(Qr=Ve||S,xi=ft||Se,Oa(o,r),xi=ft,Qr=Ve,Ni(r),g&8192)e:for(o=r.stateNode,o._visibility=S?o._visibility&-2:o._visibility|1,S&&(d===null||Se||Qr||xi||Ql(r)),d=null,o=r;;){if(o.tag===5||o.tag===26){if(d===null){Se=d=o;try{if(A=Se.stateNode,S)F=A.style,typeof F.setProperty=="function"?F.setProperty("display","none","important"):F.display="none";else{K=Se.stateNode;var vt=Se.memoizedProps.style,Ze=vt!=null&&vt.hasOwnProperty("display")?vt.display:null;K.style.display=Ze==null||typeof Ze=="boolean"?"":(""+Ze).trim()}}catch(Gt){li(Se,Se.return,Gt)}}}else if(o.tag===6){if(d===null){Se=o;try{Se.stateNode.nodeValue=S?"":Se.memoizedProps}catch(Gt){li(Se,Se.return,Gt)}}}else if(o.tag===18){if(d===null){Se=o;try{var nt=Se.stateNode;S?XM(nt,!0):XM(Se.stateNode,!1)}catch(Gt){li(Se,Se.return,Gt)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;d===o&&(d=null),o=o.return}d===o&&(d=null),o.sibling.return=o.return,o=o.sibling}g&4&&(g=r.updateQueue,g!==null&&(d=g.retryQueue,d!==null&&(g.retryQueue=null,Pi(r,d))));break;case 19:Oa(o,r),Ni(r),g&4&&(g=r.updateQueue,g!==null&&(r.updateQueue=null,Pi(r,g)));break;case 30:break;case 21:break;default:Oa(o,r),Ni(r)}}function Ni(r){var o=r.flags;if(o&2){try{for(var d,g=r.return;g!==null;){if(qi(g)){d=g;break}g=g.return}if(d==null)throw Error(n(160));switch(d.tag){case 27:var S=d.stateNode,A=Vs(r);jn(r,A,S);break;case 5:var F=d.stateNode;d.flags&32&&(is(F,""),d.flags&=-33);var K=Vs(r);jn(r,K,F);break;case 3:case 4:var Se=d.stateNode.containerInfo,Ve=Vs(r);mn(r,Ve,Se);break;default:throw Error(n(161))}}catch(ft){li(r,r.return,ft)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function _0(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;_0(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function _o(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)v0(r,o.alternate,o),o=o.sibling}function Ql(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:Zr(4,o,o.return),Ql(o);break;case 1:Tr(o,o.return);var d=o.stateNode;typeof d.componentWillUnmount=="function"&&rm(o,o.return,d),Ql(o);break;case 27:cm(o.stateNode);case 26:case 5:Tr(o,o.return),Ql(o);break;case 22:o.memoizedState===null&&Ql(o);break;case 30:Ql(o);break;default:Ql(o)}r=r.sibling}}function Kn(r,o,d){for(d=d&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var g=o.alternate,S=r,A=o,F=A.flags;switch(A.tag){case 0:case 11:case 15:Kn(S,A,d),Hs(4,A);break;case 1:if(Kn(S,A,d),g=A,S=g.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Ve){li(g,g.return,Ve)}if(g=A,S=g.updateQueue,S!==null){var K=g.stateNode;try{var Se=S.shared.hiddenCallbacks;if(Se!==null)for(S.shared.hiddenCallbacks=null,S=0;S<Se.length;S++)Is(Se[S],K)}catch(Ve){li(g,g.return,Ve)}}d&&F&64&&ol(A),Gs(A,A.return);break;case 27:Bi(A);case 26:case 5:Kn(S,A,d),d&&g===null&&F&4&&Ar(A),Gs(A,A.return);break;case 12:Kn(S,A,d);break;case 31:Kn(S,A,d),d&&F&4&&Ph(S,A);break;case 13:Kn(S,A,d),d&&F&4&&sm(S,A);break;case 22:A.memoizedState===null&&Kn(S,A,d),Gs(A,A.return);break;case 30:break;default:Kn(S,A,d)}o=o.sibling}}function Fh(r,o){var d=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(d=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==d&&(r!=null&&r.refCount++,d!=null&&ma(d))}function xo(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&ma(r))}function Ji(r,o,d,g){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Mi(r,o,d,g),o=o.sibling}function Mi(r,o,d,g){var S=o.flags;switch(o.tag){case 0:case 11:case 15:Ji(r,o,d,g),S&2048&&Hs(9,o);break;case 1:Ji(r,o,d,g);break;case 3:Ji(r,o,d,g),S&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&ma(r)));break;case 12:if(S&2048){Ji(r,o,d,g),r=o.stateNode;try{var A=o.memoizedProps,F=A.id,K=A.onPostCommit;typeof K=="function"&&K(F,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(Se){li(o,o.return,Se)}}else Ji(r,o,d,g);break;case 31:Ji(r,o,d,g);break;case 13:Ji(r,o,d,g);break;case 23:break;case 22:A=o.stateNode,F=o.alternate,o.memoizedState!==null?A._visibility&2?Ji(r,o,d,g):Wu(r,o):A._visibility&2?Ji(r,o,d,g):(A._visibility|=2,cl(r,o,d,g,(o.subtreeFlags&10256)!==0||!1)),S&2048&&Fh(F,o);break;case 24:Ji(r,o,d,g),S&2048&&xo(o.alternate,o);break;default:Ji(r,o,d,g)}}function cl(r,o,d,g,S){for(S=S&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var A=r,F=o,K=d,Se=g,Ve=F.flags;switch(F.tag){case 0:case 11:case 15:cl(A,F,K,Se,S),Hs(8,F);break;case 23:break;case 22:var ft=F.stateNode;F.memoizedState!==null?ft._visibility&2?cl(A,F,K,Se,S):Wu(A,F):(ft._visibility|=2,cl(A,F,K,Se,S)),S&&Ve&2048&&Fh(F.alternate,F);break;case 24:cl(A,F,K,Se,S),S&&Ve&2048&&xo(F.alternate,F);break;default:cl(A,F,K,Se,S)}o=o.sibling}}function Wu(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var d=r,g=o,S=g.flags;switch(g.tag){case 22:Wu(d,g),S&2048&&Fh(g.alternate,g);break;case 24:Wu(d,g),S&2048&&xo(g.alternate,g);break;default:Wu(d,g)}o=o.sibling}}var Oi=8192;function Jl(r,o,d){if(r.subtreeFlags&Oi)for(r=r.child;r!==null;)Fi(r,o,d),r=r.sibling}function Fi(r,o,d){switch(r.tag){case 26:Jl(r,o,d),r.flags&Oi&&r.memoizedState!==null&&EC(d,tr,r.memoizedState,r.memoizedProps);break;case 5:Jl(r,o,d);break;case 3:case 4:var g=tr;tr=T0(r.stateNode.containerInfo),Jl(r,o,d),tr=g;break;case 22:r.memoizedState===null&&(g=r.alternate,g!==null&&g.memoizedState!==null?(g=Oi,Oi=16777216,Jl(r,o,d),Oi=g):Jl(r,o,d));break;default:Jl(r,o,d)}}function nr(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function ka(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var d=0;d<o.length;d++){var g=o[d];Di=g,of(g,r)}nr(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)$l(r),r=r.sibling}function $l(r){switch(r.tag){case 0:case 11:case 15:ka(r),r.flags&2048&&Zr(9,r,r.return);break;case 3:ka(r);break;case 12:ka(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,Hh(r)):ka(r);break;default:ka(r)}}function Hh(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var d=0;d<o.length;d++){var g=o[d];Di=g,of(g,r)}nr(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:Zr(8,o,o.return),Hh(o);break;case 22:d=o.stateNode,d._visibility&2&&(d._visibility&=-3,Hh(o));break;default:Hh(o)}r=r.sibling}}function of(r,o){for(;Di!==null;){var d=Di;switch(d.tag){case 0:case 11:case 15:Zr(8,d,o);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var g=d.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:ma(d.memoizedState.cache)}if(g=d.child,g!==null)g.return=d,Di=g;else e:for(d=r;Di!==null;){g=Di;var S=g.sibling,A=g.return;if(Bh(g),g===d){Di=null;break e}if(S!==null){S.return=A,Di=S;break e}Di=A}}}var Gh={getCacheForType:function(r){var o=sa(Wt),d=o.data.get(r);return d===void 0&&(d=r(),o.data.set(r,d)),d},cacheSignal:function(){return sa(Wt).controller.signal}},Vh=typeof WeakMap=="function"?WeakMap:Map,zn=0,Qn=null,gn=null,wn=0,jt=0,Tn=null,un=!1,Mn=!1,oi=!1,Hi=0,Jn=0,Rr=0,So=0,ys=0,In=0,Cr=0,_s=null,La=null,ir=!1,Mo=0,ju=0,wr=1/0,Zu=null,ks=null,bi=0,xs=null,Ur=null,Jr=0,bo=0,eu=null,kh=null,tu=0,nu=null;function Xa(){return(zn&2)!==0&&wn!==0?wn&-wn:G.T!==null?B_():ri()}function c(){if(In===0)if((wn&536870912)===0||Dn){var r=at;at<<=1,(at&3932160)===0&&(at=262144),In=r}else In=536870912;return r=Qi.current,r!==null&&(r.flags|=32),In}function h(r,o,d){(r===Qn&&(jt===2||jt===9)||r.cancelPendingCommit!==null)&&(we(r,0),L(r,wn,In,!1)),yn(r,d),((zn&2)===0||r!==Qn)&&(r===Qn&&((zn&2)===0&&(So|=d),Jn===4&&L(r,wn,In,!1)),fl(r))}function y(r,o,d){if((zn&6)!==0)throw Error(n(327));var g=!d&&(o&127)===0&&(o&r.expiredLanes)===0||xt(r,o),S=g?iu(r,o):ar(r,o,!0),A=g;do{if(S===0){Mn&&!g&&L(r,o,0,!1);break}else{if(d=r.current.alternate,A&&!C(d)){S=ar(r,o,!1),A=!1;continue}if(S===2){if(A=o,r.errorRecoveryDisabledLanes&A)var F=0;else F=r.pendingLanes&-536870913,F=F!==0?F:F&536870912?536870912:0;if(F!==0){o=F;e:{var K=r;S=_s;var Se=K.current.memoizedState.isDehydrated;if(Se&&(we(K,F).flags|=256),F=ar(K,F,!1),F!==2){if(oi&&!Se){K.errorRecoveryDisabledLanes|=A,So|=A,S=4;break e}A=La,La=S,A!==null&&(La===null?La=A:La.push.apply(La,A))}S=F}if(A=!1,S!==2)continue}}if(S===1){we(r,0),L(r,o,0,!0);break}e:{switch(g=r,A=S,A){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:L(g,o,In,!un);break e;case 2:La=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(S=Mo+300-V(),10<S)){if(L(g,o,In,!un),Ge(g,0,!0)!==0)break e;Jr=o,g.timeoutHandle=GM(M.bind(null,g,d,La,Zu,ir,o,In,So,Cr,un,A,"Throttled",-0,0),S);break e}M(g,d,La,Zu,ir,o,In,So,Cr,un,A,null,-0,0)}}break}while(!0);fl(r)}function M(r,o,d,g,S,A,F,K,Se,Ve,ft,vt,Ze,nt){if(r.timeoutHandle=-1,vt=o.subtreeFlags,vt&8192||(vt&16785408)===16785408){vt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ha},Fi(o,A,vt);var Gt=(A&62914560)===A?Mo-V():(A&4194048)===A?ju-V():0;if(Gt=TC(vt,Gt),Gt!==null){Jr=A,r.cancelPendingCommit=Gt(an.bind(null,r,o,A,d,g,S,F,K,Se,ft,vt,null,Ze,nt)),L(r,A,F,!Ve);return}}an(r,o,A,d,g,S,F,K,Se)}function C(r){for(var o=r;;){var d=o.tag;if((d===0||d===11||d===15)&&o.flags&16384&&(d=o.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var g=0;g<d.length;g++){var S=d[g],A=S.getSnapshot;S=S.value;try{if(!yi(A(),S))return!1}catch{return!1}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function L(r,o,d,g){o&=~ys,o&=~So,r.suspendedLanes|=o,r.pingedLanes&=~o,g&&(r.warmLanes|=o),g=r.expirationTimes;for(var S=o;0<S;){var A=31-le(S),F=1<<A;g[A]=-1,S&=~F}d!==0&&ai(r,d,o)}function J(){return(zn&6)===0?(om(0),!1):!0}function xe(){if(gn!==null){if(jt===0)var r=gn.return;else r=gn,wa=lo=null,Bp(r),$o=null,el=0,r=gn;for(;r!==null;)Kl(r.alternate,r),r=r.return;gn=null}}function we(r,o){var d=r.timeoutHandle;d!==-1&&(r.timeoutHandle=-1,oC(d)),d=r.cancelPendingCommit,d!==null&&(r.cancelPendingCommit=null,d()),Jr=0,xe(),Qn=r,gn=d=Us(r.current,null),wn=o,jt=0,Tn=null,un=!1,Mn=xt(r,o),oi=!1,Cr=In=ys=So=Rr=Jn=0,La=_s=null,ir=!1,(o&8)!==0&&(o|=o&32);var g=r.entangledLanes;if(g!==0)for(r=r.entanglements,g&=o;0<g;){var S=31-le(g),A=1<<S;o|=r[S],g&=~A}return Hi=o,qo(),d}function pt(r,o){nn=null,G.H=jc,o===Jo||o===ps?(o=vh(),jt=3):o===Pc?(o=vh(),jt=4):jt=o===Lh?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Tn=o,gn===null&&(Jn=1,Oh(r,Za(o,r.current)))}function Rt(){var r=Qi.current;return r===null?!0:(wn&4194048)===wn?qr===null:(wn&62914560)===wn||(wn&536870912)!==0?r===qr:!1}function zt(){var r=G.H;return G.H=jc,r===null?jc:r}function Bt(){var r=G.A;return G.A=Gh,r}function ln(){Jn=4,un||(wn&4194048)!==wn&&Qi.current!==null||(Mn=!0),(Rr&134217727)===0&&(So&134217727)===0||Qn===null||L(Qn,wn,In,!1)}function ar(r,o,d){var g=zn;zn|=2;var S=zt(),A=Bt();(Qn!==r||wn!==o)&&(Zu=null,we(r,o)),o=!1;var F=Jn;e:do try{if(jt!==0&&gn!==null){var K=gn,Se=Tn;switch(jt){case 8:xe(),F=6;break e;case 3:case 2:case 9:case 6:Qi.current===null&&(o=!0);var Ve=jt;if(jt=0,Tn=null,Et(r,K,Se,Ve),d&&Mn){F=0;break e}break;default:Ve=jt,jt=0,Tn=null,Et(r,K,Se,Ve)}}lf(),F=Jn;break}catch(ft){pt(r,ft)}while(!0);return o&&r.shellSuspendCounter++,wa=lo=null,zn=g,G.H=S,G.A=A,gn===null&&(Qn=null,wn=0,qo()),F}function lf(){for(;gn!==null;)Re(gn)}function iu(r,o){var d=zn;zn|=2;var g=zt(),S=Bt();Qn!==r||wn!==o?(Zu=null,wr=V()+500,we(r,o)):Mn=xt(r,o);e:do try{if(jt!==0&&gn!==null){o=gn;var A=Tn;t:switch(jt){case 1:jt=0,Tn=null,Et(r,o,A,1);break;case 2:case 9:if(Xg(A)){jt=0,Tn=null,Ke(o);break}o=function(){jt!==2&&jt!==9||Qn!==r||(jt=7),fl(r)},A.then(o,o);break e;case 3:jt=7;break e;case 4:jt=5;break e;case 7:Xg(A)?(jt=0,Tn=null,Ke(o)):(jt=0,Tn=null,Et(r,o,A,7));break;case 5:var F=null;switch(gn.tag){case 26:F=gn.memoizedState;case 5:case 27:var K=gn;if(F?nb(F):K.stateNode.complete){jt=0,Tn=null;var Se=K.sibling;if(Se!==null)gn=Se;else{var Ve=K.return;Ve!==null?(gn=Ve,qt(Ve)):gn=null}break t}}jt=0,Tn=null,Et(r,o,A,5);break;case 6:jt=0,Tn=null,Et(r,o,A,6);break;case 8:xe(),Jn=6;break e;default:throw Error(n(462))}}je();break}catch(ft){pt(r,ft)}while(!0);return wa=lo=null,G.H=g,G.A=S,zn=d,gn!==null?0:(Qn=null,wn=0,qo(),Jn)}function je(){for(;gn!==null&&!yt();)Re(gn)}function Re(r){var o=zh(r.alternate,r,Hi);r.memoizedProps=r.pendingProps,o===null?qt(r):gn=o}function Ke(r){var o=r,d=o.alternate;switch(o.tag){case 15:case 0:o=Da(d,o,o.pendingProps,o.type,void 0,wn);break;case 11:o=Da(d,o,o.pendingProps,o.type.render,o.ref,wn);break;case 5:Bp(o);default:Kl(d,o),o=gn=Ca(o,Hi),o=zh(d,o,Hi)}r.memoizedProps=r.pendingProps,o===null?qt(r):gn=o}function Et(r,o,d,g){wa=lo=null,Bp(o),$o=null,el=0;var S=o.return;try{if(xr(r,S,o,d,wn)){Jn=1,Oh(r,Za(d,r.current)),gn=null;return}}catch(A){if(S!==null)throw gn=S,A;Jn=1,Oh(r,Za(d,r.current)),gn=null;return}o.flags&32768?(Dn||g===1?r=!0:Mn||(wn&536870912)!==0?r=!1:(un=r=!0,(g===2||g===9||g===3||g===6)&&(g=Qi.current,g!==null&&g.tag===13&&(g.flags|=16384))),hi(o,r)):qt(o)}function qt(r){var o=r;do{if((o.flags&32768)!==0){hi(o,un);return}r=o.return;var d=am(o.alternate,o,Hi);if(d!==null){gn=d;return}if(o=o.sibling,o!==null){gn=o;return}gn=o=r}while(o!==null);Jn===0&&(Jn=5)}function hi(r,o){do{var d=Ih(r.alternate,r);if(d!==null){d.flags&=32767,gn=d;return}if(d=r.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!o&&(r=r.sibling,r!==null)){gn=r;return}gn=r=d}while(r!==null);Jn=6,gn=null}function an(r,o,d,g,S,A,F,K,Se){r.cancelPendingCommit=null;do Xh();while(bi!==0);if((zn&6)!==0)throw Error(n(327));if(o!==null){if(o===r.current)throw Error(n(177));if(A=o.lanes|o.childLanes,A|=uh,An(r,d,A,F,K,Se),r===Qn&&(gn=Qn=null,wn=0),Ur=o,xs=r,Jr=d,bo=A,eu=S,kh=g,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,jR(Ae,function(){return EM(),null})):(r.callbackNode=null,r.callbackPriority=0),g=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||g){g=G.T,G.T=null,S=ee.p,ee.p=2,F=zn,zn|=4;try{qu(r,o,d)}finally{zn=F,ee.p=S,G.T=g}}bi=1,Gn(),$i(),Vn()}}function Gn(){if(bi===1){bi=0;var r=xs,o=Ur,d=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||d){d=G.T,G.T=null;var g=ee.p;ee.p=2;var S=zn;zn|=4;try{ul(o,r);var A=Y_,F=ah(r.containerInfo),K=A.focusedElem,Se=A.selectionRange;if(F!==K&&K&&K.ownerDocument&&ih(K.ownerDocument.documentElement,K)){if(Se!==null&&Tu(K)){var Ve=Se.start,ft=Se.end;if(ft===void 0&&(ft=Ve),"selectionStart"in K)K.selectionStart=Ve,K.selectionEnd=Math.min(ft,K.value.length);else{var vt=K.ownerDocument||document,Ze=vt&&vt.defaultView||window;if(Ze.getSelection){var nt=Ze.getSelection(),Gt=K.textContent.length,tn=Math.min(Se.start,Gt),pi=Se.end===void 0?tn:Math.min(Se.end,Gt);!nt.extend&&tn>pi&&(F=pi,pi=tn,tn=F);var Ce=hp(K,tn),be=hp(K,pi);if(Ce&&be&&(nt.rangeCount!==1||nt.anchorNode!==Ce.node||nt.anchorOffset!==Ce.offset||nt.focusNode!==be.node||nt.focusOffset!==be.offset)){var He=vt.createRange();He.setStart(Ce.node,Ce.offset),nt.removeAllRanges(),tn>pi?(nt.addRange(He),nt.extend(be.node,be.offset)):(He.setEnd(be.node,be.offset),nt.addRange(He))}}}}for(vt=[],nt=K;nt=nt.parentNode;)nt.nodeType===1&&vt.push({element:nt,left:nt.scrollLeft,top:nt.scrollTop});for(typeof K.focus=="function"&&K.focus(),K=0;K<vt.length;K++){var mt=vt[K];mt.element.scrollLeft=mt.left,mt.element.scrollTop=mt.top}}D0=!!X_,Y_=X_=null}finally{zn=S,ee.p=g,G.T=d}}r.current=o,bi=2}}function $i(){if(bi===2){bi=0;var r=xs,o=Ur,d=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||d){d=G.T,G.T=null;var g=ee.p;ee.p=2;var S=zn;zn|=4;try{v0(r,o.alternate,o)}finally{zn=S,ee.p=g,G.T=d}}bi=3}}function Vn(){if(bi===4||bi===3){bi=0,j();var r=xs,o=Ur,d=Jr,g=kh;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?bi=5:(bi=0,Ur=xs=null,Eo(r,r.pendingLanes));var S=r.pendingLanes;if(S===0&&(ks=null),Ai(d),o=o.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(ke,o,void 0,(o.current.flags&128)===128)}catch{}if(g!==null){o=G.T,S=ee.p,ee.p=2,G.T=null;try{for(var A=r.onRecoverableError,F=0;F<g.length;F++){var K=g[F];A(K.value,{componentStack:K.stack})}}finally{G.T=o,ee.p=S}}(Jr&3)!==0&&Xh(),fl(r),S=r.pendingLanes,(d&261930)!==0&&(S&42)!==0?r===nu?tu++:(tu=0,nu=r):tu=0,om(0)}}function Eo(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,ma(o)))}function Xh(){return Gn(),$i(),Vn(),EM()}function EM(){if(bi!==5)return!1;var r=xs,o=bo;bo=0;var d=Ai(Jr),g=G.T,S=ee.p;try{ee.p=32>d?32:d,G.T=null,d=eu,eu=null;var A=xs,F=Jr;if(bi=0,Ur=xs=null,Jr=0,(zn&6)!==0)throw Error(n(331));var K=zn;if(zn|=4,$l(A.current),Mi(A,A.current,F,d),zn=K,om(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(ke,A)}catch{}return!0}finally{ee.p=S,G.T=g,Eo(r,o)}}function TM(r,o,d){o=Za(d,o),o=im(r.stateNode,o,2),r=ho(r,o,2),r!==null&&(yn(r,2),fl(r))}function li(r,o,d){if(r.tag===3)TM(r,r,d);else for(;o!==null;){if(o.tag===3){TM(o,r,d);break}else if(o.tag===1){var g=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(ks===null||!ks.has(g))){r=Za(d,r),d=Gu(2),g=ho(o,d,2),g!==null&&($a(d,g,o,r),yn(g,2),fl(g));break}}o=o.return}}function L_(r,o,d){var g=r.pingCache;if(g===null){g=r.pingCache=new Vh;var S=new Set;g.set(o,S)}else S=g.get(o),S===void 0&&(S=new Set,g.set(o,S));S.has(d)||(oi=!0,S.add(d),r=YR.bind(null,r,o,d),o.then(r,r))}function YR(r,o,d){var g=r.pingCache;g!==null&&g.delete(o),r.pingedLanes|=r.suspendedLanes&d,r.warmLanes&=~d,Qn===r&&(wn&d)===d&&(Jn===4||Jn===3&&(wn&62914560)===wn&&300>V()-Mo?(zn&2)===0&&we(r,0):ys|=d,Cr===wn&&(Cr=0)),fl(r)}function AM(r,o){o===0&&(o=Ut()),r=Wo(r,o),r!==null&&(yn(r,o),fl(r))}function qR(r){var o=r.memoizedState,d=0;o!==null&&(d=o.retryLane),AM(r,d)}function WR(r,o){var d=0;switch(r.tag){case 31:case 13:var g=r.stateNode,S=r.memoizedState;S!==null&&(d=S.retryLane);break;case 19:g=r.stateNode;break;case 22:g=r.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(o),AM(r,d)}function jR(r,o){return Fe(r,o)}var x0=null,Yh=null,z_=!1,S0=!1,I_=!1,Ku=0;function fl(r){r!==Yh&&r.next===null&&(Yh===null?x0=Yh=r:Yh=Yh.next=r),S0=!0,z_||(z_=!0,KR())}function om(r,o){if(!I_&&S0){I_=!0;do for(var d=!1,g=x0;g!==null;){if(r!==0){var S=g.pendingLanes;if(S===0)var A=0;else{var F=g.suspendedLanes,K=g.pingedLanes;A=(1<<31-le(42|r)+1)-1,A&=S&~(F&~K),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(d=!0,UM(g,A))}else A=wn,A=Ge(g,g===Qn?A:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(A&3)===0||xt(g,A)||(d=!0,UM(g,A));g=g.next}while(d);I_=!1}}function ZR(){RM()}function RM(){S0=z_=!1;var r=0;Ku!==0&&sC()&&(r=Ku);for(var o=V(),d=null,g=x0;g!==null;){var S=g.next,A=CM(g,o);A===0?(g.next=null,d===null?x0=S:d.next=S,S===null&&(Yh=d)):(d=g,(r!==0||(A&3)!==0)&&(S0=!0)),g=S}bi!==0&&bi!==5||om(r),Ku!==0&&(Ku=0)}function CM(r,o){for(var d=r.suspendedLanes,g=r.pingedLanes,S=r.expirationTimes,A=r.pendingLanes&-62914561;0<A;){var F=31-le(A),K=1<<F,Se=S[F];Se===-1?((K&d)===0||(K&g)!==0)&&(S[F]=wt(K,o)):Se<=o&&(r.expiredLanes|=K),A&=~K}if(o=Qn,d=wn,d=Ge(r,r===o?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),g=r.callbackNode,d===0||r===o&&(jt===2||jt===9)||r.cancelPendingCommit!==null)return g!==null&&g!==null&&Ne(g),r.callbackNode=null,r.callbackPriority=0;if((d&3)===0||xt(r,d)){if(o=d&-d,o===r.callbackPriority)return o;switch(g!==null&&Ne(g),Ai(d)){case 2:case 8:d=De;break;case 32:d=Ae;break;case 268435456:d=ct;break;default:d=Ae}return g=wM.bind(null,r),d=Fe(d,g),r.callbackPriority=o,r.callbackNode=d,o}return g!==null&&g!==null&&Ne(g),r.callbackPriority=2,r.callbackNode=null,2}function wM(r,o){if(bi!==0&&bi!==5)return r.callbackNode=null,r.callbackPriority=0,null;var d=r.callbackNode;if(Xh()&&r.callbackNode!==d)return null;var g=wn;return g=Ge(r,r===Qn?g:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),g===0?null:(y(r,g,o),CM(r,V()),r.callbackNode!=null&&r.callbackNode===d?wM.bind(null,r):null)}function UM(r,o){if(Xh())return null;y(r,o,!0)}function KR(){lC(function(){(zn&6)!==0?Fe(Be,ZR):RM()})}function B_(){if(Ku===0){var r=fo;r===0&&(r=_e,_e<<=1,(_e&261888)===0&&(_e=256)),Ku=r}return Ku}function DM(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Gr(""+r)}function NM(r,o){var d=o.ownerDocument.createElement("input");return d.name=o.name,d.value=o.value,r.id&&d.setAttribute("form",r.id),o.parentNode.insertBefore(d,o),r=new FormData(r),d.parentNode.removeChild(d),r}function QR(r,o,d,g,S){if(o==="submit"&&d&&d.stateNode===S){var A=DM((S[k]||null).action),F=g.submitter;F&&(o=(o=F[k]||null)?DM(o.formAction):F.getAttribute("formAction"),o!==null&&(A=o,F=null));var K=new to("action","action",null,g,S);r.push({event:K,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(Ku!==0){var Se=F?NM(S,F):new FormData(S);Jp(d,{pending:!0,data:Se,method:S.method,action:A},null,Se)}}else typeof A=="function"&&(K.preventDefault(),Se=F?NM(S,F):new FormData(S),Jp(d,{pending:!0,data:Se,method:S.method,action:A},A,Se))},currentTarget:S}]})}}for(var P_=0;P_<lh.length;P_++){var F_=lh[P_],JR=F_.toLowerCase(),$R=F_[0].toUpperCase()+F_.slice(1);Ra(JR,"on"+$R)}Ra(ja,"onAnimationEnd"),Ra(dp,"onAnimationIteration"),Ra(ws,"onAnimationStart"),Ra("dblclick","onDoubleClick"),Ra("focusin","onFocus"),Ra("focusout","onBlur"),Ra(wu,"onTransitionRun"),Ra(Xo,"onTransitionStart"),Ra(pp,"onTransitionCancel"),Ra(oh,"onTransitionEnd"),St("onMouseEnter",["mouseout","mouseover"]),St("onMouseLeave",["mouseout","mouseover"]),St("onPointerEnter",["pointerout","pointerover"]),St("onPointerLeave",["pointerout","pointerover"]),dt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),dt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),dt("onBeforeInput",["compositionend","keypress","textInput","paste"]),dt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),dt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),dt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lm));function OM(r,o){o=(o&4)!==0;for(var d=0;d<r.length;d++){var g=r[d],S=g.event;g=g.listeners;e:{var A=void 0;if(o)for(var F=g.length-1;0<=F;F--){var K=g[F],Se=K.instance,Ve=K.currentTarget;if(K=K.listener,Se!==A&&S.isPropagationStopped())break e;A=K,S.currentTarget=Ve;try{A(S)}catch(ft){Yo(ft)}S.currentTarget=null,A=Se}else for(F=0;F<g.length;F++){if(K=g[F],Se=K.instance,Ve=K.currentTarget,K=K.listener,Se!==A&&S.isPropagationStopped())break e;A=K,S.currentTarget=Ve;try{A(S)}catch(ft){Yo(ft)}S.currentTarget=null,A=Se}}}}function Nn(r,o){var d=o[Me];d===void 0&&(d=o[Me]=new Set);var g=r+"__bubble";d.has(g)||(LM(o,r,2,!1),d.add(g))}function H_(r,o,d){var g=0;o&&(g|=4),LM(d,r,g,o)}var M0="_reactListening"+Math.random().toString(36).slice(2);function G_(r){if(!r[M0]){r[M0]=!0,Qe.forEach(function(d){d!=="selectionchange"&&(eC.has(d)||H_(d,!1,r),H_(d,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[M0]||(o[M0]=!0,H_("selectionchange",!1,o))}}function LM(r,o,d,g){switch(ub(o)){case 2:var S=CC;break;case 8:S=wC;break;default:S=n1}d=S.bind(null,o,d,r),S=void 0,!Aa||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(S=!0),g?S!==void 0?r.addEventListener(o,d,{capture:!0,passive:S}):r.addEventListener(o,d,!0):S!==void 0?r.addEventListener(o,d,{passive:S}):r.addEventListener(o,d,!1)}function V_(r,o,d,g,S){var A=g;if((o&1)===0&&(o&2)===0&&g!==null)e:for(;;){if(g===null)return;var F=g.tag;if(F===3||F===4){var K=g.stateNode.containerInfo;if(K===S)break;if(F===4)for(F=g.return;F!==null;){var Se=F.tag;if((Se===3||Se===4)&&F.stateNode.containerInfo===S)return;F=F.return}for(;K!==null;){if(F=ue(K),F===null)return;if(Se=F.tag,Se===5||Se===6||Se===26||Se===27){g=A=F;continue e}K=K.parentNode}}g=g.return}Bo(function(){var Ve=A,ft=Rl(d),vt=[];e:{var Ze=ao.get(r);if(Ze!==void 0){var nt=to,Gt=r;switch(r){case"keypress":if(As(d)===0)break e;case"keydown":case"keyup":nt=np;break;case"focusin":Gt="focus",nt=_u;break;case"focusout":Gt="blur",nt=_u;break;case"beforeblur":case"afterblur":nt=_u;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=Jf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=Ol;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=no;break;case ja:case dp:case ws:nt=Wa;break;case oh:nt=A_;break;case"scroll":case"scrollend":nt=Rs;break;case"wheel":nt=Po;break;case"copy":case"cut":case"paste":nt=Xr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=$f;break;case"toggle":case"beforetoggle":nt=ap}var tn=(o&4)!==0,pi=!tn&&(r==="scroll"||r==="scrollend"),Ce=tn?Ze!==null?Ze+"Capture":null:Ze;tn=[];for(var be=Ve,He;be!==null;){var mt=be;if(He=mt.stateNode,mt=mt.tag,mt!==5&&mt!==26&&mt!==27||He===null||Ce===null||(mt=ss(be,Ce),mt!=null&&tn.push(um(be,mt,He))),pi)break;be=be.return}0<tn.length&&(Ze=new nt(Ze,Gt,null,d,ft),vt.push({event:Ze,listeners:tn}))}}if((o&7)===0){e:{if(Ze=r==="mouseover"||r==="pointerover",nt=r==="mouseout"||r==="pointerout",Ze&&d!==rs&&(Gt=d.relatedTarget||d.fromElement)&&(ue(Gt)||Gt[$]))break e;if((nt||Ze)&&(Ze=ft.window===ft?ft:(Ze=ft.ownerDocument)?Ze.defaultView||Ze.parentWindow:window,nt?(Gt=d.relatedTarget||d.toElement,nt=Ve,Gt=Gt?ue(Gt):null,Gt!==null&&(pi=a(Gt),tn=Gt.tag,Gt!==pi||tn!==5&&tn!==27&&tn!==6)&&(Gt=null)):(nt=null,Gt=Ve),nt!==Gt)){if(tn=Jf,mt="onMouseLeave",Ce="onMouseEnter",be="mouse",(r==="pointerout"||r==="pointerover")&&(tn=$f,mt="onPointerLeave",Ce="onPointerEnter",be="pointer"),pi=nt==null?Ze:ye(nt),He=Gt==null?Ze:ye(Gt),Ze=new tn(mt,be+"leave",nt,d,ft),Ze.target=pi,Ze.relatedTarget=He,mt=null,ue(ft)===Ve&&(tn=new tn(Ce,be+"enter",Gt,d,ft),tn.target=He,tn.relatedTarget=pi,mt=tn),pi=mt,nt&&Gt)t:{for(tn=tC,Ce=nt,be=Gt,He=0,mt=Ce;mt;mt=tn(mt))He++;mt=0;for(var Zt=be;Zt;Zt=tn(Zt))mt++;for(;0<He-mt;)Ce=tn(Ce),He--;for(;0<mt-He;)be=tn(be),mt--;for(;He--;){if(Ce===be||be!==null&&Ce===be.alternate){tn=Ce;break t}Ce=tn(Ce),be=tn(be)}tn=null}else tn=null;nt!==null&&zM(vt,Ze,nt,tn,!1),Gt!==null&&pi!==null&&zM(vt,pi,Gt,tn,!0)}}e:{if(Ze=Ve?ye(Ve):window,nt=Ze.nodeName&&Ze.nodeName.toLowerCase(),nt==="select"||nt==="input"&&Ze.type==="file")var $n=up;else if(op(Ze))if(wc)$n=Ig;else{$n=Go;var Yt=Uc}else nt=Ze.nodeName,!nt||nt.toLowerCase()!=="input"||Ze.type!=="checkbox"&&Ze.type!=="radio"?Ve&&as(Ve.elementType)&&($n=up):$n=zg;if($n&&($n=$n(r,Ve))){nh(vt,$n,d,ft);break e}Yt&&Yt(r,Ze,Ve),r==="focusout"&&Ve&&Ze.type==="number"&&Ve.memoizedProps.value!=null&&_n(Ze,"number",Ze.value)}switch(Yt=Ve?ye(Ve):window,r){case"focusin":(op(Yt)||Yt.contentEditable==="true")&&(Au=Yt,rh=Ve,Ru=null);break;case"focusout":Ru=rh=Au=null;break;case"mousedown":mr=!0;break;case"contextmenu":case"mouseup":case"dragend":mr=!1,sh(vt,d,ft);break;case"selectionchange":if(Bg)break;case"keydown":case"keyup":sh(vt,d,ft)}var bn;if(Ll)e:{switch(r){case"compositionstart":var Bn="onCompositionStart";break e;case"compositionend":Bn="onCompositionEnd";break e;case"compositionupdate":Bn="onCompositionUpdate";break e}Bn=void 0}else Ho?eh(r,d)&&(Bn="onCompositionEnd"):r==="keydown"&&d.keyCode===229&&(Bn="onCompositionStart");Bn&&(pa&&d.locale!=="ko"&&(Ho||Bn!=="onCompositionStart"?Bn==="onCompositionEnd"&&Ho&&(bn=Dl()):(os=ft,Ul="value"in os?os.value:os.textContent,Ho=!0)),Yt=b0(Ve,Bn),0<Yt.length&&(Bn=new Jd(Bn,r,null,d,ft),vt.push({event:Bn,listeners:Yt}),bn?Bn.data=bn:(bn=xu(d),bn!==null&&(Bn.data=bn)))),(bn=zl?th(r,d):Ng(r,d))&&(Bn=b0(Ve,"onBeforeInput"),0<Bn.length&&(Yt=new Jd("onBeforeInput","beforeinput",null,d,ft),vt.push({event:Yt,listeners:Bn}),Yt.data=bn)),QR(vt,r,Ve,d,ft)}OM(vt,o)})}function um(r,o,d){return{instance:r,listener:o,currentTarget:d}}function b0(r,o){for(var d=o+"Capture",g=[];r!==null;){var S=r,A=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||A===null||(S=ss(r,d),S!=null&&g.unshift(um(r,S,A)),S=ss(r,o),S!=null&&g.push(um(r,S,A))),r.tag===3)return g;r=r.return}return[]}function tC(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function zM(r,o,d,g,S){for(var A=o._reactName,F=[];d!==null&&d!==g;){var K=d,Se=K.alternate,Ve=K.stateNode;if(K=K.tag,Se!==null&&Se===g)break;K!==5&&K!==26&&K!==27||Ve===null||(Se=Ve,S?(Ve=ss(d,A),Ve!=null&&F.unshift(um(d,Ve,Se))):S||(Ve=ss(d,A),Ve!=null&&F.push(um(d,Ve,Se)))),d=d.return}F.length!==0&&r.push({event:o,listeners:F})}var nC=/\r\n?/g,iC=/\u0000|\uFFFD/g;function IM(r){return(typeof r=="string"?r:""+r).replace(nC,`
`).replace(iC,"")}function BM(r,o){return o=IM(o),IM(r)===o}function di(r,o,d,g,S,A){switch(d){case"children":typeof g=="string"?o==="body"||o==="textarea"&&g===""||is(r,g):(typeof g=="number"||typeof g=="bigint")&&o!=="body"&&is(r,""+g);break;case"className":sn(r,"class",g);break;case"tabIndex":sn(r,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":sn(r,d,g);break;case"style":Tl(r,g,A);break;case"data":if(o!=="object"){sn(r,"data",g);break}case"src":case"href":if(g===""&&(o!=="a"||d!=="href")){r.removeAttribute(d);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){r.removeAttribute(d);break}g=Gr(""+g),r.setAttribute(d,g);break;case"action":case"formAction":if(typeof g=="function"){r.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(d==="formAction"?(o!=="input"&&di(r,o,"name",S.name,S,null),di(r,o,"formEncType",S.formEncType,S,null),di(r,o,"formMethod",S.formMethod,S,null),di(r,o,"formTarget",S.formTarget,S,null)):(di(r,o,"encType",S.encType,S,null),di(r,o,"method",S.method,S,null),di(r,o,"target",S.target,S,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){r.removeAttribute(d);break}g=Gr(""+g),r.setAttribute(d,g);break;case"onClick":g!=null&&(r.onclick=ha);break;case"onScroll":g!=null&&Nn("scroll",r);break;case"onScrollEnd":g!=null&&Nn("scrollend",r);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(d=g.__html,d!=null){if(S.children!=null)throw Error(n(60));r.innerHTML=d}}break;case"multiple":r.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":r.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){r.removeAttribute("xlink:href");break}d=Gr(""+g),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?r.setAttribute(d,""+g):r.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?r.setAttribute(d,""):r.removeAttribute(d);break;case"capture":case"download":g===!0?r.setAttribute(d,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?r.setAttribute(d,g):r.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?r.setAttribute(d,g):r.removeAttribute(d);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?r.removeAttribute(d):r.setAttribute(d,g);break;case"popover":Nn("beforetoggle",r),Nn("toggle",r),kt(r,"popover",g);break;case"xlinkActuate":Ft(r,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Ft(r,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Ft(r,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Ft(r,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Ft(r,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Ft(r,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":kt(r,"is",g);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=Ec.get(d)||d,kt(r,d,g))}}function k_(r,o,d,g,S,A){switch(d){case"style":Tl(r,g,A);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(d=g.__html,d!=null){if(S.children!=null)throw Error(n(60));r.innerHTML=d}}break;case"children":typeof g=="string"?is(r,g):(typeof g=="number"||typeof g=="bigint")&&is(r,""+g);break;case"onScroll":g!=null&&Nn("scroll",r);break;case"onScrollEnd":g!=null&&Nn("scrollend",r);break;case"onClick":g!=null&&(r.onclick=ha);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ot.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(S=d.endsWith("Capture"),o=d.slice(2,S?d.length-7:void 0),A=r[k]||null,A=A!=null?A[d]:null,typeof A=="function"&&r.removeEventListener(o,A,S),typeof g=="function")){typeof A!="function"&&A!==null&&(d in r?r[d]=null:r.hasAttribute(d)&&r.removeAttribute(d)),r.addEventListener(o,g,S);break e}d in r?r[d]=g:g===!0?r.setAttribute(d,""):kt(r,d,g)}}}function Ya(r,o,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Nn("error",r),Nn("load",r);var g=!1,S=!1,A;for(A in d)if(d.hasOwnProperty(A)){var F=d[A];if(F!=null)switch(A){case"src":g=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:di(r,o,A,F,d,null)}}S&&di(r,o,"srcSet",d.srcSet,d,null),g&&di(r,o,"src",d.src,d,null);return;case"input":Nn("invalid",r);var K=A=F=S=null,Se=null,Ve=null;for(g in d)if(d.hasOwnProperty(g)){var ft=d[g];if(ft!=null)switch(g){case"name":S=ft;break;case"type":F=ft;break;case"checked":Se=ft;break;case"defaultChecked":Ve=ft;break;case"value":A=ft;break;case"defaultValue":K=ft;break;case"children":case"dangerouslySetInnerHTML":if(ft!=null)throw Error(n(137,o));break;default:di(r,o,g,ft,d,null)}}ti(r,A,K,Se,Ve,F,S,!1);return;case"select":Nn("invalid",r),g=F=A=null;for(S in d)if(d.hasOwnProperty(S)&&(K=d[S],K!=null))switch(S){case"value":A=K;break;case"defaultValue":F=K;break;case"multiple":g=K;default:di(r,o,S,K,d,null)}o=A,d=F,r.multiple=!!g,o!=null?Pn(r,!!g,o,!1):d!=null&&Pn(r,!!g,d,!0);return;case"textarea":Nn("invalid",r),A=S=g=null;for(F in d)if(d.hasOwnProperty(F)&&(K=d[F],K!=null))switch(F){case"value":g=K;break;case"defaultValue":S=K;break;case"children":A=K;break;case"dangerouslySetInnerHTML":if(K!=null)throw Error(n(91));break;default:di(r,o,F,K,d,null)}ki(r,g,S,A);return;case"option":for(Se in d)d.hasOwnProperty(Se)&&(g=d[Se],g!=null)&&(Se==="selected"?r.selected=g&&typeof g!="function"&&typeof g!="symbol":di(r,o,Se,g,d,null));return;case"dialog":Nn("beforetoggle",r),Nn("toggle",r),Nn("cancel",r),Nn("close",r);break;case"iframe":case"object":Nn("load",r);break;case"video":case"audio":for(g=0;g<lm.length;g++)Nn(lm[g],r);break;case"image":Nn("error",r),Nn("load",r);break;case"details":Nn("toggle",r);break;case"embed":case"source":case"link":Nn("error",r),Nn("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ve in d)if(d.hasOwnProperty(Ve)&&(g=d[Ve],g!=null))switch(Ve){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:di(r,o,Ve,g,d,null)}return;default:if(as(o)){for(ft in d)d.hasOwnProperty(ft)&&(g=d[ft],g!==void 0&&k_(r,o,ft,g,d,void 0));return}}for(K in d)d.hasOwnProperty(K)&&(g=d[K],g!=null&&di(r,o,K,g,d,null))}function aC(r,o,d,g){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,A=null,F=null,K=null,Se=null,Ve=null,ft=null;for(nt in d){var vt=d[nt];if(d.hasOwnProperty(nt)&&vt!=null)switch(nt){case"checked":break;case"value":break;case"defaultValue":Se=vt;default:g.hasOwnProperty(nt)||di(r,o,nt,null,g,vt)}}for(var Ze in g){var nt=g[Ze];if(vt=d[Ze],g.hasOwnProperty(Ze)&&(nt!=null||vt!=null))switch(Ze){case"type":A=nt;break;case"name":S=nt;break;case"checked":Ve=nt;break;case"defaultChecked":ft=nt;break;case"value":F=nt;break;case"defaultValue":K=nt;break;case"children":case"dangerouslySetInnerHTML":if(nt!=null)throw Error(n(137,o));break;default:nt!==vt&&di(r,o,Ze,nt,g,vt)}}Yn(r,F,K,Se,Ve,ft,A,S);return;case"select":nt=F=K=Ze=null;for(A in d)if(Se=d[A],d.hasOwnProperty(A)&&Se!=null)switch(A){case"value":break;case"multiple":nt=Se;default:g.hasOwnProperty(A)||di(r,o,A,null,g,Se)}for(S in g)if(A=g[S],Se=d[S],g.hasOwnProperty(S)&&(A!=null||Se!=null))switch(S){case"value":Ze=A;break;case"defaultValue":K=A;break;case"multiple":F=A;default:A!==Se&&di(r,o,S,A,g,Se)}o=K,d=F,g=nt,Ze!=null?Pn(r,!!d,Ze,!1):!!g!=!!d&&(o!=null?Pn(r,!!d,o,!0):Pn(r,!!d,d?[]:"",!1));return;case"textarea":nt=Ze=null;for(K in d)if(S=d[K],d.hasOwnProperty(K)&&S!=null&&!g.hasOwnProperty(K))switch(K){case"value":break;case"children":break;default:di(r,o,K,null,g,S)}for(F in g)if(S=g[F],A=d[F],g.hasOwnProperty(F)&&(S!=null||A!=null))switch(F){case"value":Ze=S;break;case"defaultValue":nt=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:S!==A&&di(r,o,F,S,g,A)}Hr(r,Ze,nt);return;case"option":for(var Gt in d)Ze=d[Gt],d.hasOwnProperty(Gt)&&Ze!=null&&!g.hasOwnProperty(Gt)&&(Gt==="selected"?r.selected=!1:di(r,o,Gt,null,g,Ze));for(Se in g)Ze=g[Se],nt=d[Se],g.hasOwnProperty(Se)&&Ze!==nt&&(Ze!=null||nt!=null)&&(Se==="selected"?r.selected=Ze&&typeof Ze!="function"&&typeof Ze!="symbol":di(r,o,Se,Ze,g,nt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var tn in d)Ze=d[tn],d.hasOwnProperty(tn)&&Ze!=null&&!g.hasOwnProperty(tn)&&di(r,o,tn,null,g,Ze);for(Ve in g)if(Ze=g[Ve],nt=d[Ve],g.hasOwnProperty(Ve)&&Ze!==nt&&(Ze!=null||nt!=null))switch(Ve){case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(n(137,o));break;default:di(r,o,Ve,Ze,g,nt)}return;default:if(as(o)){for(var pi in d)Ze=d[pi],d.hasOwnProperty(pi)&&Ze!==void 0&&!g.hasOwnProperty(pi)&&k_(r,o,pi,void 0,g,Ze);for(ft in g)Ze=g[ft],nt=d[ft],!g.hasOwnProperty(ft)||Ze===nt||Ze===void 0&&nt===void 0||k_(r,o,ft,Ze,g,nt);return}}for(var Ce in d)Ze=d[Ce],d.hasOwnProperty(Ce)&&Ze!=null&&!g.hasOwnProperty(Ce)&&di(r,o,Ce,null,g,Ze);for(vt in g)Ze=g[vt],nt=d[vt],!g.hasOwnProperty(vt)||Ze===nt||Ze==null&&nt==null||di(r,o,vt,Ze,g,nt)}function PM(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function rC(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,d=performance.getEntriesByType("resource"),g=0;g<d.length;g++){var S=d[g],A=S.transferSize,F=S.initiatorType,K=S.duration;if(A&&K&&PM(F)){for(F=0,K=S.responseEnd,g+=1;g<d.length;g++){var Se=d[g],Ve=Se.startTime;if(Ve>K)break;var ft=Se.transferSize,vt=Se.initiatorType;ft&&PM(vt)&&(Se=Se.responseEnd,F+=ft*(Se<K?1:(K-Ve)/(Se-Ve)))}if(--g,o+=8*(A+F)/(S.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var X_=null,Y_=null;function E0(r){return r.nodeType===9?r:r.ownerDocument}function FM(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function HM(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function q_(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var W_=null;function sC(){var r=window.event;return r&&r.type==="popstate"?r===W_?!1:(W_=r,!0):(W_=null,!1)}var GM=typeof setTimeout=="function"?setTimeout:void 0,oC=typeof clearTimeout=="function"?clearTimeout:void 0,VM=typeof Promise=="function"?Promise:void 0,lC=typeof queueMicrotask=="function"?queueMicrotask:typeof VM<"u"?function(r){return VM.resolve(null).then(r).catch(uC)}:GM;function uC(r){setTimeout(function(){throw r})}function Qu(r){return r==="head"}function kM(r,o){var d=o,g=0;do{var S=d.nextSibling;if(r.removeChild(d),S&&S.nodeType===8)if(d=S.data,d==="/$"||d==="/&"){if(g===0){r.removeChild(S),Zh(o);return}g--}else if(d==="$"||d==="$?"||d==="$~"||d==="$!"||d==="&")g++;else if(d==="html")cm(r.ownerDocument.documentElement);else if(d==="head"){d=r.ownerDocument.head,cm(d);for(var A=d.firstChild;A;){var F=A.nextSibling,K=A.nodeName;A[Mt]||K==="SCRIPT"||K==="STYLE"||K==="LINK"&&A.rel.toLowerCase()==="stylesheet"||d.removeChild(A),A=F}}else d==="body"&&cm(r.ownerDocument.body);d=S}while(d);Zh(o)}function XM(r,o){var d=r;r=0;do{var g=d.nextSibling;if(d.nodeType===1?o?(d._stashedDisplay=d.style.display,d.style.display="none"):(d.style.display=d._stashedDisplay||"",d.getAttribute("style")===""&&d.removeAttribute("style")):d.nodeType===3&&(o?(d._stashedText=d.nodeValue,d.nodeValue=""):d.nodeValue=d._stashedText||""),g&&g.nodeType===8)if(d=g.data,d==="/$"){if(r===0)break;r--}else d!=="$"&&d!=="$?"&&d!=="$~"&&d!=="$!"||r++;d=g}while(d)}function j_(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var d=o;switch(o=o.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":j_(d),X(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}r.removeChild(d)}}function cC(r,o,d,g){for(;r.nodeType===1;){var S=d;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!g&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(g){if(!r[Mt])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(A=r.getAttribute("rel"),A==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(A!==S.rel||r.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||r.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||r.getAttribute("title")!==(S.title==null?null:S.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(A=r.getAttribute("src"),(A!==(S.src==null?null:S.src)||r.getAttribute("type")!==(S.type==null?null:S.type)||r.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&A&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var A=S.name==null?null:""+S.name;if(S.type==="hidden"&&r.getAttribute("name")===A)return r}else return r;if(r=Xs(r.nextSibling),r===null)break}return null}function fC(r,o,d){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!d||(r=Xs(r.nextSibling),r===null))return null;return r}function YM(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Xs(r.nextSibling),r===null))return null;return r}function Z_(r){return r.data==="$?"||r.data==="$~"}function K_(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function hC(r,o){var d=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||d.readyState!=="loading")o();else{var g=function(){o(),d.removeEventListener("DOMContentLoaded",g)};d.addEventListener("DOMContentLoaded",g),r._reactRetry=g}}function Xs(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var Q_=null;function qM(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var d=r.data;if(d==="/$"||d==="/&"){if(o===0)return Xs(r.nextSibling);o--}else d!=="$"&&d!=="$!"&&d!=="$?"&&d!=="$~"&&d!=="&"||o++}r=r.nextSibling}return null}function WM(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var d=r.data;if(d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"){if(o===0)return r;o--}else d!=="/$"&&d!=="/&"||o++}r=r.previousSibling}return null}function jM(r,o,d){switch(o=E0(d),r){case"html":if(r=o.documentElement,!r)throw Error(n(452));return r;case"head":if(r=o.head,!r)throw Error(n(453));return r;case"body":if(r=o.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function cm(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);X(r)}var Ys=new Map,ZM=new Set;function T0(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var au=ee.d;ee.d={f:dC,r:pC,D:mC,C:gC,L:vC,m:yC,X:xC,S:_C,M:SC};function dC(){var r=au.f(),o=J();return r||o}function pC(r){var o=me(r);o!==null&&o.tag===5&&o.type==="form"?$p(o):au.r(r)}var qh=typeof document>"u"?null:document;function KM(r,o,d){var g=qh;if(g&&typeof o=="string"&&o){var S=Ot(o);S='link[rel="'+r+'"][href="'+S+'"]',typeof d=="string"&&(S+='[crossorigin="'+d+'"]'),ZM.has(S)||(ZM.add(S),r={rel:r,crossOrigin:d,href:o},g.querySelector(S)===null&&(o=g.createElement("link"),Ya(o,"link",r),Je(o),g.head.appendChild(o)))}}function mC(r){au.D(r),KM("dns-prefetch",r,null)}function gC(r,o){au.C(r,o),KM("preconnect",r,o)}function vC(r,o,d){au.L(r,o,d);var g=qh;if(g&&r&&o){var S='link[rel="preload"][as="'+Ot(o)+'"]';o==="image"&&d&&d.imageSrcSet?(S+='[imagesrcset="'+Ot(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(S+='[imagesizes="'+Ot(d.imageSizes)+'"]')):S+='[href="'+Ot(r)+'"]';var A=S;switch(o){case"style":A=Wh(r);break;case"script":A=jh(r)}Ys.has(A)||(r=v({rel:"preload",href:o==="image"&&d&&d.imageSrcSet?void 0:r,as:o},d),Ys.set(A,r),g.querySelector(S)!==null||o==="style"&&g.querySelector(fm(A))||o==="script"&&g.querySelector(hm(A))||(o=g.createElement("link"),Ya(o,"link",r),Je(o),g.head.appendChild(o)))}}function yC(r,o){au.m(r,o);var d=qh;if(d&&r){var g=o&&typeof o.as=="string"?o.as:"script",S='link[rel="modulepreload"][as="'+Ot(g)+'"][href="'+Ot(r)+'"]',A=S;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=jh(r)}if(!Ys.has(A)&&(r=v({rel:"modulepreload",href:r},o),Ys.set(A,r),d.querySelector(S)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(hm(A)))return}g=d.createElement("link"),Ya(g,"link",r),Je(g),d.head.appendChild(g)}}}function _C(r,o,d){au.S(r,o,d);var g=qh;if(g&&r){var S=te(g).hoistableStyles,A=Wh(r);o=o||"default";var F=S.get(A);if(!F){var K={loading:0,preload:null};if(F=g.querySelector(fm(A)))K.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":o},d),(d=Ys.get(A))&&J_(r,d);var Se=F=g.createElement("link");Je(Se),Ya(Se,"link",r),Se._p=new Promise(function(Ve,ft){Se.onload=Ve,Se.onerror=ft}),Se.addEventListener("load",function(){K.loading|=1}),Se.addEventListener("error",function(){K.loading|=2}),K.loading|=4,A0(F,o,g)}F={type:"stylesheet",instance:F,count:1,state:K},S.set(A,F)}}}function xC(r,o){au.X(r,o);var d=qh;if(d&&r){var g=te(d).hoistableScripts,S=jh(r),A=g.get(S);A||(A=d.querySelector(hm(S)),A||(r=v({src:r,async:!0},o),(o=Ys.get(S))&&$_(r,o),A=d.createElement("script"),Je(A),Ya(A,"link",r),d.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},g.set(S,A))}}function SC(r,o){au.M(r,o);var d=qh;if(d&&r){var g=te(d).hoistableScripts,S=jh(r),A=g.get(S);A||(A=d.querySelector(hm(S)),A||(r=v({src:r,async:!0,type:"module"},o),(o=Ys.get(S))&&$_(r,o),A=d.createElement("script"),Je(A),Ya(A,"link",r),d.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},g.set(S,A))}}function QM(r,o,d,g){var S=(S=oe.current)?T0(S):null;if(!S)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(o=Wh(d.href),d=te(S).hoistableStyles,g=d.get(o),g||(g={type:"style",instance:null,count:0,state:null},d.set(o,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){r=Wh(d.href);var A=te(S).hoistableStyles,F=A.get(r);if(F||(S=S.ownerDocument||S,F={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(r,F),(A=S.querySelector(fm(r)))&&!A._p&&(F.instance=A,F.state.loading=5),Ys.has(r)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},Ys.set(r,d),A||MC(S,r,d,F.state))),o&&g===null)throw Error(n(528,""));return F}if(o&&g!==null)throw Error(n(529,""));return null;case"script":return o=d.async,d=d.src,typeof d=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=jh(d),d=te(S).hoistableScripts,g=d.get(o),g||(g={type:"script",instance:null,count:0,state:null},d.set(o,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function Wh(r){return'href="'+Ot(r)+'"'}function fm(r){return'link[rel="stylesheet"]['+r+"]"}function JM(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function MC(r,o,d,g){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?g.loading=1:(o=r.createElement("link"),g.preload=o,o.addEventListener("load",function(){return g.loading|=1}),o.addEventListener("error",function(){return g.loading|=2}),Ya(o,"link",d),Je(o),r.head.appendChild(o))}function jh(r){return'[src="'+Ot(r)+'"]'}function hm(r){return"script[async]"+r}function $M(r,o,d){if(o.count++,o.instance===null)switch(o.type){case"style":var g=r.querySelector('style[data-href~="'+Ot(d.href)+'"]');if(g)return o.instance=g,Je(g),g;var S=v({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return g=(r.ownerDocument||r).createElement("style"),Je(g),Ya(g,"style",S),A0(g,d.precedence,r),o.instance=g;case"stylesheet":S=Wh(d.href);var A=r.querySelector(fm(S));if(A)return o.state.loading|=4,o.instance=A,Je(A),A;g=JM(d),(S=Ys.get(S))&&J_(g,S),A=(r.ownerDocument||r).createElement("link"),Je(A);var F=A;return F._p=new Promise(function(K,Se){F.onload=K,F.onerror=Se}),Ya(A,"link",g),o.state.loading|=4,A0(A,d.precedence,r),o.instance=A;case"script":return A=jh(d.src),(S=r.querySelector(hm(A)))?(o.instance=S,Je(S),S):(g=d,(S=Ys.get(A))&&(g=v({},d),$_(g,S)),r=r.ownerDocument||r,S=r.createElement("script"),Je(S),Ya(S,"link",g),r.head.appendChild(S),o.instance=S);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(g=o.instance,o.state.loading|=4,A0(g,d.precedence,r));return o.instance}function A0(r,o,d){for(var g=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=g.length?g[g.length-1]:null,A=S,F=0;F<g.length;F++){var K=g[F];if(K.dataset.precedence===o)A=K;else if(A!==S)break}A?A.parentNode.insertBefore(r,A.nextSibling):(o=d.nodeType===9?d.head:d,o.insertBefore(r,o.firstChild))}function J_(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function $_(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var R0=null;function eb(r,o,d){if(R0===null){var g=new Map,S=R0=new Map;S.set(d,g)}else S=R0,g=S.get(d),g||(g=new Map,S.set(d,g));if(g.has(r))return g;for(g.set(r,null),d=d.getElementsByTagName(r),S=0;S<d.length;S++){var A=d[S];if(!(A[Mt]||A[Jt]||r==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var F=A.getAttribute(o)||"";F=r+F;var K=g.get(F);K?K.push(A):g.set(F,[A])}}return g}function tb(r,o,d){r=r.ownerDocument||r,r.head.insertBefore(d,o==="title"?r.querySelector("head > title"):null)}function bC(r,o,d){if(d===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(r=o.disabled,typeof o.precedence=="string"&&r==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function nb(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function EC(r,o,d,g){if(d.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var S=Wh(g.href),A=o.querySelector(fm(S));if(A){o=A._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=C0.bind(r),o.then(r,r)),d.state.loading|=4,d.instance=A,Je(A);return}A=o.ownerDocument||o,g=JM(g),(S=Ys.get(S))&&J_(g,S),A=A.createElement("link"),Je(A);var F=A;F._p=new Promise(function(K,Se){F.onload=K,F.onerror=Se}),Ya(A,"link",g),d.instance=A}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(d,o),(o=d.state.preload)&&(d.state.loading&3)===0&&(r.count++,d=C0.bind(r),o.addEventListener("load",d),o.addEventListener("error",d))}}var e1=0;function TC(r,o){return r.stylesheets&&r.count===0&&U0(r,r.stylesheets),0<r.count||0<r.imgCount?function(d){var g=setTimeout(function(){if(r.stylesheets&&U0(r,r.stylesheets),r.unsuspend){var A=r.unsuspend;r.unsuspend=null,A()}},6e4+o);0<r.imgBytes&&e1===0&&(e1=62500*rC());var S=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&U0(r,r.stylesheets),r.unsuspend)){var A=r.unsuspend;r.unsuspend=null,A()}},(r.imgBytes>e1?50:800)+o);return r.unsuspend=d,function(){r.unsuspend=null,clearTimeout(g),clearTimeout(S)}}:null}function C0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)U0(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var w0=null;function U0(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,w0=new Map,o.forEach(AC,r),w0=null,C0.call(r))}function AC(r,o){if(!(o.state.loading&4)){var d=w0.get(r);if(d)var g=d.get(null);else{d=new Map,w0.set(r,d);for(var S=r.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<S.length;A++){var F=S[A];(F.nodeName==="LINK"||F.getAttribute("media")!=="not all")&&(d.set(F.dataset.precedence,F),g=F)}g&&d.set(null,g)}S=o.instance,F=S.getAttribute("data-precedence"),A=d.get(F)||g,A===g&&d.set(null,S),d.set(F,S),this.count++,g=C0.bind(this),S.addEventListener("load",g),S.addEventListener("error",g),A?A.parentNode.insertBefore(S,A.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(S,r.firstChild)),o.state.loading|=4}}var dm={$$typeof:D,Provider:null,Consumer:null,_currentValue:ie,_currentValue2:ie,_threadCount:0};function RC(r,o,d,g,S,A,F,K,Se){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pt(0),this.hiddenUpdates=Pt(null),this.identifierPrefix=g,this.onUncaughtError=S,this.onCaughtError=A,this.onRecoverableError=F,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Se,this.incompleteTransitions=new Map}function ib(r,o,d,g,S,A,F,K,Se,Ve,ft,vt){return r=new RC(r,o,d,F,Se,Ve,ft,vt,K),o=1,A===!0&&(o|=24),A=Fa(3,null,null,o),r.current=A,A.stateNode=r,o=Sp(),o.refCount++,r.pooledCache=o,o.refCount++,A.memoizedState={element:g,isDehydrated:d,cache:o},Rp(A),r}function ab(r){return r?(r=jo,r):jo}function rb(r,o,d,g,S,A){S=ab(S),g.context===null?g.context=S:g.pendingContext=S,g=zs(o),g.payload={element:d},A=A===void 0?null:A,A!==null&&(g.callback=A),d=ho(r,g,o),d!==null&&(h(d,r,o),nl(d,r,o))}function sb(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var d=r.retryLane;r.retryLane=d!==0&&d<o?d:o}}function t1(r,o){sb(r,o),(r=r.alternate)&&sb(r,o)}function ob(r){if(r.tag===13||r.tag===31){var o=Wo(r,67108864);o!==null&&h(o,r,67108864),t1(r,67108864)}}function lb(r){if(r.tag===13||r.tag===31){var o=Xa();o=mi(o);var d=Wo(r,o);d!==null&&h(d,r,o),t1(r,o)}}var D0=!0;function CC(r,o,d,g){var S=G.T;G.T=null;var A=ee.p;try{ee.p=2,n1(r,o,d,g)}finally{ee.p=A,G.T=S}}function wC(r,o,d,g){var S=G.T;G.T=null;var A=ee.p;try{ee.p=8,n1(r,o,d,g)}finally{ee.p=A,G.T=S}}function n1(r,o,d,g){if(D0){var S=i1(g);if(S===null)V_(r,o,g,N0,d),cb(r,g);else if(DC(S,r,o,d,g))g.stopPropagation();else if(cb(r,g),o&4&&-1<UC.indexOf(r)){for(;S!==null;){var A=me(S);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var F=it(A.pendingLanes);if(F!==0){var K=A;for(K.pendingLanes|=2,K.entangledLanes|=2;F;){var Se=1<<31-le(F);K.entanglements[1]|=Se,F&=~Se}fl(A),(zn&6)===0&&(wr=V()+500,om(0))}}break;case 31:case 13:K=Wo(A,2),K!==null&&h(K,A,2),J(),t1(A,2)}if(A=i1(g),A===null&&V_(r,o,g,N0,d),A===S)break;S=A}S!==null&&g.stopPropagation()}else V_(r,o,g,null,d)}}function i1(r){return r=Rl(r),a1(r)}var N0=null;function a1(r){if(N0=null,r=ue(r),r!==null){var o=a(r);if(o===null)r=null;else{var d=o.tag;if(d===13){if(r=l(o),r!==null)return r;r=null}else if(d===31){if(r=u(o),r!==null)return r;r=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return N0=r,null}function ub(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ve()){case Be:return 2;case De:return 8;case Ae:case gt:return 32;case ct:return 268435456;default:return 32}default:return 32}}var r1=!1,Ju=null,$u=null,ec=null,pm=new Map,mm=new Map,tc=[],UC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function cb(r,o){switch(r){case"focusin":case"focusout":Ju=null;break;case"dragenter":case"dragleave":$u=null;break;case"mouseover":case"mouseout":ec=null;break;case"pointerover":case"pointerout":pm.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":mm.delete(o.pointerId)}}function gm(r,o,d,g,S,A){return r===null||r.nativeEvent!==A?(r={blockedOn:o,domEventName:d,eventSystemFlags:g,nativeEvent:A,targetContainers:[S]},o!==null&&(o=me(o),o!==null&&ob(o)),r):(r.eventSystemFlags|=g,o=r.targetContainers,S!==null&&o.indexOf(S)===-1&&o.push(S),r)}function DC(r,o,d,g,S){switch(o){case"focusin":return Ju=gm(Ju,r,o,d,g,S),!0;case"dragenter":return $u=gm($u,r,o,d,g,S),!0;case"mouseover":return ec=gm(ec,r,o,d,g,S),!0;case"pointerover":var A=S.pointerId;return pm.set(A,gm(pm.get(A)||null,r,o,d,g,S)),!0;case"gotpointercapture":return A=S.pointerId,mm.set(A,gm(mm.get(A)||null,r,o,d,g,S)),!0}return!1}function fb(r){var o=ue(r.target);if(o!==null){var d=a(o);if(d!==null){if(o=d.tag,o===13){if(o=l(d),o!==null){r.blockedOn=o,Xt(r.priority,function(){lb(d)});return}}else if(o===31){if(o=u(d),o!==null){r.blockedOn=o,Xt(r.priority,function(){lb(d)});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){r.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}r.blockedOn=null}function O0(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var d=i1(r.nativeEvent);if(d===null){d=r.nativeEvent;var g=new d.constructor(d.type,d);rs=g,d.target.dispatchEvent(g),rs=null}else return o=me(d),o!==null&&ob(o),r.blockedOn=d,!1;o.shift()}return!0}function hb(r,o,d){O0(r)&&d.delete(o)}function NC(){r1=!1,Ju!==null&&O0(Ju)&&(Ju=null),$u!==null&&O0($u)&&($u=null),ec!==null&&O0(ec)&&(ec=null),pm.forEach(hb),mm.forEach(hb)}function L0(r,o){r.blockedOn===o&&(r.blockedOn=null,r1||(r1=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,NC)))}var z0=null;function db(r){z0!==r&&(z0=r,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){z0===r&&(z0=null);for(var o=0;o<r.length;o+=3){var d=r[o],g=r[o+1],S=r[o+2];if(typeof g!="function"){if(a1(g||d)===null)continue;break}var A=me(d);A!==null&&(r.splice(o,3),o-=3,Jp(A,{pending:!0,data:S,method:d.method,action:g},g,S))}}))}function Zh(r){function o(Se){return L0(Se,r)}Ju!==null&&L0(Ju,r),$u!==null&&L0($u,r),ec!==null&&L0(ec,r),pm.forEach(o),mm.forEach(o);for(var d=0;d<tc.length;d++){var g=tc[d];g.blockedOn===r&&(g.blockedOn=null)}for(;0<tc.length&&(d=tc[0],d.blockedOn===null);)fb(d),d.blockedOn===null&&tc.shift();if(d=(r.ownerDocument||r).$$reactFormReplay,d!=null)for(g=0;g<d.length;g+=3){var S=d[g],A=d[g+1],F=S[k]||null;if(typeof A=="function")F||db(d);else if(F){var K=null;if(A&&A.hasAttribute("formAction")){if(S=A,F=A[k]||null)K=F.formAction;else if(a1(S)!==null)continue}else K=F.action;typeof K=="function"?d[g+1]=K:(d.splice(g,3),g-=3),db(d)}}}function pb(){function r(A){A.canIntercept&&A.info==="react-transition"&&A.intercept({handler:function(){return new Promise(function(F){return S=F})},focusReset:"manual",scroll:"manual"})}function o(){S!==null&&(S(),S=null),g||setTimeout(d,20)}function d(){if(!g&&!navigation.transition){var A=navigation.currentEntry;A&&A.url!=null&&navigation.navigate(A.url,{state:A.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,S=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(d,100),function(){g=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),S!==null&&(S(),S=null)}}}function s1(r){this._internalRoot=r}I0.prototype.render=s1.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));var d=o.current,g=Xa();rb(d,g,r,o,null,null)},I0.prototype.unmount=s1.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;rb(r.current,2,null,r,null,null),J(),o[$]=null}};function I0(r){this._internalRoot=r}I0.prototype.unstable_scheduleHydration=function(r){if(r){var o=ri();r={blockedOn:null,target:r,priority:o};for(var d=0;d<tc.length&&o!==0&&o<tc[d].priority;d++);tc.splice(d,0,r),d===0&&fb(r)}};var mb=e.version;if(mb!=="19.2.3")throw Error(n(527,mb,"19.2.3"));ee.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=p(o),r=r!==null?m(r):null,r=r===null?null:r.stateNode,r};var OC={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var B0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!B0.isDisabled&&B0.supportsFiber)try{ke=B0.inject(OC),Xe=B0}catch{}}return ym.createRoot=function(r,o){if(!i(r))throw Error(n(299));var d=!1,g="",S=nm,A=m0,F=Nh;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(S=o.onUncaughtError),o.onCaughtError!==void 0&&(A=o.onCaughtError),o.onRecoverableError!==void 0&&(F=o.onRecoverableError)),o=ib(r,1,!1,null,null,d,g,null,S,A,F,pb),r[$]=o.current,G_(r),new s1(o)},ym.hydrateRoot=function(r,o,d){if(!i(r))throw Error(n(299));var g=!1,S="",A=nm,F=m0,K=Nh,Se=null;return d!=null&&(d.unstable_strictMode===!0&&(g=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onUncaughtError!==void 0&&(A=d.onUncaughtError),d.onCaughtError!==void 0&&(F=d.onCaughtError),d.onRecoverableError!==void 0&&(K=d.onRecoverableError),d.formState!==void 0&&(Se=d.formState)),o=ib(r,1,!0,o,d??null,g,S,Se,A,F,K,pb),o.context=ab(null),d=o.current,g=Xa(),g=mi(g),S=zs(g),S.callback=null,ho(d,S,g),d=g,o.current.lanes=d,yn(o,d),fl(o),r[$]=o.current,G_(r),new I0(o)},ym.version="19.2.3",ym}var Tb;function XC(){if(Tb)return u1.exports;Tb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),u1.exports=kC(),u1.exports}var YC=XC(),d1={exports:{}},p1={};var Ab;function qC(){if(Ab)return p1;Ab=1;var s=Wf().__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;return p1.c=function(e){return s.H.useMemoCache(e)},p1}var Rb;function WC(){return Rb||(Rb=1,d1.exports=qC()),d1.exports}var Fy=WC(),m1={exports:{}},ru={};var Cb;function jC(){return Cb||(Cb=1,ru.ConcurrentRoot=1,ru.ContinuousEventPriority=8,ru.DefaultEventPriority=32,ru.DiscreteEventPriority=2,ru.IdleEventPriority=268435456,ru.LegacyRoot=0,ru.NoEventPriority=0),ru}var wb;function ZC(){return wb||(wb=1,m1.exports=jC()),m1.exports}var Pv=ZC();const cg="180",Af={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Rf={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},iA=0,Ix=1,aA=2,KC=3,rA=0,Hy=1,Fm=2,wo=3,xl=0,Ir=1,ur=2,vl=0,Bf=1,Bx=2,Px=3,Fx=4,sA=5,hc=100,oA=101,lA=102,uA=103,cA=104,fA=200,hA=201,dA=202,pA=203,Yv=204,qv=205,mA=206,gA=207,vA=208,yA=209,_A=210,xA=211,SA=212,MA=213,bA=214,Wv=0,jv=1,Zv=2,Gf=3,Kv=4,Qv=5,Jv=6,$v=7,fg=0,EA=1,TA=2,yl=0,AA=1,RA=2,CA=3,pS=4,wA=5,UA=6,DA=7,Hx="attached",NA="detached",gc=300,Sl=301,vc=302,Cd=303,Qm=304,Xd=306,yc=1e3,ta=1001,wd=1002,Sa=1003,Gy=1004,QC=1004,Df=1005,JC=1005,Wn=1006,Ed=1007,$C=1007,Zs=1008,Gx=1008,Pr=1009,Vy=1010,ky=1011,Ud=1012,hg=1013,Ml=1014,Vi=1015,Ia=1016,Xy=1017,Yy=1018,Dd=1020,mS=35902,gS=35899,vS=1021,yS=1022,na=1023,Nd=1026,Od=1027,dg=1028,pg=1029,_S=1030,qy=1031,ew=1032,Wy=1033,Hm=33776,Gm=33777,Vm=33778,km=33779,ey=35840,ty=35841,ny=35842,iy=35843,ay=36196,ry=37492,sy=37496,oy=37808,ly=37809,uy=37810,cy=37811,fy=37812,hy=37813,dy=37814,py=37815,my=37816,gy=37817,vy=37818,yy=37819,_y=37820,xy=37821,Sy=36492,My=36494,by=36495,Ey=36283,Ty=36284,Ay=36285,Ry=36286,OA=2200,LA=2201,zA=2202,Ld=2300,zd=2301,Fv=2302,Nf=2400,Of=2401,Jm=2402,jy=2500,xS=2501,IA=0,SS=1,Cy=2,BA=3200,MS=3201,tw=3202,nw=3203,Sc=0,PA=1,pu="",zi="srgb",fa="srgb-linear",$m="linear",ui="srgb",iw=0,Cf=7680,aw=7681,rw=7682,sw=7683,ow=34055,lw=34056,uw=5386,cw=512,fw=513,hw=514,dw=515,pw=516,mw=517,gw=518,Vx=519,FA=512,HA=513,GA=514,bS=515,VA=516,kA=517,XA=518,YA=519,eg=35044,vw=35048,yw=35040,_w=35045,xw=35049,Sw=35041,Mw=35046,bw=35050,Ew=35042,Tw="100",kx="300 es",bs=2e3,Id=2001,Aw={COMPUTE:"compute",RENDER:"render"},Rw={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},Cw={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};let bl=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const i=n[e];if(i!==void 0){const a=i.indexOf(t);a!==-1&&i.splice(a,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let a=0,l=i.length;a<l;a++)i[a].call(this,e);e.target=null}}};const sr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Ub=1234567;const Pf=Math.PI/180,Bd=180/Math.PI;function Es(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(sr[s&255]+sr[s>>8&255]+sr[s>>16&255]+sr[s>>24&255]+"-"+sr[e&255]+sr[e>>8&255]+"-"+sr[e>>16&15|64]+sr[e>>24&255]+"-"+sr[t&63|128]+sr[t>>8&255]+"-"+sr[t>>16&255]+sr[t>>24&255]+sr[n&255]+sr[n>>8&255]+sr[n>>16&255]+sr[n>>24&255]).toLowerCase()}function rn(s,e,t){return Math.max(e,Math.min(t,s))}function ES(s,e){return(s%e+e)%e}function ww(s,e,t,n,i){return n+(s-e)*(i-n)/(t-e)}function Uw(s,e,t){return s!==e?(t-s)/(e-s):0}function Xm(s,e,t){return(1-t)*s+t*e}function Dw(s,e,t,n){return Xm(s,e,1-Math.exp(-t*n))}function Nw(s,e=1){return e-Math.abs(ES(s,e*2)-e)}function Ow(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*(3-2*s))}function Lw(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*s*(s*(s*6-15)+10))}function zw(s,e){return s+Math.floor(Math.random()*(e-s+1))}function Iw(s,e){return s+Math.random()*(e-s)}function Bw(s){return s*(.5-Math.random())}function Pw(s){s!==void 0&&(Ub=s);let e=Ub+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Fw(s){return s*Pf}function Hw(s){return s*Bd}function Gw(s){return(s&s-1)===0&&s!==0}function Vw(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function kw(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function Xw(s,e,t,n,i){const a=Math.cos,l=Math.sin,u=a(t/2),f=l(t/2),p=a((e+n)/2),m=l((e+n)/2),v=a((e-n)/2),_=l((e-n)/2),x=a((n-e)/2),b=l((n-e)/2);switch(i){case"XYX":s.set(u*m,f*v,f*_,u*p);break;case"YZY":s.set(f*_,u*m,f*v,u*p);break;case"ZXZ":s.set(f*v,f*_,u*m,u*p);break;case"XZX":s.set(u*m,f*b,f*x,u*p);break;case"YXY":s.set(f*x,u*m,f*b,u*p);break;case"ZYZ":s.set(f*b,f*x,u*m,u*p);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Lr(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function Sn(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const Pd={DEG2RAD:Pf,RAD2DEG:Bd,generateUUID:Es,clamp:rn,euclideanModulo:ES,mapLinear:ww,inverseLerp:Uw,lerp:Xm,damp:Dw,pingpong:Nw,smoothstep:Ow,smootherstep:Lw,randInt:zw,randFloat:Iw,randFloatSpread:Bw,seededRandom:Pw,degToRad:Fw,radToDeg:Hw,isPowerOfTwo:Gw,ceilPowerOfTwo:Vw,floorPowerOfTwo:kw,setQuaternionFromProperEuler:Xw,normalize:Sn,denormalize:Lr};class ht{constructor(e=0,t=0){ht.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=rn(this.x,e.x,t.x),this.y=rn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=rn(this.x,e,t),this.y=rn(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(rn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(rn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),a=this.x-e.x,l=this.y-e.y;return this.x=a*n-l*i+e.x,this.y=a*i+l*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ua{constructor(e=0,t=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,a,l,u){let f=n[i+0],p=n[i+1],m=n[i+2],v=n[i+3];const _=a[l+0],x=a[l+1],b=a[l+2],R=a[l+3];if(u===0){e[t+0]=f,e[t+1]=p,e[t+2]=m,e[t+3]=v;return}if(u===1){e[t+0]=_,e[t+1]=x,e[t+2]=b,e[t+3]=R;return}if(v!==R||f!==_||p!==x||m!==b){let T=1-u;const E=f*_+p*x+m*b+v*R,w=E>=0?1:-1,D=1-E*E;if(D>Number.EPSILON){const I=Math.sqrt(D),O=Math.atan2(I,E*w);T=Math.sin(T*O)/I,u=Math.sin(u*O)/I}const U=u*w;if(f=f*T+_*U,p=p*T+x*U,m=m*T+b*U,v=v*T+R*U,T===1-u){const I=1/Math.sqrt(f*f+p*p+m*m+v*v);f*=I,p*=I,m*=I,v*=I}}e[t]=f,e[t+1]=p,e[t+2]=m,e[t+3]=v}static multiplyQuaternionsFlat(e,t,n,i,a,l){const u=n[i],f=n[i+1],p=n[i+2],m=n[i+3],v=a[l],_=a[l+1],x=a[l+2],b=a[l+3];return e[t]=u*b+m*v+f*x-p*_,e[t+1]=f*b+m*_+p*v-u*x,e[t+2]=p*b+m*x+u*_-f*v,e[t+3]=m*b-u*v-f*_-p*x,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,i=e._y,a=e._z,l=e._order,u=Math.cos,f=Math.sin,p=u(n/2),m=u(i/2),v=u(a/2),_=f(n/2),x=f(i/2),b=f(a/2);switch(l){case"XYZ":this._x=_*m*v+p*x*b,this._y=p*x*v-_*m*b,this._z=p*m*b+_*x*v,this._w=p*m*v-_*x*b;break;case"YXZ":this._x=_*m*v+p*x*b,this._y=p*x*v-_*m*b,this._z=p*m*b-_*x*v,this._w=p*m*v+_*x*b;break;case"ZXY":this._x=_*m*v-p*x*b,this._y=p*x*v+_*m*b,this._z=p*m*b+_*x*v,this._w=p*m*v-_*x*b;break;case"ZYX":this._x=_*m*v-p*x*b,this._y=p*x*v+_*m*b,this._z=p*m*b-_*x*v,this._w=p*m*v+_*x*b;break;case"YZX":this._x=_*m*v+p*x*b,this._y=p*x*v+_*m*b,this._z=p*m*b-_*x*v,this._w=p*m*v-_*x*b;break;case"XZY":this._x=_*m*v-p*x*b,this._y=p*x*v-_*m*b,this._z=p*m*b+_*x*v,this._w=p*m*v+_*x*b;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],a=t[8],l=t[1],u=t[5],f=t[9],p=t[2],m=t[6],v=t[10],_=n+u+v;if(_>0){const x=.5/Math.sqrt(_+1);this._w=.25/x,this._x=(m-f)*x,this._y=(a-p)*x,this._z=(l-i)*x}else if(n>u&&n>v){const x=2*Math.sqrt(1+n-u-v);this._w=(m-f)/x,this._x=.25*x,this._y=(i+l)/x,this._z=(a+p)/x}else if(u>v){const x=2*Math.sqrt(1+u-n-v);this._w=(a-p)/x,this._x=(i+l)/x,this._y=.25*x,this._z=(f+m)/x}else{const x=2*Math.sqrt(1+v-n-u);this._w=(l-i)/x,this._x=(a+p)/x,this._y=(f+m)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(rn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,a=e._z,l=e._w,u=t._x,f=t._y,p=t._z,m=t._w;return this._x=n*m+l*u+i*p-a*f,this._y=i*m+l*f+a*u-n*p,this._z=a*m+l*p+n*f-i*u,this._w=l*m-n*u-i*f-a*p,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,i=this._y,a=this._z,l=this._w;let u=l*e._w+n*e._x+i*e._y+a*e._z;if(u<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,u=-u):this.copy(e),u>=1)return this._w=l,this._x=n,this._y=i,this._z=a,this;const f=1-u*u;if(f<=Number.EPSILON){const x=1-t;return this._w=x*l+t*this._w,this._x=x*n+t*this._x,this._y=x*i+t*this._y,this._z=x*a+t*this._z,this.normalize(),this}const p=Math.sqrt(f),m=Math.atan2(p,u),v=Math.sin((1-t)*m)/p,_=Math.sin(t*m)/p;return this._w=l*v+this._w*_,this._x=n*v+this._x*_,this._y=i*v+this._y*_,this._z=a*v+this._z*_,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),a=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),a*Math.sin(t),a*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ne{constructor(e=0,t=0,n=0){ne.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Db.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Db.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,a=e.elements;return this.x=a[0]*t+a[3]*n+a[6]*i,this.y=a[1]*t+a[4]*n+a[7]*i,this.z=a[2]*t+a[5]*n+a[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,a=e.elements,l=1/(a[3]*t+a[7]*n+a[11]*i+a[15]);return this.x=(a[0]*t+a[4]*n+a[8]*i+a[12])*l,this.y=(a[1]*t+a[5]*n+a[9]*i+a[13])*l,this.z=(a[2]*t+a[6]*n+a[10]*i+a[14])*l,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,a=e.x,l=e.y,u=e.z,f=e.w,p=2*(l*i-u*n),m=2*(u*t-a*i),v=2*(a*n-l*t);return this.x=t+f*p+l*v-u*m,this.y=n+f*m+u*p-a*v,this.z=i+f*v+a*m-l*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*i,this.y=a[1]*t+a[5]*n+a[9]*i,this.z=a[2]*t+a[6]*n+a[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=rn(this.x,e.x,t.x),this.y=rn(this.y,e.y,t.y),this.z=rn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=rn(this.x,e,t),this.y=rn(this.y,e,t),this.z=rn(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(rn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,a=e.z,l=t.x,u=t.y,f=t.z;return this.x=i*f-a*u,this.y=a*l-n*f,this.z=n*u-i*l,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return g1.copy(this).projectOnVector(e),this.sub(g1)}reflect(e){return this.sub(g1.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(rn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const g1=new ne,Db=new ua;class dn{constructor(e,t,n,i,a,l,u,f,p){dn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,i,a,l,u,f,p)}set(e,t,n,i,a,l,u,f,p){const m=this.elements;return m[0]=e,m[1]=i,m[2]=u,m[3]=t,m[4]=a,m[5]=f,m[6]=n,m[7]=l,m[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,a=this.elements,l=n[0],u=n[3],f=n[6],p=n[1],m=n[4],v=n[7],_=n[2],x=n[5],b=n[8],R=i[0],T=i[3],E=i[6],w=i[1],D=i[4],U=i[7],I=i[2],O=i[5],P=i[8];return a[0]=l*R+u*w+f*I,a[3]=l*T+u*D+f*O,a[6]=l*E+u*U+f*P,a[1]=p*R+m*w+v*I,a[4]=p*T+m*D+v*O,a[7]=p*E+m*U+v*P,a[2]=_*R+x*w+b*I,a[5]=_*T+x*D+b*O,a[8]=_*E+x*U+b*P,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],a=e[3],l=e[4],u=e[5],f=e[6],p=e[7],m=e[8];return t*l*m-t*u*p-n*a*m+n*u*f+i*a*p-i*l*f}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],a=e[3],l=e[4],u=e[5],f=e[6],p=e[7],m=e[8],v=m*l-u*p,_=u*f-m*a,x=p*a-l*f,b=t*v+n*_+i*x;if(b===0)return this.set(0,0,0,0,0,0,0,0,0);const R=1/b;return e[0]=v*R,e[1]=(i*p-m*n)*R,e[2]=(u*n-i*l)*R,e[3]=_*R,e[4]=(m*t-i*f)*R,e[5]=(i*a-u*t)*R,e[6]=x*R,e[7]=(n*f-p*t)*R,e[8]=(l*t-n*a)*R,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,a,l,u){const f=Math.cos(a),p=Math.sin(a);return this.set(n*f,n*p,-n*(f*l+p*u)+l+e,-i*p,i*f,-i*(-p*l+f*u)+u+t,0,0,1),this}scale(e,t){return this.premultiply(v1.makeScale(e,t)),this}rotate(e){return this.premultiply(v1.makeRotation(-e)),this}translate(e,t){return this.premultiply(v1.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const v1=new dn;function qA(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}const Yw={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Md(s,e){return new Yw[s](e)}function tg(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function WA(){const s=tg("canvas");return s.style.display="block",s}const Nb={};function ng(s){s in Nb||(Nb[s]=!0,console.warn(s))}function qw(s,e,t){return new Promise(function(n,i){function a(){switch(s.clientWaitSync(e,s.SYNC_FLUSH_COMMANDS_BIT,0)){case s.WAIT_FAILED:i();break;case s.TIMEOUT_EXPIRED:setTimeout(a,t);break;default:n()}}setTimeout(a,t)})}const Ob=new dn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Lb=new dn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Ww(){const s={enabled:!0,workingColorSpace:fa,spaces:{},convert:function(i,a,l){return this.enabled===!1||a===l||!a||!l||(this.spaces[a].transfer===ui&&(i.r=vu(i.r),i.g=vu(i.g),i.b=vu(i.b)),this.spaces[a].primaries!==this.spaces[l].primaries&&(i.applyMatrix3(this.spaces[a].toXYZ),i.applyMatrix3(this.spaces[l].fromXYZ)),this.spaces[l].transfer===ui&&(i.r=Td(i.r),i.g=Td(i.g),i.b=Td(i.b))),i},workingToColorSpace:function(i,a){return this.convert(i,this.workingColorSpace,a)},colorSpaceToWorking:function(i,a){return this.convert(i,a,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===pu?$m:this.spaces[i].transfer},getToneMappingMode:function(i){return this.spaces[i].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(i,a=this.workingColorSpace){return i.fromArray(this.spaces[a].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,a,l){return i.copy(this.spaces[a].toXYZ).multiply(this.spaces[l].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(i,a){return ng("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),s.workingToColorSpace(i,a)},toWorkingColorSpace:function(i,a){return ng("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),s.colorSpaceToWorking(i,a)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return s.define({[fa]:{primaries:e,whitePoint:n,transfer:$m,toXYZ:Ob,fromXYZ:Lb,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:zi},outputColorSpaceConfig:{drawingBufferColorSpace:zi}},[zi]:{primaries:e,whitePoint:n,transfer:ui,toXYZ:Ob,fromXYZ:Lb,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:zi}}}),s}const On=Ww();function vu(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function Td(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let Kh;class jA{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Kh===void 0&&(Kh=tg("canvas")),Kh.width=e.width,Kh.height=e.height;const i=Kh.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=Kh}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=tg("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),a=i.data;for(let l=0;l<a.length;l++)a[l]=vu(a[l]/255)*255;return n.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(vu(t[n]/255)*255):t[n]=vu(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let jw=0;class dc{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:jw++}),this.uuid=Es(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let a;if(Array.isArray(i)){a=[];for(let l=0,u=i.length;l<u;l++)i[l].isDataTexture?a.push(y1(i[l].image)):a.push(y1(i[l]))}else a=y1(i);n.url=a}return t||(e.images[this.uuid]=n),n}}function y1(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?jA.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Zw=0;const _1=new ne;class Zn extends bl{constructor(e=Zn.DEFAULT_IMAGE,t=Zn.DEFAULT_MAPPING,n=ta,i=ta,a=Wn,l=Zs,u=na,f=Pr,p=Zn.DEFAULT_ANISOTROPY,m=pu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Zw++}),this.uuid=Es(),this.name="",this.source=new dc(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=a,this.minFilter=l,this.anisotropy=p,this.format=u,this.internalFormat=null,this.type=f,this.offset=new ht(0,0),this.repeat=new ht(1,1),this.center=new ht(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new dn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=m,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(_1).x}get height(){return this.source.getSize(_1).y}get depth(){return this.source.getSize(_1).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Texture.setValues(): property '${t}' does not exist.`);continue}i&&n&&i.isVector2&&n.isVector2||i&&n&&i.isVector3&&n.isVector3||i&&n&&i.isMatrix3&&n.isMatrix3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==gc)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case yc:e.x=e.x-Math.floor(e.x);break;case ta:e.x=e.x<0?0:1;break;case wd:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case yc:e.y=e.y-Math.floor(e.y);break;case ta:e.y=e.y<0?0:1;break;case wd:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Zn.DEFAULT_IMAGE=null;Zn.DEFAULT_MAPPING=gc;Zn.DEFAULT_ANISOTROPY=1;class kn{constructor(e=0,t=0,n=0,i=1){kn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,a=this.w,l=e.elements;return this.x=l[0]*t+l[4]*n+l[8]*i+l[12]*a,this.y=l[1]*t+l[5]*n+l[9]*i+l[13]*a,this.z=l[2]*t+l[6]*n+l[10]*i+l[14]*a,this.w=l[3]*t+l[7]*n+l[11]*i+l[15]*a,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,a;const f=e.elements,p=f[0],m=f[4],v=f[8],_=f[1],x=f[5],b=f[9],R=f[2],T=f[6],E=f[10];if(Math.abs(m-_)<.01&&Math.abs(v-R)<.01&&Math.abs(b-T)<.01){if(Math.abs(m+_)<.1&&Math.abs(v+R)<.1&&Math.abs(b+T)<.1&&Math.abs(p+x+E-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const D=(p+1)/2,U=(x+1)/2,I=(E+1)/2,O=(m+_)/4,P=(v+R)/4,B=(b+T)/4;return D>U&&D>I?D<.01?(n=0,i=.707106781,a=.707106781):(n=Math.sqrt(D),i=O/n,a=P/n):U>I?U<.01?(n=.707106781,i=0,a=.707106781):(i=Math.sqrt(U),n=O/i,a=B/i):I<.01?(n=.707106781,i=.707106781,a=0):(a=Math.sqrt(I),n=P/a,i=B/a),this.set(n,i,a,t),this}let w=Math.sqrt((T-b)*(T-b)+(v-R)*(v-R)+(_-m)*(_-m));return Math.abs(w)<.001&&(w=1),this.x=(T-b)/w,this.y=(v-R)/w,this.z=(_-m)/w,this.w=Math.acos((p+x+E-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=rn(this.x,e.x,t.x),this.y=rn(this.y,e.y,t.y),this.z=rn(this.z,e.z,t.z),this.w=rn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=rn(this.x,e,t),this.y=rn(this.y,e,t),this.z=rn(this.z,e,t),this.w=rn(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(rn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class TS extends bl{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Wn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new kn(0,0,e,t),this.scissorTest=!1,this.viewport=new kn(0,0,e,t);const i={width:e,height:t,depth:n.depth},a=new Zn(i);this.textures=[];const l=n.count;for(let u=0;u<l;u++)this.textures[u]=a.clone(),this.textures[u].isRenderTargetTexture=!0,this.textures[u].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:Wn,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,a=this.textures.length;i<a;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n,this.textures[i].isArrayTexture=this.textures[i].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const i=Object.assign({},e.textures[t].image);this.textures[t].source=new dc(i)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ks extends TS{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class Zy extends Zn{constructor(e=null,t=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Sa,this.minFilter=Sa,this.wrapR=ta,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Kw extends Ks{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Zy(null,e,t,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class Ky extends Zn{constructor(e=null,t=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Sa,this.minFilter=Sa,this.wrapR=ta,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Qw extends Ks{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Ky(null,e,t,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class ca{constructor(e=new ne(1/0,1/0,1/0),t=new ne(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(To.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(To.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=To.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const a=n.getAttribute("position");if(t===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let l=0,u=a.count;l<u;l++)e.isMesh===!0?e.getVertexPosition(l,To):To.fromBufferAttribute(a,l),To.applyMatrix4(e.matrixWorld),this.expandByPoint(To);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),P0.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),P0.copy(n.boundingBox)),P0.applyMatrix4(e.matrixWorld),this.union(P0)}const i=e.children;for(let a=0,l=i.length;a<l;a++)this.expandByObject(i[a],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,To),To.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(_m),F0.subVectors(this.max,_m),Qh.subVectors(e.a,_m),Jh.subVectors(e.b,_m),$h.subVectors(e.c,_m),ic.subVectors(Jh,Qh),ac.subVectors($h,Jh),uf.subVectors(Qh,$h);let t=[0,-ic.z,ic.y,0,-ac.z,ac.y,0,-uf.z,uf.y,ic.z,0,-ic.x,ac.z,0,-ac.x,uf.z,0,-uf.x,-ic.y,ic.x,0,-ac.y,ac.x,0,-uf.y,uf.x,0];return!x1(t,Qh,Jh,$h,F0)||(t=[1,0,0,0,1,0,0,0,1],!x1(t,Qh,Jh,$h,F0))?!1:(H0.crossVectors(ic,ac),t=[H0.x,H0.y,H0.z],x1(t,Qh,Jh,$h,F0))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,To).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(To).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(su[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),su[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),su[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),su[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),su[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),su[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),su[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),su[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(su),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const su=[new ne,new ne,new ne,new ne,new ne,new ne,new ne,new ne],To=new ne,P0=new ca,Qh=new ne,Jh=new ne,$h=new ne,ic=new ne,ac=new ne,uf=new ne,_m=new ne,F0=new ne,H0=new ne,cf=new ne;function x1(s,e,t,n,i){for(let a=0,l=s.length-3;a<=l;a+=3){cf.fromArray(s,a);const u=i.x*Math.abs(cf.x)+i.y*Math.abs(cf.y)+i.z*Math.abs(cf.z),f=e.dot(cf),p=t.dot(cf),m=n.dot(cf);if(Math.max(-Math.max(f,p,m),Math.min(f,p,m))>u)return!1}return!0}const Jw=new ca,xm=new ne,S1=new ne;class Ma{constructor(e=new ne,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):Jw.setFromPoints(e).getCenter(n);let i=0;for(let a=0,l=e.length;a<l;a++)i=Math.max(i,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;xm.subVectors(e,this.center);const t=xm.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=(n-this.radius)*.5;this.center.addScaledVector(xm,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(S1.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(xm.copy(e.center).add(S1)),this.expandByPoint(xm.copy(e.center).sub(S1))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const ou=new ne,M1=new ne,G0=new ne,rc=new ne,b1=new ne,V0=new ne,E1=new ne;class jf{constructor(e=new ne,t=new ne(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ou)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ou.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ou.copy(this.origin).addScaledVector(this.direction,t),ou.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){M1.copy(e).add(t).multiplyScalar(.5),G0.copy(t).sub(e).normalize(),rc.copy(this.origin).sub(M1);const a=e.distanceTo(t)*.5,l=-this.direction.dot(G0),u=rc.dot(this.direction),f=-rc.dot(G0),p=rc.lengthSq(),m=Math.abs(1-l*l);let v,_,x,b;if(m>0)if(v=l*f-u,_=l*u-f,b=a*m,v>=0)if(_>=-b)if(_<=b){const R=1/m;v*=R,_*=R,x=v*(v+l*_+2*u)+_*(l*v+_+2*f)+p}else _=a,v=Math.max(0,-(l*_+u)),x=-v*v+_*(_+2*f)+p;else _=-a,v=Math.max(0,-(l*_+u)),x=-v*v+_*(_+2*f)+p;else _<=-b?(v=Math.max(0,-(-l*a+u)),_=v>0?-a:Math.min(Math.max(-a,-f),a),x=-v*v+_*(_+2*f)+p):_<=b?(v=0,_=Math.min(Math.max(-a,-f),a),x=_*(_+2*f)+p):(v=Math.max(0,-(l*a+u)),_=v>0?a:Math.min(Math.max(-a,-f),a),x=-v*v+_*(_+2*f)+p);else _=l>0?-a:a,v=Math.max(0,-(l*_+u)),x=-v*v+_*(_+2*f)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,v),i&&i.copy(M1).addScaledVector(G0,_),x}intersectSphere(e,t){ou.subVectors(e.center,this.origin);const n=ou.dot(this.direction),i=ou.dot(ou)-n*n,a=e.radius*e.radius;if(i>a)return null;const l=Math.sqrt(a-i),u=n-l,f=n+l;return f<0?null:u<0?this.at(f,t):this.at(u,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,a,l,u,f;const p=1/this.direction.x,m=1/this.direction.y,v=1/this.direction.z,_=this.origin;return p>=0?(n=(e.min.x-_.x)*p,i=(e.max.x-_.x)*p):(n=(e.max.x-_.x)*p,i=(e.min.x-_.x)*p),m>=0?(a=(e.min.y-_.y)*m,l=(e.max.y-_.y)*m):(a=(e.max.y-_.y)*m,l=(e.min.y-_.y)*m),n>l||a>i||((a>n||isNaN(n))&&(n=a),(l<i||isNaN(i))&&(i=l),v>=0?(u=(e.min.z-_.z)*v,f=(e.max.z-_.z)*v):(u=(e.max.z-_.z)*v,f=(e.min.z-_.z)*v),n>f||u>i)||((u>n||n!==n)&&(n=u),(f<i||i!==i)&&(i=f),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return this.intersectBox(e,ou)!==null}intersectTriangle(e,t,n,i,a){b1.subVectors(t,e),V0.subVectors(n,e),E1.crossVectors(b1,V0);let l=this.direction.dot(E1),u;if(l>0){if(i)return null;u=1}else if(l<0)u=-1,l=-l;else return null;rc.subVectors(this.origin,e);const f=u*this.direction.dot(V0.crossVectors(rc,V0));if(f<0)return null;const p=u*this.direction.dot(b1.cross(rc));if(p<0||f+p>l)return null;const m=-u*rc.dot(E1);return m<0?null:this.at(m/l,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Qt{constructor(e,t,n,i,a,l,u,f,p,m,v,_,x,b,R,T){Qt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,i,a,l,u,f,p,m,v,_,x,b,R,T)}set(e,t,n,i,a,l,u,f,p,m,v,_,x,b,R,T){const E=this.elements;return E[0]=e,E[4]=t,E[8]=n,E[12]=i,E[1]=a,E[5]=l,E[9]=u,E[13]=f,E[2]=p,E[6]=m,E[10]=v,E[14]=_,E[3]=x,E[7]=b,E[11]=R,E[15]=T,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Qt().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/ed.setFromMatrixColumn(e,0).length(),a=1/ed.setFromMatrixColumn(e,1).length(),l=1/ed.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=0,t[8]=n[8]*l,t[9]=n[9]*l,t[10]=n[10]*l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,a=e.z,l=Math.cos(n),u=Math.sin(n),f=Math.cos(i),p=Math.sin(i),m=Math.cos(a),v=Math.sin(a);if(e.order==="XYZ"){const _=l*m,x=l*v,b=u*m,R=u*v;t[0]=f*m,t[4]=-f*v,t[8]=p,t[1]=x+b*p,t[5]=_-R*p,t[9]=-u*f,t[2]=R-_*p,t[6]=b+x*p,t[10]=l*f}else if(e.order==="YXZ"){const _=f*m,x=f*v,b=p*m,R=p*v;t[0]=_+R*u,t[4]=b*u-x,t[8]=l*p,t[1]=l*v,t[5]=l*m,t[9]=-u,t[2]=x*u-b,t[6]=R+_*u,t[10]=l*f}else if(e.order==="ZXY"){const _=f*m,x=f*v,b=p*m,R=p*v;t[0]=_-R*u,t[4]=-l*v,t[8]=b+x*u,t[1]=x+b*u,t[5]=l*m,t[9]=R-_*u,t[2]=-l*p,t[6]=u,t[10]=l*f}else if(e.order==="ZYX"){const _=l*m,x=l*v,b=u*m,R=u*v;t[0]=f*m,t[4]=b*p-x,t[8]=_*p+R,t[1]=f*v,t[5]=R*p+_,t[9]=x*p-b,t[2]=-p,t[6]=u*f,t[10]=l*f}else if(e.order==="YZX"){const _=l*f,x=l*p,b=u*f,R=u*p;t[0]=f*m,t[4]=R-_*v,t[8]=b*v+x,t[1]=v,t[5]=l*m,t[9]=-u*m,t[2]=-p*m,t[6]=x*v+b,t[10]=_-R*v}else if(e.order==="XZY"){const _=l*f,x=l*p,b=u*f,R=u*p;t[0]=f*m,t[4]=-v,t[8]=p*m,t[1]=_*v+R,t[5]=l*m,t[9]=x*v-b,t[2]=b*v-x,t[6]=u*m,t[10]=R*v+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose($w,e,e3)}lookAt(e,t,n){const i=this.elements;return Ss.subVectors(e,t),Ss.lengthSq()===0&&(Ss.z=1),Ss.normalize(),sc.crossVectors(n,Ss),sc.lengthSq()===0&&(Math.abs(n.z)===1?Ss.x+=1e-4:Ss.z+=1e-4,Ss.normalize(),sc.crossVectors(n,Ss)),sc.normalize(),k0.crossVectors(Ss,sc),i[0]=sc.x,i[4]=k0.x,i[8]=Ss.x,i[1]=sc.y,i[5]=k0.y,i[9]=Ss.y,i[2]=sc.z,i[6]=k0.z,i[10]=Ss.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,a=this.elements,l=n[0],u=n[4],f=n[8],p=n[12],m=n[1],v=n[5],_=n[9],x=n[13],b=n[2],R=n[6],T=n[10],E=n[14],w=n[3],D=n[7],U=n[11],I=n[15],O=i[0],P=i[4],B=i[8],N=i[12],z=i[1],q=i[5],Y=i[9],Q=i[13],Z=i[2],ae=i[6],G=i[10],ee=i[14],ie=i[3],fe=i[7],ce=i[11],H=i[15];return a[0]=l*O+u*z+f*Z+p*ie,a[4]=l*P+u*q+f*ae+p*fe,a[8]=l*B+u*Y+f*G+p*ce,a[12]=l*N+u*Q+f*ee+p*H,a[1]=m*O+v*z+_*Z+x*ie,a[5]=m*P+v*q+_*ae+x*fe,a[9]=m*B+v*Y+_*G+x*ce,a[13]=m*N+v*Q+_*ee+x*H,a[2]=b*O+R*z+T*Z+E*ie,a[6]=b*P+R*q+T*ae+E*fe,a[10]=b*B+R*Y+T*G+E*ce,a[14]=b*N+R*Q+T*ee+E*H,a[3]=w*O+D*z+U*Z+I*ie,a[7]=w*P+D*q+U*ae+I*fe,a[11]=w*B+D*Y+U*G+I*ce,a[15]=w*N+D*Q+U*ee+I*H,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],a=e[12],l=e[1],u=e[5],f=e[9],p=e[13],m=e[2],v=e[6],_=e[10],x=e[14],b=e[3],R=e[7],T=e[11],E=e[15];return b*(+a*f*v-i*p*v-a*u*_+n*p*_+i*u*x-n*f*x)+R*(+t*f*x-t*p*_+a*l*_-i*l*x+i*p*m-a*f*m)+T*(+t*p*v-t*u*x-a*l*v+n*l*x+a*u*m-n*p*m)+E*(-i*u*m-t*f*v+t*u*_+i*l*v-n*l*_+n*f*m)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],a=e[3],l=e[4],u=e[5],f=e[6],p=e[7],m=e[8],v=e[9],_=e[10],x=e[11],b=e[12],R=e[13],T=e[14],E=e[15],w=v*T*p-R*_*p+R*f*x-u*T*x-v*f*E+u*_*E,D=b*_*p-m*T*p-b*f*x+l*T*x+m*f*E-l*_*E,U=m*R*p-b*v*p+b*u*x-l*R*x-m*u*E+l*v*E,I=b*v*f-m*R*f-b*u*_+l*R*_+m*u*T-l*v*T,O=t*w+n*D+i*U+a*I;if(O===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const P=1/O;return e[0]=w*P,e[1]=(R*_*a-v*T*a-R*i*x+n*T*x+v*i*E-n*_*E)*P,e[2]=(u*T*a-R*f*a+R*i*p-n*T*p-u*i*E+n*f*E)*P,e[3]=(v*f*a-u*_*a-v*i*p+n*_*p+u*i*x-n*f*x)*P,e[4]=D*P,e[5]=(m*T*a-b*_*a+b*i*x-t*T*x-m*i*E+t*_*E)*P,e[6]=(b*f*a-l*T*a-b*i*p+t*T*p+l*i*E-t*f*E)*P,e[7]=(l*_*a-m*f*a+m*i*p-t*_*p-l*i*x+t*f*x)*P,e[8]=U*P,e[9]=(b*v*a-m*R*a-b*n*x+t*R*x+m*n*E-t*v*E)*P,e[10]=(l*R*a-b*u*a+b*n*p-t*R*p-l*n*E+t*u*E)*P,e[11]=(m*u*a-l*v*a-m*n*p+t*v*p+l*n*x-t*u*x)*P,e[12]=I*P,e[13]=(m*R*i-b*v*i+b*n*_-t*R*_-m*n*T+t*v*T)*P,e[14]=(b*u*i-l*R*i-b*n*f+t*R*f+l*n*T-t*u*T)*P,e[15]=(l*v*i-m*u*i+m*n*f-t*v*f-l*n*_+t*u*_)*P,this}scale(e){const t=this.elements,n=e.x,i=e.y,a=e.z;return t[0]*=n,t[4]*=i,t[8]*=a,t[1]*=n,t[5]*=i,t[9]*=a,t[2]*=n,t[6]*=i,t[10]*=a,t[3]*=n,t[7]*=i,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),a=1-n,l=e.x,u=e.y,f=e.z,p=a*l,m=a*u;return this.set(p*l+n,p*u-i*f,p*f+i*u,0,p*u+i*f,m*u+n,m*f-i*l,0,p*f-i*u,m*f+i*l,a*f*f+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,a,l){return this.set(1,n,a,0,e,1,l,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,a=t._x,l=t._y,u=t._z,f=t._w,p=a+a,m=l+l,v=u+u,_=a*p,x=a*m,b=a*v,R=l*m,T=l*v,E=u*v,w=f*p,D=f*m,U=f*v,I=n.x,O=n.y,P=n.z;return i[0]=(1-(R+E))*I,i[1]=(x+U)*I,i[2]=(b-D)*I,i[3]=0,i[4]=(x-U)*O,i[5]=(1-(_+E))*O,i[6]=(T+w)*O,i[7]=0,i[8]=(b+D)*P,i[9]=(T-w)*P,i[10]=(1-(_+R))*P,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let a=ed.set(i[0],i[1],i[2]).length();const l=ed.set(i[4],i[5],i[6]).length(),u=ed.set(i[8],i[9],i[10]).length();this.determinant()<0&&(a=-a),e.x=i[12],e.y=i[13],e.z=i[14],Ao.copy(this);const p=1/a,m=1/l,v=1/u;return Ao.elements[0]*=p,Ao.elements[1]*=p,Ao.elements[2]*=p,Ao.elements[4]*=m,Ao.elements[5]*=m,Ao.elements[6]*=m,Ao.elements[8]*=v,Ao.elements[9]*=v,Ao.elements[10]*=v,t.setFromRotationMatrix(Ao),n.x=a,n.y=l,n.z=u,this}makePerspective(e,t,n,i,a,l,u=bs,f=!1){const p=this.elements,m=2*a/(t-e),v=2*a/(n-i),_=(t+e)/(t-e),x=(n+i)/(n-i);let b,R;if(f)b=a/(l-a),R=l*a/(l-a);else if(u===bs)b=-(l+a)/(l-a),R=-2*l*a/(l-a);else if(u===Id)b=-l/(l-a),R=-l*a/(l-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return p[0]=m,p[4]=0,p[8]=_,p[12]=0,p[1]=0,p[5]=v,p[9]=x,p[13]=0,p[2]=0,p[6]=0,p[10]=b,p[14]=R,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,n,i,a,l,u=bs,f=!1){const p=this.elements,m=2/(t-e),v=2/(n-i),_=-(t+e)/(t-e),x=-(n+i)/(n-i);let b,R;if(f)b=1/(l-a),R=l/(l-a);else if(u===bs)b=-2/(l-a),R=-(l+a)/(l-a);else if(u===Id)b=-1/(l-a),R=-a/(l-a);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return p[0]=m,p[4]=0,p[8]=0,p[12]=_,p[1]=0,p[5]=v,p[9]=0,p[13]=x,p[2]=0,p[6]=0,p[10]=b,p[14]=R,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const ed=new ne,Ao=new Qt,$w=new ne(0,0,0),e3=new ne(1,1,1),sc=new ne,k0=new ne,Ss=new ne,zb=new Qt,Ib=new ua;class ns{constructor(e=0,t=0,n=0,i=ns.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,a=i[0],l=i[4],u=i[8],f=i[1],p=i[5],m=i[9],v=i[2],_=i[6],x=i[10];switch(t){case"XYZ":this._y=Math.asin(rn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-m,x),this._z=Math.atan2(-l,a)):(this._x=Math.atan2(_,p),this._z=0);break;case"YXZ":this._x=Math.asin(-rn(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(u,x),this._z=Math.atan2(f,p)):(this._y=Math.atan2(-v,a),this._z=0);break;case"ZXY":this._x=Math.asin(rn(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-v,x),this._z=Math.atan2(-l,p)):(this._y=0,this._z=Math.atan2(f,a));break;case"ZYX":this._y=Math.asin(-rn(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(_,x),this._z=Math.atan2(f,a)):(this._x=0,this._z=Math.atan2(-l,p));break;case"YZX":this._z=Math.asin(rn(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-m,p),this._y=Math.atan2(-v,a)):(this._x=0,this._y=Math.atan2(u,x));break;case"XZY":this._z=Math.asin(-rn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(_,p),this._y=Math.atan2(u,a)):(this._x=Math.atan2(-m,x),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return zb.makeRotationFromQuaternion(e),this.setFromRotationMatrix(zb,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Ib.setFromEuler(this),this.setFromQuaternion(Ib,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ns.DEFAULT_ORDER="XYZ";class Fd{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let t3=0;const Bb=new ne,td=new ua,lu=new Qt,X0=new ne,Sm=new ne,n3=new ne,i3=new ua,Pb=new ne(1,0,0),Fb=new ne(0,1,0),Hb=new ne(0,0,1),Gb={type:"added"},a3={type:"removed"},nd={type:"childadded",child:null},T1={type:"childremoved",child:null};class Xn extends bl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:t3++}),this.uuid=Es(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Xn.DEFAULT_UP.clone();const e=new ne,t=new ns,n=new ua,i=new ne(1,1,1);function a(){n.setFromEuler(t,!1)}function l(){t.setFromQuaternion(n,void 0,!1)}t._onChange(a),n._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Qt},normalMatrix:{value:new dn}}),this.matrix=new Qt,this.matrixWorld=new Qt,this.matrixAutoUpdate=Xn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Xn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Fd,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return td.setFromAxisAngle(e,t),this.quaternion.multiply(td),this}rotateOnWorldAxis(e,t){return td.setFromAxisAngle(e,t),this.quaternion.premultiply(td),this}rotateX(e){return this.rotateOnAxis(Pb,e)}rotateY(e){return this.rotateOnAxis(Fb,e)}rotateZ(e){return this.rotateOnAxis(Hb,e)}translateOnAxis(e,t){return Bb.copy(e).applyQuaternion(this.quaternion),this.position.add(Bb.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Pb,e)}translateY(e){return this.translateOnAxis(Fb,e)}translateZ(e){return this.translateOnAxis(Hb,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(lu.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?X0.copy(e):X0.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Sm.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?lu.lookAt(Sm,X0,this.up):lu.lookAt(X0,Sm,this.up),this.quaternion.setFromRotationMatrix(lu),i&&(lu.extractRotation(i.matrixWorld),td.setFromRotationMatrix(lu),this.quaternion.premultiply(td.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Gb),nd.child=e,this.dispatchEvent(nd),nd.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(a3),T1.child=e,this.dispatchEvent(T1),T1.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),lu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),lu.multiply(e.parent.matrixWorld)),e.applyMatrix4(lu),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Gb),nd.child=e,this.dispatchEvent(nd),nd.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const l=this.children[n].getObjectByProperty(e,t);if(l!==void 0)return l}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const i=this.children;for(let a=0,l=i.length;a<l;a++)i[a].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sm,e,n3),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sm,i3,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const i=this.children;for(let a=0,l=i.length;a<l;a++)i[a].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(u=>({...u,boundingBox:u.boundingBox?u.boundingBox.toJSON():void 0,boundingSphere:u.boundingSphere?u.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(u=>({...u})),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(i.boundingBox=this.boundingBox.toJSON()));function a(u,f){return u[f.uuid]===void 0&&(u[f.uuid]=f.toJSON(e)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=a(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const f=u.shapes;if(Array.isArray(f))for(let p=0,m=f.length;p<m;p++){const v=f[p];a(e.shapes,v)}else a(e.shapes,f)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let f=0,p=this.material.length;f<p;f++)u.push(a(e.materials,this.material[f]));i.material=u}else i.material=a(e.materials,this.material);if(this.children.length>0){i.children=[];for(let u=0;u<this.children.length;u++)i.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let u=0;u<this.animations.length;u++){const f=this.animations[u];i.animations.push(a(e.animations,f))}}if(t){const u=l(e.geometries),f=l(e.materials),p=l(e.textures),m=l(e.images),v=l(e.shapes),_=l(e.skeletons),x=l(e.animations),b=l(e.nodes);u.length>0&&(n.geometries=u),f.length>0&&(n.materials=f),p.length>0&&(n.textures=p),m.length>0&&(n.images=m),v.length>0&&(n.shapes=v),_.length>0&&(n.skeletons=_),x.length>0&&(n.animations=x),b.length>0&&(n.nodes=b)}return n.object=i,n;function l(u){const f=[];for(const p in u){const m=u[p];delete m.metadata,f.push(m)}return f}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}Xn.DEFAULT_UP=new ne(0,1,0);Xn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Xn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ro=new ne,uu=new ne,A1=new ne,cu=new ne,id=new ne,ad=new ne,Vb=new ne,R1=new ne,C1=new ne,w1=new ne,U1=new kn,D1=new kn,N1=new kn;class ts{constructor(e=new ne,t=new ne,n=new ne){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),Ro.subVectors(e,t),i.cross(Ro);const a=i.lengthSq();return a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}static getBarycoord(e,t,n,i,a){Ro.subVectors(i,t),uu.subVectors(n,t),A1.subVectors(e,t);const l=Ro.dot(Ro),u=Ro.dot(uu),f=Ro.dot(A1),p=uu.dot(uu),m=uu.dot(A1),v=l*p-u*u;if(v===0)return a.set(0,0,0),null;const _=1/v,x=(p*f-u*m)*_,b=(l*m-u*f)*_;return a.set(1-x-b,b,x)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,cu)===null?!1:cu.x>=0&&cu.y>=0&&cu.x+cu.y<=1}static getInterpolation(e,t,n,i,a,l,u,f){return this.getBarycoord(e,t,n,i,cu)===null?(f.x=0,f.y=0,"z"in f&&(f.z=0),"w"in f&&(f.w=0),null):(f.setScalar(0),f.addScaledVector(a,cu.x),f.addScaledVector(l,cu.y),f.addScaledVector(u,cu.z),f)}static getInterpolatedAttribute(e,t,n,i,a,l){return U1.setScalar(0),D1.setScalar(0),N1.setScalar(0),U1.fromBufferAttribute(e,t),D1.fromBufferAttribute(e,n),N1.fromBufferAttribute(e,i),l.setScalar(0),l.addScaledVector(U1,a.x),l.addScaledVector(D1,a.y),l.addScaledVector(N1,a.z),l}static isFrontFacing(e,t,n,i){return Ro.subVectors(n,t),uu.subVectors(e,t),Ro.cross(uu).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ro.subVectors(this.c,this.b),uu.subVectors(this.a,this.b),Ro.cross(uu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ts.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ts.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,a){return ts.getInterpolation(e,this.a,this.b,this.c,t,n,i,a)}containsPoint(e){return ts.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ts.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,a=this.c;let l,u;id.subVectors(i,n),ad.subVectors(a,n),R1.subVectors(e,n);const f=id.dot(R1),p=ad.dot(R1);if(f<=0&&p<=0)return t.copy(n);C1.subVectors(e,i);const m=id.dot(C1),v=ad.dot(C1);if(m>=0&&v<=m)return t.copy(i);const _=f*v-m*p;if(_<=0&&f>=0&&m<=0)return l=f/(f-m),t.copy(n).addScaledVector(id,l);w1.subVectors(e,a);const x=id.dot(w1),b=ad.dot(w1);if(b>=0&&x<=b)return t.copy(a);const R=x*p-f*b;if(R<=0&&p>=0&&b<=0)return u=p/(p-b),t.copy(n).addScaledVector(ad,u);const T=m*b-x*v;if(T<=0&&v-m>=0&&x-b>=0)return Vb.subVectors(a,i),u=(v-m)/(v-m+(x-b)),t.copy(i).addScaledVector(Vb,u);const E=1/(T+R+_);return l=R*E,u=_*E,t.copy(n).addScaledVector(id,l).addScaledVector(ad,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const ZA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},oc={h:0,s:0,l:0},Y0={h:0,s:0,l:0};function O1(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*6*(2/3-t):s}class Nt{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=zi){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,On.colorSpaceToWorking(this,t),this}setRGB(e,t,n,i=On.workingColorSpace){return this.r=e,this.g=t,this.b=n,On.colorSpaceToWorking(this,i),this}setHSL(e,t,n,i=On.workingColorSpace){if(e=ES(e,1),t=rn(t,0,1),n=rn(n,0,1),t===0)this.r=this.g=this.b=n;else{const a=n<=.5?n*(1+t):n+t-n*t,l=2*n-a;this.r=O1(l,a,e+1/3),this.g=O1(l,a,e),this.b=O1(l,a,e-1/3)}return On.colorSpaceToWorking(this,i),this}setStyle(e,t=zi){function n(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const l=i[1],u=i[2];switch(l){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return n(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=i[1],l=a.length;if(l===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(l===6)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=zi){const n=ZA[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=vu(e.r),this.g=vu(e.g),this.b=vu(e.b),this}copyLinearToSRGB(e){return this.r=Td(e.r),this.g=Td(e.g),this.b=Td(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=zi){return On.workingToColorSpace(or.copy(this),e),Math.round(rn(or.r*255,0,255))*65536+Math.round(rn(or.g*255,0,255))*256+Math.round(rn(or.b*255,0,255))}getHexString(e=zi){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=On.workingColorSpace){On.workingToColorSpace(or.copy(this),t);const n=or.r,i=or.g,a=or.b,l=Math.max(n,i,a),u=Math.min(n,i,a);let f,p;const m=(u+l)/2;if(u===l)f=0,p=0;else{const v=l-u;switch(p=m<=.5?v/(l+u):v/(2-l-u),l){case n:f=(i-a)/v+(i<a?6:0);break;case i:f=(a-n)/v+2;break;case a:f=(n-i)/v+4;break}f/=6}return e.h=f,e.s=p,e.l=m,e}getRGB(e,t=On.workingColorSpace){return On.workingToColorSpace(or.copy(this),t),e.r=or.r,e.g=or.g,e.b=or.b,e}getStyle(e=zi){On.workingToColorSpace(or.copy(this),e);const t=or.r,n=or.g,i=or.b;return e!==zi?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(i*255)})`}offsetHSL(e,t,n){return this.getHSL(oc),this.setHSL(oc.h+e,oc.s+t,oc.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(oc),e.getHSL(Y0);const n=Xm(oc.h,Y0.h,t),i=Xm(oc.s,Y0.s,t),a=Xm(oc.l,Y0.l,t);return this.setHSL(n,i,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,a=e.elements;return this.r=a[0]*t+a[3]*n+a[6]*i,this.g=a[1]*t+a[4]*n+a[7]*i,this.b=a[2]*t+a[5]*n+a[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const or=new Nt;Nt.NAMES=ZA;let r3=0;class ba extends bl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:r3++}),this.uuid=Es(),this.name="",this.type="Material",this.blending=Bf,this.side=xl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Yv,this.blendDst=qv,this.blendEquation=hc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Nt(0,0,0),this.blendAlpha=0,this.depthFunc=Gf,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Vx,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Cf,this.stencilZFail=Cf,this.stencilZPass=Cf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Bf&&(n.blending=this.blending),this.side!==xl&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==Yv&&(n.blendSrc=this.blendSrc),this.blendDst!==qv&&(n.blendDst=this.blendDst),this.blendEquation!==hc&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Gf&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Vx&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Cf&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Cf&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Cf&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(a){const l=[];for(const u in a){const f=a[u];delete f.metadata,l.push(f)}return l}if(t){const a=i(e.textures),l=i(e.images);a.length>0&&(n.textures=a),l.length>0&&(n.images=l)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let a=0;a!==i;++a)n[a]=t[a].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class zr extends ba{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Nt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ns,this.combine=fg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const mu=s3();function s3(){const s=new ArrayBuffer(4),e=new Float32Array(s),t=new Uint32Array(s),n=new Uint32Array(512),i=new Uint32Array(512);for(let f=0;f<256;++f){const p=f-127;p<-27?(n[f]=0,n[f|256]=32768,i[f]=24,i[f|256]=24):p<-14?(n[f]=1024>>-p-14,n[f|256]=1024>>-p-14|32768,i[f]=-p-1,i[f|256]=-p-1):p<=15?(n[f]=p+15<<10,n[f|256]=p+15<<10|32768,i[f]=13,i[f|256]=13):p<128?(n[f]=31744,n[f|256]=64512,i[f]=24,i[f|256]=24):(n[f]=31744,n[f|256]=64512,i[f]=13,i[f|256]=13)}const a=new Uint32Array(2048),l=new Uint32Array(64),u=new Uint32Array(64);for(let f=1;f<1024;++f){let p=f<<13,m=0;for(;(p&8388608)===0;)p<<=1,m-=8388608;p&=-8388609,m+=947912704,a[f]=p|m}for(let f=1024;f<2048;++f)a[f]=939524096+(f-1024<<13);for(let f=1;f<31;++f)l[f]=f<<23;l[31]=1199570944,l[32]=2147483648;for(let f=33;f<63;++f)l[f]=2147483648+(f-32<<23);l[63]=3347054592;for(let f=1;f<64;++f)f!==32&&(u[f]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:i,mantissaTable:a,exponentTable:l,offsetTable:u}}function es(s){Math.abs(s)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),s=rn(s,-65504,65504),mu.floatView[0]=s;const e=mu.uint32View[0],t=e>>23&511;return mu.baseTable[t]+((e&8388607)>>mu.shiftTable[t])}function zm(s){const e=s>>10;return mu.uint32View[0]=mu.mantissaTable[mu.offsetTable[e]+(s&1023)]+mu.exponentTable[e],mu.floatView[0]}class Lf{static toHalfFloat(e){return es(e)}static fromHalfFloat(e){return zm(e)}}const la=new ne,q0=new ht;let o3=0;class ii{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:o3++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=eg,this.updateRanges=[],this.gpuType=Vi,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)q0.fromBufferAttribute(this,t),q0.applyMatrix3(e),this.setXY(t,q0.x,q0.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)la.fromBufferAttribute(this,t),la.applyMatrix3(e),this.setXYZ(t,la.x,la.y,la.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)la.fromBufferAttribute(this,t),la.applyMatrix4(e),this.setXYZ(t,la.x,la.y,la.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)la.fromBufferAttribute(this,t),la.applyNormalMatrix(e),this.setXYZ(t,la.x,la.y,la.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)la.fromBufferAttribute(this,t),la.transformDirection(e),this.setXYZ(t,la.x,la.y,la.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Lr(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Sn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Lr(t,this.array)),t}setX(e,t){return this.normalized&&(t=Sn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Lr(t,this.array)),t}setY(e,t){return this.normalized&&(t=Sn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Lr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Sn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Lr(t,this.array)),t}setW(e,t){return this.normalized&&(t=Sn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Sn(t,this.array),n=Sn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=Sn(t,this.array),n=Sn(n,this.array),i=Sn(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,a){return e*=this.itemSize,this.normalized&&(t=Sn(t,this.array),n=Sn(n,this.array),i=Sn(i,this.array),a=Sn(a,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==eg&&(e.usage=this.usage),e}}class l3 extends ii{constructor(e,t,n){super(new Int8Array(e),t,n)}}class u3 extends ii{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class c3 extends ii{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class f3 extends ii{constructor(e,t,n){super(new Int16Array(e),t,n)}}class AS extends ii{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class h3 extends ii{constructor(e,t,n){super(new Int32Array(e),t,n)}}class RS extends ii{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class d3 extends ii{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=zm(this.array[e*this.itemSize]);return this.normalized&&(t=Lr(t,this.array)),t}setX(e,t){return this.normalized&&(t=Sn(t,this.array)),this.array[e*this.itemSize]=es(t),this}getY(e){let t=zm(this.array[e*this.itemSize+1]);return this.normalized&&(t=Lr(t,this.array)),t}setY(e,t){return this.normalized&&(t=Sn(t,this.array)),this.array[e*this.itemSize+1]=es(t),this}getZ(e){let t=zm(this.array[e*this.itemSize+2]);return this.normalized&&(t=Lr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Sn(t,this.array)),this.array[e*this.itemSize+2]=es(t),this}getW(e){let t=zm(this.array[e*this.itemSize+3]);return this.normalized&&(t=Lr(t,this.array)),t}setW(e,t){return this.normalized&&(t=Sn(t,this.array)),this.array[e*this.itemSize+3]=es(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Sn(t,this.array),n=Sn(n,this.array)),this.array[e+0]=es(t),this.array[e+1]=es(n),this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=Sn(t,this.array),n=Sn(n,this.array),i=Sn(i,this.array)),this.array[e+0]=es(t),this.array[e+1]=es(n),this.array[e+2]=es(i),this}setXYZW(e,t,n,i,a){return e*=this.itemSize,this.normalized&&(t=Sn(t,this.array),n=Sn(n,this.array),i=Sn(i,this.array),a=Sn(a,this.array)),this.array[e+0]=es(t),this.array[e+1]=es(n),this.array[e+2]=es(i),this.array[e+3]=es(a),this}}class Vt extends ii{constructor(e,t,n){super(new Float32Array(e),t,n)}}let p3=0;const qs=new Qt,L1=new Xn,rd=new ne,Ms=new ca,Mm=new ca,za=new ne;class vn extends bl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:p3++}),this.uuid=Es(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(qA(e)?RS:AS)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const a=new dn().getNormalMatrix(e);n.applyNormalMatrix(a),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return qs.makeRotationFromQuaternion(e),this.applyMatrix4(qs),this}rotateX(e){return qs.makeRotationX(e),this.applyMatrix4(qs),this}rotateY(e){return qs.makeRotationY(e),this.applyMatrix4(qs),this}rotateZ(e){return qs.makeRotationZ(e),this.applyMatrix4(qs),this}translate(e,t,n){return qs.makeTranslation(e,t,n),this.applyMatrix4(qs),this}scale(e,t,n){return qs.makeScale(e,t,n),this.applyMatrix4(qs),this}lookAt(e){return L1.lookAt(e),L1.updateMatrix(),this.applyMatrix4(L1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(rd).negate(),this.translate(rd.x,rd.y,rd.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let i=0,a=e.length;i<a;i++){const l=e[i];n.push(l.x,l.y,l.z||0)}this.setAttribute("position",new Vt(n,3))}else{const n=Math.min(e.length,t.count);for(let i=0;i<n;i++){const a=e[i];t.setXYZ(i,a.x,a.y,a.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ca);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ne(-1/0,-1/0,-1/0),new ne(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const a=t[n];Ms.setFromBufferAttribute(a),this.morphTargetsRelative?(za.addVectors(this.boundingBox.min,Ms.min),this.boundingBox.expandByPoint(za),za.addVectors(this.boundingBox.max,Ms.max),this.boundingBox.expandByPoint(za)):(this.boundingBox.expandByPoint(Ms.min),this.boundingBox.expandByPoint(Ms.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ma);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ne,1/0);return}if(e){const n=this.boundingSphere.center;if(Ms.setFromBufferAttribute(e),t)for(let a=0,l=t.length;a<l;a++){const u=t[a];Mm.setFromBufferAttribute(u),this.morphTargetsRelative?(za.addVectors(Ms.min,Mm.min),Ms.expandByPoint(za),za.addVectors(Ms.max,Mm.max),Ms.expandByPoint(za)):(Ms.expandByPoint(Mm.min),Ms.expandByPoint(Mm.max))}Ms.getCenter(n);let i=0;for(let a=0,l=e.count;a<l;a++)za.fromBufferAttribute(e,a),i=Math.max(i,n.distanceToSquared(za));if(t)for(let a=0,l=t.length;a<l;a++){const u=t[a],f=this.morphTargetsRelative;for(let p=0,m=u.count;p<m;p++)za.fromBufferAttribute(u,p),f&&(rd.fromBufferAttribute(e,p),za.add(rd)),i=Math.max(i,n.distanceToSquared(za))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,i=t.normal,a=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ii(new Float32Array(4*n.count),4));const l=this.getAttribute("tangent"),u=[],f=[];for(let B=0;B<n.count;B++)u[B]=new ne,f[B]=new ne;const p=new ne,m=new ne,v=new ne,_=new ht,x=new ht,b=new ht,R=new ne,T=new ne;function E(B,N,z){p.fromBufferAttribute(n,B),m.fromBufferAttribute(n,N),v.fromBufferAttribute(n,z),_.fromBufferAttribute(a,B),x.fromBufferAttribute(a,N),b.fromBufferAttribute(a,z),m.sub(p),v.sub(p),x.sub(_),b.sub(_);const q=1/(x.x*b.y-b.x*x.y);isFinite(q)&&(R.copy(m).multiplyScalar(b.y).addScaledVector(v,-x.y).multiplyScalar(q),T.copy(v).multiplyScalar(x.x).addScaledVector(m,-b.x).multiplyScalar(q),u[B].add(R),u[N].add(R),u[z].add(R),f[B].add(T),f[N].add(T),f[z].add(T))}let w=this.groups;w.length===0&&(w=[{start:0,count:e.count}]);for(let B=0,N=w.length;B<N;++B){const z=w[B],q=z.start,Y=z.count;for(let Q=q,Z=q+Y;Q<Z;Q+=3)E(e.getX(Q+0),e.getX(Q+1),e.getX(Q+2))}const D=new ne,U=new ne,I=new ne,O=new ne;function P(B){I.fromBufferAttribute(i,B),O.copy(I);const N=u[B];D.copy(N),D.sub(I.multiplyScalar(I.dot(N))).normalize(),U.crossVectors(O,N);const q=U.dot(f[B])<0?-1:1;l.setXYZW(B,D.x,D.y,D.z,q)}for(let B=0,N=w.length;B<N;++B){const z=w[B],q=z.start,Y=z.count;for(let Q=q,Z=q+Y;Q<Z;Q+=3)P(e.getX(Q+0)),P(e.getX(Q+1)),P(e.getX(Q+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new ii(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let _=0,x=n.count;_<x;_++)n.setXYZ(_,0,0,0);const i=new ne,a=new ne,l=new ne,u=new ne,f=new ne,p=new ne,m=new ne,v=new ne;if(e)for(let _=0,x=e.count;_<x;_+=3){const b=e.getX(_+0),R=e.getX(_+1),T=e.getX(_+2);i.fromBufferAttribute(t,b),a.fromBufferAttribute(t,R),l.fromBufferAttribute(t,T),m.subVectors(l,a),v.subVectors(i,a),m.cross(v),u.fromBufferAttribute(n,b),f.fromBufferAttribute(n,R),p.fromBufferAttribute(n,T),u.add(m),f.add(m),p.add(m),n.setXYZ(b,u.x,u.y,u.z),n.setXYZ(R,f.x,f.y,f.z),n.setXYZ(T,p.x,p.y,p.z)}else for(let _=0,x=t.count;_<x;_+=3)i.fromBufferAttribute(t,_+0),a.fromBufferAttribute(t,_+1),l.fromBufferAttribute(t,_+2),m.subVectors(l,a),v.subVectors(i,a),m.cross(v),n.setXYZ(_+0,m.x,m.y,m.z),n.setXYZ(_+1,m.x,m.y,m.z),n.setXYZ(_+2,m.x,m.y,m.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)za.fromBufferAttribute(e,t),za.normalize(),e.setXYZ(t,za.x,za.y,za.z)}toNonIndexed(){function e(u,f){const p=u.array,m=u.itemSize,v=u.normalized,_=new p.constructor(f.length*m);let x=0,b=0;for(let R=0,T=f.length;R<T;R++){u.isInterleavedBufferAttribute?x=f[R]*u.data.stride+u.offset:x=f[R]*m;for(let E=0;E<m;E++)_[b++]=p[x++]}return new ii(_,m,v)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new vn,n=this.index.array,i=this.attributes;for(const u in i){const f=i[u],p=e(f,n);t.setAttribute(u,p)}const a=this.morphAttributes;for(const u in a){const f=[],p=a[u];for(let m=0,v=p.length;m<v;m++){const _=p[m],x=e(_,n);f.push(x)}t.morphAttributes[u]=f}t.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let u=0,f=l.length;u<f;u++){const p=l[u];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const p in f)f[p]!==void 0&&(e[p]=f[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const f in n){const p=n[f];e.data.attributes[f]=p.toJSON(e.data)}const i={};let a=!1;for(const f in this.morphAttributes){const p=this.morphAttributes[f],m=[];for(let v=0,_=p.length;v<_;v++){const x=p[v];m.push(x.toJSON(e.data))}m.length>0&&(i[f]=m,a=!0)}a&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere=u.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const i=e.attributes;for(const p in i){const m=i[p];this.setAttribute(p,m.clone(t))}const a=e.morphAttributes;for(const p in a){const m=[],v=a[p];for(let _=0,x=v.length;_<x;_++)m.push(v[_].clone(t));this.morphAttributes[p]=m}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let p=0,m=l.length;p<m;p++){const v=l[p];this.addGroup(v.start,v.count,v.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const f=e.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const kb=new Qt,ff=new jf,W0=new Ma,Xb=new ne,j0=new ne,Z0=new ne,K0=new ne,z1=new ne,Q0=new ne,Yb=new ne,J0=new ne;class Si extends Xn{constructor(e=new vn,t=new zr){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=i.length;a<l;a++){const u=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,a=n.morphAttributes.position,l=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const u=this.morphTargetInfluences;if(a&&u){Q0.set(0,0,0);for(let f=0,p=a.length;f<p;f++){const m=u[f],v=a[f];m!==0&&(z1.fromBufferAttribute(v,e),l?Q0.addScaledVector(z1,m):Q0.addScaledVector(z1.sub(t),m))}t.add(Q0)}return t}raycast(e,t){const n=this.geometry,i=this.material,a=this.matrixWorld;i!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),W0.copy(n.boundingSphere),W0.applyMatrix4(a),ff.copy(e.ray).recast(e.near),!(W0.containsPoint(ff.origin)===!1&&(ff.intersectSphere(W0,Xb)===null||ff.origin.distanceToSquared(Xb)>(e.far-e.near)**2))&&(kb.copy(a).invert(),ff.copy(e.ray).applyMatrix4(kb),!(n.boundingBox!==null&&ff.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,ff)))}_computeIntersections(e,t,n){let i;const a=this.geometry,l=this.material,u=a.index,f=a.attributes.position,p=a.attributes.uv,m=a.attributes.uv1,v=a.attributes.normal,_=a.groups,x=a.drawRange;if(u!==null)if(Array.isArray(l))for(let b=0,R=_.length;b<R;b++){const T=_[b],E=l[T.materialIndex],w=Math.max(T.start,x.start),D=Math.min(u.count,Math.min(T.start+T.count,x.start+x.count));for(let U=w,I=D;U<I;U+=3){const O=u.getX(U),P=u.getX(U+1),B=u.getX(U+2);i=$0(this,E,e,n,p,m,v,O,P,B),i&&(i.faceIndex=Math.floor(U/3),i.face.materialIndex=T.materialIndex,t.push(i))}}else{const b=Math.max(0,x.start),R=Math.min(u.count,x.start+x.count);for(let T=b,E=R;T<E;T+=3){const w=u.getX(T),D=u.getX(T+1),U=u.getX(T+2);i=$0(this,l,e,n,p,m,v,w,D,U),i&&(i.faceIndex=Math.floor(T/3),t.push(i))}}else if(f!==void 0)if(Array.isArray(l))for(let b=0,R=_.length;b<R;b++){const T=_[b],E=l[T.materialIndex],w=Math.max(T.start,x.start),D=Math.min(f.count,Math.min(T.start+T.count,x.start+x.count));for(let U=w,I=D;U<I;U+=3){const O=U,P=U+1,B=U+2;i=$0(this,E,e,n,p,m,v,O,P,B),i&&(i.faceIndex=Math.floor(U/3),i.face.materialIndex=T.materialIndex,t.push(i))}}else{const b=Math.max(0,x.start),R=Math.min(f.count,x.start+x.count);for(let T=b,E=R;T<E;T+=3){const w=T,D=T+1,U=T+2;i=$0(this,l,e,n,p,m,v,w,D,U),i&&(i.faceIndex=Math.floor(T/3),t.push(i))}}}}function m3(s,e,t,n,i,a,l,u){let f;if(e.side===Ir?f=n.intersectTriangle(l,a,i,!0,u):f=n.intersectTriangle(i,a,l,e.side===xl,u),f===null)return null;J0.copy(u),J0.applyMatrix4(s.matrixWorld);const p=t.ray.origin.distanceTo(J0);return p<t.near||p>t.far?null:{distance:p,point:J0.clone(),object:s}}function $0(s,e,t,n,i,a,l,u,f,p){s.getVertexPosition(u,j0),s.getVertexPosition(f,Z0),s.getVertexPosition(p,K0);const m=m3(s,e,t,n,j0,Z0,K0,Yb);if(m){const v=new ne;ts.getBarycoord(Yb,j0,Z0,K0,v),i&&(m.uv=ts.getInterpolatedAttribute(i,u,f,p,v,new ht)),a&&(m.uv1=ts.getInterpolatedAttribute(a,u,f,p,v,new ht)),l&&(m.normal=ts.getInterpolatedAttribute(l,u,f,p,v,new ne),m.normal.dot(n.direction)>0&&m.normal.multiplyScalar(-1));const _={a:u,b:f,c:p,normal:new ne,materialIndex:0};ts.getNormal(j0,Z0,K0,_.normal),m.face=_,m.barycoord=v}return m}class Zf extends vn{constructor(e=1,t=1,n=1,i=1,a=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:a,depthSegments:l};const u=this;i=Math.floor(i),a=Math.floor(a),l=Math.floor(l);const f=[],p=[],m=[],v=[];let _=0,x=0;b("z","y","x",-1,-1,n,t,e,l,a,0),b("z","y","x",1,-1,n,t,-e,l,a,1),b("x","z","y",1,1,e,n,t,i,l,2),b("x","z","y",1,-1,e,n,-t,i,l,3),b("x","y","z",1,-1,e,t,n,i,a,4),b("x","y","z",-1,-1,e,t,-n,i,a,5),this.setIndex(f),this.setAttribute("position",new Vt(p,3)),this.setAttribute("normal",new Vt(m,3)),this.setAttribute("uv",new Vt(v,2));function b(R,T,E,w,D,U,I,O,P,B,N){const z=U/P,q=I/B,Y=U/2,Q=I/2,Z=O/2,ae=P+1,G=B+1;let ee=0,ie=0;const fe=new ne;for(let ce=0;ce<G;ce++){const H=ce*q-Q;for(let W=0;W<ae;W++){const re=W*z-Y;fe[R]=re*w,fe[T]=H*D,fe[E]=Z,p.push(fe.x,fe.y,fe.z),fe[R]=0,fe[T]=0,fe[E]=O>0?1:-1,m.push(fe.x,fe.y,fe.z),v.push(W/P),v.push(1-ce/B),ee+=1}}for(let ce=0;ce<B;ce++)for(let H=0;H<P;H++){const W=_+H+ae*ce,re=_+H+ae*(ce+1),de=_+(H+1)+ae*(ce+1),ge=_+(H+1)+ae*ce;f.push(W,re,ge),f.push(re,de,ge),ie+=6}u.addGroup(x,ie,N),x+=ie,_+=ee}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zf(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Hd(s){const e={};for(const t in s){e[t]={};for(const n in s[t]){const i=s[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function Nr(s){const e={};for(let t=0;t<s.length;t++){const n=Hd(s[t]);for(const i in n)e[i]=n[i]}return e}function g3(s){const e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}function KA(s){const e=s.getRenderTarget();return e===null?s.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:On.workingColorSpace}const CS={clone:Hd,merge:Nr};var v3=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,y3=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Fr extends ba{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=v3,this.fragmentShader=y3,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Hd(e.uniforms),this.uniformsGroups=g3(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const l=this.uniforms[i].value;l&&l.isTexture?t.uniforms[i]={type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?t.uniforms[i]={type:"c",value:l.getHex()}:l&&l.isVector2?t.uniforms[i]={type:"v2",value:l.toArray()}:l&&l.isVector3?t.uniforms[i]={type:"v3",value:l.toArray()}:l&&l.isVector4?t.uniforms[i]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?t.uniforms[i]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?t.uniforms[i]={type:"m4",value:l.toArray()}:t.uniforms[i]={value:l}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Qy extends Xn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Qt,this.projectionMatrix=new Qt,this.projectionMatrixInverse=new Qt,this.coordinateSystem=bs,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const lc=new ne,qb=new ht,Wb=new ht;class Zi extends Qy{constructor(e=50,t=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Bd*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Pf*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Bd*2*Math.atan(Math.tan(Pf*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){lc.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(lc.x,lc.y).multiplyScalar(-e/lc.z),lc.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(lc.x,lc.y).multiplyScalar(-e/lc.z)}getViewSize(e,t){return this.getViewBounds(e,qb,Wb),t.subVectors(Wb,qb)}setViewOffset(e,t,n,i,a,l){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=a,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Pf*.5*this.fov)/this.zoom,n=2*t,i=this.aspect*n,a=-.5*i;const l=this.view;if(this.view!==null&&this.view.enabled){const f=l.fullWidth,p=l.fullHeight;a+=l.offsetX*i/f,t-=l.offsetY*n/p,i*=l.width/f,n*=l.height/p}const u=this.filmOffset;u!==0&&(a+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const sd=-90,od=1;class QA extends Xn{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Zi(sd,od,e,t);i.layers=this.layers,this.add(i);const a=new Zi(sd,od,e,t);a.layers=this.layers,this.add(a);const l=new Zi(sd,od,e,t);l.layers=this.layers,this.add(l);const u=new Zi(sd,od,e,t);u.layers=this.layers,this.add(u);const f=new Zi(sd,od,e,t);f.layers=this.layers,this.add(f);const p=new Zi(sd,od,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,a,l,u,f]=t;for(const p of t)this.remove(p);if(e===bs)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),l.up.set(0,0,1),l.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),f.up.set(0,1,0),f.lookAt(0,0,-1);else if(e===Id)n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),l.up.set(0,0,-1),l.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),f.up.set(0,-1,0),f.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[a,l,u,f,p,m]=this.children,v=e.getRenderTarget(),_=e.getActiveCubeFace(),x=e.getActiveMipmapLevel(),b=e.xr.enabled;e.xr.enabled=!1;const R=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,a),e.setRenderTarget(n,1,i),e.render(t,l),e.setRenderTarget(n,2,i),e.render(t,u),e.setRenderTarget(n,3,i),e.render(t,f),e.setRenderTarget(n,4,i),e.render(t,p),n.texture.generateMipmaps=R,e.setRenderTarget(n,5,i),e.render(t,m),e.setRenderTarget(v,_,x),e.xr.enabled=b,n.texture.needsPMREMUpdate=!0}}class mg extends Zn{constructor(e=[],t=Sl,n,i,a,l,u,f,p,m){super(e,t,n,i,a,l,u,f,p,m),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class wS extends Ks{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new mg(i),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Zf(5,5,5),a=new Fr({name:"CubemapFromEquirect",uniforms:Hd(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Ir,blending:vl});a.uniforms.tEquirect.value=t;const l=new Si(i,a),u=t.minFilter;return t.minFilter===Zs&&(t.minFilter=Wn),new QA(1,10,this).update(e,l),t.minFilter=u,l.geometry.dispose(),l.material.dispose(),this}clear(e,t=!0,n=!0,i=!0){const a=e.getRenderTarget();for(let l=0;l<6;l++)e.setRenderTarget(this,l),e.clear(t,n,i);e.setRenderTarget(a)}}class gu extends Xn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _3={type:"move"};class Hv{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new gu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new gu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ne,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ne),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new gu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ne,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ne),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,a=null,l=null;const u=this._targetRay,f=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){l=!0;for(const R of e.hand.values()){const T=t.getJointPose(R,n),E=this._getHandJoint(p,R);T!==null&&(E.matrix.fromArray(T.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale),E.matrixWorldNeedsUpdate=!0,E.jointRadius=T.radius),E.visible=T!==null}const m=p.joints["index-finger-tip"],v=p.joints["thumb-tip"],_=m.position.distanceTo(v.position),x=.02,b=.005;p.inputState.pinching&&_>x+b?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&_<=x-b&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else f!==null&&e.gripSpace&&(a=t.getPose(e.gripSpace,n),a!==null&&(f.matrix.fromArray(a.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,a.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(a.linearVelocity)):f.hasLinearVelocity=!1,a.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(a.angularVelocity)):f.hasAngularVelocity=!1));u!==null&&(i=t.getPose(e.targetRaySpace,n),i===null&&a!==null&&(i=a),i!==null&&(u.matrix.fromArray(i.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,i.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(i.linearVelocity)):u.hasLinearVelocity=!1,i.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(i.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(_3)))}return u!==null&&(u.visible=i!==null),f!==null&&(f.visible=a!==null),p!==null&&(p.visible=l!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new gu;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Jy{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Nt(e),this.density=t}clone(){return new Jy(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class $y{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Nt(e),this.near=t,this.far=n}clone(){return new $y(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class gg extends Xn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ns,this.environmentIntensity=1,this.environmentRotation=new ns,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class vg{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=eg,this.updateRanges=[],this.version=0,this.uuid=Es()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,a=this.stride;i<a;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Es()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Es()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Dr=new ne;class _c{constructor(e,t,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Dr.fromBufferAttribute(this,t),Dr.applyMatrix4(e),this.setXYZ(t,Dr.x,Dr.y,Dr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Dr.fromBufferAttribute(this,t),Dr.applyNormalMatrix(e),this.setXYZ(t,Dr.x,Dr.y,Dr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Dr.fromBufferAttribute(this,t),Dr.transformDirection(e),this.setXYZ(t,Dr.x,Dr.y,Dr.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=Lr(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Sn(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Sn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Sn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Sn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Sn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Lr(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Lr(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Lr(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Lr(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Sn(t,this.array),n=Sn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Sn(t,this.array),n=Sn(n,this.array),i=Sn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=Sn(t,this.array),n=Sn(n,this.array),i=Sn(i,this.array),a=Sn(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=a,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[i+a])}return new ii(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new _c(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[i+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class US extends ba{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Nt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let ld;const bm=new ne,ud=new ne,cd=new ne,fd=new ht,Em=new ht,JA=new Qt,ev=new ne,Tm=new ne,tv=new ne,jb=new ht,I1=new ht,Zb=new ht;class $A extends Xn{constructor(e=new US){if(super(),this.isSprite=!0,this.type="Sprite",ld===void 0){ld=new vn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new vg(t,5);ld.setIndex([0,1,2,0,2,3]),ld.setAttribute("position",new _c(n,3,0,!1)),ld.setAttribute("uv",new _c(n,2,3,!1))}this.geometry=ld,this.material=e,this.center=new ht(.5,.5),this.count=1}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ud.setFromMatrixScale(this.matrixWorld),JA.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),cd.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&ud.multiplyScalar(-cd.z);const n=this.material.rotation;let i,a;n!==0&&(a=Math.cos(n),i=Math.sin(n));const l=this.center;nv(ev.set(-.5,-.5,0),cd,l,ud,i,a),nv(Tm.set(.5,-.5,0),cd,l,ud,i,a),nv(tv.set(.5,.5,0),cd,l,ud,i,a),jb.set(0,0),I1.set(1,0),Zb.set(1,1);let u=e.ray.intersectTriangle(ev,Tm,tv,!1,bm);if(u===null&&(nv(Tm.set(-.5,.5,0),cd,l,ud,i,a),I1.set(0,1),u=e.ray.intersectTriangle(ev,tv,Tm,!1,bm),u===null))return;const f=e.ray.origin.distanceTo(bm);f<e.near||f>e.far||t.push({distance:f,point:bm.clone(),uv:ts.getInterpolation(bm,ev,Tm,tv,jb,I1,Zb,new ht),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function nv(s,e,t,n,i,a){fd.subVectors(s,t).addScalar(.5).multiply(n),i!==void 0?(Em.x=a*fd.x-i*fd.y,Em.y=i*fd.x+a*fd.y):Em.copy(fd),s.copy(e),s.x+=Em.x,s.y+=Em.y,s.applyMatrix4(JA)}const iv=new ne,Kb=new ne;class e2 extends Xn{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const a=t[n];this.addLevel(a.object.clone(),a.distance,a.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const i=this.levels;let a;for(a=0;a<i.length&&!(t<i[a].distance);a++);return i.splice(a,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const i=t.splice(n,1);return this.remove(i[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let a=t[n].distance;if(t[n].object.visible&&(a-=a*t[n].hysteresis),e<a)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){iv.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(iv);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){iv.setFromMatrixPosition(e.matrixWorld),Kb.setFromMatrixPosition(this.matrixWorld);const n=iv.distanceTo(Kb)/e.zoom;t[0].object.visible=!0;let i,a;for(i=1,a=t.length;i<a;i++){let l=t[i].distance;if(t[i].object.visible&&(l-=l*t[i].hysteresis),n>=l)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<a;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,a=n.length;i<a;i++){const l=n[i];t.object.levels.push({object:l.object.uuid,distance:l.distance,hysteresis:l.hysteresis})}return t}}const Qb=new ne,Jb=new kn,$b=new kn,x3=new ne,eE=new Qt,av=new ne,B1=new Ma,tE=new Qt,P1=new jf;class DS extends Si{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Hx,this.bindMatrix=new Qt,this.bindMatrixInverse=new Qt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new ca),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,av),this.boundingBox.expandByPoint(av)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Ma),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,av),this.boundingSphere.expandByPoint(av)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,i=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),B1.copy(this.boundingSphere),B1.applyMatrix4(i),e.ray.intersectsSphere(B1)!==!1&&(tE.copy(i).invert(),P1.copy(e.ray).applyMatrix4(tE),!(this.boundingBox!==null&&P1.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,P1)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new kn,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Hx?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===NA?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,i=this.geometry;Jb.fromBufferAttribute(i.attributes.skinIndex,e),$b.fromBufferAttribute(i.attributes.skinWeight,e),Qb.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let a=0;a<4;a++){const l=$b.getComponent(a);if(l!==0){const u=Jb.getComponent(a);eE.multiplyMatrices(n.bones[u].matrixWorld,n.boneInverses[u]),t.addScaledVector(x3.copy(Qb).applyMatrix4(eE),l)}}return t.applyMatrix4(this.bindMatrixInverse)}}class e_ extends Xn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class No extends Zn{constructor(e=null,t=1,n=1,i,a,l,u,f,p=Sa,m=Sa,v,_){super(null,l,u,f,p,m,i,a,v,_),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const nE=new Qt,S3=new Qt;class yg{constructor(e=[],t=[]){this.uuid=Es(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new Qt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Qt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let a=0,l=e.length;a<l;a++){const u=e[a]?e[a].matrixWorld:S3;nE.multiplyMatrices(u,t[a]),nE.toArray(n,a*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new yg(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new No(t,e,e,na,Vi);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const a=e.bones[n];let l=t[a];l===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),l=new e_),this.bones.push(l),this.boneInverses.push(new Qt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,a=t.length;i<a;i++){const l=t[i];e.bones.push(l.uuid);const u=n[i];e.boneInverses.push(u.toArray())}return e}}class xc extends ii{constructor(e,t,n,i=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const hd=new Qt,iE=new Qt,rv=[],aE=new ca,M3=new Qt,Am=new Si,Rm=new Ma;class NS extends Si{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new xc(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,M3)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new ca),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,hd),aE.copy(e.boundingBox).applyMatrix4(hd),this.boundingBox.union(aE)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Ma),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,hd),Rm.copy(e.boundingSphere).applyMatrix4(hd),this.boundingSphere.union(Rm)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,i=this.morphTexture.source.data.data,a=n.length+1,l=e*a+1;for(let u=0;u<n.length;u++)n[u]=i[l+u]}raycast(e,t){const n=this.matrixWorld,i=this.count;if(Am.geometry=this.geometry,Am.material=this.material,Am.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Rm.copy(this.boundingSphere),Rm.applyMatrix4(n),e.ray.intersectsSphere(Rm)!==!1))for(let a=0;a<i;a++){this.getMatrixAt(a,hd),iE.multiplyMatrices(n,hd),Am.matrixWorld=iE,Am.raycast(e,rv);for(let l=0,u=rv.length;l<u;l++){const f=rv[l];f.instanceId=a,f.object=this,t.push(f)}rv.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new xc(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,i=n.length+1;this.morphTexture===null&&(this.morphTexture=new No(new Float32Array(i*this.count),i,this.count,dg,Vi));const a=this.morphTexture.source.data.data;let l=0;for(let p=0;p<n.length;p++)l+=n[p];const u=this.geometry.morphTargetsRelative?1:1-l,f=i*e;a[f]=u,a.set(n,f+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const F1=new ne,b3=new ne,E3=new dn;class du{constructor(e=new ne(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=F1.subVectors(n,t).cross(b3.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(F1),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/i;return a<0||a>1?null:t.copy(e.start).addScaledVector(n,a)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||E3.getNormalMatrix(e),i=this.coplanarPoint(F1).applyMatrix4(e),a=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const hf=new Ma,T3=new ht(.5,.5),sv=new ne;class Yd{constructor(e=new du,t=new du,n=new du,i=new du,a=new du,l=new du){this.planes=[e,t,n,i,a,l]}set(e,t,n,i,a,l){const u=this.planes;return u[0].copy(e),u[1].copy(t),u[2].copy(n),u[3].copy(i),u[4].copy(a),u[5].copy(l),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=bs,n=!1){const i=this.planes,a=e.elements,l=a[0],u=a[1],f=a[2],p=a[3],m=a[4],v=a[5],_=a[6],x=a[7],b=a[8],R=a[9],T=a[10],E=a[11],w=a[12],D=a[13],U=a[14],I=a[15];if(i[0].setComponents(p-l,x-m,E-b,I-w).normalize(),i[1].setComponents(p+l,x+m,E+b,I+w).normalize(),i[2].setComponents(p+u,x+v,E+R,I+D).normalize(),i[3].setComponents(p-u,x-v,E-R,I-D).normalize(),n)i[4].setComponents(f,_,T,U).normalize(),i[5].setComponents(p-f,x-_,E-T,I-U).normalize();else if(i[4].setComponents(p-f,x-_,E-T,I-U).normalize(),t===bs)i[5].setComponents(p+f,x+_,E+T,I+U).normalize();else if(t===Id)i[5].setComponents(f,_,T,U).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),hf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),hf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(hf)}intersectsSprite(e){hf.center.set(0,0,0);const t=T3.distanceTo(e.center);return hf.radius=.7071067811865476+t,hf.applyMatrix4(e.matrixWorld),this.intersectsSphere(hf)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(sv.x=i.normal.x>0?e.max.x:e.min.x,sv.y=i.normal.y>0?e.max.y:e.min.y,sv.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(sv)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const hl=new Qt,dl=new Yd;class t_{constructor(){this.coordinateSystem=bs}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(hl.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),dl.setFromProjectionMatrix(hl,i.coordinateSystem,i.reversedDepth),dl.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(hl.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),dl.setFromProjectionMatrix(hl,i.coordinateSystem,i.reversedDepth),dl.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(hl.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),dl.setFromProjectionMatrix(hl,i.coordinateSystem,i.reversedDepth),dl.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(hl.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),dl.setFromProjectionMatrix(hl,i.coordinateSystem,i.reversedDepth),dl.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(hl.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),dl.setFromProjectionMatrix(hl,i.coordinateSystem,i.reversedDepth),dl.containsPoint(e))return!0}return!1}clone(){return new t_}}function H1(s,e){return s-e}function A3(s,e){return s.z-e.z}function R3(s,e){return e.z-s.z}class C3{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,i){const a=this.pool,l=this.list;this.index>=a.length&&a.push({start:-1,count:-1,z:-1,index:-1});const u=a[this.index];l.push(u),this.index++,u.start=e,u.count=t,u.z=n,u.index=i}reset(){this.list.length=0,this.index=0}}const $r=new Qt,w3=new Nt(1,1,1),rE=new Yd,U3=new t_,ov=new ca,df=new Ma,Cm=new ne,sE=new ne,D3=new ne,G1=new C3,lr=new Si,lv=[];function N3(s,e,t=0){const n=e.itemSize;if(s.isInterleavedBufferAttribute||s.array.constructor!==e.array.constructor){const i=s.count;for(let a=0;a<i;a++)for(let l=0;l<n;l++)e.setComponent(a+t,l,s.getComponent(a,l))}else e.array.set(s.array,t*n);e.needsUpdate=!0}function pf(s,e){if(s.constructor!==e.constructor){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++)e[n]=s[n]}else{const t=Math.min(s.length,e.length);e.set(new s.constructor(s.buffer,0,t))}}class t2 extends Si{constructor(e,t,n=t*2,i){super(new vn,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new No(t,e,e,na,Vi);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new No(t,e,e,pg,Ml);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new No(t,e,e,na,Vi);n.colorSpace=On.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,i=this._maxIndexCount;if(this._geometryInitialized===!1){for(const a in e.attributes){const l=e.getAttribute(a),{array:u,itemSize:f,normalized:p}=l,m=new u.constructor(n*f),v=new ii(m,f,p);t.setAttribute(a,v)}if(e.getIndex()!==null){const a=n>65535?new Uint32Array(i):new Uint16Array(i);t.setIndex(new ii(a,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const i=e.getAttribute(n),a=t.getAttribute(n);if(i.itemSize!==a.itemSize||i.normalized!==a.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ca);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(t[n].active===!1)continue;const a=t[n].geometryIndex;this.getMatrixAt(n,$r),this.getBoundingBoxAt(a,ov).applyMatrix4($r),e.union(ov)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ma);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(t[n].active===!1)continue;const a=t[n].geometryIndex;this.getMatrixAt(n,$r),this.getBoundingSphereAt(a,df).applyMatrix4($r),e.union(df)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let i=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(H1),i=this._availableInstanceIds.shift(),this._instanceInfo[i]=n):(i=this._instanceInfo.length,this._instanceInfo.push(n));const a=this._matricesTexture;$r.identity().toArray(a.image.data,i*16),a.needsUpdate=!0;const l=this._colorsTexture;return l&&(w3.toArray(l.image.data,i*4),l.needsUpdate=!0),this._visibilityChanged=!0,i}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},a=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const l=e.getIndex();if(l!==null&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=n===-1?l.count:n),i.indexStart!==-1&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let f;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(H1),f=this._availableGeometryIds.shift(),a[f]=i):(f=this._geometryCount,this._geometryCount++,a.push(i)),this.setGeometryAt(f,e),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,f}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,i=n.getIndex()!==null,a=n.getIndex(),l=t.getIndex(),u=this._geometryInfo[e];if(i&&l.count>u.reservedIndexCount||t.attributes.position.count>u.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const f=u.vertexStart,p=u.reservedVertexCount;u.vertexCount=t.getAttribute("position").count;for(const m in n.attributes){const v=t.getAttribute(m),_=n.getAttribute(m);N3(v,_,f);const x=v.itemSize;for(let b=v.count,R=p;b<R;b++){const T=f+b;for(let E=0;E<x;E++)_.setComponent(T,E,0)}_.needsUpdate=!0,_.addUpdateRange(f*x,p*x)}if(i){const m=u.indexStart,v=u.reservedIndexCount;u.indexCount=t.getIndex().count;for(let _=0;_<l.count;_++)a.setX(m+_,f+l.getX(_));for(let _=l.count,x=v;_<x;_++)a.setX(m+_,f);a.needsUpdate=!0,a.addUpdateRange(m,u.reservedIndexCount)}return u.start=i?u.indexStart:u.vertexStart,u.count=i?u.indexCount:u.vertexCount,u.boundingBox=null,t.boundingBox!==null&&(u.boundingBox=t.boundingBox.clone()),u.boundingSphere=null,t.boundingSphere!==null&&(u.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let i=0,a=n.length;i<a;i++)n[i].active&&n[i].geometryIndex===e&&this.deleteInstance(i);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,i=n.map((l,u)=>u).sort((l,u)=>n[l].vertexStart-n[u].vertexStart),a=this.geometry;for(let l=0,u=n.length;l<u;l++){const f=i[l],p=n[f];if(p.active!==!1){if(a.index!==null){if(p.indexStart!==t){const{indexStart:m,vertexStart:v,reservedIndexCount:_}=p,x=a.index,b=x.array,R=e-v;for(let T=m;T<m+_;T++)b[T]=b[T]+R;x.array.copyWithin(t,m,m+_),x.addUpdateRange(t,_),p.indexStart=t}t+=p.reservedIndexCount}if(p.vertexStart!==e){const{vertexStart:m,reservedVertexCount:v}=p,_=a.attributes;for(const x in _){const b=_[x],{array:R,itemSize:T}=b;R.copyWithin(e*T,m*T,(m+v)*T),b.addUpdateRange(e*T,v*T)}p.vertexStart=e}e+=p.reservedVertexCount,p.start=a.index?p.indexStart:p.vertexStart,this._nextIndexStart=a.index?p.indexStart+p.reservedIndexCount:0,this._nextVertexStart=p.vertexStart+p.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[e];if(i.boundingBox===null){const a=new ca,l=n.index,u=n.attributes.position;for(let f=i.start,p=i.start+i.count;f<p;f++){let m=f;l&&(m=l.getX(m)),a.expandByPoint(Cm.fromBufferAttribute(u,m))}i.boundingBox=a}return t.copy(i.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[e];if(i.boundingSphere===null){const a=new Ma;this.getBoundingBoxAt(e,ov),ov.getCenter(a.center);const l=n.index,u=n.attributes.position;let f=0;for(let p=i.start,m=i.start+i.count;p<m;p++){let v=p;l&&(v=l.getX(v)),Cm.fromBufferAttribute(u,v),f=Math.max(f,a.center.distanceToSquared(Cm))}a.radius=Math.sqrt(f),i.boundingSphere=a}return t.copy(i.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,i=this._matricesTexture.image.data;return t.toArray(i,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(H1);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const i=new Int32Array(e),a=new Int32Array(e);pf(this._multiDrawCounts,i),pf(this._multiDrawStarts,a),this._multiDrawCounts=i,this._multiDrawStarts=a,this._maxInstanceCount=e;const l=this._indirectTexture,u=this._matricesTexture,f=this._colorsTexture;l.dispose(),this._initIndirectTexture(),pf(l.image.data,this._indirectTexture.image.data),u.dispose(),this._initMatricesTexture(),pf(u.image.data,this._matricesTexture.image.data),f&&(f.dispose(),this._initColorsTexture(),pf(f.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(u=>u.active);if(Math.max(...n.map(u=>u.vertexStart+u.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(f=>f.indexStart+f.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const a=this.geometry;a.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new vn,this._initializeGeometry(a));const l=this.geometry;a.index&&pf(a.index.array,l.index.array);for(const u in a.attributes)pf(a.attributes[u].array,l.attributes[u].array)}raycast(e,t){const n=this._instanceInfo,i=this._geometryInfo,a=this.matrixWorld,l=this.geometry;lr.material=this.material,lr.geometry.index=l.index,lr.geometry.attributes=l.attributes,lr.geometry.boundingBox===null&&(lr.geometry.boundingBox=new ca),lr.geometry.boundingSphere===null&&(lr.geometry.boundingSphere=new Ma);for(let u=0,f=n.length;u<f;u++){if(!n[u].visible||!n[u].active)continue;const p=n[u].geometryIndex,m=i[p];lr.geometry.setDrawRange(m.start,m.count),this.getMatrixAt(u,lr.matrixWorld).premultiply(a),this.getBoundingBoxAt(p,lr.geometry.boundingBox),this.getBoundingSphereAt(p,lr.geometry.boundingSphere),lr.raycast(e,lv);for(let v=0,_=lv.length;v<_;v++){const x=lv[v];x.object=this,x.batchId=u,t.push(x)}lv.length=0}lr.material=null,lr.geometry.index=null,lr.geometry.attributes={},lr.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,i,a){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const l=i.getIndex(),u=l===null?1:l.array.BYTES_PER_ELEMENT,f=this._instanceInfo,p=this._multiDrawStarts,m=this._multiDrawCounts,v=this._geometryInfo,_=this.perObjectFrustumCulled,x=this._indirectTexture,b=x.image.data,R=n.isArrayCamera?U3:rE;_&&!n.isArrayCamera&&($r.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),rE.setFromProjectionMatrix($r,n.coordinateSystem,n.reversedDepth));let T=0;if(this.sortObjects){$r.copy(this.matrixWorld).invert(),Cm.setFromMatrixPosition(n.matrixWorld).applyMatrix4($r),sE.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection($r);for(let D=0,U=f.length;D<U;D++)if(f[D].visible&&f[D].active){const I=f[D].geometryIndex;this.getMatrixAt(D,$r),this.getBoundingSphereAt(I,df).applyMatrix4($r);let O=!1;if(_&&(O=!R.intersectsSphere(df,n)),!O){const P=v[I],B=D3.subVectors(df.center,Cm).dot(sE);G1.push(P.start,P.count,B,D)}}const E=G1.list,w=this.customSort;w===null?E.sort(a.transparent?R3:A3):w.call(this,E,n);for(let D=0,U=E.length;D<U;D++){const I=E[D];p[T]=I.start*u,m[T]=I.count,b[T]=I.index,T++}G1.reset()}else for(let E=0,w=f.length;E<w;E++)if(f[E].visible&&f[E].active){const D=f[E].geometryIndex;let U=!1;if(_&&(this.getMatrixAt(E,$r),this.getBoundingSphereAt(D,df).applyMatrix4($r),U=!R.intersectsSphere(df,n)),!U){const I=v[D];p[T]=I.start*u,m[T]=I.count,b[T]=E,T++}}x.needsUpdate=!0,this._multiDrawCount=T,this._visibilityChanged=!1}onBeforeShadow(e,t,n,i,a,l){this.onBeforeRender(e,null,i,a,l)}}class cr extends ba{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Nt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const wy=new ne,Uy=new ne,oE=new Qt,wm=new jf,uv=new Ma,V1=new ne,lE=new ne;class yu extends Xn{constructor(e=new vn,t=new cr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,a=t.count;i<a;i++)wy.fromBufferAttribute(t,i-1),Uy.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=wy.distanceTo(Uy);e.setAttribute("lineDistance",new Vt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,a=e.params.Line.threshold,l=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),uv.copy(n.boundingSphere),uv.applyMatrix4(i),uv.radius+=a,e.ray.intersectsSphere(uv)===!1)return;oE.copy(i).invert(),wm.copy(e.ray).applyMatrix4(oE);const u=a/((this.scale.x+this.scale.y+this.scale.z)/3),f=u*u,p=this.isLineSegments?2:1,m=n.index,_=n.attributes.position;if(m!==null){const x=Math.max(0,l.start),b=Math.min(m.count,l.start+l.count);for(let R=x,T=b-1;R<T;R+=p){const E=m.getX(R),w=m.getX(R+1),D=cv(this,e,wm,f,E,w,R);D&&t.push(D)}if(this.isLineLoop){const R=m.getX(b-1),T=m.getX(x),E=cv(this,e,wm,f,R,T,b-1);E&&t.push(E)}}else{const x=Math.max(0,l.start),b=Math.min(_.count,l.start+l.count);for(let R=x,T=b-1;R<T;R+=p){const E=cv(this,e,wm,f,R,R+1,R);E&&t.push(E)}if(this.isLineLoop){const R=cv(this,e,wm,f,b-1,x,b-1);R&&t.push(R)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=i.length;a<l;a++){const u=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}}function cv(s,e,t,n,i,a,l){const u=s.geometry.attributes.position;if(wy.fromBufferAttribute(u,i),Uy.fromBufferAttribute(u,a),t.distanceSqToSegment(wy,Uy,V1,lE)>n)return;V1.applyMatrix4(s.matrixWorld);const p=e.ray.origin.distanceTo(V1);if(!(p<e.near||p>e.far))return{distance:p,point:lE.clone().applyMatrix4(s.matrixWorld),index:l,face:null,faceIndex:null,barycoord:null,object:s}}const uE=new ne,cE=new ne;class Oo extends yu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,a=t.count;i<a;i+=2)uE.fromBufferAttribute(t,i),cE.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+uE.distanceTo(cE);e.setAttribute("lineDistance",new Vt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class OS extends yu{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class n_ extends ba{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Nt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const fE=new Qt,Xx=new jf,fv=new Ma,hv=new ne;class LS extends Xn{constructor(e=new vn,t=new n_){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,a=e.params.Points.threshold,l=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),fv.copy(n.boundingSphere),fv.applyMatrix4(i),fv.radius+=a,e.ray.intersectsSphere(fv)===!1)return;fE.copy(i).invert(),Xx.copy(e.ray).applyMatrix4(fE);const u=a/((this.scale.x+this.scale.y+this.scale.z)/3),f=u*u,p=n.index,v=n.attributes.position;if(p!==null){const _=Math.max(0,l.start),x=Math.min(p.count,l.start+l.count);for(let b=_,R=x;b<R;b++){const T=p.getX(b);hv.fromBufferAttribute(v,T),hE(hv,T,f,i,e,t,this)}}else{const _=Math.max(0,l.start),x=Math.min(v.count,l.start+l.count);for(let b=_,R=x;b<R;b++)hv.fromBufferAttribute(v,b),hE(hv,b,f,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=i.length;a<l;a++){const u=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}}function hE(s,e,t,n,i,a,l){const u=Xx.distanceSqToPoint(s);if(u<t){const f=new ne;Xx.closestPointToPoint(s,f),f.applyMatrix4(n);const p=i.ray.origin.distanceTo(f);if(p<i.near||p>i.far)return;a.push({distance:p,distanceToRay:Math.sqrt(u),point:f,index:e,face:null,faceIndex:null,barycoord:null,object:l})}}class n2 extends Zn{constructor(e,t,n,i,a=Wn,l=Wn,u,f,p){super(e,t,n,i,a,l,u,f,p),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const m=this;function v(){m.needsUpdate=!0,m._requestVideoFrameCallbackId=e.requestVideoFrameCallback(v)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(v))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),super.dispose()}}class O3 extends n2{constructor(e,t,n,i,a,l,u,f){super({},e,t,n,i,a,l,u,f),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class L3 extends Zn{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Sa,this.minFilter=Sa,this.generateMipmaps=!1,this.needsUpdate=!0}}class i_ extends Zn{constructor(e,t,n,i,a,l,u,f,p,m,v,_){super(null,l,u,f,p,m,i,a,v,_),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class z3 extends i_{constructor(e,t,n,i,a,l){super(e,t,n,a,l),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=ta,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class I3 extends i_{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Sl),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class B3 extends Zn{constructor(e,t,n,i,a,l,u,f,p){super(e,t,n,i,a,l,u,f,p),this.isCanvasTexture=!0,this.needsUpdate=!0}}class zS extends Zn{constructor(e,t,n=Ml,i,a,l,u=Sa,f=Sa,p,m=Nd,v=1){if(m!==Nd&&m!==Od)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const _={width:e,height:t,depth:v};super(_,i,a,l,u,f,m,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new dc(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class IS extends Zn{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class a_ extends vn{constructor(e=1,t=1,n=4,i=8,a=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:i,heightSegments:a},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),i=Math.max(3,Math.floor(i)),a=Math.max(1,Math.floor(a));const l=[],u=[],f=[],p=[],m=t/2,v=Math.PI/2*e,_=t,x=2*v+_,b=n*2+a,R=i+1,T=new ne,E=new ne;for(let w=0;w<=b;w++){let D=0,U=0,I=0,O=0;if(w<=n){const N=w/n,z=N*Math.PI/2;U=-m-e*Math.cos(z),I=e*Math.sin(z),O=-e*Math.cos(z),D=N*v}else if(w<=n+a){const N=(w-n)/a;U=-m+N*t,I=e,O=0,D=v+N*_}else{const N=(w-n-a)/n,z=N*Math.PI/2;U=m+e*Math.sin(z),I=e*Math.cos(z),O=e*Math.sin(z),D=v+_+N*v}const P=Math.max(0,Math.min(1,D/x));let B=0;w===0?B=.5/i:w===b&&(B=-.5/i);for(let N=0;N<=i;N++){const z=N/i,q=z*Math.PI*2,Y=Math.sin(q),Q=Math.cos(q);E.x=-I*Q,E.y=U,E.z=I*Y,u.push(E.x,E.y,E.z),T.set(-I*Q,O,I*Y),T.normalize(),f.push(T.x,T.y,T.z),p.push(z+B,P)}if(w>0){const N=(w-1)*R;for(let z=0;z<i;z++){const q=N+z,Y=N+z+1,Q=w*R+z,Z=w*R+z+1;l.push(q,Y,Q),l.push(Y,Z,Q)}}}this.setIndex(l),this.setAttribute("position",new Vt(u,3)),this.setAttribute("normal",new Vt(f,3)),this.setAttribute("uv",new Vt(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new a_(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class r_ extends vn{constructor(e=1,t=32,n=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const a=[],l=[],u=[],f=[],p=new ne,m=new ht;l.push(0,0,0),u.push(0,0,1),f.push(.5,.5);for(let v=0,_=3;v<=t;v++,_+=3){const x=n+v/t*i;p.x=e*Math.cos(x),p.y=e*Math.sin(x),l.push(p.x,p.y,p.z),u.push(0,0,1),m.x=(l[_]/e+1)/2,m.y=(l[_+1]/e+1)/2,f.push(m.x,m.y)}for(let v=1;v<=t;v++)a.push(v,v+1,0);this.setIndex(a),this.setAttribute("position",new Vt(l,3)),this.setAttribute("normal",new Vt(u,3)),this.setAttribute("uv",new Vt(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new r_(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class _g extends vn{constructor(e=1,t=1,n=1,i=32,a=1,l=!1,u=0,f=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:a,openEnded:l,thetaStart:u,thetaLength:f};const p=this;i=Math.floor(i),a=Math.floor(a);const m=[],v=[],_=[],x=[];let b=0;const R=[],T=n/2;let E=0;w(),l===!1&&(e>0&&D(!0),t>0&&D(!1)),this.setIndex(m),this.setAttribute("position",new Vt(v,3)),this.setAttribute("normal",new Vt(_,3)),this.setAttribute("uv",new Vt(x,2));function w(){const U=new ne,I=new ne;let O=0;const P=(t-e)/n;for(let B=0;B<=a;B++){const N=[],z=B/a,q=z*(t-e)+e;for(let Y=0;Y<=i;Y++){const Q=Y/i,Z=Q*f+u,ae=Math.sin(Z),G=Math.cos(Z);I.x=q*ae,I.y=-z*n+T,I.z=q*G,v.push(I.x,I.y,I.z),U.set(ae,P,G).normalize(),_.push(U.x,U.y,U.z),x.push(Q,1-z),N.push(b++)}R.push(N)}for(let B=0;B<i;B++)for(let N=0;N<a;N++){const z=R[N][B],q=R[N+1][B],Y=R[N+1][B+1],Q=R[N][B+1];(e>0||N!==0)&&(m.push(z,q,Q),O+=3),(t>0||N!==a-1)&&(m.push(q,Y,Q),O+=3)}p.addGroup(E,O,0),E+=O}function D(U){const I=b,O=new ht,P=new ne;let B=0;const N=U===!0?e:t,z=U===!0?1:-1;for(let Y=1;Y<=i;Y++)v.push(0,T*z,0),_.push(0,z,0),x.push(.5,.5),b++;const q=b;for(let Y=0;Y<=i;Y++){const Z=Y/i*f+u,ae=Math.cos(Z),G=Math.sin(Z);P.x=N*G,P.y=T*z,P.z=N*ae,v.push(P.x,P.y,P.z),_.push(0,z,0),O.x=ae*.5+.5,O.y=G*.5*z+.5,x.push(O.x,O.y),b++}for(let Y=0;Y<i;Y++){const Q=I+Y,Z=q+Y;U===!0?m.push(Z,Z+1,Q):m.push(Z+1,Z,Q),B+=3}p.addGroup(E,B,U===!0?1:2),E+=B}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _g(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class xg extends _g{constructor(e=1,t=1,n=32,i=1,a=!1,l=0,u=Math.PI*2){super(0,e,t,n,i,a,l,u),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:a,thetaStart:l,thetaLength:u}}static fromJSON(e){return new xg(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Mc extends vn{constructor(e=[],t=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const a=[],l=[];u(i),p(n),m(),this.setAttribute("position",new Vt(a,3)),this.setAttribute("normal",new Vt(a.slice(),3)),this.setAttribute("uv",new Vt(l,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function u(w){const D=new ne,U=new ne,I=new ne;for(let O=0;O<t.length;O+=3)x(t[O+0],D),x(t[O+1],U),x(t[O+2],I),f(D,U,I,w)}function f(w,D,U,I){const O=I+1,P=[];for(let B=0;B<=O;B++){P[B]=[];const N=w.clone().lerp(U,B/O),z=D.clone().lerp(U,B/O),q=O-B;for(let Y=0;Y<=q;Y++)Y===0&&B===O?P[B][Y]=N:P[B][Y]=N.clone().lerp(z,Y/q)}for(let B=0;B<O;B++)for(let N=0;N<2*(O-B)-1;N++){const z=Math.floor(N/2);N%2===0?(_(P[B][z+1]),_(P[B+1][z]),_(P[B][z])):(_(P[B][z+1]),_(P[B+1][z+1]),_(P[B+1][z]))}}function p(w){const D=new ne;for(let U=0;U<a.length;U+=3)D.x=a[U+0],D.y=a[U+1],D.z=a[U+2],D.normalize().multiplyScalar(w),a[U+0]=D.x,a[U+1]=D.y,a[U+2]=D.z}function m(){const w=new ne;for(let D=0;D<a.length;D+=3){w.x=a[D+0],w.y=a[D+1],w.z=a[D+2];const U=T(w)/2/Math.PI+.5,I=E(w)/Math.PI+.5;l.push(U,1-I)}b(),v()}function v(){for(let w=0;w<l.length;w+=6){const D=l[w+0],U=l[w+2],I=l[w+4],O=Math.max(D,U,I),P=Math.min(D,U,I);O>.9&&P<.1&&(D<.2&&(l[w+0]+=1),U<.2&&(l[w+2]+=1),I<.2&&(l[w+4]+=1))}}function _(w){a.push(w.x,w.y,w.z)}function x(w,D){const U=w*3;D.x=e[U+0],D.y=e[U+1],D.z=e[U+2]}function b(){const w=new ne,D=new ne,U=new ne,I=new ne,O=new ht,P=new ht,B=new ht;for(let N=0,z=0;N<a.length;N+=9,z+=6){w.set(a[N+0],a[N+1],a[N+2]),D.set(a[N+3],a[N+4],a[N+5]),U.set(a[N+6],a[N+7],a[N+8]),O.set(l[z+0],l[z+1]),P.set(l[z+2],l[z+3]),B.set(l[z+4],l[z+5]),I.copy(w).add(D).add(U).divideScalar(3);const q=T(I);R(O,z+0,w,q),R(P,z+2,D,q),R(B,z+4,U,q)}}function R(w,D,U,I){I<0&&w.x===1&&(l[D]=w.x-1),U.x===0&&U.z===0&&(l[D]=I/2/Math.PI+.5)}function T(w){return Math.atan2(w.z,-w.x)}function E(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mc(e.vertices,e.indices,e.radius,e.details)}}class s_ extends Mc{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],l=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(a,l,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new s_(e.radius,e.detail)}}const dv=new ne,pv=new ne,k1=new ne,mv=new ts;class i2 extends vn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),a=Math.cos(Pf*t),l=e.getIndex(),u=e.getAttribute("position"),f=l?l.count:u.count,p=[0,0,0],m=["a","b","c"],v=new Array(3),_={},x=[];for(let b=0;b<f;b+=3){l?(p[0]=l.getX(b),p[1]=l.getX(b+1),p[2]=l.getX(b+2)):(p[0]=b,p[1]=b+1,p[2]=b+2);const{a:R,b:T,c:E}=mv;if(R.fromBufferAttribute(u,p[0]),T.fromBufferAttribute(u,p[1]),E.fromBufferAttribute(u,p[2]),mv.getNormal(k1),v[0]=`${Math.round(R.x*i)},${Math.round(R.y*i)},${Math.round(R.z*i)}`,v[1]=`${Math.round(T.x*i)},${Math.round(T.y*i)},${Math.round(T.z*i)}`,v[2]=`${Math.round(E.x*i)},${Math.round(E.y*i)},${Math.round(E.z*i)}`,!(v[0]===v[1]||v[1]===v[2]||v[2]===v[0]))for(let w=0;w<3;w++){const D=(w+1)%3,U=v[w],I=v[D],O=mv[m[w]],P=mv[m[D]],B=`${U}_${I}`,N=`${I}_${U}`;N in _&&_[N]?(k1.dot(_[N].normal)<=a&&(x.push(O.x,O.y,O.z),x.push(P.x,P.y,P.z)),_[N]=null):B in _||(_[B]={index0:p[w],index1:p[D],normal:k1.clone()})}}for(const b in _)if(_[b]){const{index0:R,index1:T}=_[b];dv.fromBufferAttribute(u,R),pv.fromBufferAttribute(u,T),x.push(dv.x,dv.y,dv.z),x.push(pv.x,pv.y,pv.z)}this.setAttribute("position",new Vt(x,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Lo{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),a=0;t.push(0);for(let l=1;l<=e;l++)n=this.getPoint(l/e),a+=n.distanceTo(i),t.push(a),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let i=0;const a=n.length;let l;t?l=t:l=e*n[a-1];let u=0,f=a-1,p;for(;u<=f;)if(i=Math.floor(u+(f-u)/2),p=n[i]-l,p<0)u=i+1;else if(p>0)f=i-1;else{f=i;break}if(i=f,n[i]===l)return i/(a-1);const m=n[i],_=n[i+1]-m,x=(l-m)/_;return(i+x)/(a-1)}getTangent(e,t){let i=e-1e-4,a=e+1e-4;i<0&&(i=0),a>1&&(a=1);const l=this.getPoint(i),u=this.getPoint(a),f=t||(l.isVector2?new ht:new ne);return f.copy(u).sub(l).normalize(),f}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new ne,i=[],a=[],l=[],u=new ne,f=new Qt;for(let x=0;x<=e;x++){const b=x/e;i[x]=this.getTangentAt(b,new ne)}a[0]=new ne,l[0]=new ne;let p=Number.MAX_VALUE;const m=Math.abs(i[0].x),v=Math.abs(i[0].y),_=Math.abs(i[0].z);m<=p&&(p=m,n.set(1,0,0)),v<=p&&(p=v,n.set(0,1,0)),_<=p&&n.set(0,0,1),u.crossVectors(i[0],n).normalize(),a[0].crossVectors(i[0],u),l[0].crossVectors(i[0],a[0]);for(let x=1;x<=e;x++){if(a[x]=a[x-1].clone(),l[x]=l[x-1].clone(),u.crossVectors(i[x-1],i[x]),u.length()>Number.EPSILON){u.normalize();const b=Math.acos(rn(i[x-1].dot(i[x]),-1,1));a[x].applyMatrix4(f.makeRotationAxis(u,b))}l[x].crossVectors(i[x],a[x])}if(t===!0){let x=Math.acos(rn(a[0].dot(a[e]),-1,1));x/=e,i[0].dot(u.crossVectors(a[0],a[e]))>0&&(x=-x);for(let b=1;b<=e;b++)a[b].applyMatrix4(f.makeRotationAxis(i[b],x*b)),l[b].crossVectors(i[b],a[b])}return{tangents:i,normals:a,binormals:l}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class o_ extends Lo{constructor(e=0,t=0,n=1,i=1,a=0,l=Math.PI*2,u=!1,f=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=a,this.aEndAngle=l,this.aClockwise=u,this.aRotation=f}getPoint(e,t=new ht){const n=t,i=Math.PI*2;let a=this.aEndAngle-this.aStartAngle;const l=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=i;for(;a>i;)a-=i;a<Number.EPSILON&&(l?a=0:a=i),this.aClockwise===!0&&!l&&(a===i?a=-i:a=a-i);const u=this.aStartAngle+e*a;let f=this.aX+this.xRadius*Math.cos(u),p=this.aY+this.yRadius*Math.sin(u);if(this.aRotation!==0){const m=Math.cos(this.aRotation),v=Math.sin(this.aRotation),_=f-this.aX,x=p-this.aY;f=_*m-x*v+this.aX,p=_*v+x*m+this.aY}return n.set(f,p)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class a2 extends o_{constructor(e,t,n,i,a,l){super(e,t,n,n,i,a,l),this.isArcCurve=!0,this.type="ArcCurve"}}function BS(){let s=0,e=0,t=0,n=0;function i(a,l,u,f){s=a,e=u,t=-3*a+3*l-2*u-f,n=2*a-2*l+u+f}return{initCatmullRom:function(a,l,u,f,p){i(l,u,p*(u-a),p*(f-l))},initNonuniformCatmullRom:function(a,l,u,f,p,m,v){let _=(l-a)/p-(u-a)/(p+m)+(u-l)/m,x=(u-l)/m-(f-l)/(m+v)+(f-u)/v;_*=m,x*=m,i(l,u,_,x)},calc:function(a){const l=a*a,u=l*a;return s+e*a+t*l+n*u}}}const gv=new ne,X1=new BS,Y1=new BS,q1=new BS;class r2 extends Lo{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new ne){const n=t,i=this.points,a=i.length,l=(a-(this.closed?0:1))*e;let u=Math.floor(l),f=l-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/a)+1)*a:f===0&&u===a-1&&(u=a-2,f=1);let p,m;this.closed||u>0?p=i[(u-1)%a]:(gv.subVectors(i[0],i[1]).add(i[0]),p=gv);const v=i[u%a],_=i[(u+1)%a];if(this.closed||u+2<a?m=i[(u+2)%a]:(gv.subVectors(i[a-1],i[a-2]).add(i[a-1]),m=gv),this.curveType==="centripetal"||this.curveType==="chordal"){const x=this.curveType==="chordal"?.5:.25;let b=Math.pow(p.distanceToSquared(v),x),R=Math.pow(v.distanceToSquared(_),x),T=Math.pow(_.distanceToSquared(m),x);R<1e-4&&(R=1),b<1e-4&&(b=R),T<1e-4&&(T=R),X1.initNonuniformCatmullRom(p.x,v.x,_.x,m.x,b,R,T),Y1.initNonuniformCatmullRom(p.y,v.y,_.y,m.y,b,R,T),q1.initNonuniformCatmullRom(p.z,v.z,_.z,m.z,b,R,T)}else this.curveType==="catmullrom"&&(X1.initCatmullRom(p.x,v.x,_.x,m.x,this.tension),Y1.initCatmullRom(p.y,v.y,_.y,m.y,this.tension),q1.initCatmullRom(p.z,v.z,_.z,m.z,this.tension));return n.set(X1.calc(f),Y1.calc(f),q1.calc(f)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new ne().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function dE(s,e,t,n,i){const a=(n-e)*.5,l=(i-t)*.5,u=s*s,f=s*u;return(2*t-2*n+a+l)*f+(-3*t+3*n-2*a-l)*u+a*s+t}function P3(s,e){const t=1-s;return t*t*e}function F3(s,e){return 2*(1-s)*s*e}function H3(s,e){return s*s*e}function Ym(s,e,t,n){return P3(s,e)+F3(s,t)+H3(s,n)}function G3(s,e){const t=1-s;return t*t*t*e}function V3(s,e){const t=1-s;return 3*t*t*s*e}function k3(s,e){return 3*(1-s)*s*s*e}function X3(s,e){return s*s*s*e}function qm(s,e,t,n,i){return G3(s,e)+V3(s,t)+k3(s,n)+X3(s,i)}class PS extends Lo{constructor(e=new ht,t=new ht,n=new ht,i=new ht){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new ht){const n=t,i=this.v0,a=this.v1,l=this.v2,u=this.v3;return n.set(qm(e,i.x,a.x,l.x,u.x),qm(e,i.y,a.y,l.y,u.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class s2 extends Lo{constructor(e=new ne,t=new ne,n=new ne,i=new ne){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new ne){const n=t,i=this.v0,a=this.v1,l=this.v2,u=this.v3;return n.set(qm(e,i.x,a.x,l.x,u.x),qm(e,i.y,a.y,l.y,u.y),qm(e,i.z,a.z,l.z,u.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class FS extends Lo{constructor(e=new ht,t=new ht){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ht){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ht){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class o2 extends Lo{constructor(e=new ne,t=new ne){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ne){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ne){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class HS extends Lo{constructor(e=new ht,t=new ht,n=new ht){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ht){const n=t,i=this.v0,a=this.v1,l=this.v2;return n.set(Ym(e,i.x,a.x,l.x),Ym(e,i.y,a.y,l.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class GS extends Lo{constructor(e=new ne,t=new ne,n=new ne){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ne){const n=t,i=this.v0,a=this.v1,l=this.v2;return n.set(Ym(e,i.x,a.x,l.x),Ym(e,i.y,a.y,l.y),Ym(e,i.z,a.z,l.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class VS extends Lo{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ht){const n=t,i=this.points,a=(i.length-1)*e,l=Math.floor(a),u=a-l,f=i[l===0?l:l-1],p=i[l],m=i[l>i.length-2?i.length-1:l+1],v=i[l>i.length-3?i.length-1:l+2];return n.set(dE(u,f.x,p.x,m.x,v.x),dE(u,f.y,p.y,m.y,v.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new ht().fromArray(i))}return this}}var Dy=Object.freeze({__proto__:null,ArcCurve:a2,CatmullRomCurve3:r2,CubicBezierCurve:PS,CubicBezierCurve3:s2,EllipseCurve:o_,LineCurve:FS,LineCurve3:o2,QuadraticBezierCurve:HS,QuadraticBezierCurve3:GS,SplineCurve:VS});class l2 extends Lo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Dy[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let a=0;for(;a<i.length;){if(i[a]>=n){const l=i[a]-n,u=this.curves[a],f=u.getLength(),p=f===0?0:1-l/f;return u.getPointAt(p,t)}a++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,a=this.curves;i<a.length;i++){const l=a[i],u=l.isEllipseCurve?e*2:l.isLineCurve||l.isLineCurve3?1:l.isSplineCurve?e*l.points.length:e,f=l.getPoints(u);for(let p=0;p<f.length;p++){const m=f[p];n&&n.equals(m)||(t.push(m),n=m)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new Dy[i.type]().fromJSON(i))}return this}}class Ny extends l2{constructor(e){super(),this.type="Path",this.currentPoint=new ht,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new FS(this.currentPoint.clone(),new ht(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const a=new HS(this.currentPoint.clone(),new ht(e,t),new ht(n,i));return this.curves.push(a),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,a,l){const u=new PS(this.currentPoint.clone(),new ht(e,t),new ht(n,i),new ht(a,l));return this.curves.push(u),this.currentPoint.set(a,l),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new VS(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,a,l){const u=this.currentPoint.x,f=this.currentPoint.y;return this.absarc(e+u,t+f,n,i,a,l),this}absarc(e,t,n,i,a,l){return this.absellipse(e,t,n,n,i,a,l),this}ellipse(e,t,n,i,a,l,u,f){const p=this.currentPoint.x,m=this.currentPoint.y;return this.absellipse(e+p,t+m,n,i,a,l,u,f),this}absellipse(e,t,n,i,a,l,u,f){const p=new o_(e,t,n,i,a,l,u,f);if(this.curves.length>0){const v=p.getPoint(0);v.equals(this.currentPoint)||this.lineTo(v.x,v.y)}this.curves.push(p);const m=p.getPoint(1);return this.currentPoint.copy(m),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Ff extends Ny{constructor(e){super(e),this.uuid=Es(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new Ny().fromJSON(i))}return this}}function Y3(s,e,t=2){const n=e&&e.length,i=n?e[0]*t:s.length;let a=u2(s,0,i,t,!0);const l=[];if(!a||a.next===a.prev)return l;let u,f,p;if(n&&(a=K3(s,e,a,t)),s.length>80*t){u=1/0,f=1/0;let m=-1/0,v=-1/0;for(let _=t;_<i;_+=t){const x=s[_],b=s[_+1];x<u&&(u=x),b<f&&(f=b),x>m&&(m=x),b>v&&(v=b)}p=Math.max(m-u,v-f),p=p!==0?32767/p:0}return ig(a,l,t,u,f,p,0),l}function u2(s,e,t,n,i){let a;if(i===oU(s,e,t,n)>0)for(let l=e;l<t;l+=n)a=pE(l/n|0,s[l],s[l+1],a);else for(let l=t-n;l>=e;l-=n)a=pE(l/n|0,s[l],s[l+1],a);return a&&Gd(a,a.next)&&(rg(a),a=a.next),a}function Vf(s,e){if(!s)return s;e||(e=s);let t=s,n;do if(n=!1,!t.steiner&&(Gd(t,t.next)||Gi(t.prev,t,t.next)===0)){if(rg(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function ig(s,e,t,n,i,a,l){if(!s)return;!l&&a&&tU(s,n,i,a);let u=s;for(;s.prev!==s.next;){const f=s.prev,p=s.next;if(a?W3(s,n,i,a):q3(s)){e.push(f.i,s.i,p.i),rg(s),s=p.next,u=p.next;continue}if(s=p,s===u){l?l===1?(s=j3(Vf(s),e),ig(s,e,t,n,i,a,2)):l===2&&Z3(s,e,t,n,i,a):ig(Vf(s),e,t,n,i,a,1);break}}}function q3(s){const e=s.prev,t=s,n=s.next;if(Gi(e,t,n)>=0)return!1;const i=e.x,a=t.x,l=n.x,u=e.y,f=t.y,p=n.y,m=Math.min(i,a,l),v=Math.min(u,f,p),_=Math.max(i,a,l),x=Math.max(u,f,p);let b=n.next;for(;b!==e;){if(b.x>=m&&b.x<=_&&b.y>=v&&b.y<=x&&Im(i,u,a,f,l,p,b.x,b.y)&&Gi(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function W3(s,e,t,n){const i=s.prev,a=s,l=s.next;if(Gi(i,a,l)>=0)return!1;const u=i.x,f=a.x,p=l.x,m=i.y,v=a.y,_=l.y,x=Math.min(u,f,p),b=Math.min(m,v,_),R=Math.max(u,f,p),T=Math.max(m,v,_),E=Yx(x,b,e,t,n),w=Yx(R,T,e,t,n);let D=s.prevZ,U=s.nextZ;for(;D&&D.z>=E&&U&&U.z<=w;){if(D.x>=x&&D.x<=R&&D.y>=b&&D.y<=T&&D!==i&&D!==l&&Im(u,m,f,v,p,_,D.x,D.y)&&Gi(D.prev,D,D.next)>=0||(D=D.prevZ,U.x>=x&&U.x<=R&&U.y>=b&&U.y<=T&&U!==i&&U!==l&&Im(u,m,f,v,p,_,U.x,U.y)&&Gi(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;D&&D.z>=E;){if(D.x>=x&&D.x<=R&&D.y>=b&&D.y<=T&&D!==i&&D!==l&&Im(u,m,f,v,p,_,D.x,D.y)&&Gi(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;U&&U.z<=w;){if(U.x>=x&&U.x<=R&&U.y>=b&&U.y<=T&&U!==i&&U!==l&&Im(u,m,f,v,p,_,U.x,U.y)&&Gi(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function j3(s,e){let t=s;do{const n=t.prev,i=t.next.next;!Gd(n,i)&&f2(n,t,t.next,i)&&ag(n,i)&&ag(i,n)&&(e.push(n.i,t.i,i.i),rg(t),rg(t.next),t=s=i),t=t.next}while(t!==s);return Vf(t)}function Z3(s,e,t,n,i,a){let l=s;do{let u=l.next.next;for(;u!==l.prev;){if(l.i!==u.i&&aU(l,u)){let f=h2(l,u);l=Vf(l,l.next),f=Vf(f,f.next),ig(l,e,t,n,i,a,0),ig(f,e,t,n,i,a,0);return}u=u.next}l=l.next}while(l!==s)}function K3(s,e,t,n){const i=[];for(let a=0,l=e.length;a<l;a++){const u=e[a]*n,f=a<l-1?e[a+1]*n:s.length,p=u2(s,u,f,n,!1);p===p.next&&(p.steiner=!0),i.push(iU(p))}i.sort(Q3);for(let a=0;a<i.length;a++)t=J3(i[a],t);return t}function Q3(s,e){let t=s.x-e.x;if(t===0&&(t=s.y-e.y,t===0)){const n=(s.next.y-s.y)/(s.next.x-s.x),i=(e.next.y-e.y)/(e.next.x-e.x);t=n-i}return t}function J3(s,e){const t=$3(s,e);if(!t)return e;const n=h2(t,s);return Vf(n,n.next),Vf(t,t.next)}function $3(s,e){let t=e;const n=s.x,i=s.y;let a=-1/0,l;if(Gd(s,t))return t;do{if(Gd(s,t.next))return t.next;if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const v=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(v<=n&&v>a&&(a=v,l=t.x<t.next.x?t:t.next,v===n))return l}t=t.next}while(t!==e);if(!l)return null;const u=l,f=l.x,p=l.y;let m=1/0;t=l;do{if(n>=t.x&&t.x>=f&&n!==t.x&&c2(i<p?n:a,i,f,p,i<p?a:n,i,t.x,t.y)){const v=Math.abs(i-t.y)/(n-t.x);ag(t,s)&&(v<m||v===m&&(t.x>l.x||t.x===l.x&&eU(l,t)))&&(l=t,m=v)}t=t.next}while(t!==u);return l}function eU(s,e){return Gi(s.prev,s,e.prev)<0&&Gi(e.next,s,s.next)<0}function tU(s,e,t,n){let i=s;do i.z===0&&(i.z=Yx(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==s);i.prevZ.nextZ=null,i.prevZ=null,nU(i)}function nU(s){let e,t=1;do{let n=s,i;s=null;let a=null;for(e=0;n;){e++;let l=n,u=0;for(let p=0;p<t&&(u++,l=l.nextZ,!!l);p++);let f=t;for(;u>0||f>0&&l;)u!==0&&(f===0||!l||n.z<=l.z)?(i=n,n=n.nextZ,u--):(i=l,l=l.nextZ,f--),a?a.nextZ=i:s=i,i.prevZ=a,a=i;n=l}a.nextZ=null,t*=2}while(e>1);return s}function Yx(s,e,t,n,i){return s=(s-t)*i|0,e=(e-n)*i|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function iU(s){let e=s,t=s;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==s);return t}function c2(s,e,t,n,i,a,l,u){return(i-l)*(e-u)>=(s-l)*(a-u)&&(s-l)*(n-u)>=(t-l)*(e-u)&&(t-l)*(a-u)>=(i-l)*(n-u)}function Im(s,e,t,n,i,a,l,u){return!(s===l&&e===u)&&c2(s,e,t,n,i,a,l,u)}function aU(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!rU(s,e)&&(ag(s,e)&&ag(e,s)&&sU(s,e)&&(Gi(s.prev,s,e.prev)||Gi(s,e.prev,e))||Gd(s,e)&&Gi(s.prev,s,s.next)>0&&Gi(e.prev,e,e.next)>0)}function Gi(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function Gd(s,e){return s.x===e.x&&s.y===e.y}function f2(s,e,t,n){const i=yv(Gi(s,e,t)),a=yv(Gi(s,e,n)),l=yv(Gi(t,n,s)),u=yv(Gi(t,n,e));return!!(i!==a&&l!==u||i===0&&vv(s,t,e)||a===0&&vv(s,n,e)||l===0&&vv(t,s,n)||u===0&&vv(t,e,n))}function vv(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function yv(s){return s>0?1:s<0?-1:0}function rU(s,e){let t=s;do{if(t.i!==s.i&&t.next.i!==s.i&&t.i!==e.i&&t.next.i!==e.i&&f2(t,t.next,s,e))return!0;t=t.next}while(t!==s);return!1}function ag(s,e){return Gi(s.prev,s,s.next)<0?Gi(s,e,s.next)>=0&&Gi(s,s.prev,e)>=0:Gi(s,e,s.prev)<0||Gi(s,s.next,e)<0}function sU(s,e){let t=s,n=!1;const i=(s.x+e.x)/2,a=(s.y+e.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&i<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==s);return n}function h2(s,e){const t=qx(s.i,s.x,s.y),n=qx(e.i,e.x,e.y),i=s.next,a=e.prev;return s.next=e,e.prev=s,t.next=i,i.prev=t,n.next=t,t.prev=n,a.next=n,n.prev=a,n}function pE(s,e,t,n){const i=qx(s,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function rg(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function qx(s,e,t){return{i:s,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function oU(s,e,t,n){let i=0;for(let a=e,l=t-n;a<t;a+=n)i+=(s[l]-s[a])*(s[a+1]+s[l+1]),l=a;return i}class lU{static triangulate(e,t,n=2){return Y3(e,t,n)}}class Do{static area(e){const t=e.length;let n=0;for(let i=t-1,a=0;a<t;i=a++)n+=e[i].x*e[a].y-e[a].x*e[i].y;return n*.5}static isClockWise(e){return Do.area(e)<0}static triangulateShape(e,t){const n=[],i=[],a=[];mE(e),gE(n,e);let l=e.length;t.forEach(mE);for(let f=0;f<t.length;f++)i.push(l),l+=t[f].length,gE(n,t[f]);const u=lU.triangulate(n,i);for(let f=0;f<u.length;f+=3)a.push(u.slice(f,f+3));return a}}function mE(s){const e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function gE(s,e){for(let t=0;t<e.length;t++)s.push(e[t].x),s.push(e[t].y)}class l_ extends vn{constructor(e=new Ff([new ht(.5,.5),new ht(-.5,.5),new ht(-.5,-.5),new ht(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],a=[];for(let u=0,f=e.length;u<f;u++){const p=e[u];l(p)}this.setAttribute("position",new Vt(i,3)),this.setAttribute("uv",new Vt(a,2)),this.computeVertexNormals();function l(u){const f=[],p=t.curveSegments!==void 0?t.curveSegments:12,m=t.steps!==void 0?t.steps:1,v=t.depth!==void 0?t.depth:1;let _=t.bevelEnabled!==void 0?t.bevelEnabled:!0,x=t.bevelThickness!==void 0?t.bevelThickness:.2,b=t.bevelSize!==void 0?t.bevelSize:x-.1,R=t.bevelOffset!==void 0?t.bevelOffset:0,T=t.bevelSegments!==void 0?t.bevelSegments:3;const E=t.extrudePath,w=t.UVGenerator!==void 0?t.UVGenerator:uU;let D,U=!1,I,O,P,B;E&&(D=E.getSpacedPoints(m),U=!0,_=!1,I=E.computeFrenetFrames(m,!1),O=new ne,P=new ne,B=new ne),_||(T=0,x=0,b=0,R=0);const N=u.extractPoints(p);let z=N.shape;const q=N.holes;if(!Do.isClockWise(z)){z=z.reverse();for(let Ie=0,Oe=q.length;Ie<Oe;Ie++){const Ue=q[Ie];Do.isClockWise(Ue)&&(q[Ie]=Ue.reverse())}}function Q(Ie){const Ue=10000000000000001e-36;let Le=Ie[0];for(let ze=1;ze<=Ie.length;ze++){const Pe=ze%Ie.length,Fe=Ie[Pe],Ne=Fe.x-Le.x,yt=Fe.y-Le.y,j=Ne*Ne+yt*yt,V=Math.max(Math.abs(Fe.x),Math.abs(Fe.y),Math.abs(Le.x),Math.abs(Le.y)),ve=Ue*V*V;if(j<=ve){Ie.splice(Pe,1),ze--;continue}Le=Fe}}Q(z),q.forEach(Q);const Z=q.length,ae=z;for(let Ie=0;Ie<Z;Ie++){const Oe=q[Ie];z=z.concat(Oe)}function G(Ie,Oe,Ue){return Oe||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ie.clone().addScaledVector(Oe,Ue)}const ee=z.length;function ie(Ie,Oe,Ue){let Le,ze,Pe;const Fe=Ie.x-Oe.x,Ne=Ie.y-Oe.y,yt=Ue.x-Ie.x,j=Ue.y-Ie.y,V=Fe*Fe+Ne*Ne,ve=Fe*j-Ne*yt;if(Math.abs(ve)>Number.EPSILON){const Be=Math.sqrt(V),De=Math.sqrt(yt*yt+j*j),Ae=Oe.x-Ne/Be,gt=Oe.y+Fe/Be,ct=Ue.x-j/De,_t=Ue.y+yt/De,bt=((ct-Ae)*j-(_t-gt)*yt)/(Fe*j-Ne*yt);Le=Ae+Fe*bt-Ie.x,ze=gt+Ne*bt-Ie.y;const ke=Le*Le+ze*ze;if(ke<=2)return new ht(Le,ze);Pe=Math.sqrt(ke/2)}else{let Be=!1;Fe>Number.EPSILON?yt>Number.EPSILON&&(Be=!0):Fe<-Number.EPSILON?yt<-Number.EPSILON&&(Be=!0):Math.sign(Ne)===Math.sign(j)&&(Be=!0),Be?(Le=-Ne,ze=Fe,Pe=Math.sqrt(V)):(Le=Fe,ze=Ne,Pe=Math.sqrt(V/2))}return new ht(Le/Pe,ze/Pe)}const fe=[];for(let Ie=0,Oe=ae.length,Ue=Oe-1,Le=Ie+1;Ie<Oe;Ie++,Ue++,Le++)Ue===Oe&&(Ue=0),Le===Oe&&(Le=0),fe[Ie]=ie(ae[Ie],ae[Ue],ae[Le]);const ce=[];let H,W=fe.concat();for(let Ie=0,Oe=Z;Ie<Oe;Ie++){const Ue=q[Ie];H=[];for(let Le=0,ze=Ue.length,Pe=ze-1,Fe=Le+1;Le<ze;Le++,Pe++,Fe++)Pe===ze&&(Pe=0),Fe===ze&&(Fe=0),H[Le]=ie(Ue[Le],Ue[Pe],Ue[Fe]);ce.push(H),W=W.concat(H)}let re;if(T===0)re=Do.triangulateShape(ae,q);else{const Ie=[],Oe=[];for(let Ue=0;Ue<T;Ue++){const Le=Ue/T,ze=x*Math.cos(Le*Math.PI/2),Pe=b*Math.sin(Le*Math.PI/2)+R;for(let Fe=0,Ne=ae.length;Fe<Ne;Fe++){const yt=G(ae[Fe],fe[Fe],Pe);We(yt.x,yt.y,-ze),Le===0&&Ie.push(yt)}for(let Fe=0,Ne=Z;Fe<Ne;Fe++){const yt=q[Fe];H=ce[Fe];const j=[];for(let V=0,ve=yt.length;V<ve;V++){const Be=G(yt[V],H[V],Pe);We(Be.x,Be.y,-ze),Le===0&&j.push(Be)}Le===0&&Oe.push(j)}}re=Do.triangulateShape(Ie,Oe)}const de=re.length,ge=b+R;for(let Ie=0;Ie<ee;Ie++){const Oe=_?G(z[Ie],W[Ie],ge):z[Ie];U?(P.copy(I.normals[0]).multiplyScalar(Oe.x),O.copy(I.binormals[0]).multiplyScalar(Oe.y),B.copy(D[0]).add(P).add(O),We(B.x,B.y,B.z)):We(Oe.x,Oe.y,0)}for(let Ie=1;Ie<=m;Ie++)for(let Oe=0;Oe<ee;Oe++){const Ue=_?G(z[Oe],W[Oe],ge):z[Oe];U?(P.copy(I.normals[Ie]).multiplyScalar(Ue.x),O.copy(I.binormals[Ie]).multiplyScalar(Ue.y),B.copy(D[Ie]).add(P).add(O),We(B.x,B.y,B.z)):We(Ue.x,Ue.y,v/m*Ie)}for(let Ie=T-1;Ie>=0;Ie--){const Oe=Ie/T,Ue=x*Math.cos(Oe*Math.PI/2),Le=b*Math.sin(Oe*Math.PI/2)+R;for(let ze=0,Pe=ae.length;ze<Pe;ze++){const Fe=G(ae[ze],fe[ze],Le);We(Fe.x,Fe.y,v+Ue)}for(let ze=0,Pe=q.length;ze<Pe;ze++){const Fe=q[ze];H=ce[ze];for(let Ne=0,yt=Fe.length;Ne<yt;Ne++){const j=G(Fe[Ne],H[Ne],Le);U?We(j.x,j.y+D[m-1].y,D[m-1].x+Ue):We(j.x,j.y,v+Ue)}}}oe(),he();function oe(){const Ie=i.length/3;if(_){let Oe=0,Ue=ee*Oe;for(let Le=0;Le<de;Le++){const ze=re[Le];rt(ze[2]+Ue,ze[1]+Ue,ze[0]+Ue)}Oe=m+T*2,Ue=ee*Oe;for(let Le=0;Le<de;Le++){const ze=re[Le];rt(ze[0]+Ue,ze[1]+Ue,ze[2]+Ue)}}else{for(let Oe=0;Oe<de;Oe++){const Ue=re[Oe];rt(Ue[2],Ue[1],Ue[0])}for(let Oe=0;Oe<de;Oe++){const Ue=re[Oe];rt(Ue[0]+ee*m,Ue[1]+ee*m,Ue[2]+ee*m)}}n.addGroup(Ie,i.length/3-Ie,0)}function he(){const Ie=i.length/3;let Oe=0;Ee(ae,Oe),Oe+=ae.length;for(let Ue=0,Le=q.length;Ue<Le;Ue++){const ze=q[Ue];Ee(ze,Oe),Oe+=ze.length}n.addGroup(Ie,i.length/3-Ie,1)}function Ee(Ie,Oe){let Ue=Ie.length;for(;--Ue>=0;){const Le=Ue;let ze=Ue-1;ze<0&&(ze=Ie.length-1);for(let Pe=0,Fe=m+T*2;Pe<Fe;Pe++){const Ne=ee*Pe,yt=ee*(Pe+1),j=Oe+Le+Ne,V=Oe+ze+Ne,ve=Oe+ze+yt,Be=Oe+Le+yt;st(j,V,ve,Be)}}}function We(Ie,Oe,Ue){f.push(Ie),f.push(Oe),f.push(Ue)}function rt(Ie,Oe,Ue){et(Ie),et(Oe),et(Ue);const Le=i.length/3,ze=w.generateTopUV(n,i,Le-3,Le-2,Le-1);se(ze[0]),se(ze[1]),se(ze[2])}function st(Ie,Oe,Ue,Le){et(Ie),et(Oe),et(Le),et(Oe),et(Ue),et(Le);const ze=i.length/3,Pe=w.generateSideWallUV(n,i,ze-6,ze-3,ze-2,ze-1);se(Pe[0]),se(Pe[1]),se(Pe[3]),se(Pe[1]),se(Pe[2]),se(Pe[3])}function et(Ie){i.push(f[Ie*3+0]),i.push(f[Ie*3+1]),i.push(f[Ie*3+2])}function se(Ie){a.push(Ie.x),a.push(Ie.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return cU(t,n,e)}static fromJSON(e,t){const n=[];for(let a=0,l=e.shapes.length;a<l;a++){const u=t[e.shapes[a]];n.push(u)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new Dy[i.type]().fromJSON(i)),new l_(n,e.options)}}const uU={generateTopUV:function(s,e,t,n,i){const a=e[t*3],l=e[t*3+1],u=e[n*3],f=e[n*3+1],p=e[i*3],m=e[i*3+1];return[new ht(a,l),new ht(u,f),new ht(p,m)]},generateSideWallUV:function(s,e,t,n,i,a){const l=e[t*3],u=e[t*3+1],f=e[t*3+2],p=e[n*3],m=e[n*3+1],v=e[n*3+2],_=e[i*3],x=e[i*3+1],b=e[i*3+2],R=e[a*3],T=e[a*3+1],E=e[a*3+2];return Math.abs(u-m)<Math.abs(l-p)?[new ht(l,1-f),new ht(p,1-v),new ht(_,1-b),new ht(R,1-E)]:[new ht(u,1-f),new ht(m,1-v),new ht(x,1-b),new ht(T,1-E)]}};function cU(s,e,t){if(t.shapes=[],Array.isArray(s))for(let n=0,i=s.length;n<i;n++){const a=s[n];t.shapes.push(a.uuid)}else t.shapes.push(s.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Sg extends Mc{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,a,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Sg(e.radius,e.detail)}}class u_ extends vn{constructor(e=[new ht(0,-.5),new ht(.5,0),new ht(0,.5)],t=12,n=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=rn(i,0,Math.PI*2);const a=[],l=[],u=[],f=[],p=[],m=1/t,v=new ne,_=new ht,x=new ne,b=new ne,R=new ne;let T=0,E=0;for(let w=0;w<=e.length-1;w++)switch(w){case 0:T=e[w+1].x-e[w].x,E=e[w+1].y-e[w].y,x.x=E*1,x.y=-T,x.z=E*0,R.copy(x),x.normalize(),f.push(x.x,x.y,x.z);break;case e.length-1:f.push(R.x,R.y,R.z);break;default:T=e[w+1].x-e[w].x,E=e[w+1].y-e[w].y,x.x=E*1,x.y=-T,x.z=E*0,b.copy(x),x.x+=R.x,x.y+=R.y,x.z+=R.z,x.normalize(),f.push(x.x,x.y,x.z),R.copy(b)}for(let w=0;w<=t;w++){const D=n+w*m*i,U=Math.sin(D),I=Math.cos(D);for(let O=0;O<=e.length-1;O++){v.x=e[O].x*U,v.y=e[O].y,v.z=e[O].x*I,l.push(v.x,v.y,v.z),_.x=w/t,_.y=O/(e.length-1),u.push(_.x,_.y);const P=f[3*O+0]*U,B=f[3*O+1],N=f[3*O+0]*I;p.push(P,B,N)}}for(let w=0;w<t;w++)for(let D=0;D<e.length-1;D++){const U=D+w*e.length,I=U,O=U+e.length,P=U+e.length+1,B=U+1;a.push(I,O,B),a.push(P,B,O)}this.setIndex(a),this.setAttribute("position",new Vt(l,3)),this.setAttribute("uv",new Vt(u,2)),this.setAttribute("normal",new Vt(p,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new u_(e.points,e.segments,e.phiStart,e.phiLength)}}class Mg extends Mc{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Mg(e.radius,e.detail)}}class zo extends vn{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const a=e/2,l=t/2,u=Math.floor(n),f=Math.floor(i),p=u+1,m=f+1,v=e/u,_=t/f,x=[],b=[],R=[],T=[];for(let E=0;E<m;E++){const w=E*_-l;for(let D=0;D<p;D++){const U=D*v-a;b.push(U,-w,0),R.push(0,0,1),T.push(D/u),T.push(1-E/f)}}for(let E=0;E<f;E++)for(let w=0;w<u;w++){const D=w+p*E,U=w+p*(E+1),I=w+1+p*(E+1),O=w+1+p*E;x.push(D,U,O),x.push(U,I,O)}this.setIndex(x),this.setAttribute("position",new Vt(b,3)),this.setAttribute("normal",new Vt(R,3)),this.setAttribute("uv",new Vt(T,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zo(e.width,e.height,e.widthSegments,e.heightSegments)}}class c_ extends vn{constructor(e=.5,t=1,n=32,i=1,a=0,l=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:a,thetaLength:l},n=Math.max(3,n),i=Math.max(1,i);const u=[],f=[],p=[],m=[];let v=e;const _=(t-e)/i,x=new ne,b=new ht;for(let R=0;R<=i;R++){for(let T=0;T<=n;T++){const E=a+T/n*l;x.x=v*Math.cos(E),x.y=v*Math.sin(E),f.push(x.x,x.y,x.z),p.push(0,0,1),b.x=(x.x/t+1)/2,b.y=(x.y/t+1)/2,m.push(b.x,b.y)}v+=_}for(let R=0;R<i;R++){const T=R*(n+1);for(let E=0;E<n;E++){const w=E+T,D=w,U=w+n+1,I=w+n+2,O=w+1;u.push(D,U,O),u.push(U,I,O)}}this.setIndex(u),this.setAttribute("position",new Vt(f,3)),this.setAttribute("normal",new Vt(p,3)),this.setAttribute("uv",new Vt(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new c_(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class f_ extends vn{constructor(e=new Ff([new ht(0,.5),new ht(-.5,-.5),new ht(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],a=[],l=[];let u=0,f=0;if(Array.isArray(e)===!1)p(e);else for(let m=0;m<e.length;m++)p(e[m]),this.addGroup(u,f,m),u+=f,f=0;this.setIndex(n),this.setAttribute("position",new Vt(i,3)),this.setAttribute("normal",new Vt(a,3)),this.setAttribute("uv",new Vt(l,2));function p(m){const v=i.length/3,_=m.extractPoints(t);let x=_.shape;const b=_.holes;Do.isClockWise(x)===!1&&(x=x.reverse());for(let T=0,E=b.length;T<E;T++){const w=b[T];Do.isClockWise(w)===!0&&(b[T]=w.reverse())}const R=Do.triangulateShape(x,b);for(let T=0,E=b.length;T<E;T++){const w=b[T];x=x.concat(w)}for(let T=0,E=x.length;T<E;T++){const w=x[T];i.push(w.x,w.y,0),a.push(0,0,1),l.push(w.x,w.y)}for(let T=0,E=R.length;T<E;T++){const w=R[T],D=w[0]+v,U=w[1]+v,I=w[2]+v;n.push(D,U,I),f+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return fU(t,e)}static fromJSON(e,t){const n=[];for(let i=0,a=e.shapes.length;i<a;i++){const l=t[e.shapes[i]];n.push(l)}return new f_(n,e.curveSegments)}}function fU(s,e){if(e.shapes=[],Array.isArray(s))for(let t=0,n=s.length;t<n;t++){const i=s[t];e.shapes.push(i.uuid)}else e.shapes.push(s.uuid);return e}class bg extends vn{constructor(e=1,t=32,n=16,i=0,a=Math.PI*2,l=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:a,thetaStart:l,thetaLength:u},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const f=Math.min(l+u,Math.PI);let p=0;const m=[],v=new ne,_=new ne,x=[],b=[],R=[],T=[];for(let E=0;E<=n;E++){const w=[],D=E/n;let U=0;E===0&&l===0?U=.5/t:E===n&&f===Math.PI&&(U=-.5/t);for(let I=0;I<=t;I++){const O=I/t;v.x=-e*Math.cos(i+O*a)*Math.sin(l+D*u),v.y=e*Math.cos(l+D*u),v.z=e*Math.sin(i+O*a)*Math.sin(l+D*u),b.push(v.x,v.y,v.z),_.copy(v).normalize(),R.push(_.x,_.y,_.z),T.push(O+U,1-D),w.push(p++)}m.push(w)}for(let E=0;E<n;E++)for(let w=0;w<t;w++){const D=m[E][w+1],U=m[E][w],I=m[E+1][w],O=m[E+1][w+1];(E!==0||l>0)&&x.push(D,U,O),(E!==n-1||f<Math.PI)&&x.push(U,I,O)}this.setIndex(x),this.setAttribute("position",new Vt(b,3)),this.setAttribute("normal",new Vt(R,3)),this.setAttribute("uv",new Vt(T,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bg(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class h_ extends Mc{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new h_(e.radius,e.detail)}}class d_ extends vn{constructor(e=1,t=.4,n=12,i=48,a=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:a},n=Math.floor(n),i=Math.floor(i);const l=[],u=[],f=[],p=[],m=new ne,v=new ne,_=new ne;for(let x=0;x<=n;x++)for(let b=0;b<=i;b++){const R=b/i*a,T=x/n*Math.PI*2;v.x=(e+t*Math.cos(T))*Math.cos(R),v.y=(e+t*Math.cos(T))*Math.sin(R),v.z=t*Math.sin(T),u.push(v.x,v.y,v.z),m.x=e*Math.cos(R),m.y=e*Math.sin(R),_.subVectors(v,m).normalize(),f.push(_.x,_.y,_.z),p.push(b/i),p.push(x/n)}for(let x=1;x<=n;x++)for(let b=1;b<=i;b++){const R=(i+1)*x+b-1,T=(i+1)*(x-1)+b-1,E=(i+1)*(x-1)+b,w=(i+1)*x+b;l.push(R,T,w),l.push(T,E,w)}this.setIndex(l),this.setAttribute("position",new Vt(u,3)),this.setAttribute("normal",new Vt(f,3)),this.setAttribute("uv",new Vt(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new d_(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class p_ extends vn{constructor(e=1,t=.4,n=64,i=8,a=2,l=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:a,q:l},n=Math.floor(n),i=Math.floor(i);const u=[],f=[],p=[],m=[],v=new ne,_=new ne,x=new ne,b=new ne,R=new ne,T=new ne,E=new ne;for(let D=0;D<=n;++D){const U=D/n*a*Math.PI*2;w(U,a,l,e,x),w(U+.01,a,l,e,b),T.subVectors(b,x),E.addVectors(b,x),R.crossVectors(T,E),E.crossVectors(R,T),R.normalize(),E.normalize();for(let I=0;I<=i;++I){const O=I/i*Math.PI*2,P=-t*Math.cos(O),B=t*Math.sin(O);v.x=x.x+(P*E.x+B*R.x),v.y=x.y+(P*E.y+B*R.y),v.z=x.z+(P*E.z+B*R.z),f.push(v.x,v.y,v.z),_.subVectors(v,x).normalize(),p.push(_.x,_.y,_.z),m.push(D/n),m.push(I/i)}}for(let D=1;D<=n;D++)for(let U=1;U<=i;U++){const I=(i+1)*(D-1)+(U-1),O=(i+1)*D+(U-1),P=(i+1)*D+U,B=(i+1)*(D-1)+U;u.push(I,O,B),u.push(O,P,B)}this.setIndex(u),this.setAttribute("position",new Vt(f,3)),this.setAttribute("normal",new Vt(p,3)),this.setAttribute("uv",new Vt(m,2));function w(D,U,I,O,P){const B=Math.cos(D),N=Math.sin(D),z=I/U*D,q=Math.cos(z);P.x=O*(2+q)*.5*B,P.y=O*(2+q)*N*.5,P.z=O*Math.sin(z)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new p_(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class m_ extends vn{constructor(e=new GS(new ne(-1,-1,0),new ne(-1,1,0),new ne(1,1,0)),t=64,n=1,i=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:a};const l=e.computeFrenetFrames(t,a);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;const u=new ne,f=new ne,p=new ht;let m=new ne;const v=[],_=[],x=[],b=[];R(),this.setIndex(b),this.setAttribute("position",new Vt(v,3)),this.setAttribute("normal",new Vt(_,3)),this.setAttribute("uv",new Vt(x,2));function R(){for(let D=0;D<t;D++)T(D);T(a===!1?t:0),w(),E()}function T(D){m=e.getPointAt(D/t,m);const U=l.normals[D],I=l.binormals[D];for(let O=0;O<=i;O++){const P=O/i*Math.PI*2,B=Math.sin(P),N=-Math.cos(P);f.x=N*U.x+B*I.x,f.y=N*U.y+B*I.y,f.z=N*U.z+B*I.z,f.normalize(),_.push(f.x,f.y,f.z),u.x=m.x+n*f.x,u.y=m.y+n*f.y,u.z=m.z+n*f.z,v.push(u.x,u.y,u.z)}}function E(){for(let D=1;D<=t;D++)for(let U=1;U<=i;U++){const I=(i+1)*(D-1)+(U-1),O=(i+1)*D+(U-1),P=(i+1)*D+U,B=(i+1)*(D-1)+U;b.push(I,O,B),b.push(O,P,B)}}function w(){for(let D=0;D<=t;D++)for(let U=0;U<=i;U++)p.x=D/t,p.y=U/i,x.push(p.x,p.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new m_(new Dy[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class d2 extends vn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,i=new ne,a=new ne;if(e.index!==null){const l=e.attributes.position,u=e.index;let f=e.groups;f.length===0&&(f=[{start:0,count:u.count,materialIndex:0}]);for(let p=0,m=f.length;p<m;++p){const v=f[p],_=v.start,x=v.count;for(let b=_,R=_+x;b<R;b+=3)for(let T=0;T<3;T++){const E=u.getX(b+T),w=u.getX(b+(T+1)%3);i.fromBufferAttribute(l,E),a.fromBufferAttribute(l,w),vE(i,a,n)===!0&&(t.push(i.x,i.y,i.z),t.push(a.x,a.y,a.z))}}}else{const l=e.attributes.position;for(let u=0,f=l.count/3;u<f;u++)for(let p=0;p<3;p++){const m=3*u+p,v=3*u+(p+1)%3;i.fromBufferAttribute(l,m),a.fromBufferAttribute(l,v),vE(i,a,n)===!0&&(t.push(i.x,i.y,i.z),t.push(a.x,a.y,a.z))}}this.setAttribute("position",new Vt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function vE(s,e,t){const n=`${s.x},${s.y},${s.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${s.x},${s.y},${s.z}`;return t.has(n)===!0||t.has(i)===!0?!1:(t.add(n),t.add(i),!0)}var yE=Object.freeze({__proto__:null,BoxGeometry:Zf,CapsuleGeometry:a_,CircleGeometry:r_,ConeGeometry:xg,CylinderGeometry:_g,DodecahedronGeometry:s_,EdgesGeometry:i2,ExtrudeGeometry:l_,IcosahedronGeometry:Sg,LatheGeometry:u_,OctahedronGeometry:Mg,PlaneGeometry:zo,PolyhedronGeometry:Mc,RingGeometry:c_,ShapeGeometry:f_,SphereGeometry:bg,TetrahedronGeometry:h_,TorusGeometry:d_,TorusKnotGeometry:p_,TubeGeometry:m_,WireframeGeometry:d2});class p2 extends ba{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Nt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class m2 extends Fr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class qd extends ba{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Nt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sc,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ns,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Qs extends qd{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ht(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return rn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Nt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Nt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Nt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class g2 extends ba{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Nt(16777215),this.specular=new Nt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sc,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ns,this.combine=fg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class v2 extends ba{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Nt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sc,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class y2 extends ba{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sc,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class _2 extends ba{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Nt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sc,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ns,this.combine=fg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class g_ extends ba{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BA,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class v_ extends ba{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class x2 extends ba{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Nt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sc,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class S2 extends cr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function zf(s,e){return!s||s.constructor===e?s:typeof e.BYTES_PER_ELEMENT=="number"?new e(s):Array.prototype.slice.call(s)}function M2(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function b2(s){function e(i,a){return s[i]-s[a]}const t=s.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(e),n}function Wx(s,e,t){const n=s.length,i=new s.constructor(n);for(let a=0,l=0;l!==n;++a){const u=t[a]*e;for(let f=0;f!==e;++f)i[l++]=s[u+f]}return i}function kS(s,e,t,n){let i=1,a=s[0];for(;a!==void 0&&a[n]===void 0;)a=s[i++];if(a===void 0)return;let l=a[n];if(l!==void 0)if(Array.isArray(l))do l=a[n],l!==void 0&&(e.push(a.time),t.push(...l)),a=s[i++];while(a!==void 0);else if(l.toArray!==void 0)do l=a[n],l!==void 0&&(e.push(a.time),l.toArray(t,t.length)),a=s[i++];while(a!==void 0);else do l=a[n],l!==void 0&&(e.push(a.time),t.push(l)),a=s[i++];while(a!==void 0)}function hU(s,e,t,n,i=30){const a=s.clone();a.name=e;const l=[];for(let f=0;f<a.tracks.length;++f){const p=a.tracks[f],m=p.getValueSize(),v=[],_=[];for(let x=0;x<p.times.length;++x){const b=p.times[x]*i;if(!(b<t||b>=n)){v.push(p.times[x]);for(let R=0;R<m;++R)_.push(p.values[x*m+R])}}v.length!==0&&(p.times=zf(v,p.times.constructor),p.values=zf(_,p.values.constructor),l.push(p))}a.tracks=l;let u=1/0;for(let f=0;f<a.tracks.length;++f)u>a.tracks[f].times[0]&&(u=a.tracks[f].times[0]);for(let f=0;f<a.tracks.length;++f)a.tracks[f].shift(-1*u);return a.resetDuration(),a}function dU(s,e=0,t=s,n=30){n<=0&&(n=30);const i=t.tracks.length,a=e/n;for(let l=0;l<i;++l){const u=t.tracks[l],f=u.ValueTypeName;if(f==="bool"||f==="string")continue;const p=s.tracks.find(function(E){return E.name===u.name&&E.ValueTypeName===f});if(p===void 0)continue;let m=0;const v=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=v/3);let _=0;const x=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=x/3);const b=u.times.length-1;let R;if(a<=u.times[0]){const E=m,w=v-m;R=u.values.slice(E,w)}else if(a>=u.times[b]){const E=b*v+m,w=E+v-m;R=u.values.slice(E,w)}else{const E=u.createInterpolant(),w=m,D=v-m;E.evaluate(a),R=E.resultBuffer.slice(w,D)}f==="quaternion"&&new ua().fromArray(R).normalize().conjugate().toArray(R);const T=p.times.length;for(let E=0;E<T;++E){const w=E*x+_;if(f==="quaternion")ua.multiplyQuaternionsFlat(p.values,w,R,0,p.values,w);else{const D=x-_*2;for(let U=0;U<D;++U)p.values[w+U]-=R[U]}}}return s.blendMode=xS,s}class pU{static convertArray(e,t){return zf(e,t)}static isTypedArray(e){return M2(e)}static getKeyframeOrder(e){return b2(e)}static sortedArray(e,t,n){return Wx(e,t,n)}static flattenJSON(e,t,n,i){kS(e,t,n,i)}static subclip(e,t,n,i,a=30){return hU(e,t,n,i,a)}static makeClipAdditive(e,t=0,n=e,i=30){return dU(e,t,n,i)}}class Wd{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],a=t[n-1];e:{t:{let l;n:{i:if(!(e<i)){for(let u=n+2;;){if(i===void 0){if(e<a)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===u)break;if(a=i,i=t[++n],e<i)break t}l=t.length;break n}if(!(e>=a)){const u=t[1];e<u&&(n=2,a=u);for(let f=n-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===f)break;if(i=a,a=t[--n-1],e>=a)break t}l=n,n=0;break n}break e}for(;n<l;){const u=n+l>>>1;e<t[u]?l=u:n=u+1}if(i=t[n],a=t[n-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,a,i)}return this.interpolate_(n,a,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,a=e*i;for(let l=0;l!==i;++l)t[l]=n[a+l];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class E2 extends Wd{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Nf,endingEnd:Nf}}intervalChanged_(e,t,n){const i=this.parameterPositions;let a=e-2,l=e+1,u=i[a],f=i[l];if(u===void 0)switch(this.getSettings_().endingStart){case Of:a=e,u=2*t-n;break;case Jm:a=i.length-2,u=t+i[a]-i[a+1];break;default:a=e,u=n}if(f===void 0)switch(this.getSettings_().endingEnd){case Of:l=e,f=2*n-t;break;case Jm:l=1,f=n+i[1]-i[0];break;default:l=e-1,f=t}const p=(n-t)*.5,m=this.valueSize;this._weightPrev=p/(t-u),this._weightNext=p/(f-n),this._offsetPrev=a*m,this._offsetNext=l*m}interpolate_(e,t,n,i){const a=this.resultBuffer,l=this.sampleValues,u=this.valueSize,f=e*u,p=f-u,m=this._offsetPrev,v=this._offsetNext,_=this._weightPrev,x=this._weightNext,b=(n-t)/(i-t),R=b*b,T=R*b,E=-_*T+2*_*R-_*b,w=(1+_)*T+(-1.5-2*_)*R+(-.5+_)*b+1,D=(-1-x)*T+(1.5+x)*R+.5*b,U=x*T-x*R;for(let I=0;I!==u;++I)a[I]=E*l[m+I]+w*l[p+I]+D*l[f+I]+U*l[v+I];return a}}class XS extends Wd{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const a=this.resultBuffer,l=this.sampleValues,u=this.valueSize,f=e*u,p=f-u,m=(n-t)/(i-t),v=1-m;for(let _=0;_!==u;++_)a[_]=l[p+_]*v+l[f+_]*m;return a}}class T2 extends Wd{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Js{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=zf(t,this.TimeBufferType),this.values=zf(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:zf(e.times,Array),values:zf(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new T2(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new XS(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new E2(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Ld:t=this.InterpolantFactoryMethodDiscrete;break;case zd:t=this.InterpolantFactoryMethodLinear;break;case Fv:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ld;case this.InterpolantFactoryMethodLinear:return zd;case this.InterpolantFactoryMethodSmooth:return Fv}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let a=0,l=i-1;for(;a!==i&&n[a]<e;)++a;for(;l!==-1&&n[l]>t;)--l;if(++l,a!==0||l!==i){a>=l&&(l=Math.max(l,1),a=l-1);const u=this.getValueSize();this.times=n.slice(a,l),this.values=this.values.slice(a*u,l*u)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,a=n.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let l=null;for(let u=0;u!==a;u++){const f=n[u];if(typeof f=="number"&&isNaN(f)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,u,f),e=!1;break}if(l!==null&&l>f){console.error("THREE.KeyframeTrack: Out of order keys.",this,u,f,l),e=!1;break}l=f}if(i!==void 0&&M2(i))for(let u=0,f=i.length;u!==f;++u){const p=i[u];if(isNaN(p)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,p),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===Fv,a=e.length-1;let l=1;for(let u=1;u<a;++u){let f=!1;const p=e[u],m=e[u+1];if(p!==m&&(u!==1||p!==e[0]))if(i)f=!0;else{const v=u*n,_=v-n,x=v+n;for(let b=0;b!==n;++b){const R=t[v+b];if(R!==t[_+b]||R!==t[x+b]){f=!0;break}}}if(f){if(u!==l){e[l]=e[u];const v=u*n,_=l*n;for(let x=0;x!==n;++x)t[_+x]=t[v+x]}++l}}if(a>0){e[l]=e[a];for(let u=a*n,f=l*n,p=0;p!==n;++p)t[f+p]=t[u+p];++l}return l!==e.length?(this.times=e.slice(0,l),this.values=t.slice(0,l*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,i=new n(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}Js.prototype.ValueTypeName="";Js.prototype.TimeBufferType=Float32Array;Js.prototype.ValueBufferType=Float32Array;Js.prototype.DefaultInterpolation=zd;class Kf extends Js{constructor(e,t,n){super(e,t,n)}}Kf.prototype.ValueTypeName="bool";Kf.prototype.ValueBufferType=Array;Kf.prototype.DefaultInterpolation=Ld;Kf.prototype.InterpolantFactoryMethodLinear=void 0;Kf.prototype.InterpolantFactoryMethodSmooth=void 0;class YS extends Js{constructor(e,t,n,i){super(e,t,n,i)}}YS.prototype.ValueTypeName="color";class kf extends Js{constructor(e,t,n,i){super(e,t,n,i)}}kf.prototype.ValueTypeName="number";class A2 extends Wd{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const a=this.resultBuffer,l=this.sampleValues,u=this.valueSize,f=(n-t)/(i-t);let p=e*u;for(let m=p+u;p!==m;p+=4)ua.slerpFlat(a,0,l,p-u,l,p,f);return a}}class Xf extends Js{constructor(e,t,n,i){super(e,t,n,i)}InterpolantFactoryMethodLinear(e){return new A2(this.times,this.values,this.getValueSize(),e)}}Xf.prototype.ValueTypeName="quaternion";Xf.prototype.InterpolantFactoryMethodSmooth=void 0;class Qf extends Js{constructor(e,t,n){super(e,t,n)}}Qf.prototype.ValueTypeName="string";Qf.prototype.ValueBufferType=Array;Qf.prototype.DefaultInterpolation=Ld;Qf.prototype.InterpolantFactoryMethodLinear=void 0;Qf.prototype.InterpolantFactoryMethodSmooth=void 0;class Yf extends Js{constructor(e,t,n,i){super(e,t,n,i)}}Yf.prototype.ValueTypeName="vector";class Vd{constructor(e="",t=-1,n=[],i=jy){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=Es(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let l=0,u=n.length;l!==u;++l)t.push(gU(n[l]).scale(i));const a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a.userData=JSON.parse(e.userData||"{}"),a}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let a=0,l=n.length;a!==l;++a)t.push(Js.toJSON(n[a]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const a=t.length,l=[];for(let u=0;u<a;u++){let f=[],p=[];f.push((u+a-1)%a,u,(u+1)%a),p.push(0,1,0);const m=b2(f);f=Wx(f,1,m),p=Wx(p,1,m),!i&&f[0]===0&&(f.push(a),p.push(p[0])),l.push(new kf(".morphTargetInfluences["+t[u].name+"]",f,p).scale(1/n))}return new this(e,-1,l)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},a=/^([\w-]*?)([\d]+)$/;for(let u=0,f=e.length;u<f;u++){const p=e[u],m=p.name.match(a);if(m&&m.length>1){const v=m[1];let _=i[v];_||(i[v]=_=[]),_.push(p)}}const l=[];for(const u in i)l.push(this.CreateFromMorphTargetSequence(u,i[u],t,n));return l}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(v,_,x,b,R){if(x.length!==0){const T=[],E=[];kS(x,T,E,b),T.length!==0&&R.push(new v(_,T,E))}},i=[],a=e.name||"default",l=e.fps||30,u=e.blendMode;let f=e.length||-1;const p=e.hierarchy||[];for(let v=0;v<p.length;v++){const _=p[v].keys;if(!(!_||_.length===0))if(_[0].morphTargets){const x={};let b;for(b=0;b<_.length;b++)if(_[b].morphTargets)for(let R=0;R<_[b].morphTargets.length;R++)x[_[b].morphTargets[R]]=-1;for(const R in x){const T=[],E=[];for(let w=0;w!==_[b].morphTargets.length;++w){const D=_[b];T.push(D.time),E.push(D.morphTarget===R?1:0)}i.push(new kf(".morphTargetInfluence["+R+"]",T,E))}f=x.length*l}else{const x=".bones["+t[v].name+"]";n(Yf,x+".position",_,"pos",i),n(Xf,x+".quaternion",_,"rot",i),n(Yf,x+".scale",_,"scl",i)}}return i.length===0?null:new this(a,f,i,u)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,i=e.length;n!==i;++n){const a=this.tracks[n];t=Math.max(t,a.times[a.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function mU(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return kf;case"vector":case"vector2":case"vector3":case"vector4":return Yf;case"color":return YS;case"quaternion":return Xf;case"bool":case"boolean":return Kf;case"string":return Qf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+s)}function gU(s){if(s.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=mU(s.type);if(s.times===void 0){const t=[],n=[];kS(s.keys,t,n,"value"),s.times=t,s.values=n}return e.parse!==void 0?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}const gl={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class y_{constructor(e,t,n){const i=this;let a=!1,l=0,u=0,f;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.abortController=new AbortController,this.itemStart=function(m){u++,a===!1&&i.onStart!==void 0&&i.onStart(m,l,u),a=!0},this.itemEnd=function(m){l++,i.onProgress!==void 0&&i.onProgress(m,l,u),l===u&&(a=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(m){i.onError!==void 0&&i.onError(m)},this.resolveURL=function(m){return f?f(m):m},this.setURLModifier=function(m){return f=m,this},this.addHandler=function(m,v){return p.push(m,v),this},this.removeHandler=function(m){const v=p.indexOf(m);return v!==-1&&p.splice(v,2),this},this.getHandler=function(m){for(let v=0,_=p.length;v<_;v+=2){const x=p[v],b=p[v+1];if(x.global&&(x.lastIndex=0),x.test(m))return b}return null},this.abort=function(){return this.abortController.abort(),this.abortController=new AbortController,this}}}const R2=new y_;class fr{constructor(e){this.manager=e!==void 0?e:R2,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,a){n.load(e,i,t,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}fr.DEFAULT_MATERIAL_NAME="__DEFAULT";const fu={};class vU extends Error{constructor(e,t){super(e),this.response=t}}class Br extends fr{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=gl.get(`file:${e}`);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(a),this.manager.itemEnd(e)},0),a;if(fu[e]!==void 0){fu[e].push({onLoad:t,onProgress:n,onError:i});return}fu[e]=[],fu[e].push({onLoad:t,onProgress:n,onError:i});const l=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),u=this.mimeType,f=this.responseType;fetch(l).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const m=fu[e],v=p.body.getReader(),_=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),x=_?parseInt(_):0,b=x!==0;let R=0;const T=new ReadableStream({start(E){w();function w(){v.read().then(({done:D,value:U})=>{if(D)E.close();else{R+=U.byteLength;const I=new ProgressEvent("progress",{lengthComputable:b,loaded:R,total:x});for(let O=0,P=m.length;O<P;O++){const B=m[O];B.onProgress&&B.onProgress(I)}E.enqueue(U),w()}},D=>{E.error(D)})}}});return new Response(T)}else throw new vU(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(f){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(m=>new DOMParser().parseFromString(m,u));case"json":return p.json();default:if(u==="")return p.text();{const v=/charset="?([^;"\s]*)"?/i.exec(u),_=v&&v[1]?v[1].toLowerCase():void 0,x=new TextDecoder(_);return p.arrayBuffer().then(b=>x.decode(b))}}}).then(p=>{gl.add(`file:${e}`,p);const m=fu[e];delete fu[e];for(let v=0,_=m.length;v<_;v++){const x=m[v];x.onLoad&&x.onLoad(p)}}).catch(p=>{const m=fu[e];if(m===void 0)throw this.manager.itemError(e),p;delete fu[e];for(let v=0,_=m.length;v<_;v++){const x=m[v];x.onError&&x.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class yU extends fr{constructor(e){super(e)}load(e,t,n,i){const a=this,l=new Br(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){try{t(a.parse(JSON.parse(u)))}catch(f){i?i(f):console.error(f),a.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=Vd.parse(e[n]);t.push(i)}return t}}class _U extends fr{constructor(e){super(e)}load(e,t,n,i){const a=this,l=[],u=new i_,f=new Br(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(a.withCredentials);let p=0;function m(v){f.load(e[v],function(_){const x=a.parse(_,!0);l[v]={width:x.width,height:x.height,format:x.format,mipmaps:x.mipmaps},p+=1,p===6&&(x.mipmapCount===1&&(u.minFilter=Wn),u.image=l,u.format=x.format,u.needsUpdate=!0,t&&t(u))},n,i)}if(Array.isArray(e))for(let v=0,_=e.length;v<_;++v)m(v);else f.load(e,function(v){const _=a.parse(v,!0);if(_.isCubemap){const x=_.mipmaps.length/_.mipmapCount;for(let b=0;b<x;b++){l[b]={mipmaps:[]};for(let R=0;R<_.mipmapCount;R++)l[b].mipmaps.push(_.mipmaps[b*_.mipmapCount+R]),l[b].format=_.format,l[b].width=_.width,l[b].height=_.height}u.image=l}else u.image.width=_.width,u.image.height=_.height,u.mipmaps=_.mipmaps;_.mipmapCount===1&&(u.minFilter=Wn),u.format=_.format,u.needsUpdate=!0,t&&t(u)},n,i);return u}}const dd=new WeakMap;class sg extends fr{constructor(e){super(e)}load(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,l=gl.get(`image:${e}`);if(l!==void 0){if(l.complete===!0)a.manager.itemStart(e),setTimeout(function(){t&&t(l),a.manager.itemEnd(e)},0);else{let v=dd.get(l);v===void 0&&(v=[],dd.set(l,v)),v.push({onLoad:t,onError:i})}return l}const u=tg("img");function f(){m(),t&&t(this);const v=dd.get(this)||[];for(let _=0;_<v.length;_++){const x=v[_];x.onLoad&&x.onLoad(this)}dd.delete(this),a.manager.itemEnd(e)}function p(v){m(),i&&i(v),gl.remove(`image:${e}`);const _=dd.get(this)||[];for(let x=0;x<_.length;x++){const b=_[x];b.onError&&b.onError(v)}dd.delete(this),a.manager.itemError(e),a.manager.itemEnd(e)}function m(){u.removeEventListener("load",f,!1),u.removeEventListener("error",p,!1)}return u.addEventListener("load",f,!1),u.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),gl.add(`image:${e}`,u),a.manager.itemStart(e),u.src=e,u}}class C2 extends fr{constructor(e){super(e)}load(e,t,n,i){const a=new mg;a.colorSpace=zi;const l=new sg(this.manager);l.setCrossOrigin(this.crossOrigin),l.setPath(this.path);let u=0;function f(p){l.load(e[p],function(m){a.images[p]=m,u++,u===6&&(a.needsUpdate=!0,t&&t(a))},void 0,i)}for(let p=0;p<e.length;++p)f(p);return a}}class qS extends fr{constructor(e){super(e)}load(e,t,n,i){const a=this,l=new No,u=new Br(this.manager);return u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setPath(this.path),u.setWithCredentials(a.withCredentials),u.load(e,function(f){let p;try{p=a.parse(f)}catch(m){if(i!==void 0)i(m);else{console.error(m);return}}p.image!==void 0?l.image=p.image:p.data!==void 0&&(l.image.width=p.width,l.image.height=p.height,l.image.data=p.data),l.wrapS=p.wrapS!==void 0?p.wrapS:ta,l.wrapT=p.wrapT!==void 0?p.wrapT:ta,l.magFilter=p.magFilter!==void 0?p.magFilter:Wn,l.minFilter=p.minFilter!==void 0?p.minFilter:Wn,l.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.colorSpace!==void 0&&(l.colorSpace=p.colorSpace),p.flipY!==void 0&&(l.flipY=p.flipY),p.format!==void 0&&(l.format=p.format),p.type!==void 0&&(l.type=p.type),p.mipmaps!==void 0&&(l.mipmaps=p.mipmaps,l.minFilter=Zs),p.mipmapCount===1&&(l.minFilter=Wn),p.generateMipmaps!==void 0&&(l.generateMipmaps=p.generateMipmaps),l.needsUpdate=!0,t&&t(l,p)},n,i),l}}class Eg extends fr{constructor(e){super(e)}load(e,t,n,i){const a=new Zn,l=new sg(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(e,function(u){a.image=u,a.needsUpdate=!0,t!==void 0&&t(a)},n,i),a}}class bc extends Xn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Nt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class w2 extends bc{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Xn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Nt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const W1=new Qt,_E=new ne,xE=new ne;class WS{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ht(512,512),this.mapType=Pr,this.map=null,this.mapPass=null,this.matrix=new Qt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Yd,this._frameExtents=new ht(1,1),this._viewportCount=1,this._viewports=[new kn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;_E.setFromMatrixPosition(e.matrixWorld),t.position.copy(_E),xE.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(xE),t.updateMatrixWorld(),W1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(W1,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(W1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class xU extends WS{constructor(){super(new Zi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=Bd*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height*this.aspect,a=e.distance||t.far;(n!==t.fov||i!==t.aspect||a!==t.far)&&(t.fov=n,t.aspect=i,t.far=a,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class jS extends bc{constructor(e,t,n=0,i=Math.PI/3,a=0,l=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Xn.DEFAULT_UP),this.updateMatrix(),this.target=new Xn,this.distance=n,this.angle=i,this.penumbra=a,this.decay=l,this.map=null,this.shadow=new xU}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const SE=new Qt,Um=new ne,j1=new ne;class SU extends WS{constructor(){super(new Zi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ht(4,2),this._viewportCount=6,this._viewports=[new kn(2,1,1,1),new kn(0,1,1,1),new kn(3,1,1,1),new kn(1,1,1,1),new kn(3,0,1,1),new kn(1,0,1,1)],this._cubeDirections=[new ne(1,0,0),new ne(-1,0,0),new ne(0,0,1),new ne(0,0,-1),new ne(0,1,0),new ne(0,-1,0)],this._cubeUps=[new ne(0,1,0),new ne(0,1,0),new ne(0,1,0),new ne(0,1,0),new ne(0,0,1),new ne(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,a=e.distance||n.far;a!==n.far&&(n.far=a,n.updateProjectionMatrix()),Um.setFromMatrixPosition(e.matrixWorld),n.position.copy(Um),j1.copy(n.position),j1.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(j1),n.updateMatrixWorld(),i.makeTranslation(-Um.x,-Um.y,-Um.z),SE.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(SE,n.coordinateSystem,n.reversedDepth)}}class ZS extends bc{constructor(e,t,n=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new SU}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class _l extends Qy{constructor(e=-1,t=1,n=1,i=-1,a=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=a,this.far=l,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,a,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=a,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let a=n-e,l=n+e,u=i+t,f=i-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=p*this.view.offsetX,l=a+p*this.view.width,u-=m*this.view.offsetY,f=u-m*this.view.height}this.projectionMatrix.makeOrthographic(a,l,u,f,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class MU extends WS{constructor(){super(new _l(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class KS extends bc{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Xn.DEFAULT_UP),this.updateMatrix(),this.target=new Xn,this.shadow=new MU}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class U2 extends bc{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class D2 extends bc{constructor(e,t,n=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class N2{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ne)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,a=e.z,l=this.coefficients;return t.copy(l[0]).multiplyScalar(.282095),t.addScaledVector(l[1],.488603*i),t.addScaledVector(l[2],.488603*a),t.addScaledVector(l[3],.488603*n),t.addScaledVector(l[4],1.092548*(n*i)),t.addScaledVector(l[5],1.092548*(i*a)),t.addScaledVector(l[6],.315392*(3*a*a-1)),t.addScaledVector(l[7],1.092548*(n*a)),t.addScaledVector(l[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,a=e.z,l=this.coefficients;return t.copy(l[0]).multiplyScalar(.886227),t.addScaledVector(l[1],2*.511664*i),t.addScaledVector(l[2],2*.511664*a),t.addScaledVector(l[3],2*.511664*n),t.addScaledVector(l[4],2*.429043*n*i),t.addScaledVector(l[5],2*.429043*i*a),t.addScaledVector(l[6],.743125*a*a-.247708),t.addScaledVector(l[7],2*.429043*n*a),t.addScaledVector(l[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const n=e.x,i=e.y,a=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*a,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*a,t[6]=.315392*(3*a*a-1),t[7]=1.092548*n*a,t[8]=.546274*(n*n-i*i)}}class O2 extends bc{constructor(e=new N2,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class __ extends fr{constructor(e){super(e),this.textures={}}load(e,t,n,i){const a=this,l=new Br(a.manager);l.setPath(a.path),l.setRequestHeader(a.requestHeader),l.setWithCredentials(a.withCredentials),l.load(e,function(u){try{t(a.parse(JSON.parse(u)))}catch(f){i?i(f):console.error(f),a.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(a){return t[a]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",a),t[a]}const i=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new Nt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const a in e.uniforms){const l=e.uniforms[a];switch(i.uniforms[a]={},l.type){case"t":i.uniforms[a].value=n(l.value);break;case"c":i.uniforms[a].value=new Nt().setHex(l.value);break;case"v2":i.uniforms[a].value=new ht().fromArray(l.value);break;case"v3":i.uniforms[a].value=new ne().fromArray(l.value);break;case"v4":i.uniforms[a].value=new kn().fromArray(l.value);break;case"m3":i.uniforms[a].value=new dn().fromArray(l.value);break;case"m4":i.uniforms[a].value=new Qt().fromArray(l.value);break;default:i.uniforms[a].value=l.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const a in e.extensions)i.extensions[a]=e.extensions[a];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let a=e.normalScale;Array.isArray(a)===!1&&(a=[a,a]),i.normalScale=new ht().fromArray(a)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new ht().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return __.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:p2,SpriteMaterial:US,RawShaderMaterial:m2,ShaderMaterial:Fr,PointsMaterial:n_,MeshPhysicalMaterial:Qs,MeshStandardMaterial:qd,MeshPhongMaterial:g2,MeshToonMaterial:v2,MeshNormalMaterial:y2,MeshLambertMaterial:_2,MeshDepthMaterial:g_,MeshDistanceMaterial:v_,MeshBasicMaterial:zr,MeshMatcapMaterial:x2,LineDashedMaterial:S2,LineBasicMaterial:cr,Material:ba};return new t[e]}}class mc{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class QS extends vn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class L2 extends fr{constructor(e){super(e)}load(e,t,n,i){const a=this,l=new Br(a.manager);l.setPath(a.path),l.setRequestHeader(a.requestHeader),l.setWithCredentials(a.withCredentials),l.load(e,function(u){try{t(a.parse(JSON.parse(u)))}catch(f){i?i(f):console.error(f),a.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(x,b){if(t[b]!==void 0)return t[b];const T=x.interleavedBuffers[b],E=a(x,T.buffer),w=Md(T.type,E),D=new vg(w,T.stride);return D.uuid=T.uuid,t[b]=D,D}function a(x,b){if(n[b]!==void 0)return n[b];const T=x.arrayBuffers[b],E=new Uint32Array(T).buffer;return n[b]=E,E}const l=e.isInstancedBufferGeometry?new QS:new vn,u=e.data.index;if(u!==void 0){const x=Md(u.type,u.array);l.setIndex(new ii(x,1))}const f=e.data.attributes;for(const x in f){const b=f[x];let R;if(b.isInterleavedBufferAttribute){const T=i(e.data,b.data);R=new _c(T,b.itemSize,b.offset,b.normalized)}else{const T=Md(b.type,b.array),E=b.isInstancedBufferAttribute?xc:ii;R=new E(T,b.itemSize,b.normalized)}b.name!==void 0&&(R.name=b.name),b.usage!==void 0&&R.setUsage(b.usage),l.setAttribute(x,R)}const p=e.data.morphAttributes;if(p)for(const x in p){const b=p[x],R=[];for(let T=0,E=b.length;T<E;T++){const w=b[T];let D;if(w.isInterleavedBufferAttribute){const U=i(e.data,w.data);D=new _c(U,w.itemSize,w.offset,w.normalized)}else{const U=Md(w.type,w.array);D=new ii(U,w.itemSize,w.normalized)}w.name!==void 0&&(D.name=w.name),R.push(D)}l.morphAttributes[x]=R}e.data.morphTargetsRelative&&(l.morphTargetsRelative=!0);const v=e.data.groups||e.data.drawcalls||e.data.offsets;if(v!==void 0)for(let x=0,b=v.length;x!==b;++x){const R=v[x];l.addGroup(R.start,R.count,R.materialIndex)}const _=e.data.boundingSphere;return _!==void 0&&(l.boundingSphere=new Ma().fromJSON(_)),e.name&&(l.name=e.name),e.userData&&(l.userData=e.userData),l}}class bU extends fr{constructor(e){super(e)}load(e,t,n,i){const a=this,l=this.path===""?mc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||l;const u=new Br(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(f){let p=null;try{p=JSON.parse(f)}catch(v){i!==void 0&&i(v),console.error("THREE:ObjectLoader: Can't parse "+e+".",v.message);return}const m=p.metadata;if(m===void 0||m.type===void 0||m.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}a.parse(p,t)},n,i)}async loadAsync(e,t){const n=this,i=this.path===""?mc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const a=new Br(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials);const l=await a.loadAsync(e,t),u=JSON.parse(l),f=u.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(u)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),a=this.parseGeometries(e.geometries,i),l=this.parseImages(e.images,function(){t!==void 0&&t(p)}),u=this.parseTextures(e.textures,l),f=this.parseMaterials(e.materials,u),p=this.parseObject(e.object,a,f,u,n),m=this.parseSkeletons(e.skeletons,p);if(this.bindSkeletons(p,m),this.bindLightTargets(p),t!==void 0){let v=!1;for(const _ in l)if(l[_].data instanceof HTMLImageElement){v=!0;break}v===!1&&t(p)}return p}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),a=await this.parseImagesAsync(e.images),l=this.parseTextures(e.textures,a),u=this.parseMaterials(e.materials,l),f=this.parseObject(e.object,i,u,l,t),p=this.parseSkeletons(e.skeletons,f);return this.bindSkeletons(f,p),this.bindLightTargets(f),f}parseShapes(e){const t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){const a=new Ff().fromJSON(e[n]);t[a.uuid]=a}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(a){a.isBone&&(i[a.uuid]=a)}),e!==void 0)for(let a=0,l=e.length;a<l;a++){const u=new yg().fromJSON(e[a],i);n[u.uuid]=u}return n}parseGeometries(e,t){const n={};if(e!==void 0){const i=new L2;for(let a=0,l=e.length;a<l;a++){let u;const f=e[a];switch(f.type){case"BufferGeometry":case"InstancedBufferGeometry":u=i.parse(f);break;default:f.type in yE?u=yE[f.type].fromJSON(f,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${f.type}"`)}u.uuid=f.uuid,f.name!==void 0&&(u.name=f.name),f.userData!==void 0&&(u.userData=f.userData),n[f.uuid]=u}}return n}parseMaterials(e,t){const n={},i={};if(e!==void 0){const a=new __;a.setTextures(t);for(let l=0,u=e.length;l<u;l++){const f=e[l];n[f.uuid]===void 0&&(n[f.uuid]=a.parse(f)),i[f.uuid]=n[f.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const i=e[n],a=Vd.parse(i);t[a.uuid]=a}return t}parseImages(e,t){const n=this,i={};let a;function l(f){return n.manager.itemStart(f),a.load(f,function(){n.manager.itemEnd(f)},void 0,function(){n.manager.itemError(f),n.manager.itemEnd(f)})}function u(f){if(typeof f=="string"){const p=f,m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:n.resourcePath+p;return l(m)}else return f.data?{data:Md(f.type,f.data),width:f.width,height:f.height}:null}if(e!==void 0&&e.length>0){const f=new y_(t);a=new sg(f),a.setCrossOrigin(this.crossOrigin);for(let p=0,m=e.length;p<m;p++){const v=e[p],_=v.url;if(Array.isArray(_)){const x=[];for(let b=0,R=_.length;b<R;b++){const T=_[b],E=u(T);E!==null&&(E instanceof HTMLImageElement?x.push(E):x.push(new No(E.data,E.width,E.height)))}i[v.uuid]=new dc(x)}else{const x=u(v.url);i[v.uuid]=new dc(x)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function a(l){if(typeof l=="string"){const u=l,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:t.resourcePath+u;return await i.loadAsync(f)}else return l.data?{data:Md(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){i=new sg(this.manager),i.setCrossOrigin(this.crossOrigin);for(let l=0,u=e.length;l<u;l++){const f=e[l],p=f.url;if(Array.isArray(p)){const m=[];for(let v=0,_=p.length;v<_;v++){const x=p[v],b=await a(x);b!==null&&(b instanceof HTMLImageElement?m.push(b):m.push(new No(b.data,b.width,b.height)))}n[f.uuid]=new dc(m)}else{const m=await a(f.url);n[f.uuid]=new dc(m)}}}return n}parseTextures(e,t){function n(a,l){return typeof a=="number"?a:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",a),l[a])}const i={};if(e!==void 0)for(let a=0,l=e.length;a<l;a++){const u=e[a];u.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',u.uuid),t[u.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",u.image);const f=t[u.image],p=f.data;let m;Array.isArray(p)?(m=new mg,p.length===6&&(m.needsUpdate=!0)):(p&&p.data?m=new No:m=new Zn,p&&(m.needsUpdate=!0)),m.source=f,m.uuid=u.uuid,u.name!==void 0&&(m.name=u.name),u.mapping!==void 0&&(m.mapping=n(u.mapping,EU)),u.channel!==void 0&&(m.channel=u.channel),u.offset!==void 0&&m.offset.fromArray(u.offset),u.repeat!==void 0&&m.repeat.fromArray(u.repeat),u.center!==void 0&&m.center.fromArray(u.center),u.rotation!==void 0&&(m.rotation=u.rotation),u.wrap!==void 0&&(m.wrapS=n(u.wrap[0],ME),m.wrapT=n(u.wrap[1],ME)),u.format!==void 0&&(m.format=u.format),u.internalFormat!==void 0&&(m.internalFormat=u.internalFormat),u.type!==void 0&&(m.type=u.type),u.colorSpace!==void 0&&(m.colorSpace=u.colorSpace),u.minFilter!==void 0&&(m.minFilter=n(u.minFilter,bE)),u.magFilter!==void 0&&(m.magFilter=n(u.magFilter,bE)),u.anisotropy!==void 0&&(m.anisotropy=u.anisotropy),u.flipY!==void 0&&(m.flipY=u.flipY),u.generateMipmaps!==void 0&&(m.generateMipmaps=u.generateMipmaps),u.premultiplyAlpha!==void 0&&(m.premultiplyAlpha=u.premultiplyAlpha),u.unpackAlignment!==void 0&&(m.unpackAlignment=u.unpackAlignment),u.compareFunction!==void 0&&(m.compareFunction=u.compareFunction),u.userData!==void 0&&(m.userData=u.userData),i[u.uuid]=m}return i}parseObject(e,t,n,i,a){let l;function u(_){return t[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",_),t[_]}function f(_){if(_!==void 0){if(Array.isArray(_)){const x=[];for(let b=0,R=_.length;b<R;b++){const T=_[b];n[T]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",T),x.push(n[T])}return x}return n[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",_),n[_]}}function p(_){return i[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",_),i[_]}let m,v;switch(e.type){case"Scene":l=new gg,e.background!==void 0&&(Number.isInteger(e.background)?l.background=new Nt(e.background):l.background=p(e.background)),e.environment!==void 0&&(l.environment=p(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?l.fog=new $y(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(l.fog=new Jy(e.fog.color,e.fog.density)),e.fog.name!==""&&(l.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(l.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(l.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&l.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(l.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&l.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":l=new Zi(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(l.focus=e.focus),e.zoom!==void 0&&(l.zoom=e.zoom),e.filmGauge!==void 0&&(l.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(l.filmOffset=e.filmOffset),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"OrthographicCamera":l=new _l(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(l.zoom=e.zoom),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"AmbientLight":l=new U2(e.color,e.intensity);break;case"DirectionalLight":l=new KS(e.color,e.intensity),l.target=e.target||"";break;case"PointLight":l=new ZS(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":l=new D2(e.color,e.intensity,e.width,e.height);break;case"SpotLight":l=new jS(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),l.target=e.target||"";break;case"HemisphereLight":l=new w2(e.color,e.groundColor,e.intensity);break;case"LightProbe":l=new O2().fromJSON(e);break;case"SkinnedMesh":m=u(e.geometry),v=f(e.material),l=new DS(m,v),e.bindMode!==void 0&&(l.bindMode=e.bindMode),e.bindMatrix!==void 0&&l.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(l.skeleton=e.skeleton);break;case"Mesh":m=u(e.geometry),v=f(e.material),l=new Si(m,v);break;case"InstancedMesh":m=u(e.geometry),v=f(e.material);const _=e.count,x=e.instanceMatrix,b=e.instanceColor;l=new NS(m,v,_),l.instanceMatrix=new xc(new Float32Array(x.array),16),b!==void 0&&(l.instanceColor=new xc(new Float32Array(b.array),b.itemSize));break;case"BatchedMesh":m=u(e.geometry),v=f(e.material),l=new t2(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,v),l.geometry=m,l.perObjectFrustumCulled=e.perObjectFrustumCulled,l.sortObjects=e.sortObjects,l._drawRanges=e.drawRanges,l._reservedRanges=e.reservedRanges,l._geometryInfo=e.geometryInfo.map(R=>{let T=null,E=null;return R.boundingBox!==void 0&&(T=new ca().fromJSON(R.boundingBox)),R.boundingSphere!==void 0&&(E=new Ma().fromJSON(R.boundingSphere)),{...R,boundingBox:T,boundingSphere:E}}),l._instanceInfo=e.instanceInfo,l._availableInstanceIds=e._availableInstanceIds,l._availableGeometryIds=e._availableGeometryIds,l._nextIndexStart=e.nextIndexStart,l._nextVertexStart=e.nextVertexStart,l._geometryCount=e.geometryCount,l._maxInstanceCount=e.maxInstanceCount,l._maxVertexCount=e.maxVertexCount,l._maxIndexCount=e.maxIndexCount,l._geometryInitialized=e.geometryInitialized,l._matricesTexture=p(e.matricesTexture.uuid),l._indirectTexture=p(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(l._colorsTexture=p(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(l.boundingSphere=new Ma().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(l.boundingBox=new ca().fromJSON(e.boundingBox));break;case"LOD":l=new e2;break;case"Line":l=new yu(u(e.geometry),f(e.material));break;case"LineLoop":l=new OS(u(e.geometry),f(e.material));break;case"LineSegments":l=new Oo(u(e.geometry),f(e.material));break;case"PointCloud":case"Points":l=new LS(u(e.geometry),f(e.material));break;case"Sprite":l=new $A(f(e.material));break;case"Group":l=new gu;break;case"Bone":l=new e_;break;default:l=new Xn}if(l.uuid=e.uuid,e.name!==void 0&&(l.name=e.name),e.matrix!==void 0?(l.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(l.matrixAutoUpdate=e.matrixAutoUpdate),l.matrixAutoUpdate&&l.matrix.decompose(l.position,l.quaternion,l.scale)):(e.position!==void 0&&l.position.fromArray(e.position),e.rotation!==void 0&&l.rotation.fromArray(e.rotation),e.quaternion!==void 0&&l.quaternion.fromArray(e.quaternion),e.scale!==void 0&&l.scale.fromArray(e.scale)),e.up!==void 0&&l.up.fromArray(e.up),e.castShadow!==void 0&&(l.castShadow=e.castShadow),e.receiveShadow!==void 0&&(l.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(l.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(l.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(l.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(l.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&l.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(l.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(l.visible=e.visible),e.frustumCulled!==void 0&&(l.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(l.renderOrder=e.renderOrder),e.userData!==void 0&&(l.userData=e.userData),e.layers!==void 0&&(l.layers.mask=e.layers),e.children!==void 0){const _=e.children;for(let x=0;x<_.length;x++)l.add(this.parseObject(_[x],t,n,i,a))}if(e.animations!==void 0){const _=e.animations;for(let x=0;x<_.length;x++){const b=_[x];l.animations.push(a[b])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(l.autoUpdate=e.autoUpdate);const _=e.levels;for(let x=0;x<_.length;x++){const b=_[x],R=l.getObjectByProperty("uuid",b.object);R!==void 0&&l.addLevel(R,b.distance,b.hysteresis)}}return l}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const i=t[n.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,i=e.getObjectByProperty("uuid",n);i!==void 0?t.target=i:t.target=new Xn}})}}const EU={UVMapping:gc,CubeReflectionMapping:Sl,CubeRefractionMapping:vc,EquirectangularReflectionMapping:Cd,EquirectangularRefractionMapping:Qm,CubeUVReflectionMapping:Xd},ME={RepeatWrapping:yc,ClampToEdgeWrapping:ta,MirroredRepeatWrapping:wd},bE={NearestFilter:Sa,NearestMipmapNearestFilter:Gy,NearestMipmapLinearFilter:Df,LinearFilter:Wn,LinearMipmapNearestFilter:Ed,LinearMipmapLinearFilter:Zs},Z1=new WeakMap;class z2 extends fr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,l=gl.get(`image-bitmap:${e}`);if(l!==void 0){if(a.manager.itemStart(e),l.then){l.then(p=>{if(Z1.has(l)===!0)i&&i(Z1.get(l)),a.manager.itemError(e),a.manager.itemEnd(e);else return t&&t(p),a.manager.itemEnd(e),p});return}return setTimeout(function(){t&&t(l),a.manager.itemEnd(e)},0),l}const u={};u.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",u.headers=this.requestHeader,u.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const f=fetch(e,u).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(p){return gl.add(`image-bitmap:${e}`,p),t&&t(p),a.manager.itemEnd(e),p}).catch(function(p){i&&i(p),Z1.set(f,p),gl.remove(`image-bitmap:${e}`),a.manager.itemError(e),a.manager.itemEnd(e)});gl.add(`image-bitmap:${e}`,f),a.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let _v;class JS{static getContext(){return _v===void 0&&(_v=new(window.AudioContext||window.webkitAudioContext)),_v}static setContext(e){_v=e}}class TU extends fr{constructor(e){super(e)}load(e,t,n,i){const a=this,l=new Br(this.manager);l.setResponseType("arraybuffer"),l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(f){try{const p=f.slice(0);JS.getContext().decodeAudioData(p,function(v){t(v)}).catch(u)}catch(p){u(p)}},n,i);function u(f){i?i(f):console.error(f),a.manager.itemError(e)}}}const EE=new Qt,TE=new Qt,mf=new Qt;class AU{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Zi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Zi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,mf.copy(e.projectionMatrix);const i=t.eyeSep/2,a=i*t.near/t.focus,l=t.near*Math.tan(Pf*t.fov*.5)/t.zoom;let u,f;TE.elements[12]=-i,EE.elements[12]=i,u=-l*t.aspect+a,f=l*t.aspect+a,mf.elements[0]=2*t.near/(f-u),mf.elements[8]=(f+u)/(f-u),this.cameraL.projectionMatrix.copy(mf),u=-l*t.aspect-a,f=l*t.aspect-a,mf.elements[0]=2*t.near/(f-u),mf.elements[8]=(f+u)/(f-u),this.cameraR.projectionMatrix.copy(mf)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(TE),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(EE)}}class I2 extends Zi{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class $S{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const gf=new ne,K1=new ua,RU=new ne,vf=new ne,yf=new ne;class CU extends Xn{constructor(){super(),this.type="AudioListener",this.context=JS.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new $S}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(gf,K1,RU),vf.set(0,0,-1).applyQuaternion(K1),yf.set(0,1,0).applyQuaternion(K1),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(gf.x,n),t.positionY.linearRampToValueAtTime(gf.y,n),t.positionZ.linearRampToValueAtTime(gf.z,n),t.forwardX.linearRampToValueAtTime(vf.x,n),t.forwardY.linearRampToValueAtTime(vf.y,n),t.forwardZ.linearRampToValueAtTime(vf.z,n),t.upX.linearRampToValueAtTime(yf.x,n),t.upY.linearRampToValueAtTime(yf.y,n),t.upZ.linearRampToValueAtTime(yf.z,n)}else t.setPosition(gf.x,gf.y,gf.z),t.setOrientation(vf.x,vf.y,vf.z,yf.x,yf.y,yf.z)}}let B2=class extends Xn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}};const _f=new ne,AE=new ua,wU=new ne,xf=new ne;class UU extends B2{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_f,AE,wU),xf.set(0,0,1).applyQuaternion(AE);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(_f.x,n),t.positionY.linearRampToValueAtTime(_f.y,n),t.positionZ.linearRampToValueAtTime(_f.z,n),t.orientationX.linearRampToValueAtTime(xf.x,n),t.orientationY.linearRampToValueAtTime(xf.y,n),t.orientationZ.linearRampToValueAtTime(xf.z,n)}else t.setPosition(_f.x,_f.y,_f.z),t.setOrientation(xf.x,xf.y,xf.z)}}class DU{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class P2{constructor(e,t,n){this.binding=e,this.valueSize=n;let i,a,l;switch(t){case"quaternion":i=this._slerp,a=this._slerpAdditive,l=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,a=this._select,l=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,a=this._lerpAdditive,l=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=a,this._setIdentity=l,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,a=e*i+i;let l=this.cumulativeWeight;if(l===0){for(let u=0;u!==i;++u)n[a+u]=n[u];l=t}else{l+=t;const u=t/l;this._mixBufferRegion(n,a,0,u,i)}this.cumulativeWeight=l}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,a=this.cumulativeWeight,l=this.cumulativeWeightAdditive,u=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,a<1){const f=t*this._origIndex;this._mixBufferRegion(n,i,f,1-a,t)}l>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let f=t,p=t+t;f!==p;++f)if(n[f]!==n[f+t]){u.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let a=n,l=i;a!==l;++a)t[a]=t[i+a%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,a){if(i>=.5)for(let l=0;l!==a;++l)e[t+l]=e[n+l]}_slerp(e,t,n,i){ua.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,a){const l=this._workIndex*a;ua.multiplyQuaternionsFlat(e,l,e,t,e,n),ua.slerpFlat(e,t,e,t,e,l,i)}_lerp(e,t,n,i,a){const l=1-i;for(let u=0;u!==a;++u){const f=t+u;e[f]=e[f]*l+e[n+u]*i}}_lerpAdditive(e,t,n,i,a){for(let l=0;l!==a;++l){const u=t+l;e[u]=e[u]+e[n+l]*i}}}const eM="\\[\\]\\.:\\/",NU=new RegExp("["+eM+"]","g"),tM="[^"+eM+"]",OU="[^"+eM.replace("\\.","")+"]",LU=/((?:WC+[\/:])*)/.source.replace("WC",tM),zU=/(WCOD+)?/.source.replace("WCOD",OU),IU=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",tM),BU=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",tM),PU=new RegExp("^"+LU+zU+IU+BU+"$"),FU=["material","materials","bones","map"];class HU{constructor(e,t,n){const i=n||qn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,a=n.length;i!==a;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class qn{constructor(e,t,n){this.path=t,this.parsedPath=n||qn.parseTrackName(t),this.node=qn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new qn.Composite(e,t,n):new qn(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(NU,"")}static parseTrackName(e){const t=PU.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const a=n.nodeName.substring(i+1);FU.indexOf(a)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=a)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(a){for(let l=0;l<a.length;l++){const u=a[l];if(u.name===t||u.uuid===t)return u;const f=n(u.children);if(f)return f}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,a=n.length;i!==a;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,a=n.length;i!==a;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,a=n.length;i!==a;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,a=n.length;i!==a;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let a=t.propertyIndex;if(e||(e=qn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let p=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let m=0;m<e.length;m++)if(e[m].name===p){p=m;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(p!==void 0){if(e[p]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const l=e[i];if(l===void 0){const p=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+p+"."+i+" but it wasn't found.",e);return}let u=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?u=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(u=this.Versioning.MatrixWorldNeedsUpdate);let f=this.BindingType.Direct;if(a!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}f=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=a}else l.fromArray!==void 0&&l.toArray!==void 0?(f=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(f=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=i;this.getValue=this.GetterByBindingType[f],this.setValue=this.SetterByBindingTypeAndVersioning[f][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}qn.Composite=HU;qn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};qn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};qn.prototype.GetterByBindingType=[qn.prototype._getValue_direct,qn.prototype._getValue_array,qn.prototype._getValue_arrayElement,qn.prototype._getValue_toArray];qn.prototype.SetterByBindingTypeAndVersioning=[[qn.prototype._setValue_direct,qn.prototype._setValue_direct_setNeedsUpdate,qn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[qn.prototype._setValue_array,qn.prototype._setValue_array_setNeedsUpdate,qn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[qn.prototype._setValue_arrayElement,qn.prototype._setValue_arrayElement_setNeedsUpdate,qn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[qn.prototype._setValue_fromArray,qn.prototype._setValue_fromArray_setNeedsUpdate,qn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class GU{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Es(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,a=this._bindings,l=a.length;let u,f=e.length,p=this.nCachedObjects_;for(let m=0,v=arguments.length;m!==v;++m){const _=arguments[m],x=_.uuid;let b=t[x];if(b===void 0){b=f++,t[x]=b,e.push(_);for(let R=0,T=l;R!==T;++R)a[R].push(new qn(_,n[R],i[R]))}else if(b<p){u=e[b];const R=--p,T=e[R];t[T.uuid]=b,e[b]=T,t[x]=R,e[R]=_;for(let E=0,w=l;E!==w;++E){const D=a[E],U=D[R];let I=D[b];D[b]=U,I===void 0&&(I=new qn(_,n[E],i[E])),D[R]=I}}else e[b]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=p}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let a=this.nCachedObjects_;for(let l=0,u=arguments.length;l!==u;++l){const f=arguments[l],p=f.uuid,m=t[p];if(m!==void 0&&m>=a){const v=a++,_=e[v];t[_.uuid]=m,e[m]=_,t[p]=v,e[v]=f;for(let x=0,b=i;x!==b;++x){const R=n[x],T=R[v],E=R[m];R[m]=T,R[v]=E}}}this.nCachedObjects_=a}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let a=this.nCachedObjects_,l=e.length;for(let u=0,f=arguments.length;u!==f;++u){const p=arguments[u],m=p.uuid,v=t[m];if(v!==void 0)if(delete t[m],v<a){const _=--a,x=e[_],b=--l,R=e[b];t[x.uuid]=v,e[v]=x,t[R.uuid]=_,e[_]=R,e.pop();for(let T=0,E=i;T!==E;++T){const w=n[T],D=w[_],U=w[b];w[v]=D,w[_]=U,w.pop()}}else{const _=--l,x=e[_];_>0&&(t[x.uuid]=v),e[v]=x,e.pop();for(let b=0,R=i;b!==R;++b){const T=n[b];T[v]=T[_],T.pop()}}}this.nCachedObjects_=a}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const a=this._bindings;if(i!==void 0)return a[i];const l=this._paths,u=this._parsedPaths,f=this._objects,p=f.length,m=this.nCachedObjects_,v=new Array(p);i=a.length,n[e]=i,l.push(e),u.push(t),a.push(v);for(let _=m,x=f.length;_!==x;++_){const b=f[_];v[_]=new qn(b,e,t)}return v}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const i=this._paths,a=this._parsedPaths,l=this._bindings,u=l.length-1,f=l[u],p=e[u];t[p]=n,l[n]=f,l.pop(),a[n]=a[u],a.pop(),i[n]=i[u],i.pop()}}}class F2{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const a=t.tracks,l=a.length,u=new Array(l),f={endingStart:Nf,endingEnd:Nf};for(let p=0;p!==l;++p){const m=a[p].createInterpolant(null);u[p]=m,m.settings=f}this._interpolantSettings=f,this._interpolants=u,this._propertyBindings=new Array(l),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LA,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const i=this._clip.duration,a=e._clip.duration,l=a/i,u=i/a;e.warp(1,l,t),this.warp(u,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,a=i.time,l=this.timeScale;let u=this._timeScaleInterpolant;u===null&&(u=i._lendControlInterpolant(),this._timeScaleInterpolant=u);const f=u.parameterPositions,p=u.sampleValues;return f[0]=a,f[1]=a+n,p[0]=e/l,p[1]=t/l,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled){this._updateWeight(e);return}const a=this._startTime;if(a!==null){const f=(e-a)*n;f<0||n===0?t=0:(this._startTime=null,t=n*f)}t*=this._updateTimeScale(e);const l=this._updateTime(t),u=this._updateWeight(e);if(u>0){const f=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case xS:for(let m=0,v=f.length;m!==v;++m)f[m].evaluate(l),p[m].accumulateAdditive(u);break;case jy:default:for(let m=0,v=f.length;m!==v;++m)f[m].evaluate(l),p[m].accumulate(i,u)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,a=this._loopCount;const l=n===zA;if(e===0)return a===-1?i:l&&(a&1)===1?t-i:i;if(n===OA){a===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(a===-1&&(e>=0?(a=0,this._setEndings(!0,this.repetitions===0,l)):this._setEndings(this.repetitions===0,!0,l)),i>=t||i<0){const u=Math.floor(i/t);i-=t*u,a+=Math.abs(u);const f=this.repetitions-a;if(f<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(f===1){const p=e<0;this._setEndings(p,!p,l)}else this._setEndings(!1,!1,l);this._loopCount=a,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:u})}}else this.time=i;if(l&&(a&1)===1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=Of,i.endingEnd=Of):(e?i.endingStart=this.zeroSlopeAtStart?Of:Nf:i.endingStart=Jm,t?i.endingEnd=this.zeroSlopeAtEnd?Of:Nf:i.endingEnd=Jm)}_scheduleFading(e,t,n){const i=this._mixer,a=i.time;let l=this._weightInterpolant;l===null&&(l=i._lendControlInterpolant(),this._weightInterpolant=l);const u=l.parameterPositions,f=l.sampleValues;return u[0]=a,f[0]=t,u[1]=a+e,f[1]=n,this}}const VU=new Float32Array(1);class kU extends bl{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,a=i.length,l=e._propertyBindings,u=e._interpolants,f=n.uuid,p=this._bindingsByRootAndName;let m=p[f];m===void 0&&(m={},p[f]=m);for(let v=0;v!==a;++v){const _=i[v],x=_.name;let b=m[x];if(b!==void 0)++b.referenceCount,l[v]=b;else{if(b=l[v],b!==void 0){b._cacheIndex===null&&(++b.referenceCount,this._addInactiveBinding(b,f,x));continue}const R=t&&t._propertyBindings[v].binding.parsedPath;b=new P2(qn.create(n,x,R),_.ValueTypeName,_.getValueSize()),++b.referenceCount,this._addInactiveBinding(b,f,x),l[v]=b}u[v].resultBuffer=b.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,a=this._actionsByClip[i];this._bindAction(e,a&&a.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const a=t[n];a.useCount++===0&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const a=t[n];--a.useCount===0&&(a.restoreOriginalState(),this._takeBackBinding(a))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,a=this._actionsByClip;let l=a[t];if(l===void 0)l={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,a[t]=l;else{const u=l.knownActions;e._byClipCacheIndex=u.length,u.push(e)}e._cacheIndex=i.length,i.push(e),l.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const a=e._clip.uuid,l=this._actionsByClip,u=l[a],f=u.knownActions,p=f[f.length-1],m=e._byClipCacheIndex;p._byClipCacheIndex=m,f[m]=p,f.pop(),e._byClipCacheIndex=null;const v=u.actionByRoot,_=(e._localRoot||this._root).uuid;delete v[_],f.length===0&&delete l[a],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const a=t[n];--a.referenceCount===0&&this._removeInactiveBinding(a)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,a=t[i];e._cacheIndex=i,t[i]=e,a._cacheIndex=n,t[n]=a}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,a=t[i];e._cacheIndex=i,t[i]=e,a._cacheIndex=n,t[n]=a}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,a=this._bindings;let l=i[t];l===void 0&&(l={},i[t]=l),l[n]=e,e._cacheIndex=a.length,a.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,a=n.path,l=this._bindingsByRootAndName,u=l[i],f=t[t.length-1],p=e._cacheIndex;f._cacheIndex=p,t[p]=f,t.pop(),delete u[a],Object.keys(u).length===0&&delete l[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,a=t[i];e._cacheIndex=i,t[i]=e,a._cacheIndex=n,t[n]=a}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,a=t[i];e._cacheIndex=i,t[i]=e,a._cacheIndex=n,t[n]=a}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new XS(new Float32Array(2),new Float32Array(2),1,VU),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,a=t[i];e.__cacheIndex=i,t[i]=e,a.__cacheIndex=n,t[n]=a}clipAction(e,t,n){const i=t||this._root,a=i.uuid;let l=typeof e=="string"?Vd.findByName(i,e):e;const u=l!==null?l.uuid:e,f=this._actionsByClip[u];let p=null;if(n===void 0&&(l!==null?n=l.blendMode:n=jy),f!==void 0){const v=f.actionByRoot[a];if(v!==void 0&&v.blendMode===n)return v;p=f.knownActions[0],l===null&&(l=p._clip)}if(l===null)return null;const m=new F2(this,l,t,n);return this._bindAction(m,p),this._addInactiveAction(m,u,a),m}existingAction(e,t){const n=t||this._root,i=n.uuid,a=typeof e=="string"?Vd.findByName(n,e):e,l=a?a.uuid:e,u=this._actionsByClip[l];return u!==void 0&&u.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,a=Math.sign(e),l=this._accuIndex^=1;for(let p=0;p!==n;++p)t[p]._update(i,e,a,l);const u=this._bindings,f=this._nActiveBindings;for(let p=0;p!==f;++p)u[p].apply(l);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,a=i[n];if(a!==void 0){const l=a.knownActions;for(let u=0,f=l.length;u!==f;++u){const p=l[u];this._deactivateAction(p);const m=p._cacheIndex,v=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,v._cacheIndex=m,t[m]=v,t.pop(),this._removeInactiveBindingsForAction(p)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const l in n){const u=n[l].actionByRoot,f=u[t];f!==void 0&&(this._deactivateAction(f),this._removeInactiveAction(f))}const i=this._bindingsByRootAndName,a=i[t];if(a!==void 0)for(const l in a){const u=a[l];u.restoreOriginalState(),this._removeInactiveBinding(u)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class XU extends TS{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isRenderTarget3D=!0,this.depth=n,this.texture=new Ky(null,e,t,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class nM{constructor(e){this.value=e}clone(){return new nM(this.value.clone===void 0?this.value:this.value.clone())}}let YU=0;class qU extends bl{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:YU++}),this.name="",this.usage=eg,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++){const a=Array.isArray(t[n])?t[n]:[t[n]];for(let l=0;l<a.length;l++)this.uniforms.push(a[l].clone())}return this}clone(){return new this.constructor().copy(this)}}class WU extends vg{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class jU{constructor(e,t,n,i,a,l=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=a,this.normalized=l,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const RE=new Qt;class iM{constructor(e,t,n=0,i=1/0){this.ray=new jf(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new Fd,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return RE.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(RE),this}intersectObject(e,t=!0,n=[]){return jx(e,this,n,t),n.sort(CE),n}intersectObjects(e,t=!0,n=[]){for(let i=0,a=e.length;i<a;i++)jx(e[i],this,n,t);return n.sort(CE),n}}function CE(s,e){return s.distance-e.distance}function jx(s,e,t,n){let i=!0;if(s.layers.test(e.layers)&&s.raycast(e,t)===!1&&(i=!1),i===!0&&n===!0){const a=s.children;for(let l=0,u=a.length;l<u;l++)jx(a[l],e,t,!0)}}class ZU{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=KU.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function KU(){this._document.hidden===!1&&this.reset()}class Zx{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=rn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(rn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class QU{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class aM{constructor(e,t,n,i){aM.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,i)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,i){const a=this.elements;return a[0]=e,a[2]=t,a[1]=n,a[3]=i,this}}const wE=new ht;class JU{constructor(e=new ht(1/0,1/0),t=new ht(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=wE.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,wE).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const UE=new ne,xv=new ne,pd=new ne,md=new ne,Q1=new ne,$U=new ne,eD=new ne;class tD{constructor(e=new ne,t=new ne){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){UE.subVectors(e,this.start),xv.subVectors(this.end,this.start);const n=xv.dot(xv);let a=xv.dot(UE)/n;return t&&(a=rn(a,0,1)),a}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}distanceSqToLine3(e,t=$U,n=eD){const i=10000000000000001e-32;let a,l;const u=this.start,f=e.start,p=this.end,m=e.end;pd.subVectors(p,u),md.subVectors(m,f),Q1.subVectors(u,f);const v=pd.dot(pd),_=md.dot(md),x=md.dot(Q1);if(v<=i&&_<=i)return t.copy(u),n.copy(f),t.sub(n),t.dot(t);if(v<=i)a=0,l=x/_,l=rn(l,0,1);else{const b=pd.dot(Q1);if(_<=i)l=0,a=rn(-b/v,0,1);else{const R=pd.dot(md),T=v*_-R*R;T!==0?a=rn((R*x-b*_)/T,0,1):a=0,l=(R*a+x)/_,l<0?(l=0,a=rn(-b/v,0,1)):l>1&&(l=1,a=rn((R-b)/v,0,1))}}return t.copy(u).add(pd.multiplyScalar(a)),n.copy(f).add(md.multiplyScalar(l)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const DE=new ne;class nD extends Xn{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new vn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let l=0,u=1,f=32;l<f;l++,u++){const p=l/f*Math.PI*2,m=u/f*Math.PI*2;i.push(Math.cos(p),Math.sin(p),1,Math.cos(m),Math.sin(m),1)}n.setAttribute("position",new Vt(i,3));const a=new cr({fog:!1,toneMapped:!1});this.cone=new Oo(n,a),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),DE.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(DE),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const uc=new ne,Sv=new Qt,J1=new Qt;class iD extends Oo{constructor(e){const t=H2(e),n=new vn,i=[],a=[];for(let p=0;p<t.length;p++){const m=t[p];m.parent&&m.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),a.push(0,0,0),a.push(0,0,0))}n.setAttribute("position",new Vt(i,3)),n.setAttribute("color",new Vt(a,3));const l=new cr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const u=new Nt(255),f=new Nt(65280);this.setColors(u,f)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");J1.copy(this.root.matrixWorld).invert();for(let a=0,l=0;a<t.length;a++){const u=t[a];u.parent&&u.parent.isBone&&(Sv.multiplyMatrices(J1,u.matrixWorld),uc.setFromMatrixPosition(Sv),i.setXYZ(l,uc.x,uc.y,uc.z),Sv.multiplyMatrices(J1,u.parent.matrixWorld),uc.setFromMatrixPosition(Sv),i.setXYZ(l+1,uc.x,uc.y,uc.z),l+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const i=this.geometry.getAttribute("color");for(let a=0;a<i.count;a+=2)i.setXYZ(a,e.r,e.g,e.b),i.setXYZ(a+1,t.r,t.g,t.b);return i.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function H2(s){const e=[];s.isBone===!0&&e.push(s);for(let t=0;t<s.children.length;t++)e.push(...H2(s.children[t]));return e}class aD extends Si{constructor(e,t,n){const i=new bg(t,4,2),a=new zr({wireframe:!0,fog:!1,toneMapped:!1});super(i,a),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const rD=new ne,NE=new Nt,OE=new Nt;class sD extends Xn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new Mg(t);i.rotateY(Math.PI*.5),this.material=new zr({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const a=i.getAttribute("position"),l=new Float32Array(a.count*3);i.setAttribute("color",new ii(l,3)),this.add(new Si(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");NE.copy(this.light.color),OE.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){const a=n<i/2?NE:OE;t.setXYZ(n,a.r,a.g,a.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(rD.setFromMatrixPosition(this.light.matrixWorld).negate())}}class oD extends Oo{constructor(e=10,t=10,n=4473924,i=8947848){n=new Nt(n),i=new Nt(i);const a=t/2,l=e/t,u=e/2,f=[],p=[];for(let _=0,x=0,b=-u;_<=t;_++,b+=l){f.push(-u,0,b,u,0,b),f.push(b,0,-u,b,0,u);const R=_===a?n:i;R.toArray(p,x),x+=3,R.toArray(p,x),x+=3,R.toArray(p,x),x+=3,R.toArray(p,x),x+=3}const m=new vn;m.setAttribute("position",new Vt(f,3)),m.setAttribute("color",new Vt(p,3));const v=new cr({vertexColors:!0,toneMapped:!1});super(m,v),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class lD extends Oo{constructor(e=10,t=16,n=8,i=64,a=4473924,l=8947848){a=new Nt(a),l=new Nt(l);const u=[],f=[];if(t>1)for(let v=0;v<t;v++){const _=v/t*(Math.PI*2),x=Math.sin(_)*e,b=Math.cos(_)*e;u.push(0,0,0),u.push(x,0,b);const R=v&1?a:l;f.push(R.r,R.g,R.b),f.push(R.r,R.g,R.b)}for(let v=0;v<n;v++){const _=v&1?a:l,x=e-e/n*v;for(let b=0;b<i;b++){let R=b/i*(Math.PI*2),T=Math.sin(R)*x,E=Math.cos(R)*x;u.push(T,0,E),f.push(_.r,_.g,_.b),R=(b+1)/i*(Math.PI*2),T=Math.sin(R)*x,E=Math.cos(R)*x,u.push(T,0,E),f.push(_.r,_.g,_.b)}}const p=new vn;p.setAttribute("position",new Vt(u,3)),p.setAttribute("color",new Vt(f,3));const m=new cr({vertexColors:!0,toneMapped:!1});super(p,m),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const LE=new ne,Mv=new ne,zE=new ne;class uD extends Xn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new vn;i.setAttribute("position",new Vt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const a=new cr({fog:!1,toneMapped:!1});this.lightPlane=new yu(i,a),this.add(this.lightPlane),i=new vn,i.setAttribute("position",new Vt([0,0,0,0,0,1],3)),this.targetLine=new yu(i,a),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),LE.setFromMatrixPosition(this.light.matrixWorld),Mv.setFromMatrixPosition(this.light.target.matrixWorld),zE.subVectors(Mv,LE),this.lightPlane.lookAt(Mv),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Mv),this.targetLine.scale.z=zE.length()}}const bv=new ne,ji=new Qy;class cD extends Oo{constructor(e){const t=new vn,n=new cr({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],a=[],l={};u("n1","n2"),u("n2","n4"),u("n4","n3"),u("n3","n1"),u("f1","f2"),u("f2","f4"),u("f4","f3"),u("f3","f1"),u("n1","f1"),u("n2","f2"),u("n3","f3"),u("n4","f4"),u("p","n1"),u("p","n2"),u("p","n3"),u("p","n4"),u("u1","u2"),u("u2","u3"),u("u3","u1"),u("c","t"),u("p","c"),u("cn1","cn2"),u("cn3","cn4"),u("cf1","cf2"),u("cf3","cf4");function u(b,R){f(b),f(R)}function f(b){i.push(0,0,0),a.push(0,0,0),l[b]===void 0&&(l[b]=[]),l[b].push(i.length/3-1)}t.setAttribute("position",new Vt(i,3)),t.setAttribute("color",new Vt(a,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=l,this.update();const p=new Nt(16755200),m=new Nt(16711680),v=new Nt(43775),_=new Nt(16777215),x=new Nt(3355443);this.setColors(p,m,v,_,x)}setColors(e,t,n,i,a){const u=this.geometry.getAttribute("color");return u.setXYZ(0,e.r,e.g,e.b),u.setXYZ(1,e.r,e.g,e.b),u.setXYZ(2,e.r,e.g,e.b),u.setXYZ(3,e.r,e.g,e.b),u.setXYZ(4,e.r,e.g,e.b),u.setXYZ(5,e.r,e.g,e.b),u.setXYZ(6,e.r,e.g,e.b),u.setXYZ(7,e.r,e.g,e.b),u.setXYZ(8,e.r,e.g,e.b),u.setXYZ(9,e.r,e.g,e.b),u.setXYZ(10,e.r,e.g,e.b),u.setXYZ(11,e.r,e.g,e.b),u.setXYZ(12,e.r,e.g,e.b),u.setXYZ(13,e.r,e.g,e.b),u.setXYZ(14,e.r,e.g,e.b),u.setXYZ(15,e.r,e.g,e.b),u.setXYZ(16,e.r,e.g,e.b),u.setXYZ(17,e.r,e.g,e.b),u.setXYZ(18,e.r,e.g,e.b),u.setXYZ(19,e.r,e.g,e.b),u.setXYZ(20,e.r,e.g,e.b),u.setXYZ(21,e.r,e.g,e.b),u.setXYZ(22,e.r,e.g,e.b),u.setXYZ(23,e.r,e.g,e.b),u.setXYZ(24,t.r,t.g,t.b),u.setXYZ(25,t.r,t.g,t.b),u.setXYZ(26,t.r,t.g,t.b),u.setXYZ(27,t.r,t.g,t.b),u.setXYZ(28,t.r,t.g,t.b),u.setXYZ(29,t.r,t.g,t.b),u.setXYZ(30,t.r,t.g,t.b),u.setXYZ(31,t.r,t.g,t.b),u.setXYZ(32,n.r,n.g,n.b),u.setXYZ(33,n.r,n.g,n.b),u.setXYZ(34,n.r,n.g,n.b),u.setXYZ(35,n.r,n.g,n.b),u.setXYZ(36,n.r,n.g,n.b),u.setXYZ(37,n.r,n.g,n.b),u.setXYZ(38,i.r,i.g,i.b),u.setXYZ(39,i.r,i.g,i.b),u.setXYZ(40,a.r,a.g,a.b),u.setXYZ(41,a.r,a.g,a.b),u.setXYZ(42,a.r,a.g,a.b),u.setXYZ(43,a.r,a.g,a.b),u.setXYZ(44,a.r,a.g,a.b),u.setXYZ(45,a.r,a.g,a.b),u.setXYZ(46,a.r,a.g,a.b),u.setXYZ(47,a.r,a.g,a.b),u.setXYZ(48,a.r,a.g,a.b),u.setXYZ(49,a.r,a.g,a.b),u.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,i=1;let a,l;if(ji.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)a=1,l=0;else if(this.camera.coordinateSystem===bs)a=-1,l=1;else if(this.camera.coordinateSystem===Id)a=0,l=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);ea("c",t,e,ji,0,0,a),ea("t",t,e,ji,0,0,l),ea("n1",t,e,ji,-n,-i,a),ea("n2",t,e,ji,n,-i,a),ea("n3",t,e,ji,-n,i,a),ea("n4",t,e,ji,n,i,a),ea("f1",t,e,ji,-n,-i,l),ea("f2",t,e,ji,n,-i,l),ea("f3",t,e,ji,-n,i,l),ea("f4",t,e,ji,n,i,l),ea("u1",t,e,ji,n*.7,i*1.1,a),ea("u2",t,e,ji,-n*.7,i*1.1,a),ea("u3",t,e,ji,0,i*2,a),ea("cf1",t,e,ji,-n,0,l),ea("cf2",t,e,ji,n,0,l),ea("cf3",t,e,ji,0,-i,l),ea("cf4",t,e,ji,0,i,l),ea("cn1",t,e,ji,-n,0,a),ea("cn2",t,e,ji,n,0,a),ea("cn3",t,e,ji,0,-i,a),ea("cn4",t,e,ji,0,i,a),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ea(s,e,t,n,i,a,l){bv.set(i,a,l).unproject(n);const u=e[s];if(u!==void 0){const f=t.getAttribute("position");for(let p=0,m=u.length;p<m;p++)f.setXYZ(u[p],bv.x,bv.y,bv.z)}}const Ev=new ca;class fD extends Oo{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),a=new vn;a.setIndex(new ii(n,1)),a.setAttribute("position",new ii(i,3)),super(a,new cr({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Ev.setFromObject(this.object),Ev.isEmpty())return;const e=Ev.min,t=Ev.max,n=this.geometry.attributes.position,i=n.array;i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=e.x,i[4]=t.y,i[5]=t.z,i[6]=e.x,i[7]=e.y,i[8]=t.z,i[9]=t.x,i[10]=e.y,i[11]=t.z,i[12]=t.x,i[13]=t.y,i[14]=e.z,i[15]=e.x,i[16]=t.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=t.x,i[22]=e.y,i[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class hD extends Oo{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],a=new vn;a.setIndex(new ii(n,1)),a.setAttribute("position",new Vt(i,3)),super(a,new cr({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class dD extends yu{constructor(e,t=1,n=16776960){const i=n,a=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],l=new vn;l.setAttribute("position",new Vt(a,3)),l.computeBoundingSphere(),super(l,new cr({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const u=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],f=new vn;f.setAttribute("position",new Vt(u,3)),f.computeBoundingSphere(),this.add(new Si(f,new zr({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const IE=new ne;let Tv,$1;class pD extends Xn{constructor(e=new ne(0,0,1),t=new ne(0,0,0),n=1,i=16776960,a=n*.2,l=a*.2){super(),this.type="ArrowHelper",Tv===void 0&&(Tv=new vn,Tv.setAttribute("position",new Vt([0,0,0,0,1,0],3)),$1=new xg(.5,1,5,1),$1.translate(0,-.5,0)),this.position.copy(t),this.line=new yu(Tv,new cr({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Si($1,new zr({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,a,l)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{IE.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(IE,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class mD extends Oo{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new vn;i.setAttribute("position",new Vt(t,3)),i.setAttribute("color",new Vt(n,3));const a=new cr({vertexColors:!0,toneMapped:!1});super(i,a),this.type="AxesHelper"}setColors(e,t,n){const i=new Nt,a=this.geometry.attributes.color.array;return i.set(e),i.toArray(a,0),i.toArray(a,3),i.set(t),i.toArray(a,6),i.toArray(a,9),i.set(n),i.toArray(a,12),i.toArray(a,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class gD{constructor(){this.type="ShapePath",this.color=new Nt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Ny,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,a,l){return this.currentPath.bezierCurveTo(e,t,n,i,a,l),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(E){const w=[];for(let D=0,U=E.length;D<U;D++){const I=E[D],O=new Ff;O.curves=I.curves,w.push(O)}return w}function n(E,w){const D=w.length;let U=!1;for(let I=D-1,O=0;O<D;I=O++){let P=w[I],B=w[O],N=B.x-P.x,z=B.y-P.y;if(Math.abs(z)>Number.EPSILON){if(z<0&&(P=w[O],N=-N,B=w[I],z=-z),E.y<P.y||E.y>B.y)continue;if(E.y===P.y){if(E.x===P.x)return!0}else{const q=z*(E.x-P.x)-N*(E.y-P.y);if(q===0)return!0;if(q<0)continue;U=!U}}else{if(E.y!==P.y)continue;if(B.x<=E.x&&E.x<=P.x||P.x<=E.x&&E.x<=B.x)return!0}}return U}const i=Do.isClockWise,a=this.subPaths;if(a.length===0)return[];let l,u,f;const p=[];if(a.length===1)return u=a[0],f=new Ff,f.curves=u.curves,p.push(f),p;let m=!i(a[0].getPoints());m=e?!m:m;const v=[],_=[];let x=[],b=0,R;_[b]=void 0,x[b]=[];for(let E=0,w=a.length;E<w;E++)u=a[E],R=u.getPoints(),l=i(R),l=e?!l:l,l?(!m&&_[b]&&b++,_[b]={s:new Ff,p:R},_[b].s.curves=u.curves,m&&b++,x[b]=[]):x[b].push({h:u,p:R[0]});if(!_[0])return t(a);if(_.length>1){let E=!1,w=0;for(let D=0,U=_.length;D<U;D++)v[D]=[];for(let D=0,U=_.length;D<U;D++){const I=x[D];for(let O=0;O<I.length;O++){const P=I[O];let B=!0;for(let N=0;N<_.length;N++)n(P.p,_[N].p)&&(D!==N&&w++,B?(B=!1,v[N].push(P)):E=!0);B&&v[D].push(P)}}w>0&&E===!1&&(x=v)}let T;for(let E=0,w=_.length;E<w;E++){f=_[E].s,p.push(f),T=x[E];for(let D=0,U=T.length;D<U;D++)f.holes.push(T[D].h)}return p}}class vD extends bl{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function yD(s,e){const t=s.image&&s.image.width?s.image.width/s.image.height:1;return t>e?(s.repeat.x=1,s.repeat.y=t/e,s.offset.x=0,s.offset.y=(1-s.repeat.y)/2):(s.repeat.x=e/t,s.repeat.y=1,s.offset.x=(1-s.repeat.x)/2,s.offset.y=0),s}function _D(s,e){const t=s.image&&s.image.width?s.image.width/s.image.height:1;return t>e?(s.repeat.x=e/t,s.repeat.y=1,s.offset.x=(1-s.repeat.x)/2,s.offset.y=0):(s.repeat.x=1,s.repeat.y=t/e,s.offset.x=0,s.offset.y=(1-s.repeat.y)/2),s}function xD(s){return s.repeat.x=1,s.repeat.y=1,s.offset.x=0,s.offset.y=0,s}function Kx(s,e,t,n){const i=SD(n);switch(t){case vS:return s*e;case dg:return s*e/i.components*i.byteLength;case pg:return s*e/i.components*i.byteLength;case _S:return s*e*2/i.components*i.byteLength;case qy:return s*e*2/i.components*i.byteLength;case yS:return s*e*3/i.components*i.byteLength;case na:return s*e*4/i.components*i.byteLength;case Wy:return s*e*4/i.components*i.byteLength;case Hm:case Gm:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*8;case Vm:case km:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case ty:case iy:return Math.max(s,16)*Math.max(e,8)/4;case ey:case ny:return Math.max(s,8)*Math.max(e,8)/2;case ay:case ry:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*8;case sy:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case oy:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case ly:return Math.floor((s+4)/5)*Math.floor((e+3)/4)*16;case uy:return Math.floor((s+4)/5)*Math.floor((e+4)/5)*16;case cy:return Math.floor((s+5)/6)*Math.floor((e+4)/5)*16;case fy:return Math.floor((s+5)/6)*Math.floor((e+5)/6)*16;case hy:return Math.floor((s+7)/8)*Math.floor((e+4)/5)*16;case dy:return Math.floor((s+7)/8)*Math.floor((e+5)/6)*16;case py:return Math.floor((s+7)/8)*Math.floor((e+7)/8)*16;case my:return Math.floor((s+9)/10)*Math.floor((e+4)/5)*16;case gy:return Math.floor((s+9)/10)*Math.floor((e+5)/6)*16;case vy:return Math.floor((s+9)/10)*Math.floor((e+7)/8)*16;case yy:return Math.floor((s+9)/10)*Math.floor((e+9)/10)*16;case _y:return Math.floor((s+11)/12)*Math.floor((e+9)/10)*16;case xy:return Math.floor((s+11)/12)*Math.floor((e+11)/12)*16;case Sy:case My:case by:return Math.ceil(s/4)*Math.ceil(e/4)*16;case Ey:case Ty:return Math.ceil(s/4)*Math.ceil(e/4)*8;case Ay:case Ry:return Math.ceil(s/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function SD(s){switch(s){case Pr:case Vy:return{byteLength:1,components:1};case Ud:case ky:case Ia:return{byteLength:2,components:1};case Xy:case Yy:return{byteLength:2,components:4};case Ml:case hg:case Vi:return{byteLength:4,components:1};case mS:case gS:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${s}.`)}class MD{static contain(e,t){return yD(e,t)}static cover(e,t){return _D(e,t)}static fill(e){return xD(e)}static getByteLength(e,t,n,i){return Kx(e,t,n,i)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:cg}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=cg);function G2(){let s=null,e=!1,t=null,n=null;function i(a,l){t(a,l),n=s.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=s.requestAnimationFrame(i),e=!0)},stop:function(){s.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(a){t=a},setContext:function(a){s=a}}}function bD(s){const e=new WeakMap;function t(u,f){const p=u.array,m=u.usage,v=p.byteLength,_=s.createBuffer();s.bindBuffer(f,_),s.bufferData(f,p,m),u.onUploadCallback();let x;if(p instanceof Float32Array)x=s.FLOAT;else if(typeof Float16Array<"u"&&p instanceof Float16Array)x=s.HALF_FLOAT;else if(p instanceof Uint16Array)u.isFloat16BufferAttribute?x=s.HALF_FLOAT:x=s.UNSIGNED_SHORT;else if(p instanceof Int16Array)x=s.SHORT;else if(p instanceof Uint32Array)x=s.UNSIGNED_INT;else if(p instanceof Int32Array)x=s.INT;else if(p instanceof Int8Array)x=s.BYTE;else if(p instanceof Uint8Array)x=s.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)x=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:_,type:x,bytesPerElement:p.BYTES_PER_ELEMENT,version:u.version,size:v}}function n(u,f,p){const m=f.array,v=f.updateRanges;if(s.bindBuffer(p,u),v.length===0)s.bufferSubData(p,0,m);else{v.sort((x,b)=>x.start-b.start);let _=0;for(let x=1;x<v.length;x++){const b=v[_],R=v[x];R.start<=b.start+b.count+1?b.count=Math.max(b.count,R.start+R.count-b.start):(++_,v[_]=R)}v.length=_+1;for(let x=0,b=v.length;x<b;x++){const R=v[x];s.bufferSubData(p,R.start*m.BYTES_PER_ELEMENT,m,R.start,R.count)}f.clearUpdateRanges()}f.onUploadCallback()}function i(u){return u.isInterleavedBufferAttribute&&(u=u.data),e.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const f=e.get(u);f&&(s.deleteBuffer(f.buffer),e.delete(u))}function l(u,f){if(u.isInterleavedBufferAttribute&&(u=u.data),u.isGLBufferAttribute){const m=e.get(u);(!m||m.version<u.version)&&e.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}const p=e.get(u);if(p===void 0)e.set(u,t(u,f));else if(p.version<u.version){if(p.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(p.buffer,u,f),p.version=u.version}}return{get:i,remove:a,update:l}}var ED=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,TD=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,AD=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,RD=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,CD=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,wD=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,UD=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,DD=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,ND=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,OD=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,LD=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,zD=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,ID=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,BD=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,PD=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,FD=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,HD=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,GD=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,VD=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,kD=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,XD=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,YD=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,qD=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,WD=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,jD=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,ZD=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,KD=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,QD=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,JD=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,$D=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,eN="gl_FragColor = linearToOutputTexel( gl_FragColor );",tN=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,nN=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,iN=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,aN=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,rN=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,sN=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,oN=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,lN=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,uN=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,cN=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,fN=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,hN=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,dN=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,pN=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,mN=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,gN=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,vN=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,yN=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,_N=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,xN=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,SN=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,MN=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,bN=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,EN=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,TN=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,AN=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,RN=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,CN=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,wN=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,UN=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,DN=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,NN=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,ON=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,LN=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,zN=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,IN=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,BN=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,PN=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,FN=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,HN=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,GN=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,VN=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,kN=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,XN=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,YN=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,qN=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,WN=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,jN=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,ZN=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,KN=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,QN=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,JN=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,$N=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,eO=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,tO=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,nO=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,iO=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,aO=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,rO=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		float depth = unpackRGBAToDepth( texture2D( depths, uv ) );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			return step( depth, compare );
		#else
			return step( compare, depth );
		#endif
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow( sampler2D shadow, vec2 uv, float compare ) {
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			float hard_shadow = step( distribution.x, compare );
		#else
			float hard_shadow = step( compare, distribution.x );
		#endif
		if ( hard_shadow != 1.0 ) {
			float distance = compare - distribution.x;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,sO=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,oO=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,lO=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,uO=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,cO=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,fO=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,hO=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,dO=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,pO=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,mO=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,gO=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,vO=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,yO=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,_O=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,xO=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,SO=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,MO=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const bO=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,EO=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,TO=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,AO=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,RO=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,CO=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,wO=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,UO=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,DO=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,NO=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,OO=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,LO=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,zO=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,IO=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,BO=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,PO=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,FO=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,HO=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GO=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,VO=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,kO=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,XO=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,YO=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,qO=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,WO=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,jO=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ZO=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,KO=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,QO=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,JO=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,$O=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,eL=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,tL=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,nL=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,xn={alphahash_fragment:ED,alphahash_pars_fragment:TD,alphamap_fragment:AD,alphamap_pars_fragment:RD,alphatest_fragment:CD,alphatest_pars_fragment:wD,aomap_fragment:UD,aomap_pars_fragment:DD,batching_pars_vertex:ND,batching_vertex:OD,begin_vertex:LD,beginnormal_vertex:zD,bsdfs:ID,iridescence_fragment:BD,bumpmap_pars_fragment:PD,clipping_planes_fragment:FD,clipping_planes_pars_fragment:HD,clipping_planes_pars_vertex:GD,clipping_planes_vertex:VD,color_fragment:kD,color_pars_fragment:XD,color_pars_vertex:YD,color_vertex:qD,common:WD,cube_uv_reflection_fragment:jD,defaultnormal_vertex:ZD,displacementmap_pars_vertex:KD,displacementmap_vertex:QD,emissivemap_fragment:JD,emissivemap_pars_fragment:$D,colorspace_fragment:eN,colorspace_pars_fragment:tN,envmap_fragment:nN,envmap_common_pars_fragment:iN,envmap_pars_fragment:aN,envmap_pars_vertex:rN,envmap_physical_pars_fragment:gN,envmap_vertex:sN,fog_vertex:oN,fog_pars_vertex:lN,fog_fragment:uN,fog_pars_fragment:cN,gradientmap_pars_fragment:fN,lightmap_pars_fragment:hN,lights_lambert_fragment:dN,lights_lambert_pars_fragment:pN,lights_pars_begin:mN,lights_toon_fragment:vN,lights_toon_pars_fragment:yN,lights_phong_fragment:_N,lights_phong_pars_fragment:xN,lights_physical_fragment:SN,lights_physical_pars_fragment:MN,lights_fragment_begin:bN,lights_fragment_maps:EN,lights_fragment_end:TN,logdepthbuf_fragment:AN,logdepthbuf_pars_fragment:RN,logdepthbuf_pars_vertex:CN,logdepthbuf_vertex:wN,map_fragment:UN,map_pars_fragment:DN,map_particle_fragment:NN,map_particle_pars_fragment:ON,metalnessmap_fragment:LN,metalnessmap_pars_fragment:zN,morphinstance_vertex:IN,morphcolor_vertex:BN,morphnormal_vertex:PN,morphtarget_pars_vertex:FN,morphtarget_vertex:HN,normal_fragment_begin:GN,normal_fragment_maps:VN,normal_pars_fragment:kN,normal_pars_vertex:XN,normal_vertex:YN,normalmap_pars_fragment:qN,clearcoat_normal_fragment_begin:WN,clearcoat_normal_fragment_maps:jN,clearcoat_pars_fragment:ZN,iridescence_pars_fragment:KN,opaque_fragment:QN,packing:JN,premultiplied_alpha_fragment:$N,project_vertex:eO,dithering_fragment:tO,dithering_pars_fragment:nO,roughnessmap_fragment:iO,roughnessmap_pars_fragment:aO,shadowmap_pars_fragment:rO,shadowmap_pars_vertex:sO,shadowmap_vertex:oO,shadowmask_pars_fragment:lO,skinbase_vertex:uO,skinning_pars_vertex:cO,skinning_vertex:fO,skinnormal_vertex:hO,specularmap_fragment:dO,specularmap_pars_fragment:pO,tonemapping_fragment:mO,tonemapping_pars_fragment:gO,transmission_fragment:vO,transmission_pars_fragment:yO,uv_pars_fragment:_O,uv_pars_vertex:xO,uv_vertex:SO,worldpos_vertex:MO,background_vert:bO,background_frag:EO,backgroundCube_vert:TO,backgroundCube_frag:AO,cube_vert:RO,cube_frag:CO,depth_vert:wO,depth_frag:UO,distanceRGBA_vert:DO,distanceRGBA_frag:NO,equirect_vert:OO,equirect_frag:LO,linedashed_vert:zO,linedashed_frag:IO,meshbasic_vert:BO,meshbasic_frag:PO,meshlambert_vert:FO,meshlambert_frag:HO,meshmatcap_vert:GO,meshmatcap_frag:VO,meshnormal_vert:kO,meshnormal_frag:XO,meshphong_vert:YO,meshphong_frag:qO,meshphysical_vert:WO,meshphysical_frag:jO,meshtoon_vert:ZO,meshtoon_frag:KO,points_vert:QO,points_frag:JO,shadow_vert:$O,shadow_frag:eL,sprite_vert:tL,sprite_frag:nL},It={common:{diffuse:{value:new Nt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new dn},alphaMap:{value:null},alphaMapTransform:{value:new dn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new dn}},envmap:{envMap:{value:null},envMapRotation:{value:new dn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new dn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new dn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new dn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new dn},normalScale:{value:new ht(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new dn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new dn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new dn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new dn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Nt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Nt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new dn},alphaTest:{value:0},uvTransform:{value:new dn}},sprite:{diffuse:{value:new Nt(16777215)},opacity:{value:1},center:{value:new ht(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new dn},alphaMap:{value:null},alphaMapTransform:{value:new dn},alphaTest:{value:0}}},Uo={basic:{uniforms:Nr([It.common,It.specularmap,It.envmap,It.aomap,It.lightmap,It.fog]),vertexShader:xn.meshbasic_vert,fragmentShader:xn.meshbasic_frag},lambert:{uniforms:Nr([It.common,It.specularmap,It.envmap,It.aomap,It.lightmap,It.emissivemap,It.bumpmap,It.normalmap,It.displacementmap,It.fog,It.lights,{emissive:{value:new Nt(0)}}]),vertexShader:xn.meshlambert_vert,fragmentShader:xn.meshlambert_frag},phong:{uniforms:Nr([It.common,It.specularmap,It.envmap,It.aomap,It.lightmap,It.emissivemap,It.bumpmap,It.normalmap,It.displacementmap,It.fog,It.lights,{emissive:{value:new Nt(0)},specular:{value:new Nt(1118481)},shininess:{value:30}}]),vertexShader:xn.meshphong_vert,fragmentShader:xn.meshphong_frag},standard:{uniforms:Nr([It.common,It.envmap,It.aomap,It.lightmap,It.emissivemap,It.bumpmap,It.normalmap,It.displacementmap,It.roughnessmap,It.metalnessmap,It.fog,It.lights,{emissive:{value:new Nt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:xn.meshphysical_vert,fragmentShader:xn.meshphysical_frag},toon:{uniforms:Nr([It.common,It.aomap,It.lightmap,It.emissivemap,It.bumpmap,It.normalmap,It.displacementmap,It.gradientmap,It.fog,It.lights,{emissive:{value:new Nt(0)}}]),vertexShader:xn.meshtoon_vert,fragmentShader:xn.meshtoon_frag},matcap:{uniforms:Nr([It.common,It.bumpmap,It.normalmap,It.displacementmap,It.fog,{matcap:{value:null}}]),vertexShader:xn.meshmatcap_vert,fragmentShader:xn.meshmatcap_frag},points:{uniforms:Nr([It.points,It.fog]),vertexShader:xn.points_vert,fragmentShader:xn.points_frag},dashed:{uniforms:Nr([It.common,It.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:xn.linedashed_vert,fragmentShader:xn.linedashed_frag},depth:{uniforms:Nr([It.common,It.displacementmap]),vertexShader:xn.depth_vert,fragmentShader:xn.depth_frag},normal:{uniforms:Nr([It.common,It.bumpmap,It.normalmap,It.displacementmap,{opacity:{value:1}}]),vertexShader:xn.meshnormal_vert,fragmentShader:xn.meshnormal_frag},sprite:{uniforms:Nr([It.sprite,It.fog]),vertexShader:xn.sprite_vert,fragmentShader:xn.sprite_frag},background:{uniforms:{uvTransform:{value:new dn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:xn.background_vert,fragmentShader:xn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new dn}},vertexShader:xn.backgroundCube_vert,fragmentShader:xn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:xn.cube_vert,fragmentShader:xn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:xn.equirect_vert,fragmentShader:xn.equirect_frag},distanceRGBA:{uniforms:Nr([It.common,It.displacementmap,{referencePosition:{value:new ne},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:xn.distanceRGBA_vert,fragmentShader:xn.distanceRGBA_frag},shadow:{uniforms:Nr([It.lights,It.fog,{color:{value:new Nt(0)},opacity:{value:1}}]),vertexShader:xn.shadow_vert,fragmentShader:xn.shadow_frag}};Uo.physical={uniforms:Nr([Uo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new dn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new dn},clearcoatNormalScale:{value:new ht(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new dn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new dn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new dn},sheen:{value:0},sheenColor:{value:new Nt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new dn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new dn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new dn},transmissionSamplerSize:{value:new ht},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new dn},attenuationDistance:{value:0},attenuationColor:{value:new Nt(0)},specularColor:{value:new Nt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new dn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new dn},anisotropyVector:{value:new ht},anisotropyMap:{value:null},anisotropyMapTransform:{value:new dn}}]),vertexShader:xn.meshphysical_vert,fragmentShader:xn.meshphysical_frag};const Av={r:0,b:0,g:0},Sf=new ns,iL=new Qt;function aL(s,e,t,n,i,a,l){const u=new Nt(0);let f=a===!0?0:1,p,m,v=null,_=0,x=null;function b(D){let U=D.isScene===!0?D.background:null;return U&&U.isTexture&&(U=(D.backgroundBlurriness>0?t:e).get(U)),U}function R(D){let U=!1;const I=b(D);I===null?E(u,f):I&&I.isColor&&(E(I,1),U=!0);const O=s.xr.getEnvironmentBlendMode();O==="additive"?n.buffers.color.setClear(0,0,0,1,l):O==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,l),(s.autoClear||U)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil))}function T(D,U){const I=b(U);I&&(I.isCubeTexture||I.mapping===Xd)?(m===void 0&&(m=new Si(new Zf(1,1,1),new Fr({name:"BackgroundCubeMaterial",uniforms:Hd(Uo.backgroundCube.uniforms),vertexShader:Uo.backgroundCube.vertexShader,fragmentShader:Uo.backgroundCube.fragmentShader,side:Ir,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(O,P,B){this.matrixWorld.copyPosition(B.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(m)),Sf.copy(U.backgroundRotation),Sf.x*=-1,Sf.y*=-1,Sf.z*=-1,I.isCubeTexture&&I.isRenderTargetTexture===!1&&(Sf.y*=-1,Sf.z*=-1),m.material.uniforms.envMap.value=I,m.material.uniforms.flipEnvMap.value=I.isCubeTexture&&I.isRenderTargetTexture===!1?-1:1,m.material.uniforms.backgroundBlurriness.value=U.backgroundBlurriness,m.material.uniforms.backgroundIntensity.value=U.backgroundIntensity,m.material.uniforms.backgroundRotation.value.setFromMatrix4(iL.makeRotationFromEuler(Sf)),m.material.toneMapped=On.getTransfer(I.colorSpace)!==ui,(v!==I||_!==I.version||x!==s.toneMapping)&&(m.material.needsUpdate=!0,v=I,_=I.version,x=s.toneMapping),m.layers.enableAll(),D.unshift(m,m.geometry,m.material,0,0,null)):I&&I.isTexture&&(p===void 0&&(p=new Si(new zo(2,2),new Fr({name:"BackgroundMaterial",uniforms:Hd(Uo.background.uniforms),vertexShader:Uo.background.vertexShader,fragmentShader:Uo.background.fragmentShader,side:xl,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(p)),p.material.uniforms.t2D.value=I,p.material.uniforms.backgroundIntensity.value=U.backgroundIntensity,p.material.toneMapped=On.getTransfer(I.colorSpace)!==ui,I.matrixAutoUpdate===!0&&I.updateMatrix(),p.material.uniforms.uvTransform.value.copy(I.matrix),(v!==I||_!==I.version||x!==s.toneMapping)&&(p.material.needsUpdate=!0,v=I,_=I.version,x=s.toneMapping),p.layers.enableAll(),D.unshift(p,p.geometry,p.material,0,0,null))}function E(D,U){D.getRGB(Av,KA(s)),n.buffers.color.setClear(Av.r,Av.g,Av.b,U,l)}function w(){m!==void 0&&(m.geometry.dispose(),m.material.dispose(),m=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return u},setClearColor:function(D,U=1){u.set(D),f=U,E(u,f)},getClearAlpha:function(){return f},setClearAlpha:function(D){f=D,E(u,f)},render:R,addToRenderList:T,dispose:w}}function rL(s,e){const t=s.getParameter(s.MAX_VERTEX_ATTRIBS),n={},i=_(null);let a=i,l=!1;function u(z,q,Y,Q,Z){let ae=!1;const G=v(Q,Y,q);a!==G&&(a=G,p(a.object)),ae=x(z,Q,Y,Z),ae&&b(z,Q,Y,Z),Z!==null&&e.update(Z,s.ELEMENT_ARRAY_BUFFER),(ae||l)&&(l=!1,U(z,q,Y,Q),Z!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.get(Z).buffer))}function f(){return s.createVertexArray()}function p(z){return s.bindVertexArray(z)}function m(z){return s.deleteVertexArray(z)}function v(z,q,Y){const Q=Y.wireframe===!0;let Z=n[z.id];Z===void 0&&(Z={},n[z.id]=Z);let ae=Z[q.id];ae===void 0&&(ae={},Z[q.id]=ae);let G=ae[Q];return G===void 0&&(G=_(f()),ae[Q]=G),G}function _(z){const q=[],Y=[],Q=[];for(let Z=0;Z<t;Z++)q[Z]=0,Y[Z]=0,Q[Z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:q,enabledAttributes:Y,attributeDivisors:Q,object:z,attributes:{},index:null}}function x(z,q,Y,Q){const Z=a.attributes,ae=q.attributes;let G=0;const ee=Y.getAttributes();for(const ie in ee)if(ee[ie].location>=0){const ce=Z[ie];let H=ae[ie];if(H===void 0&&(ie==="instanceMatrix"&&z.instanceMatrix&&(H=z.instanceMatrix),ie==="instanceColor"&&z.instanceColor&&(H=z.instanceColor)),ce===void 0||ce.attribute!==H||H&&ce.data!==H.data)return!0;G++}return a.attributesNum!==G||a.index!==Q}function b(z,q,Y,Q){const Z={},ae=q.attributes;let G=0;const ee=Y.getAttributes();for(const ie in ee)if(ee[ie].location>=0){let ce=ae[ie];ce===void 0&&(ie==="instanceMatrix"&&z.instanceMatrix&&(ce=z.instanceMatrix),ie==="instanceColor"&&z.instanceColor&&(ce=z.instanceColor));const H={};H.attribute=ce,ce&&ce.data&&(H.data=ce.data),Z[ie]=H,G++}a.attributes=Z,a.attributesNum=G,a.index=Q}function R(){const z=a.newAttributes;for(let q=0,Y=z.length;q<Y;q++)z[q]=0}function T(z){E(z,0)}function E(z,q){const Y=a.newAttributes,Q=a.enabledAttributes,Z=a.attributeDivisors;Y[z]=1,Q[z]===0&&(s.enableVertexAttribArray(z),Q[z]=1),Z[z]!==q&&(s.vertexAttribDivisor(z,q),Z[z]=q)}function w(){const z=a.newAttributes,q=a.enabledAttributes;for(let Y=0,Q=q.length;Y<Q;Y++)q[Y]!==z[Y]&&(s.disableVertexAttribArray(Y),q[Y]=0)}function D(z,q,Y,Q,Z,ae,G){G===!0?s.vertexAttribIPointer(z,q,Y,Z,ae):s.vertexAttribPointer(z,q,Y,Q,Z,ae)}function U(z,q,Y,Q){R();const Z=Q.attributes,ae=Y.getAttributes(),G=q.defaultAttributeValues;for(const ee in ae){const ie=ae[ee];if(ie.location>=0){let fe=Z[ee];if(fe===void 0&&(ee==="instanceMatrix"&&z.instanceMatrix&&(fe=z.instanceMatrix),ee==="instanceColor"&&z.instanceColor&&(fe=z.instanceColor)),fe!==void 0){const ce=fe.normalized,H=fe.itemSize,W=e.get(fe);if(W===void 0)continue;const re=W.buffer,de=W.type,ge=W.bytesPerElement,oe=de===s.INT||de===s.UNSIGNED_INT||fe.gpuType===hg;if(fe.isInterleavedBufferAttribute){const he=fe.data,Ee=he.stride,We=fe.offset;if(he.isInstancedInterleavedBuffer){for(let rt=0;rt<ie.locationSize;rt++)E(ie.location+rt,he.meshPerAttribute);z.isInstancedMesh!==!0&&Q._maxInstanceCount===void 0&&(Q._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let rt=0;rt<ie.locationSize;rt++)T(ie.location+rt);s.bindBuffer(s.ARRAY_BUFFER,re);for(let rt=0;rt<ie.locationSize;rt++)D(ie.location+rt,H/ie.locationSize,de,ce,Ee*ge,(We+H/ie.locationSize*rt)*ge,oe)}else{if(fe.isInstancedBufferAttribute){for(let he=0;he<ie.locationSize;he++)E(ie.location+he,fe.meshPerAttribute);z.isInstancedMesh!==!0&&Q._maxInstanceCount===void 0&&(Q._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let he=0;he<ie.locationSize;he++)T(ie.location+he);s.bindBuffer(s.ARRAY_BUFFER,re);for(let he=0;he<ie.locationSize;he++)D(ie.location+he,H/ie.locationSize,de,ce,H*ge,H/ie.locationSize*he*ge,oe)}}else if(G!==void 0){const ce=G[ee];if(ce!==void 0)switch(ce.length){case 2:s.vertexAttrib2fv(ie.location,ce);break;case 3:s.vertexAttrib3fv(ie.location,ce);break;case 4:s.vertexAttrib4fv(ie.location,ce);break;default:s.vertexAttrib1fv(ie.location,ce)}}}}w()}function I(){B();for(const z in n){const q=n[z];for(const Y in q){const Q=q[Y];for(const Z in Q)m(Q[Z].object),delete Q[Z];delete q[Y]}delete n[z]}}function O(z){if(n[z.id]===void 0)return;const q=n[z.id];for(const Y in q){const Q=q[Y];for(const Z in Q)m(Q[Z].object),delete Q[Z];delete q[Y]}delete n[z.id]}function P(z){for(const q in n){const Y=n[q];if(Y[z.id]===void 0)continue;const Q=Y[z.id];for(const Z in Q)m(Q[Z].object),delete Q[Z];delete Y[z.id]}}function B(){N(),l=!0,a!==i&&(a=i,p(a.object))}function N(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:u,reset:B,resetDefaultState:N,dispose:I,releaseStatesOfGeometry:O,releaseStatesOfProgram:P,initAttributes:R,enableAttribute:T,disableUnusedAttributes:w}}function sL(s,e,t){let n;function i(p){n=p}function a(p,m){s.drawArrays(n,p,m),t.update(m,n,1)}function l(p,m,v){v!==0&&(s.drawArraysInstanced(n,p,m,v),t.update(m,n,v))}function u(p,m,v){if(v===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,p,0,m,0,v);let x=0;for(let b=0;b<v;b++)x+=m[b];t.update(x,n,1)}function f(p,m,v,_){if(v===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let b=0;b<p.length;b++)l(p[b],m[b],_[b]);else{x.multiDrawArraysInstancedWEBGL(n,p,0,m,0,_,0,v);let b=0;for(let R=0;R<v;R++)b+=m[R]*_[R];t.update(b,n,1)}}this.setMode=i,this.render=a,this.renderInstances=l,this.renderMultiDraw=u,this.renderMultiDrawInstances=f}function oL(s,e,t,n){let i;function a(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const P=e.get("EXT_texture_filter_anisotropic");i=s.getParameter(P.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function l(P){return!(P!==na&&n.convert(P)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_FORMAT))}function u(P){const B=P===Ia&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(P!==Pr&&n.convert(P)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_TYPE)&&P!==Vi&&!B)}function f(P){if(P==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";P="mediump"}return P==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const m=f(p);m!==p&&(console.warn("THREE.WebGLRenderer:",p,"not supported, using",m,"instead."),p=m);const v=t.logarithmicDepthBuffer===!0,_=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),x=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),b=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),R=s.getParameter(s.MAX_TEXTURE_SIZE),T=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),E=s.getParameter(s.MAX_VERTEX_ATTRIBS),w=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),D=s.getParameter(s.MAX_VARYING_VECTORS),U=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),I=b>0,O=s.getParameter(s.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:f,textureFormatReadable:l,textureTypeReadable:u,precision:p,logarithmicDepthBuffer:v,reversedDepthBuffer:_,maxTextures:x,maxVertexTextures:b,maxTextureSize:R,maxCubemapSize:T,maxAttributes:E,maxVertexUniforms:w,maxVaryings:D,maxFragmentUniforms:U,vertexTextures:I,maxSamples:O}}function lL(s){const e=this;let t=null,n=0,i=!1,a=!1;const l=new du,u=new dn,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(v,_){const x=v.length!==0||_||n!==0||i;return i=_,n=v.length,x},this.beginShadows=function(){a=!0,m(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(v,_){t=m(v,_,0)},this.setState=function(v,_,x){const b=v.clippingPlanes,R=v.clipIntersection,T=v.clipShadows,E=s.get(v);if(!i||b===null||b.length===0||a&&!T)a?m(null):p();else{const w=a?0:n,D=w*4;let U=E.clippingState||null;f.value=U,U=m(b,_,D,x);for(let I=0;I!==D;++I)U[I]=t[I];E.clippingState=U,this.numIntersection=R?this.numPlanes:0,this.numPlanes+=w}};function p(){f.value!==t&&(f.value=t,f.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function m(v,_,x,b){const R=v!==null?v.length:0;let T=null;if(R!==0){if(T=f.value,b!==!0||T===null){const E=x+R*4,w=_.matrixWorldInverse;u.getNormalMatrix(w),(T===null||T.length<E)&&(T=new Float32Array(E));for(let D=0,U=x;D!==R;++D,U+=4)l.copy(v[D]).applyMatrix4(w,u),l.normal.toArray(T,U),T[U+3]=l.constant}f.value=T,f.needsUpdate=!0}return e.numPlanes=R,e.numIntersection=0,T}}function uL(s){let e=new WeakMap;function t(l,u){return u===Cd?l.mapping=Sl:u===Qm&&(l.mapping=vc),l}function n(l){if(l&&l.isTexture){const u=l.mapping;if(u===Cd||u===Qm)if(e.has(l)){const f=e.get(l).texture;return t(f,l.mapping)}else{const f=l.image;if(f&&f.height>0){const p=new wS(f.height);return p.fromEquirectangularTexture(s,l),e.set(l,p),l.addEventListener("dispose",i),t(p.texture,l.mapping)}else return null}}return l}function i(l){const u=l.target;u.removeEventListener("dispose",i);const f=e.get(u);f!==void 0&&(e.delete(u),f.dispose())}function a(){e=new WeakMap}return{get:n,dispose:a}}const bd=4,BE=[.125,.215,.35,.446,.526,.582],Uf=20,ex=new _l,PE=new Nt;let tx=null,nx=0,ix=0,ax=!1;const wf=(1+Math.sqrt(5))/2,gd=1/wf,FE=[new ne(-wf,gd,0),new ne(wf,gd,0),new ne(-gd,0,wf),new ne(gd,0,wf),new ne(0,wf,-gd),new ne(0,wf,gd),new ne(-1,1,-1),new ne(1,1,-1),new ne(-1,1,1),new ne(1,1,1)],cL=new ne;class Qx{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100,a={}){const{size:l=256,position:u=cL}=a;tx=this._renderer.getRenderTarget(),nx=this._renderer.getActiveCubeFace(),ix=this._renderer.getActiveMipmapLevel(),ax=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(l);const f=this._allocateTargets();return f.depthBuffer=!0,this._sceneToCubeUV(e,n,i,f,u),t>0&&this._blur(f,0,0,t),this._applyPMREM(f),this._cleanup(f),f}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=VE(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=GE(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(tx,nx,ix),this._renderer.xr.enabled=ax,e.scissorTest=!1,Rv(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Sl||e.mapping===vc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),tx=this._renderer.getRenderTarget(),nx=this._renderer.getActiveCubeFace(),ix=this._renderer.getActiveMipmapLevel(),ax=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Wn,minFilter:Wn,generateMipmaps:!1,type:Ia,format:na,colorSpace:fa,depthBuffer:!1},i=HE(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=HE(e,t,n);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=fL(a)),this._blurMaterial=hL(a,e,t)}return i}_compileMaterial(e){const t=new Si(this._lodPlanes[0],e);this._renderer.compile(t,ex)}_sceneToCubeUV(e,t,n,i,a){const f=new Zi(90,1,t,n),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],v=this._renderer,_=v.autoClear,x=v.toneMapping;v.getClearColor(PE),v.toneMapping=yl,v.autoClear=!1,v.state.buffers.depth.getReversed()&&(v.setRenderTarget(i),v.clearDepth(),v.setRenderTarget(null));const R=new zr({name:"PMREM.Background",side:Ir,depthWrite:!1,depthTest:!1}),T=new Si(new Zf,R);let E=!1;const w=e.background;w?w.isColor&&(R.color.copy(w),e.background=null,E=!0):(R.color.copy(PE),E=!0);for(let D=0;D<6;D++){const U=D%3;U===0?(f.up.set(0,p[D],0),f.position.set(a.x,a.y,a.z),f.lookAt(a.x+m[D],a.y,a.z)):U===1?(f.up.set(0,0,p[D]),f.position.set(a.x,a.y,a.z),f.lookAt(a.x,a.y+m[D],a.z)):(f.up.set(0,p[D],0),f.position.set(a.x,a.y,a.z),f.lookAt(a.x,a.y,a.z+m[D]));const I=this._cubeSize;Rv(i,U*I,D>2?I:0,I,I),v.setRenderTarget(i),E&&v.render(T,f),v.render(e,f)}T.geometry.dispose(),T.material.dispose(),v.toneMapping=x,v.autoClear=_,e.background=w}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===Sl||e.mapping===vc;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=VE()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=GE());const a=i?this._cubemapMaterial:this._equirectMaterial,l=new Si(this._lodPlanes[0],a),u=a.uniforms;u.envMap.value=e;const f=this._cubeSize;Rv(t,0,0,3*f,2*f),n.setRenderTarget(t),n.render(l,ex)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let a=1;a<i;a++){const l=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]),u=FE[(i-a-1)%FE.length];this._blur(e,a-1,a,l,u)}t.autoClear=n}_blur(e,t,n,i,a){const l=this._pingPongRenderTarget;this._halfBlur(e,l,t,n,i,"latitudinal",a),this._halfBlur(l,e,n,n,i,"longitudinal",a)}_halfBlur(e,t,n,i,a,l,u){const f=this._renderer,p=this._blurMaterial;l!=="latitudinal"&&l!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const m=3,v=new Si(this._lodPlanes[i],p),_=p.uniforms,x=this._sizeLods[n]-1,b=isFinite(a)?Math.PI/(2*x):2*Math.PI/(2*Uf-1),R=a/b,T=isFinite(a)?1+Math.floor(m*R):Uf;T>Uf&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${T} samples when the maximum is set to ${Uf}`);const E=[];let w=0;for(let P=0;P<Uf;++P){const B=P/R,N=Math.exp(-B*B/2);E.push(N),P===0?w+=N:P<T&&(w+=2*N)}for(let P=0;P<E.length;P++)E[P]=E[P]/w;_.envMap.value=e.texture,_.samples.value=T,_.weights.value=E,_.latitudinal.value=l==="latitudinal",u&&(_.poleAxis.value=u);const{_lodMax:D}=this;_.dTheta.value=b,_.mipInt.value=D-n;const U=this._sizeLods[i],I=3*U*(i>D-bd?i-D+bd:0),O=4*(this._cubeSize-U);Rv(t,I,O,3*U,2*U),f.setRenderTarget(t),f.render(v,ex)}}function fL(s){const e=[],t=[],n=[];let i=s;const a=s-bd+1+BE.length;for(let l=0;l<a;l++){const u=Math.pow(2,i);t.push(u);let f=1/u;l>s-bd?f=BE[l-s+bd-1]:l===0&&(f=0),n.push(f);const p=1/(u-2),m=-p,v=1+p,_=[m,m,v,m,v,v,m,m,v,v,m,v],x=6,b=6,R=3,T=2,E=1,w=new Float32Array(R*b*x),D=new Float32Array(T*b*x),U=new Float32Array(E*b*x);for(let O=0;O<x;O++){const P=O%3*2/3-1,B=O>2?0:-1,N=[P,B,0,P+2/3,B,0,P+2/3,B+1,0,P,B,0,P+2/3,B+1,0,P,B+1,0];w.set(N,R*b*O),D.set(_,T*b*O);const z=[O,O,O,O,O,O];U.set(z,E*b*O)}const I=new vn;I.setAttribute("position",new ii(w,R)),I.setAttribute("uv",new ii(D,T)),I.setAttribute("faceIndex",new ii(U,E)),e.push(I),i>bd&&i--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function HE(s,e,t){const n=new Ks(s,e,t);return n.texture.mapping=Xd,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Rv(s,e,t,n,i){s.viewport.set(e,t,n,i),s.scissor.set(e,t,n,i)}function hL(s,e,t){const n=new Float32Array(Uf),i=new ne(0,1,0);return new Fr({name:"SphericalGaussianBlur",defines:{n:Uf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:rM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:vl,depthTest:!1,depthWrite:!1})}function GE(){return new Fr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:rM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:vl,depthTest:!1,depthWrite:!1})}function VE(){return new Fr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:rM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:vl,depthTest:!1,depthWrite:!1})}function rM(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function dL(s){let e=new WeakMap,t=null;function n(u){if(u&&u.isTexture){const f=u.mapping,p=f===Cd||f===Qm,m=f===Sl||f===vc;if(p||m){let v=e.get(u);const _=v!==void 0?v.texture.pmremVersion:0;if(u.isRenderTargetTexture&&u.pmremVersion!==_)return t===null&&(t=new Qx(s)),v=p?t.fromEquirectangular(u,v):t.fromCubemap(u,v),v.texture.pmremVersion=u.pmremVersion,e.set(u,v),v.texture;if(v!==void 0)return v.texture;{const x=u.image;return p&&x&&x.height>0||m&&x&&i(x)?(t===null&&(t=new Qx(s)),v=p?t.fromEquirectangular(u):t.fromCubemap(u),v.texture.pmremVersion=u.pmremVersion,e.set(u,v),u.addEventListener("dispose",a),v.texture):null}}}return u}function i(u){let f=0;const p=6;for(let m=0;m<p;m++)u[m]!==void 0&&f++;return f===p}function a(u){const f=u.target;f.removeEventListener("dispose",a);const p=e.get(f);p!==void 0&&(e.delete(f),p.dispose())}function l(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:l}}function pL(s){const e={};function t(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=s.getExtension(n)}return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const i=t(n);return i===null&&ng("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function mL(s,e,t,n){const i={},a=new WeakMap;function l(v){const _=v.target;_.index!==null&&e.remove(_.index);for(const b in _.attributes)e.remove(_.attributes[b]);_.removeEventListener("dispose",l),delete i[_.id];const x=a.get(_);x&&(e.remove(x),a.delete(_)),n.releaseStatesOfGeometry(_),_.isInstancedBufferGeometry===!0&&delete _._maxInstanceCount,t.memory.geometries--}function u(v,_){return i[_.id]===!0||(_.addEventListener("dispose",l),i[_.id]=!0,t.memory.geometries++),_}function f(v){const _=v.attributes;for(const x in _)e.update(_[x],s.ARRAY_BUFFER)}function p(v){const _=[],x=v.index,b=v.attributes.position;let R=0;if(x!==null){const w=x.array;R=x.version;for(let D=0,U=w.length;D<U;D+=3){const I=w[D+0],O=w[D+1],P=w[D+2];_.push(I,O,O,P,P,I)}}else if(b!==void 0){const w=b.array;R=b.version;for(let D=0,U=w.length/3-1;D<U;D+=3){const I=D+0,O=D+1,P=D+2;_.push(I,O,O,P,P,I)}}else return;const T=new(qA(_)?RS:AS)(_,1);T.version=R;const E=a.get(v);E&&e.remove(E),a.set(v,T)}function m(v){const _=a.get(v);if(_){const x=v.index;x!==null&&_.version<x.version&&p(v)}else p(v);return a.get(v)}return{get:u,update:f,getWireframeAttribute:m}}function gL(s,e,t){let n;function i(_){n=_}let a,l;function u(_){a=_.type,l=_.bytesPerElement}function f(_,x){s.drawElements(n,x,a,_*l),t.update(x,n,1)}function p(_,x,b){b!==0&&(s.drawElementsInstanced(n,x,a,_*l,b),t.update(x,n,b))}function m(_,x,b){if(b===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,x,0,a,_,0,b);let T=0;for(let E=0;E<b;E++)T+=x[E];t.update(T,n,1)}function v(_,x,b,R){if(b===0)return;const T=e.get("WEBGL_multi_draw");if(T===null)for(let E=0;E<_.length;E++)p(_[E]/l,x[E],R[E]);else{T.multiDrawElementsInstancedWEBGL(n,x,0,a,_,0,R,0,b);let E=0;for(let w=0;w<b;w++)E+=x[w]*R[w];t.update(E,n,1)}}this.setMode=i,this.setIndex=u,this.render=f,this.renderInstances=p,this.renderMultiDraw=m,this.renderMultiDrawInstances=v}function vL(s){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(a,l,u){switch(t.calls++,l){case s.TRIANGLES:t.triangles+=u*(a/3);break;case s.LINES:t.lines+=u*(a/2);break;case s.LINE_STRIP:t.lines+=u*(a-1);break;case s.LINE_LOOP:t.lines+=u*a;break;case s.POINTS:t.points+=u*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",l);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:n}}function yL(s,e,t){const n=new WeakMap,i=new kn;function a(l,u,f){const p=l.morphTargetInfluences,m=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,v=m!==void 0?m.length:0;let _=n.get(u);if(_===void 0||_.count!==v){let z=function(){B.dispose(),n.delete(u),u.removeEventListener("dispose",z)};var x=z;_!==void 0&&_.texture.dispose();const b=u.morphAttributes.position!==void 0,R=u.morphAttributes.normal!==void 0,T=u.morphAttributes.color!==void 0,E=u.morphAttributes.position||[],w=u.morphAttributes.normal||[],D=u.morphAttributes.color||[];let U=0;b===!0&&(U=1),R===!0&&(U=2),T===!0&&(U=3);let I=u.attributes.position.count*U,O=1;I>e.maxTextureSize&&(O=Math.ceil(I/e.maxTextureSize),I=e.maxTextureSize);const P=new Float32Array(I*O*4*v),B=new Zy(P,I,O,v);B.type=Vi,B.needsUpdate=!0;const N=U*4;for(let q=0;q<v;q++){const Y=E[q],Q=w[q],Z=D[q],ae=I*O*4*q;for(let G=0;G<Y.count;G++){const ee=G*N;b===!0&&(i.fromBufferAttribute(Y,G),P[ae+ee+0]=i.x,P[ae+ee+1]=i.y,P[ae+ee+2]=i.z,P[ae+ee+3]=0),R===!0&&(i.fromBufferAttribute(Q,G),P[ae+ee+4]=i.x,P[ae+ee+5]=i.y,P[ae+ee+6]=i.z,P[ae+ee+7]=0),T===!0&&(i.fromBufferAttribute(Z,G),P[ae+ee+8]=i.x,P[ae+ee+9]=i.y,P[ae+ee+10]=i.z,P[ae+ee+11]=Z.itemSize===4?i.w:1)}}_={count:v,texture:B,size:new ht(I,O)},n.set(u,_),u.addEventListener("dispose",z)}if(l.isInstancedMesh===!0&&l.morphTexture!==null)f.getUniforms().setValue(s,"morphTexture",l.morphTexture,t);else{let b=0;for(let T=0;T<p.length;T++)b+=p[T];const R=u.morphTargetsRelative?1:1-b;f.getUniforms().setValue(s,"morphTargetBaseInfluence",R),f.getUniforms().setValue(s,"morphTargetInfluences",p)}f.getUniforms().setValue(s,"morphTargetsTexture",_.texture,t),f.getUniforms().setValue(s,"morphTargetsTextureSize",_.size)}return{update:a}}function _L(s,e,t,n){let i=new WeakMap;function a(f){const p=n.render.frame,m=f.geometry,v=e.get(f,m);if(i.get(v)!==p&&(e.update(v),i.set(v,p)),f.isInstancedMesh&&(f.hasEventListener("dispose",u)===!1&&f.addEventListener("dispose",u),i.get(f)!==p&&(t.update(f.instanceMatrix,s.ARRAY_BUFFER),f.instanceColor!==null&&t.update(f.instanceColor,s.ARRAY_BUFFER),i.set(f,p))),f.isSkinnedMesh){const _=f.skeleton;i.get(_)!==p&&(_.update(),i.set(_,p))}return v}function l(){i=new WeakMap}function u(f){const p=f.target;p.removeEventListener("dispose",u),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:a,dispose:l}}const V2=new Zn,kE=new zS(1,1),k2=new Zy,X2=new Ky,Y2=new mg,XE=[],YE=[],qE=new Float32Array(16),WE=new Float32Array(9),jE=new Float32Array(4);function jd(s,e,t){const n=s[0];if(n<=0||n>0)return s;const i=e*t;let a=XE[i];if(a===void 0&&(a=new Float32Array(i),XE[i]=a),e!==0){n.toArray(a,0);for(let l=1,u=0;l!==e;++l)u+=t,s[l].toArray(a,u)}return a}function Ea(s,e){if(s.length!==e.length)return!1;for(let t=0,n=s.length;t<n;t++)if(s[t]!==e[t])return!1;return!0}function Ta(s,e){for(let t=0,n=e.length;t<n;t++)s[t]=e[t]}function x_(s,e){let t=YE[e];t===void 0&&(t=new Int32Array(e),YE[e]=t);for(let n=0;n!==e;++n)t[n]=s.allocateTextureUnit();return t}function xL(s,e){const t=this.cache;t[0]!==e&&(s.uniform1f(this.addr,e),t[0]=e)}function SL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ea(t,e))return;s.uniform2fv(this.addr,e),Ta(t,e)}}function ML(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ea(t,e))return;s.uniform3fv(this.addr,e),Ta(t,e)}}function bL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ea(t,e))return;s.uniform4fv(this.addr,e),Ta(t,e)}}function EL(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ea(t,e))return;s.uniformMatrix2fv(this.addr,!1,e),Ta(t,e)}else{if(Ea(t,n))return;jE.set(n),s.uniformMatrix2fv(this.addr,!1,jE),Ta(t,n)}}function TL(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ea(t,e))return;s.uniformMatrix3fv(this.addr,!1,e),Ta(t,e)}else{if(Ea(t,n))return;WE.set(n),s.uniformMatrix3fv(this.addr,!1,WE),Ta(t,n)}}function AL(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ea(t,e))return;s.uniformMatrix4fv(this.addr,!1,e),Ta(t,e)}else{if(Ea(t,n))return;qE.set(n),s.uniformMatrix4fv(this.addr,!1,qE),Ta(t,n)}}function RL(s,e){const t=this.cache;t[0]!==e&&(s.uniform1i(this.addr,e),t[0]=e)}function CL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ea(t,e))return;s.uniform2iv(this.addr,e),Ta(t,e)}}function wL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ea(t,e))return;s.uniform3iv(this.addr,e),Ta(t,e)}}function UL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ea(t,e))return;s.uniform4iv(this.addr,e),Ta(t,e)}}function DL(s,e){const t=this.cache;t[0]!==e&&(s.uniform1ui(this.addr,e),t[0]=e)}function NL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ea(t,e))return;s.uniform2uiv(this.addr,e),Ta(t,e)}}function OL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ea(t,e))return;s.uniform3uiv(this.addr,e),Ta(t,e)}}function LL(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ea(t,e))return;s.uniform4uiv(this.addr,e),Ta(t,e)}}function zL(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i);let a;this.type===s.SAMPLER_2D_SHADOW?(kE.compareFunction=bS,a=kE):a=V2,t.setTexture2D(e||a,i)}function IL(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||X2,i)}function BL(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTextureCube(e||Y2,i)}function PL(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||k2,i)}function FL(s){switch(s){case 5126:return xL;case 35664:return SL;case 35665:return ML;case 35666:return bL;case 35674:return EL;case 35675:return TL;case 35676:return AL;case 5124:case 35670:return RL;case 35667:case 35671:return CL;case 35668:case 35672:return wL;case 35669:case 35673:return UL;case 5125:return DL;case 36294:return NL;case 36295:return OL;case 36296:return LL;case 35678:case 36198:case 36298:case 36306:case 35682:return zL;case 35679:case 36299:case 36307:return IL;case 35680:case 36300:case 36308:case 36293:return BL;case 36289:case 36303:case 36311:case 36292:return PL}}function HL(s,e){s.uniform1fv(this.addr,e)}function GL(s,e){const t=jd(e,this.size,2);s.uniform2fv(this.addr,t)}function VL(s,e){const t=jd(e,this.size,3);s.uniform3fv(this.addr,t)}function kL(s,e){const t=jd(e,this.size,4);s.uniform4fv(this.addr,t)}function XL(s,e){const t=jd(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,t)}function YL(s,e){const t=jd(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,t)}function qL(s,e){const t=jd(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,t)}function WL(s,e){s.uniform1iv(this.addr,e)}function jL(s,e){s.uniform2iv(this.addr,e)}function ZL(s,e){s.uniform3iv(this.addr,e)}function KL(s,e){s.uniform4iv(this.addr,e)}function QL(s,e){s.uniform1uiv(this.addr,e)}function JL(s,e){s.uniform2uiv(this.addr,e)}function $L(s,e){s.uniform3uiv(this.addr,e)}function e4(s,e){s.uniform4uiv(this.addr,e)}function t4(s,e,t){const n=this.cache,i=e.length,a=x_(t,i);Ea(n,a)||(s.uniform1iv(this.addr,a),Ta(n,a));for(let l=0;l!==i;++l)t.setTexture2D(e[l]||V2,a[l])}function n4(s,e,t){const n=this.cache,i=e.length,a=x_(t,i);Ea(n,a)||(s.uniform1iv(this.addr,a),Ta(n,a));for(let l=0;l!==i;++l)t.setTexture3D(e[l]||X2,a[l])}function i4(s,e,t){const n=this.cache,i=e.length,a=x_(t,i);Ea(n,a)||(s.uniform1iv(this.addr,a),Ta(n,a));for(let l=0;l!==i;++l)t.setTextureCube(e[l]||Y2,a[l])}function a4(s,e,t){const n=this.cache,i=e.length,a=x_(t,i);Ea(n,a)||(s.uniform1iv(this.addr,a),Ta(n,a));for(let l=0;l!==i;++l)t.setTexture2DArray(e[l]||k2,a[l])}function r4(s){switch(s){case 5126:return HL;case 35664:return GL;case 35665:return VL;case 35666:return kL;case 35674:return XL;case 35675:return YL;case 35676:return qL;case 5124:case 35670:return WL;case 35667:case 35671:return jL;case 35668:case 35672:return ZL;case 35669:case 35673:return KL;case 5125:return QL;case 36294:return JL;case 36295:return $L;case 36296:return e4;case 35678:case 36198:case 36298:case 36306:case 35682:return t4;case 35679:case 36299:case 36307:return n4;case 35680:case 36300:case 36308:case 36293:return i4;case 36289:case 36303:case 36311:case 36292:return a4}}class s4{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=FL(t.type)}}class o4{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=r4(t.type)}}class l4{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let a=0,l=i.length;a!==l;++a){const u=i[a];u.setValue(e,t[u.id],n)}}}const rx=/(\w+)(\])?(\[|\.)?/g;function ZE(s,e){s.seq.push(e),s.map[e.id]=e}function u4(s,e,t){const n=s.name,i=n.length;for(rx.lastIndex=0;;){const a=rx.exec(n),l=rx.lastIndex;let u=a[1];const f=a[2]==="]",p=a[3];if(f&&(u=u|0),p===void 0||p==="["&&l+2===i){ZE(t,p===void 0?new s4(u,s,e):new o4(u,s,e));break}else{let v=t.map[u];v===void 0&&(v=new l4(u),ZE(t,v)),t=v}}}class Gv{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const a=e.getActiveUniform(t,i),l=e.getUniformLocation(t,a.name);u4(a,l,this)}}setValue(e,t,n,i){const a=this.map[t];a!==void 0&&a.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];i!==void 0&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let a=0,l=t.length;a!==l;++a){const u=t[a],f=n[u.id];f.needsUpdate!==!1&&u.setValue(e,f.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,a=e.length;i!==a;++i){const l=e[i];l.id in t&&n.push(l)}return n}}function KE(s,e,t){const n=s.createShader(e);return s.shaderSource(n,t),s.compileShader(n),n}const c4=37297;let f4=0;function h4(s,e){const t=s.split(`
`),n=[],i=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let l=i;l<a;l++){const u=l+1;n.push(`${u===e?">":" "} ${u}: ${t[l]}`)}return n.join(`
`)}const QE=new dn;function d4(s){On._getMatrix(QE,On.workingColorSpace,s);const e=`mat3( ${QE.elements.map(t=>t.toFixed(4))} )`;switch(On.getTransfer(s)){case $m:return[e,"LinearTransferOETF"];case ui:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",s),[e,"LinearTransferOETF"]}}function JE(s,e,t){const n=s.getShaderParameter(e,s.COMPILE_STATUS),a=(s.getShaderInfoLog(e)||"").trim();if(n&&a==="")return"";const l=/ERROR: 0:(\d+)/.exec(a);if(l){const u=parseInt(l[1]);return t.toUpperCase()+`

`+a+`

`+h4(s.getShaderSource(e),u)}else return a}function p4(s,e){const t=d4(e);return[`vec4 ${s}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function m4(s,e){let t;switch(e){case AA:t="Linear";break;case RA:t="Reinhard";break;case CA:t="Cineon";break;case pS:t="ACESFilmic";break;case UA:t="AgX";break;case DA:t="Neutral";break;case wA:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+s+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Cv=new ne;function g4(){On.getLuminanceCoefficients(Cv);const s=Cv.x.toFixed(4),e=Cv.y.toFixed(4),t=Cv.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${s}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function v4(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",s.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Bm).join(`
`)}function y4(s){const e=[];for(const t in s){const n=s[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function _4(s,e){const t={},n=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const a=s.getActiveAttrib(e,i),l=a.name;let u=1;a.type===s.FLOAT_MAT2&&(u=2),a.type===s.FLOAT_MAT3&&(u=3),a.type===s.FLOAT_MAT4&&(u=4),t[l]={type:a.type,location:s.getAttribLocation(e,l),locationSize:u}}return t}function Bm(s){return s!==""}function $E(s,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function eT(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const x4=/^[ \t]*#include +<([\w\d./]+)>/gm;function Jx(s){return s.replace(x4,M4)}const S4=new Map;function M4(s,e){let t=xn[e];if(t===void 0){const n=S4.get(e);if(n!==void 0)t=xn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return Jx(t)}const b4=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function tT(s){return s.replace(b4,E4)}function E4(s,e,t,n){let i="";for(let a=parseInt(e);a<parseInt(t);a++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function nT(s){let e=`precision ${s.precision} float;
	precision ${s.precision} int;
	precision ${s.precision} sampler2D;
	precision ${s.precision} samplerCube;
	precision ${s.precision} sampler3D;
	precision ${s.precision} sampler2DArray;
	precision ${s.precision} sampler2DShadow;
	precision ${s.precision} samplerCubeShadow;
	precision ${s.precision} sampler2DArrayShadow;
	precision ${s.precision} isampler2D;
	precision ${s.precision} isampler3D;
	precision ${s.precision} isamplerCube;
	precision ${s.precision} isampler2DArray;
	precision ${s.precision} usampler2D;
	precision ${s.precision} usampler3D;
	precision ${s.precision} usamplerCube;
	precision ${s.precision} usampler2DArray;
	`;return s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function T4(s){let e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===Hy?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===Fm?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===wo&&(e="SHADOWMAP_TYPE_VSM"),e}function A4(s){let e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case Sl:case vc:e="ENVMAP_TYPE_CUBE";break;case Xd:e="ENVMAP_TYPE_CUBE_UV";break}return e}function R4(s){let e="ENVMAP_MODE_REFLECTION";return s.envMap&&s.envMapMode===vc&&(e="ENVMAP_MODE_REFRACTION"),e}function C4(s){let e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case fg:e="ENVMAP_BLENDING_MULTIPLY";break;case EA:e="ENVMAP_BLENDING_MIX";break;case TA:e="ENVMAP_BLENDING_ADD";break}return e}function w4(s){const e=s.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function U4(s,e,t,n){const i=s.getContext(),a=t.defines;let l=t.vertexShader,u=t.fragmentShader;const f=T4(t),p=A4(t),m=R4(t),v=C4(t),_=w4(t),x=v4(t),b=y4(a),R=i.createProgram();let T,E,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(T=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(Bm).join(`
`),T.length>0&&(T+=`
`),E=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(Bm).join(`
`),E.length>0&&(E+=`
`)):(T=[nT(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Bm).join(`
`),E=[nT(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+m:"",t.envMap?"#define "+v:"",_?"#define CUBEUV_TEXEL_WIDTH "+_.texelWidth:"",_?"#define CUBEUV_TEXEL_HEIGHT "+_.texelHeight:"",_?"#define CUBEUV_MAX_MIP "+_.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==yl?"#define TONE_MAPPING":"",t.toneMapping!==yl?xn.tonemapping_pars_fragment:"",t.toneMapping!==yl?m4("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",xn.colorspace_pars_fragment,p4("linearToOutputTexel",t.outputColorSpace),g4(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Bm).join(`
`)),l=Jx(l),l=$E(l,t),l=eT(l,t),u=Jx(u),u=$E(u,t),u=eT(u,t),l=tT(l),u=tT(u),t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,T=[x,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+T,E=["#define varying in",t.glslVersion===kx?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===kx?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+E);const D=w+T+l,U=w+E+u,I=KE(i,i.VERTEX_SHADER,D),O=KE(i,i.FRAGMENT_SHADER,U);i.attachShader(R,I),i.attachShader(R,O),t.index0AttributeName!==void 0?i.bindAttribLocation(R,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(R,0,"position"),i.linkProgram(R);function P(q){if(s.debug.checkShaderErrors){const Y=i.getProgramInfoLog(R)||"",Q=i.getShaderInfoLog(I)||"",Z=i.getShaderInfoLog(O)||"",ae=Y.trim(),G=Q.trim(),ee=Z.trim();let ie=!0,fe=!0;if(i.getProgramParameter(R,i.LINK_STATUS)===!1)if(ie=!1,typeof s.debug.onShaderError=="function")s.debug.onShaderError(i,R,I,O);else{const ce=JE(i,I,"vertex"),H=JE(i,O,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(R,i.VALIDATE_STATUS)+`

Material Name: `+q.name+`
Material Type: `+q.type+`

Program Info Log: `+ae+`
`+ce+`
`+H)}else ae!==""?console.warn("THREE.WebGLProgram: Program Info Log:",ae):(G===""||ee==="")&&(fe=!1);fe&&(q.diagnostics={runnable:ie,programLog:ae,vertexShader:{log:G,prefix:T},fragmentShader:{log:ee,prefix:E}})}i.deleteShader(I),i.deleteShader(O),B=new Gv(i,R),N=_4(i,R)}let B;this.getUniforms=function(){return B===void 0&&P(this),B};let N;this.getAttributes=function(){return N===void 0&&P(this),N};let z=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return z===!1&&(z=i.getProgramParameter(R,c4)),z},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(R),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=f4++,this.cacheKey=e,this.usedTimes=1,this.program=R,this.vertexShader=I,this.fragmentShader=O,this}let D4=0;class N4{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),a=this._getShaderStage(n),l=this._getShaderCacheForMaterial(e);return l.has(i)===!1&&(l.add(i),i.usedTimes++),l.has(a)===!1&&(l.add(a),a.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new O4(e),t.set(e,n)),n}}class O4{constructor(e){this.id=D4++,this.code=e,this.usedTimes=0}}function L4(s,e,t,n,i,a,l){const u=new Fd,f=new N4,p=new Set,m=[],v=i.logarithmicDepthBuffer,_=i.vertexTextures;let x=i.precision;const b={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function R(N){return p.add(N),N===0?"uv":`uv${N}`}function T(N,z,q,Y,Q){const Z=Y.fog,ae=Q.geometry,G=N.isMeshStandardMaterial?Y.environment:null,ee=(N.isMeshStandardMaterial?t:e).get(N.envMap||G),ie=ee&&ee.mapping===Xd?ee.image.height:null,fe=b[N.type];N.precision!==null&&(x=i.getMaxPrecision(N.precision),x!==N.precision&&console.warn("THREE.WebGLProgram.getParameters:",N.precision,"not supported, using",x,"instead."));const ce=ae.morphAttributes.position||ae.morphAttributes.normal||ae.morphAttributes.color,H=ce!==void 0?ce.length:0;let W=0;ae.morphAttributes.position!==void 0&&(W=1),ae.morphAttributes.normal!==void 0&&(W=2),ae.morphAttributes.color!==void 0&&(W=3);let re,de,ge,oe;if(fe){const Pt=Uo[fe];re=Pt.vertexShader,de=Pt.fragmentShader}else re=N.vertexShader,de=N.fragmentShader,f.update(N),ge=f.getVertexShaderID(N),oe=f.getFragmentShaderID(N);const he=s.getRenderTarget(),Ee=s.state.buffers.depth.getReversed(),We=Q.isInstancedMesh===!0,rt=Q.isBatchedMesh===!0,st=!!N.map,et=!!N.matcap,se=!!ee,Ie=!!N.aoMap,Oe=!!N.lightMap,Ue=!!N.bumpMap,Le=!!N.normalMap,ze=!!N.displacementMap,Pe=!!N.emissiveMap,Fe=!!N.metalnessMap,Ne=!!N.roughnessMap,yt=N.anisotropy>0,j=N.clearcoat>0,V=N.dispersion>0,ve=N.iridescence>0,Be=N.sheen>0,De=N.transmission>0,Ae=yt&&!!N.anisotropyMap,gt=j&&!!N.clearcoatMap,ct=j&&!!N.clearcoatNormalMap,_t=j&&!!N.clearcoatRoughnessMap,bt=ve&&!!N.iridescenceMap,ke=ve&&!!N.iridescenceThicknessMap,Xe=Be&&!!N.sheenColorMap,lt=Be&&!!N.sheenRoughnessMap,le=!!N.specularMap,Te=!!N.specularColorMap,ut=!!N.specularIntensityMap,pe=De&&!!N.transmissionMap,_e=De&&!!N.thicknessMap,at=!!N.gradientMap,Tt=!!N.alphaMap,it=N.alphaTest>0,Ge=!!N.alphaHash,xt=!!N.extensions;let wt=yl;N.toneMapped&&(he===null||he.isXRRenderTarget===!0)&&(wt=s.toneMapping);const Ut={shaderID:fe,shaderType:N.type,shaderName:N.name,vertexShader:re,fragmentShader:de,defines:N.defines,customVertexShaderID:ge,customFragmentShaderID:oe,isRawShaderMaterial:N.isRawShaderMaterial===!0,glslVersion:N.glslVersion,precision:x,batching:rt,batchingColor:rt&&Q._colorsTexture!==null,instancing:We,instancingColor:We&&Q.instanceColor!==null,instancingMorph:We&&Q.morphTexture!==null,supportsVertexTextures:_,outputColorSpace:he===null?s.outputColorSpace:he.isXRRenderTarget===!0?he.texture.colorSpace:fa,alphaToCoverage:!!N.alphaToCoverage,map:st,matcap:et,envMap:se,envMapMode:se&&ee.mapping,envMapCubeUVHeight:ie,aoMap:Ie,lightMap:Oe,bumpMap:Ue,normalMap:Le,displacementMap:_&&ze,emissiveMap:Pe,normalMapObjectSpace:Le&&N.normalMapType===PA,normalMapTangentSpace:Le&&N.normalMapType===Sc,metalnessMap:Fe,roughnessMap:Ne,anisotropy:yt,anisotropyMap:Ae,clearcoat:j,clearcoatMap:gt,clearcoatNormalMap:ct,clearcoatRoughnessMap:_t,dispersion:V,iridescence:ve,iridescenceMap:bt,iridescenceThicknessMap:ke,sheen:Be,sheenColorMap:Xe,sheenRoughnessMap:lt,specularMap:le,specularColorMap:Te,specularIntensityMap:ut,transmission:De,transmissionMap:pe,thicknessMap:_e,gradientMap:at,opaque:N.transparent===!1&&N.blending===Bf&&N.alphaToCoverage===!1,alphaMap:Tt,alphaTest:it,alphaHash:Ge,combine:N.combine,mapUv:st&&R(N.map.channel),aoMapUv:Ie&&R(N.aoMap.channel),lightMapUv:Oe&&R(N.lightMap.channel),bumpMapUv:Ue&&R(N.bumpMap.channel),normalMapUv:Le&&R(N.normalMap.channel),displacementMapUv:ze&&R(N.displacementMap.channel),emissiveMapUv:Pe&&R(N.emissiveMap.channel),metalnessMapUv:Fe&&R(N.metalnessMap.channel),roughnessMapUv:Ne&&R(N.roughnessMap.channel),anisotropyMapUv:Ae&&R(N.anisotropyMap.channel),clearcoatMapUv:gt&&R(N.clearcoatMap.channel),clearcoatNormalMapUv:ct&&R(N.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:_t&&R(N.clearcoatRoughnessMap.channel),iridescenceMapUv:bt&&R(N.iridescenceMap.channel),iridescenceThicknessMapUv:ke&&R(N.iridescenceThicknessMap.channel),sheenColorMapUv:Xe&&R(N.sheenColorMap.channel),sheenRoughnessMapUv:lt&&R(N.sheenRoughnessMap.channel),specularMapUv:le&&R(N.specularMap.channel),specularColorMapUv:Te&&R(N.specularColorMap.channel),specularIntensityMapUv:ut&&R(N.specularIntensityMap.channel),transmissionMapUv:pe&&R(N.transmissionMap.channel),thicknessMapUv:_e&&R(N.thicknessMap.channel),alphaMapUv:Tt&&R(N.alphaMap.channel),vertexTangents:!!ae.attributes.tangent&&(Le||yt),vertexColors:N.vertexColors,vertexAlphas:N.vertexColors===!0&&!!ae.attributes.color&&ae.attributes.color.itemSize===4,pointsUvs:Q.isPoints===!0&&!!ae.attributes.uv&&(st||Tt),fog:!!Z,useFog:N.fog===!0,fogExp2:!!Z&&Z.isFogExp2,flatShading:N.flatShading===!0&&N.wireframe===!1,sizeAttenuation:N.sizeAttenuation===!0,logarithmicDepthBuffer:v,reversedDepthBuffer:Ee,skinning:Q.isSkinnedMesh===!0,morphTargets:ae.morphAttributes.position!==void 0,morphNormals:ae.morphAttributes.normal!==void 0,morphColors:ae.morphAttributes.color!==void 0,morphTargetsCount:H,morphTextureStride:W,numDirLights:z.directional.length,numPointLights:z.point.length,numSpotLights:z.spot.length,numSpotLightMaps:z.spotLightMap.length,numRectAreaLights:z.rectArea.length,numHemiLights:z.hemi.length,numDirLightShadows:z.directionalShadowMap.length,numPointLightShadows:z.pointShadowMap.length,numSpotLightShadows:z.spotShadowMap.length,numSpotLightShadowsWithMaps:z.numSpotLightShadowsWithMaps,numLightProbes:z.numLightProbes,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:N.dithering,shadowMapEnabled:s.shadowMap.enabled&&q.length>0,shadowMapType:s.shadowMap.type,toneMapping:wt,decodeVideoTexture:st&&N.map.isVideoTexture===!0&&On.getTransfer(N.map.colorSpace)===ui,decodeVideoTextureEmissive:Pe&&N.emissiveMap.isVideoTexture===!0&&On.getTransfer(N.emissiveMap.colorSpace)===ui,premultipliedAlpha:N.premultipliedAlpha,doubleSided:N.side===ur,flipSided:N.side===Ir,useDepthPacking:N.depthPacking>=0,depthPacking:N.depthPacking||0,index0AttributeName:N.index0AttributeName,extensionClipCullDistance:xt&&N.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(xt&&N.extensions.multiDraw===!0||rt)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:N.customProgramCacheKey()};return Ut.vertexUv1s=p.has(1),Ut.vertexUv2s=p.has(2),Ut.vertexUv3s=p.has(3),p.clear(),Ut}function E(N){const z=[];if(N.shaderID?z.push(N.shaderID):(z.push(N.customVertexShaderID),z.push(N.customFragmentShaderID)),N.defines!==void 0)for(const q in N.defines)z.push(q),z.push(N.defines[q]);return N.isRawShaderMaterial===!1&&(w(z,N),D(z,N),z.push(s.outputColorSpace)),z.push(N.customProgramCacheKey),z.join()}function w(N,z){N.push(z.precision),N.push(z.outputColorSpace),N.push(z.envMapMode),N.push(z.envMapCubeUVHeight),N.push(z.mapUv),N.push(z.alphaMapUv),N.push(z.lightMapUv),N.push(z.aoMapUv),N.push(z.bumpMapUv),N.push(z.normalMapUv),N.push(z.displacementMapUv),N.push(z.emissiveMapUv),N.push(z.metalnessMapUv),N.push(z.roughnessMapUv),N.push(z.anisotropyMapUv),N.push(z.clearcoatMapUv),N.push(z.clearcoatNormalMapUv),N.push(z.clearcoatRoughnessMapUv),N.push(z.iridescenceMapUv),N.push(z.iridescenceThicknessMapUv),N.push(z.sheenColorMapUv),N.push(z.sheenRoughnessMapUv),N.push(z.specularMapUv),N.push(z.specularColorMapUv),N.push(z.specularIntensityMapUv),N.push(z.transmissionMapUv),N.push(z.thicknessMapUv),N.push(z.combine),N.push(z.fogExp2),N.push(z.sizeAttenuation),N.push(z.morphTargetsCount),N.push(z.morphAttributeCount),N.push(z.numDirLights),N.push(z.numPointLights),N.push(z.numSpotLights),N.push(z.numSpotLightMaps),N.push(z.numHemiLights),N.push(z.numRectAreaLights),N.push(z.numDirLightShadows),N.push(z.numPointLightShadows),N.push(z.numSpotLightShadows),N.push(z.numSpotLightShadowsWithMaps),N.push(z.numLightProbes),N.push(z.shadowMapType),N.push(z.toneMapping),N.push(z.numClippingPlanes),N.push(z.numClipIntersection),N.push(z.depthPacking)}function D(N,z){u.disableAll(),z.supportsVertexTextures&&u.enable(0),z.instancing&&u.enable(1),z.instancingColor&&u.enable(2),z.instancingMorph&&u.enable(3),z.matcap&&u.enable(4),z.envMap&&u.enable(5),z.normalMapObjectSpace&&u.enable(6),z.normalMapTangentSpace&&u.enable(7),z.clearcoat&&u.enable(8),z.iridescence&&u.enable(9),z.alphaTest&&u.enable(10),z.vertexColors&&u.enable(11),z.vertexAlphas&&u.enable(12),z.vertexUv1s&&u.enable(13),z.vertexUv2s&&u.enable(14),z.vertexUv3s&&u.enable(15),z.vertexTangents&&u.enable(16),z.anisotropy&&u.enable(17),z.alphaHash&&u.enable(18),z.batching&&u.enable(19),z.dispersion&&u.enable(20),z.batchingColor&&u.enable(21),z.gradientMap&&u.enable(22),N.push(u.mask),u.disableAll(),z.fog&&u.enable(0),z.useFog&&u.enable(1),z.flatShading&&u.enable(2),z.logarithmicDepthBuffer&&u.enable(3),z.reversedDepthBuffer&&u.enable(4),z.skinning&&u.enable(5),z.morphTargets&&u.enable(6),z.morphNormals&&u.enable(7),z.morphColors&&u.enable(8),z.premultipliedAlpha&&u.enable(9),z.shadowMapEnabled&&u.enable(10),z.doubleSided&&u.enable(11),z.flipSided&&u.enable(12),z.useDepthPacking&&u.enable(13),z.dithering&&u.enable(14),z.transmission&&u.enable(15),z.sheen&&u.enable(16),z.opaque&&u.enable(17),z.pointsUvs&&u.enable(18),z.decodeVideoTexture&&u.enable(19),z.decodeVideoTextureEmissive&&u.enable(20),z.alphaToCoverage&&u.enable(21),N.push(u.mask)}function U(N){const z=b[N.type];let q;if(z){const Y=Uo[z];q=CS.clone(Y.uniforms)}else q=N.uniforms;return q}function I(N,z){let q;for(let Y=0,Q=m.length;Y<Q;Y++){const Z=m[Y];if(Z.cacheKey===z){q=Z,++q.usedTimes;break}}return q===void 0&&(q=new U4(s,z,N,a),m.push(q)),q}function O(N){if(--N.usedTimes===0){const z=m.indexOf(N);m[z]=m[m.length-1],m.pop(),N.destroy()}}function P(N){f.remove(N)}function B(){f.dispose()}return{getParameters:T,getProgramCacheKey:E,getUniforms:U,acquireProgram:I,releaseProgram:O,releaseShaderCache:P,programs:m,dispose:B}}function z4(){let s=new WeakMap;function e(l){return s.has(l)}function t(l){let u=s.get(l);return u===void 0&&(u={},s.set(l,u)),u}function n(l){s.delete(l)}function i(l,u,f){s.get(l)[u]=f}function a(){s=new WeakMap}return{has:e,get:t,remove:n,update:i,dispose:a}}function I4(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function iT(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function aT(){const s=[];let e=0;const t=[],n=[],i=[];function a(){e=0,t.length=0,n.length=0,i.length=0}function l(v,_,x,b,R,T){let E=s[e];return E===void 0?(E={id:v.id,object:v,geometry:_,material:x,groupOrder:b,renderOrder:v.renderOrder,z:R,group:T},s[e]=E):(E.id=v.id,E.object=v,E.geometry=_,E.material=x,E.groupOrder=b,E.renderOrder=v.renderOrder,E.z=R,E.group=T),e++,E}function u(v,_,x,b,R,T){const E=l(v,_,x,b,R,T);x.transmission>0?n.push(E):x.transparent===!0?i.push(E):t.push(E)}function f(v,_,x,b,R,T){const E=l(v,_,x,b,R,T);x.transmission>0?n.unshift(E):x.transparent===!0?i.unshift(E):t.unshift(E)}function p(v,_){t.length>1&&t.sort(v||I4),n.length>1&&n.sort(_||iT),i.length>1&&i.sort(_||iT)}function m(){for(let v=e,_=s.length;v<_;v++){const x=s[v];if(x.id===null)break;x.id=null,x.object=null,x.geometry=null,x.material=null,x.group=null}}return{opaque:t,transmissive:n,transparent:i,init:a,push:u,unshift:f,finish:m,sort:p}}function B4(){let s=new WeakMap;function e(n,i){const a=s.get(n);let l;return a===void 0?(l=new aT,s.set(n,[l])):i>=a.length?(l=new aT,a.push(l)):l=a[i],l}function t(){s=new WeakMap}return{get:e,dispose:t}}function P4(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ne,color:new Nt};break;case"SpotLight":t={position:new ne,direction:new ne,color:new Nt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ne,color:new Nt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ne,skyColor:new Nt,groundColor:new Nt};break;case"RectAreaLight":t={color:new Nt,position:new ne,halfWidth:new ne,halfHeight:new ne};break}return s[e.id]=t,t}}}function F4(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht,shadowCameraNear:1,shadowCameraFar:1e3};break}return s[e.id]=t,t}}}let H4=0;function G4(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function V4(s){const e=new P4,t=F4(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)n.probe.push(new ne);const i=new ne,a=new Qt,l=new Qt;function u(p){let m=0,v=0,_=0;for(let N=0;N<9;N++)n.probe[N].set(0,0,0);let x=0,b=0,R=0,T=0,E=0,w=0,D=0,U=0,I=0,O=0,P=0;p.sort(G4);for(let N=0,z=p.length;N<z;N++){const q=p[N],Y=q.color,Q=q.intensity,Z=q.distance,ae=q.shadow&&q.shadow.map?q.shadow.map.texture:null;if(q.isAmbientLight)m+=Y.r*Q,v+=Y.g*Q,_+=Y.b*Q;else if(q.isLightProbe){for(let G=0;G<9;G++)n.probe[G].addScaledVector(q.sh.coefficients[G],Q);P++}else if(q.isDirectionalLight){const G=e.get(q);if(G.color.copy(q.color).multiplyScalar(q.intensity),q.castShadow){const ee=q.shadow,ie=t.get(q);ie.shadowIntensity=ee.intensity,ie.shadowBias=ee.bias,ie.shadowNormalBias=ee.normalBias,ie.shadowRadius=ee.radius,ie.shadowMapSize=ee.mapSize,n.directionalShadow[x]=ie,n.directionalShadowMap[x]=ae,n.directionalShadowMatrix[x]=q.shadow.matrix,w++}n.directional[x]=G,x++}else if(q.isSpotLight){const G=e.get(q);G.position.setFromMatrixPosition(q.matrixWorld),G.color.copy(Y).multiplyScalar(Q),G.distance=Z,G.coneCos=Math.cos(q.angle),G.penumbraCos=Math.cos(q.angle*(1-q.penumbra)),G.decay=q.decay,n.spot[R]=G;const ee=q.shadow;if(q.map&&(n.spotLightMap[I]=q.map,I++,ee.updateMatrices(q),q.castShadow&&O++),n.spotLightMatrix[R]=ee.matrix,q.castShadow){const ie=t.get(q);ie.shadowIntensity=ee.intensity,ie.shadowBias=ee.bias,ie.shadowNormalBias=ee.normalBias,ie.shadowRadius=ee.radius,ie.shadowMapSize=ee.mapSize,n.spotShadow[R]=ie,n.spotShadowMap[R]=ae,U++}R++}else if(q.isRectAreaLight){const G=e.get(q);G.color.copy(Y).multiplyScalar(Q),G.halfWidth.set(q.width*.5,0,0),G.halfHeight.set(0,q.height*.5,0),n.rectArea[T]=G,T++}else if(q.isPointLight){const G=e.get(q);if(G.color.copy(q.color).multiplyScalar(q.intensity),G.distance=q.distance,G.decay=q.decay,q.castShadow){const ee=q.shadow,ie=t.get(q);ie.shadowIntensity=ee.intensity,ie.shadowBias=ee.bias,ie.shadowNormalBias=ee.normalBias,ie.shadowRadius=ee.radius,ie.shadowMapSize=ee.mapSize,ie.shadowCameraNear=ee.camera.near,ie.shadowCameraFar=ee.camera.far,n.pointShadow[b]=ie,n.pointShadowMap[b]=ae,n.pointShadowMatrix[b]=q.shadow.matrix,D++}n.point[b]=G,b++}else if(q.isHemisphereLight){const G=e.get(q);G.skyColor.copy(q.color).multiplyScalar(Q),G.groundColor.copy(q.groundColor).multiplyScalar(Q),n.hemi[E]=G,E++}}T>0&&(s.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=It.LTC_FLOAT_1,n.rectAreaLTC2=It.LTC_FLOAT_2):(n.rectAreaLTC1=It.LTC_HALF_1,n.rectAreaLTC2=It.LTC_HALF_2)),n.ambient[0]=m,n.ambient[1]=v,n.ambient[2]=_;const B=n.hash;(B.directionalLength!==x||B.pointLength!==b||B.spotLength!==R||B.rectAreaLength!==T||B.hemiLength!==E||B.numDirectionalShadows!==w||B.numPointShadows!==D||B.numSpotShadows!==U||B.numSpotMaps!==I||B.numLightProbes!==P)&&(n.directional.length=x,n.spot.length=R,n.rectArea.length=T,n.point.length=b,n.hemi.length=E,n.directionalShadow.length=w,n.directionalShadowMap.length=w,n.pointShadow.length=D,n.pointShadowMap.length=D,n.spotShadow.length=U,n.spotShadowMap.length=U,n.directionalShadowMatrix.length=w,n.pointShadowMatrix.length=D,n.spotLightMatrix.length=U+I-O,n.spotLightMap.length=I,n.numSpotLightShadowsWithMaps=O,n.numLightProbes=P,B.directionalLength=x,B.pointLength=b,B.spotLength=R,B.rectAreaLength=T,B.hemiLength=E,B.numDirectionalShadows=w,B.numPointShadows=D,B.numSpotShadows=U,B.numSpotMaps=I,B.numLightProbes=P,n.version=H4++)}function f(p,m){let v=0,_=0,x=0,b=0,R=0;const T=m.matrixWorldInverse;for(let E=0,w=p.length;E<w;E++){const D=p[E];if(D.isDirectionalLight){const U=n.directional[v];U.direction.setFromMatrixPosition(D.matrixWorld),i.setFromMatrixPosition(D.target.matrixWorld),U.direction.sub(i),U.direction.transformDirection(T),v++}else if(D.isSpotLight){const U=n.spot[x];U.position.setFromMatrixPosition(D.matrixWorld),U.position.applyMatrix4(T),U.direction.setFromMatrixPosition(D.matrixWorld),i.setFromMatrixPosition(D.target.matrixWorld),U.direction.sub(i),U.direction.transformDirection(T),x++}else if(D.isRectAreaLight){const U=n.rectArea[b];U.position.setFromMatrixPosition(D.matrixWorld),U.position.applyMatrix4(T),l.identity(),a.copy(D.matrixWorld),a.premultiply(T),l.extractRotation(a),U.halfWidth.set(D.width*.5,0,0),U.halfHeight.set(0,D.height*.5,0),U.halfWidth.applyMatrix4(l),U.halfHeight.applyMatrix4(l),b++}else if(D.isPointLight){const U=n.point[_];U.position.setFromMatrixPosition(D.matrixWorld),U.position.applyMatrix4(T),_++}else if(D.isHemisphereLight){const U=n.hemi[R];U.direction.setFromMatrixPosition(D.matrixWorld),U.direction.transformDirection(T),R++}}}return{setup:u,setupView:f,state:n}}function rT(s){const e=new V4(s),t=[],n=[];function i(m){p.camera=m,t.length=0,n.length=0}function a(m){t.push(m)}function l(m){n.push(m)}function u(){e.setup(t)}function f(m){e.setupView(t,m)}const p={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:p,setupLights:u,setupLightsView:f,pushLight:a,pushShadow:l}}function k4(s){let e=new WeakMap;function t(i,a=0){const l=e.get(i);let u;return l===void 0?(u=new rT(s),e.set(i,[u])):a>=l.length?(u=new rT(s),l.push(u)):u=l[a],u}function n(){e=new WeakMap}return{get:t,dispose:n}}const X4=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Y4=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function q4(s,e,t){let n=new Yd;const i=new ht,a=new ht,l=new kn,u=new g_({depthPacking:MS}),f=new v_,p={},m=t.maxTextureSize,v={[xl]:Ir,[Ir]:xl,[ur]:ur},_=new Fr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ht},radius:{value:4}},vertexShader:X4,fragmentShader:Y4}),x=_.clone();x.defines.HORIZONTAL_PASS=1;const b=new vn;b.setAttribute("position",new ii(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const R=new Si(b,_),T=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Hy;let E=this.type;this.render=function(O,P,B){if(T.enabled===!1||T.autoUpdate===!1&&T.needsUpdate===!1||O.length===0)return;const N=s.getRenderTarget(),z=s.getActiveCubeFace(),q=s.getActiveMipmapLevel(),Y=s.state;Y.setBlending(vl),Y.buffers.depth.getReversed()===!0?Y.buffers.color.setClear(0,0,0,0):Y.buffers.color.setClear(1,1,1,1),Y.buffers.depth.setTest(!0),Y.setScissorTest(!1);const Q=E!==wo&&this.type===wo,Z=E===wo&&this.type!==wo;for(let ae=0,G=O.length;ae<G;ae++){const ee=O[ae],ie=ee.shadow;if(ie===void 0){console.warn("THREE.WebGLShadowMap:",ee,"has no shadow.");continue}if(ie.autoUpdate===!1&&ie.needsUpdate===!1)continue;i.copy(ie.mapSize);const fe=ie.getFrameExtents();if(i.multiply(fe),a.copy(ie.mapSize),(i.x>m||i.y>m)&&(i.x>m&&(a.x=Math.floor(m/fe.x),i.x=a.x*fe.x,ie.mapSize.x=a.x),i.y>m&&(a.y=Math.floor(m/fe.y),i.y=a.y*fe.y,ie.mapSize.y=a.y)),ie.map===null||Q===!0||Z===!0){const H=this.type!==wo?{minFilter:Sa,magFilter:Sa}:{};ie.map!==null&&ie.map.dispose(),ie.map=new Ks(i.x,i.y,H),ie.map.texture.name=ee.name+".shadowMap",ie.camera.updateProjectionMatrix()}s.setRenderTarget(ie.map),s.clear();const ce=ie.getViewportCount();for(let H=0;H<ce;H++){const W=ie.getViewport(H);l.set(a.x*W.x,a.y*W.y,a.x*W.z,a.y*W.w),Y.viewport(l),ie.updateMatrices(ee,H),n=ie.getFrustum(),U(P,B,ie.camera,ee,this.type)}ie.isPointLightShadow!==!0&&this.type===wo&&w(ie,B),ie.needsUpdate=!1}E=this.type,T.needsUpdate=!1,s.setRenderTarget(N,z,q)};function w(O,P){const B=e.update(R);_.defines.VSM_SAMPLES!==O.blurSamples&&(_.defines.VSM_SAMPLES=O.blurSamples,x.defines.VSM_SAMPLES=O.blurSamples,_.needsUpdate=!0,x.needsUpdate=!0),O.mapPass===null&&(O.mapPass=new Ks(i.x,i.y)),_.uniforms.shadow_pass.value=O.map.texture,_.uniforms.resolution.value=O.mapSize,_.uniforms.radius.value=O.radius,s.setRenderTarget(O.mapPass),s.clear(),s.renderBufferDirect(P,null,B,_,R,null),x.uniforms.shadow_pass.value=O.mapPass.texture,x.uniforms.resolution.value=O.mapSize,x.uniforms.radius.value=O.radius,s.setRenderTarget(O.map),s.clear(),s.renderBufferDirect(P,null,B,x,R,null)}function D(O,P,B,N){let z=null;const q=B.isPointLight===!0?O.customDistanceMaterial:O.customDepthMaterial;if(q!==void 0)z=q;else if(z=B.isPointLight===!0?f:u,s.localClippingEnabled&&P.clipShadows===!0&&Array.isArray(P.clippingPlanes)&&P.clippingPlanes.length!==0||P.displacementMap&&P.displacementScale!==0||P.alphaMap&&P.alphaTest>0||P.map&&P.alphaTest>0||P.alphaToCoverage===!0){const Y=z.uuid,Q=P.uuid;let Z=p[Y];Z===void 0&&(Z={},p[Y]=Z);let ae=Z[Q];ae===void 0&&(ae=z.clone(),Z[Q]=ae,P.addEventListener("dispose",I)),z=ae}if(z.visible=P.visible,z.wireframe=P.wireframe,N===wo?z.side=P.shadowSide!==null?P.shadowSide:P.side:z.side=P.shadowSide!==null?P.shadowSide:v[P.side],z.alphaMap=P.alphaMap,z.alphaTest=P.alphaToCoverage===!0?.5:P.alphaTest,z.map=P.map,z.clipShadows=P.clipShadows,z.clippingPlanes=P.clippingPlanes,z.clipIntersection=P.clipIntersection,z.displacementMap=P.displacementMap,z.displacementScale=P.displacementScale,z.displacementBias=P.displacementBias,z.wireframeLinewidth=P.wireframeLinewidth,z.linewidth=P.linewidth,B.isPointLight===!0&&z.isMeshDistanceMaterial===!0){const Y=s.properties.get(z);Y.light=B}return z}function U(O,P,B,N,z){if(O.visible===!1)return;if(O.layers.test(P.layers)&&(O.isMesh||O.isLine||O.isPoints)&&(O.castShadow||O.receiveShadow&&z===wo)&&(!O.frustumCulled||n.intersectsObject(O))){O.modelViewMatrix.multiplyMatrices(B.matrixWorldInverse,O.matrixWorld);const Q=e.update(O),Z=O.material;if(Array.isArray(Z)){const ae=Q.groups;for(let G=0,ee=ae.length;G<ee;G++){const ie=ae[G],fe=Z[ie.materialIndex];if(fe&&fe.visible){const ce=D(O,fe,N,z);O.onBeforeShadow(s,O,P,B,Q,ce,ie),s.renderBufferDirect(B,null,Q,ce,O,ie),O.onAfterShadow(s,O,P,B,Q,ce,ie)}}}else if(Z.visible){const ae=D(O,Z,N,z);O.onBeforeShadow(s,O,P,B,Q,ae,null),s.renderBufferDirect(B,null,Q,ae,O,null),O.onAfterShadow(s,O,P,B,Q,ae,null)}}const Y=O.children;for(let Q=0,Z=Y.length;Q<Z;Q++)U(Y[Q],P,B,N,z)}function I(O){O.target.removeEventListener("dispose",I);for(const B in p){const N=p[B],z=O.target.uuid;z in N&&(N[z].dispose(),delete N[z])}}}const W4={[Wv]:jv,[Zv]:Jv,[Kv]:$v,[Gf]:Qv,[jv]:Wv,[Jv]:Zv,[$v]:Kv,[Qv]:Gf};function j4(s,e){function t(){let pe=!1;const _e=new kn;let at=null;const Tt=new kn(0,0,0,0);return{setMask:function(it){at!==it&&!pe&&(s.colorMask(it,it,it,it),at=it)},setLocked:function(it){pe=it},setClear:function(it,Ge,xt,wt,Ut){Ut===!0&&(it*=wt,Ge*=wt,xt*=wt),_e.set(it,Ge,xt,wt),Tt.equals(_e)===!1&&(s.clearColor(it,Ge,xt,wt),Tt.copy(_e))},reset:function(){pe=!1,at=null,Tt.set(-1,0,0,0)}}}function n(){let pe=!1,_e=!1,at=null,Tt=null,it=null;return{setReversed:function(Ge){if(_e!==Ge){const xt=e.get("EXT_clip_control");Ge?xt.clipControlEXT(xt.LOWER_LEFT_EXT,xt.ZERO_TO_ONE_EXT):xt.clipControlEXT(xt.LOWER_LEFT_EXT,xt.NEGATIVE_ONE_TO_ONE_EXT),_e=Ge;const wt=it;it=null,this.setClear(wt)}},getReversed:function(){return _e},setTest:function(Ge){Ge?he(s.DEPTH_TEST):Ee(s.DEPTH_TEST)},setMask:function(Ge){at!==Ge&&!pe&&(s.depthMask(Ge),at=Ge)},setFunc:function(Ge){if(_e&&(Ge=W4[Ge]),Tt!==Ge){switch(Ge){case Wv:s.depthFunc(s.NEVER);break;case jv:s.depthFunc(s.ALWAYS);break;case Zv:s.depthFunc(s.LESS);break;case Gf:s.depthFunc(s.LEQUAL);break;case Kv:s.depthFunc(s.EQUAL);break;case Qv:s.depthFunc(s.GEQUAL);break;case Jv:s.depthFunc(s.GREATER);break;case $v:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}Tt=Ge}},setLocked:function(Ge){pe=Ge},setClear:function(Ge){it!==Ge&&(_e&&(Ge=1-Ge),s.clearDepth(Ge),it=Ge)},reset:function(){pe=!1,at=null,Tt=null,it=null,_e=!1}}}function i(){let pe=!1,_e=null,at=null,Tt=null,it=null,Ge=null,xt=null,wt=null,Ut=null;return{setTest:function(Pt){pe||(Pt?he(s.STENCIL_TEST):Ee(s.STENCIL_TEST))},setMask:function(Pt){_e!==Pt&&!pe&&(s.stencilMask(Pt),_e=Pt)},setFunc:function(Pt,yn,An){(at!==Pt||Tt!==yn||it!==An)&&(s.stencilFunc(Pt,yn,An),at=Pt,Tt=yn,it=An)},setOp:function(Pt,yn,An){(Ge!==Pt||xt!==yn||wt!==An)&&(s.stencilOp(Pt,yn,An),Ge=Pt,xt=yn,wt=An)},setLocked:function(Pt){pe=Pt},setClear:function(Pt){Ut!==Pt&&(s.clearStencil(Pt),Ut=Pt)},reset:function(){pe=!1,_e=null,at=null,Tt=null,it=null,Ge=null,xt=null,wt=null,Ut=null}}}const a=new t,l=new n,u=new i,f=new WeakMap,p=new WeakMap;let m={},v={},_=new WeakMap,x=[],b=null,R=!1,T=null,E=null,w=null,D=null,U=null,I=null,O=null,P=new Nt(0,0,0),B=0,N=!1,z=null,q=null,Y=null,Q=null,Z=null;const ae=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let G=!1,ee=0;const ie=s.getParameter(s.VERSION);ie.indexOf("WebGL")!==-1?(ee=parseFloat(/^WebGL (\d)/.exec(ie)[1]),G=ee>=1):ie.indexOf("OpenGL ES")!==-1&&(ee=parseFloat(/^OpenGL ES (\d)/.exec(ie)[1]),G=ee>=2);let fe=null,ce={};const H=s.getParameter(s.SCISSOR_BOX),W=s.getParameter(s.VIEWPORT),re=new kn().fromArray(H),de=new kn().fromArray(W);function ge(pe,_e,at,Tt){const it=new Uint8Array(4),Ge=s.createTexture();s.bindTexture(pe,Ge),s.texParameteri(pe,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(pe,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let xt=0;xt<at;xt++)pe===s.TEXTURE_3D||pe===s.TEXTURE_2D_ARRAY?s.texImage3D(_e,0,s.RGBA,1,1,Tt,0,s.RGBA,s.UNSIGNED_BYTE,it):s.texImage2D(_e+xt,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,it);return Ge}const oe={};oe[s.TEXTURE_2D]=ge(s.TEXTURE_2D,s.TEXTURE_2D,1),oe[s.TEXTURE_CUBE_MAP]=ge(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),oe[s.TEXTURE_2D_ARRAY]=ge(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),oe[s.TEXTURE_3D]=ge(s.TEXTURE_3D,s.TEXTURE_3D,1,1),a.setClear(0,0,0,1),l.setClear(1),u.setClear(0),he(s.DEPTH_TEST),l.setFunc(Gf),Ue(!1),Le(Ix),he(s.CULL_FACE),Ie(vl);function he(pe){m[pe]!==!0&&(s.enable(pe),m[pe]=!0)}function Ee(pe){m[pe]!==!1&&(s.disable(pe),m[pe]=!1)}function We(pe,_e){return v[pe]!==_e?(s.bindFramebuffer(pe,_e),v[pe]=_e,pe===s.DRAW_FRAMEBUFFER&&(v[s.FRAMEBUFFER]=_e),pe===s.FRAMEBUFFER&&(v[s.DRAW_FRAMEBUFFER]=_e),!0):!1}function rt(pe,_e){let at=x,Tt=!1;if(pe){at=_.get(_e),at===void 0&&(at=[],_.set(_e,at));const it=pe.textures;if(at.length!==it.length||at[0]!==s.COLOR_ATTACHMENT0){for(let Ge=0,xt=it.length;Ge<xt;Ge++)at[Ge]=s.COLOR_ATTACHMENT0+Ge;at.length=it.length,Tt=!0}}else at[0]!==s.BACK&&(at[0]=s.BACK,Tt=!0);Tt&&s.drawBuffers(at)}function st(pe){return b!==pe?(s.useProgram(pe),b=pe,!0):!1}const et={[hc]:s.FUNC_ADD,[oA]:s.FUNC_SUBTRACT,[lA]:s.FUNC_REVERSE_SUBTRACT};et[uA]=s.MIN,et[cA]=s.MAX;const se={[fA]:s.ZERO,[hA]:s.ONE,[dA]:s.SRC_COLOR,[Yv]:s.SRC_ALPHA,[_A]:s.SRC_ALPHA_SATURATE,[vA]:s.DST_COLOR,[mA]:s.DST_ALPHA,[pA]:s.ONE_MINUS_SRC_COLOR,[qv]:s.ONE_MINUS_SRC_ALPHA,[yA]:s.ONE_MINUS_DST_COLOR,[gA]:s.ONE_MINUS_DST_ALPHA,[xA]:s.CONSTANT_COLOR,[SA]:s.ONE_MINUS_CONSTANT_COLOR,[MA]:s.CONSTANT_ALPHA,[bA]:s.ONE_MINUS_CONSTANT_ALPHA};function Ie(pe,_e,at,Tt,it,Ge,xt,wt,Ut,Pt){if(pe===vl){R===!0&&(Ee(s.BLEND),R=!1);return}if(R===!1&&(he(s.BLEND),R=!0),pe!==sA){if(pe!==T||Pt!==N){if((E!==hc||U!==hc)&&(s.blendEquation(s.FUNC_ADD),E=hc,U=hc),Pt)switch(pe){case Bf:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case Bx:s.blendFunc(s.ONE,s.ONE);break;case Px:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case Fx:s.blendFuncSeparate(s.DST_COLOR,s.ONE_MINUS_SRC_ALPHA,s.ZERO,s.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",pe);break}else switch(pe){case Bf:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case Bx:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE,s.ONE,s.ONE);break;case Px:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Fx:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",pe);break}w=null,D=null,I=null,O=null,P.set(0,0,0),B=0,T=pe,N=Pt}return}it=it||_e,Ge=Ge||at,xt=xt||Tt,(_e!==E||it!==U)&&(s.blendEquationSeparate(et[_e],et[it]),E=_e,U=it),(at!==w||Tt!==D||Ge!==I||xt!==O)&&(s.blendFuncSeparate(se[at],se[Tt],se[Ge],se[xt]),w=at,D=Tt,I=Ge,O=xt),(wt.equals(P)===!1||Ut!==B)&&(s.blendColor(wt.r,wt.g,wt.b,Ut),P.copy(wt),B=Ut),T=pe,N=!1}function Oe(pe,_e){pe.side===ur?Ee(s.CULL_FACE):he(s.CULL_FACE);let at=pe.side===Ir;_e&&(at=!at),Ue(at),pe.blending===Bf&&pe.transparent===!1?Ie(vl):Ie(pe.blending,pe.blendEquation,pe.blendSrc,pe.blendDst,pe.blendEquationAlpha,pe.blendSrcAlpha,pe.blendDstAlpha,pe.blendColor,pe.blendAlpha,pe.premultipliedAlpha),l.setFunc(pe.depthFunc),l.setTest(pe.depthTest),l.setMask(pe.depthWrite),a.setMask(pe.colorWrite);const Tt=pe.stencilWrite;u.setTest(Tt),Tt&&(u.setMask(pe.stencilWriteMask),u.setFunc(pe.stencilFunc,pe.stencilRef,pe.stencilFuncMask),u.setOp(pe.stencilFail,pe.stencilZFail,pe.stencilZPass)),Pe(pe.polygonOffset,pe.polygonOffsetFactor,pe.polygonOffsetUnits),pe.alphaToCoverage===!0?he(s.SAMPLE_ALPHA_TO_COVERAGE):Ee(s.SAMPLE_ALPHA_TO_COVERAGE)}function Ue(pe){z!==pe&&(pe?s.frontFace(s.CW):s.frontFace(s.CCW),z=pe)}function Le(pe){pe!==iA?(he(s.CULL_FACE),pe!==q&&(pe===Ix?s.cullFace(s.BACK):pe===aA?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):Ee(s.CULL_FACE),q=pe}function ze(pe){pe!==Y&&(G&&s.lineWidth(pe),Y=pe)}function Pe(pe,_e,at){pe?(he(s.POLYGON_OFFSET_FILL),(Q!==_e||Z!==at)&&(s.polygonOffset(_e,at),Q=_e,Z=at)):Ee(s.POLYGON_OFFSET_FILL)}function Fe(pe){pe?he(s.SCISSOR_TEST):Ee(s.SCISSOR_TEST)}function Ne(pe){pe===void 0&&(pe=s.TEXTURE0+ae-1),fe!==pe&&(s.activeTexture(pe),fe=pe)}function yt(pe,_e,at){at===void 0&&(fe===null?at=s.TEXTURE0+ae-1:at=fe);let Tt=ce[at];Tt===void 0&&(Tt={type:void 0,texture:void 0},ce[at]=Tt),(Tt.type!==pe||Tt.texture!==_e)&&(fe!==at&&(s.activeTexture(at),fe=at),s.bindTexture(pe,_e||oe[pe]),Tt.type=pe,Tt.texture=_e)}function j(){const pe=ce[fe];pe!==void 0&&pe.type!==void 0&&(s.bindTexture(pe.type,null),pe.type=void 0,pe.texture=void 0)}function V(){try{s.compressedTexImage2D(...arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function ve(){try{s.compressedTexImage3D(...arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function Be(){try{s.texSubImage2D(...arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function De(){try{s.texSubImage3D(...arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function Ae(){try{s.compressedTexSubImage2D(...arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function gt(){try{s.compressedTexSubImage3D(...arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function ct(){try{s.texStorage2D(...arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function _t(){try{s.texStorage3D(...arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function bt(){try{s.texImage2D(...arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function ke(){try{s.texImage3D(...arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function Xe(pe){re.equals(pe)===!1&&(s.scissor(pe.x,pe.y,pe.z,pe.w),re.copy(pe))}function lt(pe){de.equals(pe)===!1&&(s.viewport(pe.x,pe.y,pe.z,pe.w),de.copy(pe))}function le(pe,_e){let at=p.get(_e);at===void 0&&(at=new WeakMap,p.set(_e,at));let Tt=at.get(pe);Tt===void 0&&(Tt=s.getUniformBlockIndex(_e,pe.name),at.set(pe,Tt))}function Te(pe,_e){const Tt=p.get(_e).get(pe);f.get(_e)!==Tt&&(s.uniformBlockBinding(_e,Tt,pe.__bindingPointIndex),f.set(_e,Tt))}function ut(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),l.setReversed(!1),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),m={},fe=null,ce={},v={},_=new WeakMap,x=[],b=null,R=!1,T=null,E=null,w=null,D=null,U=null,I=null,O=null,P=new Nt(0,0,0),B=0,N=!1,z=null,q=null,Y=null,Q=null,Z=null,re.set(0,0,s.canvas.width,s.canvas.height),de.set(0,0,s.canvas.width,s.canvas.height),a.reset(),l.reset(),u.reset()}return{buffers:{color:a,depth:l,stencil:u},enable:he,disable:Ee,bindFramebuffer:We,drawBuffers:rt,useProgram:st,setBlending:Ie,setMaterial:Oe,setFlipSided:Ue,setCullFace:Le,setLineWidth:ze,setPolygonOffset:Pe,setScissorTest:Fe,activeTexture:Ne,bindTexture:yt,unbindTexture:j,compressedTexImage2D:V,compressedTexImage3D:ve,texImage2D:bt,texImage3D:ke,updateUBOMapping:le,uniformBlockBinding:Te,texStorage2D:ct,texStorage3D:_t,texSubImage2D:Be,texSubImage3D:De,compressedTexSubImage2D:Ae,compressedTexSubImage3D:gt,scissor:Xe,viewport:lt,reset:ut}}function Z4(s,e,t,n,i,a,l){const u=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new ht,m=new WeakMap;let v;const _=new WeakMap;let x=!1;try{x=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function b(j,V){return x?new OffscreenCanvas(j,V):tg("canvas")}function R(j,V,ve){let Be=1;const De=yt(j);if((De.width>ve||De.height>ve)&&(Be=ve/Math.max(De.width,De.height)),Be<1)if(typeof HTMLImageElement<"u"&&j instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&j instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&j instanceof ImageBitmap||typeof VideoFrame<"u"&&j instanceof VideoFrame){const Ae=Math.floor(Be*De.width),gt=Math.floor(Be*De.height);v===void 0&&(v=b(Ae,gt));const ct=V?b(Ae,gt):v;return ct.width=Ae,ct.height=gt,ct.getContext("2d").drawImage(j,0,0,Ae,gt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+De.width+"x"+De.height+") to ("+Ae+"x"+gt+")."),ct}else return"data"in j&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+De.width+"x"+De.height+")."),j;return j}function T(j){return j.generateMipmaps}function E(j){s.generateMipmap(j)}function w(j){return j.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:j.isWebGL3DRenderTarget?s.TEXTURE_3D:j.isWebGLArrayRenderTarget||j.isCompressedArrayTexture?s.TEXTURE_2D_ARRAY:s.TEXTURE_2D}function D(j,V,ve,Be,De=!1){if(j!==null){if(s[j]!==void 0)return s[j];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+j+"'")}let Ae=V;if(V===s.RED&&(ve===s.FLOAT&&(Ae=s.R32F),ve===s.HALF_FLOAT&&(Ae=s.R16F),ve===s.UNSIGNED_BYTE&&(Ae=s.R8)),V===s.RED_INTEGER&&(ve===s.UNSIGNED_BYTE&&(Ae=s.R8UI),ve===s.UNSIGNED_SHORT&&(Ae=s.R16UI),ve===s.UNSIGNED_INT&&(Ae=s.R32UI),ve===s.BYTE&&(Ae=s.R8I),ve===s.SHORT&&(Ae=s.R16I),ve===s.INT&&(Ae=s.R32I)),V===s.RG&&(ve===s.FLOAT&&(Ae=s.RG32F),ve===s.HALF_FLOAT&&(Ae=s.RG16F),ve===s.UNSIGNED_BYTE&&(Ae=s.RG8)),V===s.RG_INTEGER&&(ve===s.UNSIGNED_BYTE&&(Ae=s.RG8UI),ve===s.UNSIGNED_SHORT&&(Ae=s.RG16UI),ve===s.UNSIGNED_INT&&(Ae=s.RG32UI),ve===s.BYTE&&(Ae=s.RG8I),ve===s.SHORT&&(Ae=s.RG16I),ve===s.INT&&(Ae=s.RG32I)),V===s.RGB_INTEGER&&(ve===s.UNSIGNED_BYTE&&(Ae=s.RGB8UI),ve===s.UNSIGNED_SHORT&&(Ae=s.RGB16UI),ve===s.UNSIGNED_INT&&(Ae=s.RGB32UI),ve===s.BYTE&&(Ae=s.RGB8I),ve===s.SHORT&&(Ae=s.RGB16I),ve===s.INT&&(Ae=s.RGB32I)),V===s.RGBA_INTEGER&&(ve===s.UNSIGNED_BYTE&&(Ae=s.RGBA8UI),ve===s.UNSIGNED_SHORT&&(Ae=s.RGBA16UI),ve===s.UNSIGNED_INT&&(Ae=s.RGBA32UI),ve===s.BYTE&&(Ae=s.RGBA8I),ve===s.SHORT&&(Ae=s.RGBA16I),ve===s.INT&&(Ae=s.RGBA32I)),V===s.RGB&&(ve===s.UNSIGNED_INT_5_9_9_9_REV&&(Ae=s.RGB9_E5),ve===s.UNSIGNED_INT_10F_11F_11F_REV&&(Ae=s.R11F_G11F_B10F)),V===s.RGBA){const gt=De?$m:On.getTransfer(Be);ve===s.FLOAT&&(Ae=s.RGBA32F),ve===s.HALF_FLOAT&&(Ae=s.RGBA16F),ve===s.UNSIGNED_BYTE&&(Ae=gt===ui?s.SRGB8_ALPHA8:s.RGBA8),ve===s.UNSIGNED_SHORT_4_4_4_4&&(Ae=s.RGBA4),ve===s.UNSIGNED_SHORT_5_5_5_1&&(Ae=s.RGB5_A1)}return(Ae===s.R16F||Ae===s.R32F||Ae===s.RG16F||Ae===s.RG32F||Ae===s.RGBA16F||Ae===s.RGBA32F)&&e.get("EXT_color_buffer_float"),Ae}function U(j,V){let ve;return j?V===null||V===Ml||V===Dd?ve=s.DEPTH24_STENCIL8:V===Vi?ve=s.DEPTH32F_STENCIL8:V===Ud&&(ve=s.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):V===null||V===Ml||V===Dd?ve=s.DEPTH_COMPONENT24:V===Vi?ve=s.DEPTH_COMPONENT32F:V===Ud&&(ve=s.DEPTH_COMPONENT16),ve}function I(j,V){return T(j)===!0||j.isFramebufferTexture&&j.minFilter!==Sa&&j.minFilter!==Wn?Math.log2(Math.max(V.width,V.height))+1:j.mipmaps!==void 0&&j.mipmaps.length>0?j.mipmaps.length:j.isCompressedTexture&&Array.isArray(j.image)?V.mipmaps.length:1}function O(j){const V=j.target;V.removeEventListener("dispose",O),B(V),V.isVideoTexture&&m.delete(V)}function P(j){const V=j.target;V.removeEventListener("dispose",P),z(V)}function B(j){const V=n.get(j);if(V.__webglInit===void 0)return;const ve=j.source,Be=_.get(ve);if(Be){const De=Be[V.__cacheKey];De.usedTimes--,De.usedTimes===0&&N(j),Object.keys(Be).length===0&&_.delete(ve)}n.remove(j)}function N(j){const V=n.get(j);s.deleteTexture(V.__webglTexture);const ve=j.source,Be=_.get(ve);delete Be[V.__cacheKey],l.memory.textures--}function z(j){const V=n.get(j);if(j.depthTexture&&(j.depthTexture.dispose(),n.remove(j.depthTexture)),j.isWebGLCubeRenderTarget)for(let Be=0;Be<6;Be++){if(Array.isArray(V.__webglFramebuffer[Be]))for(let De=0;De<V.__webglFramebuffer[Be].length;De++)s.deleteFramebuffer(V.__webglFramebuffer[Be][De]);else s.deleteFramebuffer(V.__webglFramebuffer[Be]);V.__webglDepthbuffer&&s.deleteRenderbuffer(V.__webglDepthbuffer[Be])}else{if(Array.isArray(V.__webglFramebuffer))for(let Be=0;Be<V.__webglFramebuffer.length;Be++)s.deleteFramebuffer(V.__webglFramebuffer[Be]);else s.deleteFramebuffer(V.__webglFramebuffer);if(V.__webglDepthbuffer&&s.deleteRenderbuffer(V.__webglDepthbuffer),V.__webglMultisampledFramebuffer&&s.deleteFramebuffer(V.__webglMultisampledFramebuffer),V.__webglColorRenderbuffer)for(let Be=0;Be<V.__webglColorRenderbuffer.length;Be++)V.__webglColorRenderbuffer[Be]&&s.deleteRenderbuffer(V.__webglColorRenderbuffer[Be]);V.__webglDepthRenderbuffer&&s.deleteRenderbuffer(V.__webglDepthRenderbuffer)}const ve=j.textures;for(let Be=0,De=ve.length;Be<De;Be++){const Ae=n.get(ve[Be]);Ae.__webglTexture&&(s.deleteTexture(Ae.__webglTexture),l.memory.textures--),n.remove(ve[Be])}n.remove(j)}let q=0;function Y(){q=0}function Q(){const j=q;return j>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+j+" texture units while this GPU supports only "+i.maxTextures),q+=1,j}function Z(j){const V=[];return V.push(j.wrapS),V.push(j.wrapT),V.push(j.wrapR||0),V.push(j.magFilter),V.push(j.minFilter),V.push(j.anisotropy),V.push(j.internalFormat),V.push(j.format),V.push(j.type),V.push(j.generateMipmaps),V.push(j.premultiplyAlpha),V.push(j.flipY),V.push(j.unpackAlignment),V.push(j.colorSpace),V.join()}function ae(j,V){const ve=n.get(j);if(j.isVideoTexture&&Fe(j),j.isRenderTargetTexture===!1&&j.isExternalTexture!==!0&&j.version>0&&ve.__version!==j.version){const Be=j.image;if(Be===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Be.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{oe(ve,j,V);return}}else j.isExternalTexture&&(ve.__webglTexture=j.sourceTexture?j.sourceTexture:null);t.bindTexture(s.TEXTURE_2D,ve.__webglTexture,s.TEXTURE0+V)}function G(j,V){const ve=n.get(j);if(j.isRenderTargetTexture===!1&&j.version>0&&ve.__version!==j.version){oe(ve,j,V);return}t.bindTexture(s.TEXTURE_2D_ARRAY,ve.__webglTexture,s.TEXTURE0+V)}function ee(j,V){const ve=n.get(j);if(j.isRenderTargetTexture===!1&&j.version>0&&ve.__version!==j.version){oe(ve,j,V);return}t.bindTexture(s.TEXTURE_3D,ve.__webglTexture,s.TEXTURE0+V)}function ie(j,V){const ve=n.get(j);if(j.version>0&&ve.__version!==j.version){he(ve,j,V);return}t.bindTexture(s.TEXTURE_CUBE_MAP,ve.__webglTexture,s.TEXTURE0+V)}const fe={[yc]:s.REPEAT,[ta]:s.CLAMP_TO_EDGE,[wd]:s.MIRRORED_REPEAT},ce={[Sa]:s.NEAREST,[Gy]:s.NEAREST_MIPMAP_NEAREST,[Df]:s.NEAREST_MIPMAP_LINEAR,[Wn]:s.LINEAR,[Ed]:s.LINEAR_MIPMAP_NEAREST,[Zs]:s.LINEAR_MIPMAP_LINEAR},H={[FA]:s.NEVER,[YA]:s.ALWAYS,[HA]:s.LESS,[bS]:s.LEQUAL,[GA]:s.EQUAL,[XA]:s.GEQUAL,[VA]:s.GREATER,[kA]:s.NOTEQUAL};function W(j,V){if(V.type===Vi&&e.has("OES_texture_float_linear")===!1&&(V.magFilter===Wn||V.magFilter===Ed||V.magFilter===Df||V.magFilter===Zs||V.minFilter===Wn||V.minFilter===Ed||V.minFilter===Df||V.minFilter===Zs)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),s.texParameteri(j,s.TEXTURE_WRAP_S,fe[V.wrapS]),s.texParameteri(j,s.TEXTURE_WRAP_T,fe[V.wrapT]),(j===s.TEXTURE_3D||j===s.TEXTURE_2D_ARRAY)&&s.texParameteri(j,s.TEXTURE_WRAP_R,fe[V.wrapR]),s.texParameteri(j,s.TEXTURE_MAG_FILTER,ce[V.magFilter]),s.texParameteri(j,s.TEXTURE_MIN_FILTER,ce[V.minFilter]),V.compareFunction&&(s.texParameteri(j,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(j,s.TEXTURE_COMPARE_FUNC,H[V.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(V.magFilter===Sa||V.minFilter!==Df&&V.minFilter!==Zs||V.type===Vi&&e.has("OES_texture_float_linear")===!1)return;if(V.anisotropy>1||n.get(V).__currentAnisotropy){const ve=e.get("EXT_texture_filter_anisotropic");s.texParameterf(j,ve.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(V.anisotropy,i.getMaxAnisotropy())),n.get(V).__currentAnisotropy=V.anisotropy}}}function re(j,V){let ve=!1;j.__webglInit===void 0&&(j.__webglInit=!0,V.addEventListener("dispose",O));const Be=V.source;let De=_.get(Be);De===void 0&&(De={},_.set(Be,De));const Ae=Z(V);if(Ae!==j.__cacheKey){De[Ae]===void 0&&(De[Ae]={texture:s.createTexture(),usedTimes:0},l.memory.textures++,ve=!0),De[Ae].usedTimes++;const gt=De[j.__cacheKey];gt!==void 0&&(De[j.__cacheKey].usedTimes--,gt.usedTimes===0&&N(V)),j.__cacheKey=Ae,j.__webglTexture=De[Ae].texture}return ve}function de(j,V,ve){return Math.floor(Math.floor(j/ve)/V)}function ge(j,V,ve,Be){const Ae=j.updateRanges;if(Ae.length===0)t.texSubImage2D(s.TEXTURE_2D,0,0,0,V.width,V.height,ve,Be,V.data);else{Ae.sort((ke,Xe)=>ke.start-Xe.start);let gt=0;for(let ke=1;ke<Ae.length;ke++){const Xe=Ae[gt],lt=Ae[ke],le=Xe.start+Xe.count,Te=de(lt.start,V.width,4),ut=de(Xe.start,V.width,4);lt.start<=le+1&&Te===ut&&de(lt.start+lt.count-1,V.width,4)===Te?Xe.count=Math.max(Xe.count,lt.start+lt.count-Xe.start):(++gt,Ae[gt]=lt)}Ae.length=gt+1;const ct=s.getParameter(s.UNPACK_ROW_LENGTH),_t=s.getParameter(s.UNPACK_SKIP_PIXELS),bt=s.getParameter(s.UNPACK_SKIP_ROWS);s.pixelStorei(s.UNPACK_ROW_LENGTH,V.width);for(let ke=0,Xe=Ae.length;ke<Xe;ke++){const lt=Ae[ke],le=Math.floor(lt.start/4),Te=Math.ceil(lt.count/4),ut=le%V.width,pe=Math.floor(le/V.width),_e=Te,at=1;s.pixelStorei(s.UNPACK_SKIP_PIXELS,ut),s.pixelStorei(s.UNPACK_SKIP_ROWS,pe),t.texSubImage2D(s.TEXTURE_2D,0,ut,pe,_e,at,ve,Be,V.data)}j.clearUpdateRanges(),s.pixelStorei(s.UNPACK_ROW_LENGTH,ct),s.pixelStorei(s.UNPACK_SKIP_PIXELS,_t),s.pixelStorei(s.UNPACK_SKIP_ROWS,bt)}}function oe(j,V,ve){let Be=s.TEXTURE_2D;(V.isDataArrayTexture||V.isCompressedArrayTexture)&&(Be=s.TEXTURE_2D_ARRAY),V.isData3DTexture&&(Be=s.TEXTURE_3D);const De=re(j,V),Ae=V.source;t.bindTexture(Be,j.__webglTexture,s.TEXTURE0+ve);const gt=n.get(Ae);if(Ae.version!==gt.__version||De===!0){t.activeTexture(s.TEXTURE0+ve);const ct=On.getPrimaries(On.workingColorSpace),_t=V.colorSpace===pu?null:On.getPrimaries(V.colorSpace),bt=V.colorSpace===pu||ct===_t?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,V.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,V.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,bt);let ke=R(V.image,!1,i.maxTextureSize);ke=Ne(V,ke);const Xe=a.convert(V.format,V.colorSpace),lt=a.convert(V.type);let le=D(V.internalFormat,Xe,lt,V.colorSpace,V.isVideoTexture);W(Be,V);let Te;const ut=V.mipmaps,pe=V.isVideoTexture!==!0,_e=gt.__version===void 0||De===!0,at=Ae.dataReady,Tt=I(V,ke);if(V.isDepthTexture)le=U(V.format===Od,V.type),_e&&(pe?t.texStorage2D(s.TEXTURE_2D,1,le,ke.width,ke.height):t.texImage2D(s.TEXTURE_2D,0,le,ke.width,ke.height,0,Xe,lt,null));else if(V.isDataTexture)if(ut.length>0){pe&&_e&&t.texStorage2D(s.TEXTURE_2D,Tt,le,ut[0].width,ut[0].height);for(let it=0,Ge=ut.length;it<Ge;it++)Te=ut[it],pe?at&&t.texSubImage2D(s.TEXTURE_2D,it,0,0,Te.width,Te.height,Xe,lt,Te.data):t.texImage2D(s.TEXTURE_2D,it,le,Te.width,Te.height,0,Xe,lt,Te.data);V.generateMipmaps=!1}else pe?(_e&&t.texStorage2D(s.TEXTURE_2D,Tt,le,ke.width,ke.height),at&&ge(V,ke,Xe,lt)):t.texImage2D(s.TEXTURE_2D,0,le,ke.width,ke.height,0,Xe,lt,ke.data);else if(V.isCompressedTexture)if(V.isCompressedArrayTexture){pe&&_e&&t.texStorage3D(s.TEXTURE_2D_ARRAY,Tt,le,ut[0].width,ut[0].height,ke.depth);for(let it=0,Ge=ut.length;it<Ge;it++)if(Te=ut[it],V.format!==na)if(Xe!==null)if(pe){if(at)if(V.layerUpdates.size>0){const xt=Kx(Te.width,Te.height,V.format,V.type);for(const wt of V.layerUpdates){const Ut=Te.data.subarray(wt*xt/Te.data.BYTES_PER_ELEMENT,(wt+1)*xt/Te.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,it,0,0,wt,Te.width,Te.height,1,Xe,Ut)}V.clearLayerUpdates()}else t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,it,0,0,0,Te.width,Te.height,ke.depth,Xe,Te.data)}else t.compressedTexImage3D(s.TEXTURE_2D_ARRAY,it,le,Te.width,Te.height,ke.depth,0,Te.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else pe?at&&t.texSubImage3D(s.TEXTURE_2D_ARRAY,it,0,0,0,Te.width,Te.height,ke.depth,Xe,lt,Te.data):t.texImage3D(s.TEXTURE_2D_ARRAY,it,le,Te.width,Te.height,ke.depth,0,Xe,lt,Te.data)}else{pe&&_e&&t.texStorage2D(s.TEXTURE_2D,Tt,le,ut[0].width,ut[0].height);for(let it=0,Ge=ut.length;it<Ge;it++)Te=ut[it],V.format!==na?Xe!==null?pe?at&&t.compressedTexSubImage2D(s.TEXTURE_2D,it,0,0,Te.width,Te.height,Xe,Te.data):t.compressedTexImage2D(s.TEXTURE_2D,it,le,Te.width,Te.height,0,Te.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):pe?at&&t.texSubImage2D(s.TEXTURE_2D,it,0,0,Te.width,Te.height,Xe,lt,Te.data):t.texImage2D(s.TEXTURE_2D,it,le,Te.width,Te.height,0,Xe,lt,Te.data)}else if(V.isDataArrayTexture)if(pe){if(_e&&t.texStorage3D(s.TEXTURE_2D_ARRAY,Tt,le,ke.width,ke.height,ke.depth),at)if(V.layerUpdates.size>0){const it=Kx(ke.width,ke.height,V.format,V.type);for(const Ge of V.layerUpdates){const xt=ke.data.subarray(Ge*it/ke.data.BYTES_PER_ELEMENT,(Ge+1)*it/ke.data.BYTES_PER_ELEMENT);t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,Ge,ke.width,ke.height,1,Xe,lt,xt)}V.clearLayerUpdates()}else t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,ke.width,ke.height,ke.depth,Xe,lt,ke.data)}else t.texImage3D(s.TEXTURE_2D_ARRAY,0,le,ke.width,ke.height,ke.depth,0,Xe,lt,ke.data);else if(V.isData3DTexture)pe?(_e&&t.texStorage3D(s.TEXTURE_3D,Tt,le,ke.width,ke.height,ke.depth),at&&t.texSubImage3D(s.TEXTURE_3D,0,0,0,0,ke.width,ke.height,ke.depth,Xe,lt,ke.data)):t.texImage3D(s.TEXTURE_3D,0,le,ke.width,ke.height,ke.depth,0,Xe,lt,ke.data);else if(V.isFramebufferTexture){if(_e)if(pe)t.texStorage2D(s.TEXTURE_2D,Tt,le,ke.width,ke.height);else{let it=ke.width,Ge=ke.height;for(let xt=0;xt<Tt;xt++)t.texImage2D(s.TEXTURE_2D,xt,le,it,Ge,0,Xe,lt,null),it>>=1,Ge>>=1}}else if(ut.length>0){if(pe&&_e){const it=yt(ut[0]);t.texStorage2D(s.TEXTURE_2D,Tt,le,it.width,it.height)}for(let it=0,Ge=ut.length;it<Ge;it++)Te=ut[it],pe?at&&t.texSubImage2D(s.TEXTURE_2D,it,0,0,Xe,lt,Te):t.texImage2D(s.TEXTURE_2D,it,le,Xe,lt,Te);V.generateMipmaps=!1}else if(pe){if(_e){const it=yt(ke);t.texStorage2D(s.TEXTURE_2D,Tt,le,it.width,it.height)}at&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,Xe,lt,ke)}else t.texImage2D(s.TEXTURE_2D,0,le,Xe,lt,ke);T(V)&&E(Be),gt.__version=Ae.version,V.onUpdate&&V.onUpdate(V)}j.__version=V.version}function he(j,V,ve){if(V.image.length!==6)return;const Be=re(j,V),De=V.source;t.bindTexture(s.TEXTURE_CUBE_MAP,j.__webglTexture,s.TEXTURE0+ve);const Ae=n.get(De);if(De.version!==Ae.__version||Be===!0){t.activeTexture(s.TEXTURE0+ve);const gt=On.getPrimaries(On.workingColorSpace),ct=V.colorSpace===pu?null:On.getPrimaries(V.colorSpace),_t=V.colorSpace===pu||gt===ct?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,V.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,V.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,_t);const bt=V.isCompressedTexture||V.image[0].isCompressedTexture,ke=V.image[0]&&V.image[0].isDataTexture,Xe=[];for(let Ge=0;Ge<6;Ge++)!bt&&!ke?Xe[Ge]=R(V.image[Ge],!0,i.maxCubemapSize):Xe[Ge]=ke?V.image[Ge].image:V.image[Ge],Xe[Ge]=Ne(V,Xe[Ge]);const lt=Xe[0],le=a.convert(V.format,V.colorSpace),Te=a.convert(V.type),ut=D(V.internalFormat,le,Te,V.colorSpace),pe=V.isVideoTexture!==!0,_e=Ae.__version===void 0||Be===!0,at=De.dataReady;let Tt=I(V,lt);W(s.TEXTURE_CUBE_MAP,V);let it;if(bt){pe&&_e&&t.texStorage2D(s.TEXTURE_CUBE_MAP,Tt,ut,lt.width,lt.height);for(let Ge=0;Ge<6;Ge++){it=Xe[Ge].mipmaps;for(let xt=0;xt<it.length;xt++){const wt=it[xt];V.format!==na?le!==null?pe?at&&t.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,xt,0,0,wt.width,wt.height,le,wt.data):t.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,xt,ut,wt.width,wt.height,0,wt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pe?at&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,xt,0,0,wt.width,wt.height,le,Te,wt.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,xt,ut,wt.width,wt.height,0,le,Te,wt.data)}}}else{if(it=V.mipmaps,pe&&_e){it.length>0&&Tt++;const Ge=yt(Xe[0]);t.texStorage2D(s.TEXTURE_CUBE_MAP,Tt,ut,Ge.width,Ge.height)}for(let Ge=0;Ge<6;Ge++)if(ke){pe?at&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,0,0,Xe[Ge].width,Xe[Ge].height,le,Te,Xe[Ge].data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,ut,Xe[Ge].width,Xe[Ge].height,0,le,Te,Xe[Ge].data);for(let xt=0;xt<it.length;xt++){const Ut=it[xt].image[Ge].image;pe?at&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,xt+1,0,0,Ut.width,Ut.height,le,Te,Ut.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,xt+1,ut,Ut.width,Ut.height,0,le,Te,Ut.data)}}else{pe?at&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,0,0,le,Te,Xe[Ge]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,ut,le,Te,Xe[Ge]);for(let xt=0;xt<it.length;xt++){const wt=it[xt];pe?at&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,xt+1,0,0,le,Te,wt.image[Ge]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,xt+1,ut,le,Te,wt.image[Ge])}}}T(V)&&E(s.TEXTURE_CUBE_MAP),Ae.__version=De.version,V.onUpdate&&V.onUpdate(V)}j.__version=V.version}function Ee(j,V,ve,Be,De,Ae){const gt=a.convert(ve.format,ve.colorSpace),ct=a.convert(ve.type),_t=D(ve.internalFormat,gt,ct,ve.colorSpace),bt=n.get(V),ke=n.get(ve);if(ke.__renderTarget=V,!bt.__hasExternalTextures){const Xe=Math.max(1,V.width>>Ae),lt=Math.max(1,V.height>>Ae);De===s.TEXTURE_3D||De===s.TEXTURE_2D_ARRAY?t.texImage3D(De,Ae,_t,Xe,lt,V.depth,0,gt,ct,null):t.texImage2D(De,Ae,_t,Xe,lt,0,gt,ct,null)}t.bindFramebuffer(s.FRAMEBUFFER,j),Pe(V)?u.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,Be,De,ke.__webglTexture,0,ze(V)):(De===s.TEXTURE_2D||De>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&De<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&s.framebufferTexture2D(s.FRAMEBUFFER,Be,De,ke.__webglTexture,Ae),t.bindFramebuffer(s.FRAMEBUFFER,null)}function We(j,V,ve){if(s.bindRenderbuffer(s.RENDERBUFFER,j),V.depthBuffer){const Be=V.depthTexture,De=Be&&Be.isDepthTexture?Be.type:null,Ae=U(V.stencilBuffer,De),gt=V.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,ct=ze(V);Pe(V)?u.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,ct,Ae,V.width,V.height):ve?s.renderbufferStorageMultisample(s.RENDERBUFFER,ct,Ae,V.width,V.height):s.renderbufferStorage(s.RENDERBUFFER,Ae,V.width,V.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,gt,s.RENDERBUFFER,j)}else{const Be=V.textures;for(let De=0;De<Be.length;De++){const Ae=Be[De],gt=a.convert(Ae.format,Ae.colorSpace),ct=a.convert(Ae.type),_t=D(Ae.internalFormat,gt,ct,Ae.colorSpace),bt=ze(V);ve&&Pe(V)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,bt,_t,V.width,V.height):Pe(V)?u.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,bt,_t,V.width,V.height):s.renderbufferStorage(s.RENDERBUFFER,_t,V.width,V.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function rt(j,V){if(V&&V.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(s.FRAMEBUFFER,j),!(V.depthTexture&&V.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Be=n.get(V.depthTexture);Be.__renderTarget=V,(!Be.__webglTexture||V.depthTexture.image.width!==V.width||V.depthTexture.image.height!==V.height)&&(V.depthTexture.image.width=V.width,V.depthTexture.image.height=V.height,V.depthTexture.needsUpdate=!0),ae(V.depthTexture,0);const De=Be.__webglTexture,Ae=ze(V);if(V.depthTexture.format===Nd)Pe(V)?u.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,De,0,Ae):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,De,0);else if(V.depthTexture.format===Od)Pe(V)?u.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,De,0,Ae):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,De,0);else throw new Error("Unknown depthTexture format")}function st(j){const V=n.get(j),ve=j.isWebGLCubeRenderTarget===!0;if(V.__boundDepthTexture!==j.depthTexture){const Be=j.depthTexture;if(V.__depthDisposeCallback&&V.__depthDisposeCallback(),Be){const De=()=>{delete V.__boundDepthTexture,delete V.__depthDisposeCallback,Be.removeEventListener("dispose",De)};Be.addEventListener("dispose",De),V.__depthDisposeCallback=De}V.__boundDepthTexture=Be}if(j.depthTexture&&!V.__autoAllocateDepthBuffer){if(ve)throw new Error("target.depthTexture not supported in Cube render targets");const Be=j.texture.mipmaps;Be&&Be.length>0?rt(V.__webglFramebuffer[0],j):rt(V.__webglFramebuffer,j)}else if(ve){V.__webglDepthbuffer=[];for(let Be=0;Be<6;Be++)if(t.bindFramebuffer(s.FRAMEBUFFER,V.__webglFramebuffer[Be]),V.__webglDepthbuffer[Be]===void 0)V.__webglDepthbuffer[Be]=s.createRenderbuffer(),We(V.__webglDepthbuffer[Be],j,!1);else{const De=j.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Ae=V.__webglDepthbuffer[Be];s.bindRenderbuffer(s.RENDERBUFFER,Ae),s.framebufferRenderbuffer(s.FRAMEBUFFER,De,s.RENDERBUFFER,Ae)}}else{const Be=j.texture.mipmaps;if(Be&&Be.length>0?t.bindFramebuffer(s.FRAMEBUFFER,V.__webglFramebuffer[0]):t.bindFramebuffer(s.FRAMEBUFFER,V.__webglFramebuffer),V.__webglDepthbuffer===void 0)V.__webglDepthbuffer=s.createRenderbuffer(),We(V.__webglDepthbuffer,j,!1);else{const De=j.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Ae=V.__webglDepthbuffer;s.bindRenderbuffer(s.RENDERBUFFER,Ae),s.framebufferRenderbuffer(s.FRAMEBUFFER,De,s.RENDERBUFFER,Ae)}}t.bindFramebuffer(s.FRAMEBUFFER,null)}function et(j,V,ve){const Be=n.get(j);V!==void 0&&Ee(Be.__webglFramebuffer,j,j.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),ve!==void 0&&st(j)}function se(j){const V=j.texture,ve=n.get(j),Be=n.get(V);j.addEventListener("dispose",P);const De=j.textures,Ae=j.isWebGLCubeRenderTarget===!0,gt=De.length>1;if(gt||(Be.__webglTexture===void 0&&(Be.__webglTexture=s.createTexture()),Be.__version=V.version,l.memory.textures++),Ae){ve.__webglFramebuffer=[];for(let ct=0;ct<6;ct++)if(V.mipmaps&&V.mipmaps.length>0){ve.__webglFramebuffer[ct]=[];for(let _t=0;_t<V.mipmaps.length;_t++)ve.__webglFramebuffer[ct][_t]=s.createFramebuffer()}else ve.__webglFramebuffer[ct]=s.createFramebuffer()}else{if(V.mipmaps&&V.mipmaps.length>0){ve.__webglFramebuffer=[];for(let ct=0;ct<V.mipmaps.length;ct++)ve.__webglFramebuffer[ct]=s.createFramebuffer()}else ve.__webglFramebuffer=s.createFramebuffer();if(gt)for(let ct=0,_t=De.length;ct<_t;ct++){const bt=n.get(De[ct]);bt.__webglTexture===void 0&&(bt.__webglTexture=s.createTexture(),l.memory.textures++)}if(j.samples>0&&Pe(j)===!1){ve.__webglMultisampledFramebuffer=s.createFramebuffer(),ve.__webglColorRenderbuffer=[],t.bindFramebuffer(s.FRAMEBUFFER,ve.__webglMultisampledFramebuffer);for(let ct=0;ct<De.length;ct++){const _t=De[ct];ve.__webglColorRenderbuffer[ct]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,ve.__webglColorRenderbuffer[ct]);const bt=a.convert(_t.format,_t.colorSpace),ke=a.convert(_t.type),Xe=D(_t.internalFormat,bt,ke,_t.colorSpace,j.isXRRenderTarget===!0),lt=ze(j);s.renderbufferStorageMultisample(s.RENDERBUFFER,lt,Xe,j.width,j.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+ct,s.RENDERBUFFER,ve.__webglColorRenderbuffer[ct])}s.bindRenderbuffer(s.RENDERBUFFER,null),j.depthBuffer&&(ve.__webglDepthRenderbuffer=s.createRenderbuffer(),We(ve.__webglDepthRenderbuffer,j,!0)),t.bindFramebuffer(s.FRAMEBUFFER,null)}}if(Ae){t.bindTexture(s.TEXTURE_CUBE_MAP,Be.__webglTexture),W(s.TEXTURE_CUBE_MAP,V);for(let ct=0;ct<6;ct++)if(V.mipmaps&&V.mipmaps.length>0)for(let _t=0;_t<V.mipmaps.length;_t++)Ee(ve.__webglFramebuffer[ct][_t],j,V,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+ct,_t);else Ee(ve.__webglFramebuffer[ct],j,V,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+ct,0);T(V)&&E(s.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(gt){for(let ct=0,_t=De.length;ct<_t;ct++){const bt=De[ct],ke=n.get(bt);let Xe=s.TEXTURE_2D;(j.isWebGL3DRenderTarget||j.isWebGLArrayRenderTarget)&&(Xe=j.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),t.bindTexture(Xe,ke.__webglTexture),W(Xe,bt),Ee(ve.__webglFramebuffer,j,bt,s.COLOR_ATTACHMENT0+ct,Xe,0),T(bt)&&E(Xe)}t.unbindTexture()}else{let ct=s.TEXTURE_2D;if((j.isWebGL3DRenderTarget||j.isWebGLArrayRenderTarget)&&(ct=j.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),t.bindTexture(ct,Be.__webglTexture),W(ct,V),V.mipmaps&&V.mipmaps.length>0)for(let _t=0;_t<V.mipmaps.length;_t++)Ee(ve.__webglFramebuffer[_t],j,V,s.COLOR_ATTACHMENT0,ct,_t);else Ee(ve.__webglFramebuffer,j,V,s.COLOR_ATTACHMENT0,ct,0);T(V)&&E(ct),t.unbindTexture()}j.depthBuffer&&st(j)}function Ie(j){const V=j.textures;for(let ve=0,Be=V.length;ve<Be;ve++){const De=V[ve];if(T(De)){const Ae=w(j),gt=n.get(De).__webglTexture;t.bindTexture(Ae,gt),E(Ae),t.unbindTexture()}}}const Oe=[],Ue=[];function Le(j){if(j.samples>0){if(Pe(j)===!1){const V=j.textures,ve=j.width,Be=j.height;let De=s.COLOR_BUFFER_BIT;const Ae=j.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,gt=n.get(j),ct=V.length>1;if(ct)for(let bt=0;bt<V.length;bt++)t.bindFramebuffer(s.FRAMEBUFFER,gt.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+bt,s.RENDERBUFFER,null),t.bindFramebuffer(s.FRAMEBUFFER,gt.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+bt,s.TEXTURE_2D,null,0);t.bindFramebuffer(s.READ_FRAMEBUFFER,gt.__webglMultisampledFramebuffer);const _t=j.texture.mipmaps;_t&&_t.length>0?t.bindFramebuffer(s.DRAW_FRAMEBUFFER,gt.__webglFramebuffer[0]):t.bindFramebuffer(s.DRAW_FRAMEBUFFER,gt.__webglFramebuffer);for(let bt=0;bt<V.length;bt++){if(j.resolveDepthBuffer&&(j.depthBuffer&&(De|=s.DEPTH_BUFFER_BIT),j.stencilBuffer&&j.resolveStencilBuffer&&(De|=s.STENCIL_BUFFER_BIT)),ct){s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,gt.__webglColorRenderbuffer[bt]);const ke=n.get(V[bt]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,ke,0)}s.blitFramebuffer(0,0,ve,Be,0,0,ve,Be,De,s.NEAREST),f===!0&&(Oe.length=0,Ue.length=0,Oe.push(s.COLOR_ATTACHMENT0+bt),j.depthBuffer&&j.resolveDepthBuffer===!1&&(Oe.push(Ae),Ue.push(Ae),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,Ue)),s.invalidateFramebuffer(s.READ_FRAMEBUFFER,Oe))}if(t.bindFramebuffer(s.READ_FRAMEBUFFER,null),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),ct)for(let bt=0;bt<V.length;bt++){t.bindFramebuffer(s.FRAMEBUFFER,gt.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+bt,s.RENDERBUFFER,gt.__webglColorRenderbuffer[bt]);const ke=n.get(V[bt]).__webglTexture;t.bindFramebuffer(s.FRAMEBUFFER,gt.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+bt,s.TEXTURE_2D,ke,0)}t.bindFramebuffer(s.DRAW_FRAMEBUFFER,gt.__webglMultisampledFramebuffer)}else if(j.depthBuffer&&j.resolveDepthBuffer===!1&&f){const V=j.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[V])}}}function ze(j){return Math.min(i.maxSamples,j.samples)}function Pe(j){const V=n.get(j);return j.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&V.__useRenderToTexture!==!1}function Fe(j){const V=l.render.frame;m.get(j)!==V&&(m.set(j,V),j.update())}function Ne(j,V){const ve=j.colorSpace,Be=j.format,De=j.type;return j.isCompressedTexture===!0||j.isVideoTexture===!0||ve!==fa&&ve!==pu&&(On.getTransfer(ve)===ui?(Be!==na||De!==Pr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ve)),V}function yt(j){return typeof HTMLImageElement<"u"&&j instanceof HTMLImageElement?(p.width=j.naturalWidth||j.width,p.height=j.naturalHeight||j.height):typeof VideoFrame<"u"&&j instanceof VideoFrame?(p.width=j.displayWidth,p.height=j.displayHeight):(p.width=j.width,p.height=j.height),p}this.allocateTextureUnit=Q,this.resetTextureUnits=Y,this.setTexture2D=ae,this.setTexture2DArray=G,this.setTexture3D=ee,this.setTextureCube=ie,this.rebindTextures=et,this.setupRenderTarget=se,this.updateRenderTargetMipmap=Ie,this.updateMultisampleRenderTarget=Le,this.setupDepthRenderbuffer=st,this.setupFrameBufferTexture=Ee,this.useMultisampledRTT=Pe}function q2(s,e){function t(n,i=pu){let a;const l=On.getTransfer(i);if(n===Pr)return s.UNSIGNED_BYTE;if(n===Xy)return s.UNSIGNED_SHORT_4_4_4_4;if(n===Yy)return s.UNSIGNED_SHORT_5_5_5_1;if(n===mS)return s.UNSIGNED_INT_5_9_9_9_REV;if(n===gS)return s.UNSIGNED_INT_10F_11F_11F_REV;if(n===Vy)return s.BYTE;if(n===ky)return s.SHORT;if(n===Ud)return s.UNSIGNED_SHORT;if(n===hg)return s.INT;if(n===Ml)return s.UNSIGNED_INT;if(n===Vi)return s.FLOAT;if(n===Ia)return s.HALF_FLOAT;if(n===vS)return s.ALPHA;if(n===yS)return s.RGB;if(n===na)return s.RGBA;if(n===Nd)return s.DEPTH_COMPONENT;if(n===Od)return s.DEPTH_STENCIL;if(n===dg)return s.RED;if(n===pg)return s.RED_INTEGER;if(n===_S)return s.RG;if(n===qy)return s.RG_INTEGER;if(n===Wy)return s.RGBA_INTEGER;if(n===Hm||n===Gm||n===Vm||n===km)if(l===ui)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(n===Hm)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Gm)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Vm)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===km)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(n===Hm)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Gm)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Vm)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===km)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===ey||n===ty||n===ny||n===iy)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(n===ey)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===ty)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===ny)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===iy)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===ay||n===ry||n===sy)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(n===ay||n===ry)return l===ui?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(n===sy)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===oy||n===ly||n===uy||n===cy||n===fy||n===hy||n===dy||n===py||n===my||n===gy||n===vy||n===yy||n===_y||n===xy)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(n===oy)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===ly)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===uy)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===cy)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===fy)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===hy)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===dy)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===py)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===my)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===gy)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===vy)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===yy)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===_y)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===xy)return l===ui?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Sy||n===My||n===by)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(n===Sy)return l===ui?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===My)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===by)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===Ey||n===Ty||n===Ay||n===Ry)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(n===Ey)return a.COMPRESSED_RED_RGTC1_EXT;if(n===Ty)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Ay)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Ry)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Dd?s.UNSIGNED_INT_24_8:s[n]!==void 0?s[n]:null}return{convert:t}}const K4=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Q4=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class J4{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new IS(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new Fr({vertexShader:K4,fragmentShader:Q4,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Si(new zo(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class $4 extends bl{constructor(e,t){super();const n=this;let i=null,a=1,l=null,u="local-floor",f=1,p=null,m=null,v=null,_=null,x=null,b=null;const R=typeof XRWebGLBinding<"u",T=new J4,E={},w=t.getContextAttributes();let D=null,U=null;const I=[],O=[],P=new ht;let B=null;const N=new Zi;N.viewport=new kn;const z=new Zi;z.viewport=new kn;const q=[N,z],Y=new I2;let Q=null,Z=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(oe){let he=I[oe];return he===void 0&&(he=new Hv,I[oe]=he),he.getTargetRaySpace()},this.getControllerGrip=function(oe){let he=I[oe];return he===void 0&&(he=new Hv,I[oe]=he),he.getGripSpace()},this.getHand=function(oe){let he=I[oe];return he===void 0&&(he=new Hv,I[oe]=he),he.getHandSpace()};function ae(oe){const he=O.indexOf(oe.inputSource);if(he===-1)return;const Ee=I[he];Ee!==void 0&&(Ee.update(oe.inputSource,oe.frame,p||l),Ee.dispatchEvent({type:oe.type,data:oe.inputSource}))}function G(){i.removeEventListener("select",ae),i.removeEventListener("selectstart",ae),i.removeEventListener("selectend",ae),i.removeEventListener("squeeze",ae),i.removeEventListener("squeezestart",ae),i.removeEventListener("squeezeend",ae),i.removeEventListener("end",G),i.removeEventListener("inputsourceschange",ee);for(let oe=0;oe<I.length;oe++){const he=O[oe];he!==null&&(O[oe]=null,I[oe].disconnect(he))}Q=null,Z=null,T.reset();for(const oe in E)delete E[oe];e.setRenderTarget(D),x=null,_=null,v=null,i=null,U=null,ge.stop(),n.isPresenting=!1,e.setPixelRatio(B),e.setSize(P.width,P.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(oe){a=oe,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(oe){u=oe,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||l},this.setReferenceSpace=function(oe){p=oe},this.getBaseLayer=function(){return _!==null?_:x},this.getBinding=function(){return v===null&&R&&(v=new XRWebGLBinding(i,t)),v},this.getFrame=function(){return b},this.getSession=function(){return i},this.setSession=async function(oe){if(i=oe,i!==null){if(D=e.getRenderTarget(),i.addEventListener("select",ae),i.addEventListener("selectstart",ae),i.addEventListener("selectend",ae),i.addEventListener("squeeze",ae),i.addEventListener("squeezestart",ae),i.addEventListener("squeezeend",ae),i.addEventListener("end",G),i.addEventListener("inputsourceschange",ee),w.xrCompatible!==!0&&await t.makeXRCompatible(),B=e.getPixelRatio(),e.getSize(P),R&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ee=null,We=null,rt=null;w.depth&&(rt=w.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ee=w.stencil?Od:Nd,We=w.stencil?Dd:Ml);const st={colorFormat:t.RGBA8,depthFormat:rt,scaleFactor:a};v=this.getBinding(),_=v.createProjectionLayer(st),i.updateRenderState({layers:[_]}),e.setPixelRatio(1),e.setSize(_.textureWidth,_.textureHeight,!1),U=new Ks(_.textureWidth,_.textureHeight,{format:na,type:Pr,depthTexture:new zS(_.textureWidth,_.textureHeight,We,void 0,void 0,void 0,void 0,void 0,void 0,Ee),stencilBuffer:w.stencil,colorSpace:e.outputColorSpace,samples:w.antialias?4:0,resolveDepthBuffer:_.ignoreDepthValues===!1,resolveStencilBuffer:_.ignoreDepthValues===!1})}else{const Ee={antialias:w.antialias,alpha:!0,depth:w.depth,stencil:w.stencil,framebufferScaleFactor:a};x=new XRWebGLLayer(i,t,Ee),i.updateRenderState({baseLayer:x}),e.setPixelRatio(1),e.setSize(x.framebufferWidth,x.framebufferHeight,!1),U=new Ks(x.framebufferWidth,x.framebufferHeight,{format:na,type:Pr,colorSpace:e.outputColorSpace,stencilBuffer:w.stencil,resolveDepthBuffer:x.ignoreDepthValues===!1,resolveStencilBuffer:x.ignoreDepthValues===!1})}U.isXRRenderTarget=!0,this.setFoveation(f),p=null,l=await i.requestReferenceSpace(u),ge.setContext(i),ge.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return T.getDepthTexture()};function ee(oe){for(let he=0;he<oe.removed.length;he++){const Ee=oe.removed[he],We=O.indexOf(Ee);We>=0&&(O[We]=null,I[We].disconnect(Ee))}for(let he=0;he<oe.added.length;he++){const Ee=oe.added[he];let We=O.indexOf(Ee);if(We===-1){for(let st=0;st<I.length;st++)if(st>=O.length){O.push(Ee),We=st;break}else if(O[st]===null){O[st]=Ee,We=st;break}if(We===-1)break}const rt=I[We];rt&&rt.connect(Ee)}}const ie=new ne,fe=new ne;function ce(oe,he,Ee){ie.setFromMatrixPosition(he.matrixWorld),fe.setFromMatrixPosition(Ee.matrixWorld);const We=ie.distanceTo(fe),rt=he.projectionMatrix.elements,st=Ee.projectionMatrix.elements,et=rt[14]/(rt[10]-1),se=rt[14]/(rt[10]+1),Ie=(rt[9]+1)/rt[5],Oe=(rt[9]-1)/rt[5],Ue=(rt[8]-1)/rt[0],Le=(st[8]+1)/st[0],ze=et*Ue,Pe=et*Le,Fe=We/(-Ue+Le),Ne=Fe*-Ue;if(he.matrixWorld.decompose(oe.position,oe.quaternion,oe.scale),oe.translateX(Ne),oe.translateZ(Fe),oe.matrixWorld.compose(oe.position,oe.quaternion,oe.scale),oe.matrixWorldInverse.copy(oe.matrixWorld).invert(),rt[10]===-1)oe.projectionMatrix.copy(he.projectionMatrix),oe.projectionMatrixInverse.copy(he.projectionMatrixInverse);else{const yt=et+Fe,j=se+Fe,V=ze-Ne,ve=Pe+(We-Ne),Be=Ie*se/j*yt,De=Oe*se/j*yt;oe.projectionMatrix.makePerspective(V,ve,Be,De,yt,j),oe.projectionMatrixInverse.copy(oe.projectionMatrix).invert()}}function H(oe,he){he===null?oe.matrixWorld.copy(oe.matrix):oe.matrixWorld.multiplyMatrices(he.matrixWorld,oe.matrix),oe.matrixWorldInverse.copy(oe.matrixWorld).invert()}this.updateCamera=function(oe){if(i===null)return;let he=oe.near,Ee=oe.far;T.texture!==null&&(T.depthNear>0&&(he=T.depthNear),T.depthFar>0&&(Ee=T.depthFar)),Y.near=z.near=N.near=he,Y.far=z.far=N.far=Ee,(Q!==Y.near||Z!==Y.far)&&(i.updateRenderState({depthNear:Y.near,depthFar:Y.far}),Q=Y.near,Z=Y.far),Y.layers.mask=oe.layers.mask|6,N.layers.mask=Y.layers.mask&3,z.layers.mask=Y.layers.mask&5;const We=oe.parent,rt=Y.cameras;H(Y,We);for(let st=0;st<rt.length;st++)H(rt[st],We);rt.length===2?ce(Y,N,z):Y.projectionMatrix.copy(N.projectionMatrix),W(oe,Y,We)};function W(oe,he,Ee){Ee===null?oe.matrix.copy(he.matrixWorld):(oe.matrix.copy(Ee.matrixWorld),oe.matrix.invert(),oe.matrix.multiply(he.matrixWorld)),oe.matrix.decompose(oe.position,oe.quaternion,oe.scale),oe.updateMatrixWorld(!0),oe.projectionMatrix.copy(he.projectionMatrix),oe.projectionMatrixInverse.copy(he.projectionMatrixInverse),oe.isPerspectiveCamera&&(oe.fov=Bd*2*Math.atan(1/oe.projectionMatrix.elements[5]),oe.zoom=1)}this.getCamera=function(){return Y},this.getFoveation=function(){if(!(_===null&&x===null))return f},this.setFoveation=function(oe){f=oe,_!==null&&(_.fixedFoveation=oe),x!==null&&x.fixedFoveation!==void 0&&(x.fixedFoveation=oe)},this.hasDepthSensing=function(){return T.texture!==null},this.getDepthSensingMesh=function(){return T.getMesh(Y)},this.getCameraTexture=function(oe){return E[oe]};let re=null;function de(oe,he){if(m=he.getViewerPose(p||l),b=he,m!==null){const Ee=m.views;x!==null&&(e.setRenderTargetFramebuffer(U,x.framebuffer),e.setRenderTarget(U));let We=!1;Ee.length!==Y.cameras.length&&(Y.cameras.length=0,We=!0);for(let se=0;se<Ee.length;se++){const Ie=Ee[se];let Oe=null;if(x!==null)Oe=x.getViewport(Ie);else{const Le=v.getViewSubImage(_,Ie);Oe=Le.viewport,se===0&&(e.setRenderTargetTextures(U,Le.colorTexture,Le.depthStencilTexture),e.setRenderTarget(U))}let Ue=q[se];Ue===void 0&&(Ue=new Zi,Ue.layers.enable(se),Ue.viewport=new kn,q[se]=Ue),Ue.matrix.fromArray(Ie.transform.matrix),Ue.matrix.decompose(Ue.position,Ue.quaternion,Ue.scale),Ue.projectionMatrix.fromArray(Ie.projectionMatrix),Ue.projectionMatrixInverse.copy(Ue.projectionMatrix).invert(),Ue.viewport.set(Oe.x,Oe.y,Oe.width,Oe.height),se===0&&(Y.matrix.copy(Ue.matrix),Y.matrix.decompose(Y.position,Y.quaternion,Y.scale)),We===!0&&Y.cameras.push(Ue)}const rt=i.enabledFeatures;if(rt&&rt.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&R){v=n.getBinding();const se=v.getDepthInformation(Ee[0]);se&&se.isValid&&se.texture&&T.init(se,i.renderState)}if(rt&&rt.includes("camera-access")&&R){e.state.unbindTexture(),v=n.getBinding();for(let se=0;se<Ee.length;se++){const Ie=Ee[se].camera;if(Ie){let Oe=E[Ie];Oe||(Oe=new IS,E[Ie]=Oe);const Ue=v.getCameraImage(Ie);Oe.sourceTexture=Ue}}}}for(let Ee=0;Ee<I.length;Ee++){const We=O[Ee],rt=I[Ee];We!==null&&rt!==void 0&&rt.update(We,he,p||l)}re&&re(oe,he),he.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:he}),b=null}const ge=new G2;ge.setAnimationLoop(de),this.setAnimationLoop=function(oe){re=oe},this.dispose=function(){}}}const Mf=new ns,ez=new Qt;function tz(s,e){function t(T,E){T.matrixAutoUpdate===!0&&T.updateMatrix(),E.value.copy(T.matrix)}function n(T,E){E.color.getRGB(T.fogColor.value,KA(s)),E.isFog?(T.fogNear.value=E.near,T.fogFar.value=E.far):E.isFogExp2&&(T.fogDensity.value=E.density)}function i(T,E,w,D,U){E.isMeshBasicMaterial||E.isMeshLambertMaterial?a(T,E):E.isMeshToonMaterial?(a(T,E),v(T,E)):E.isMeshPhongMaterial?(a(T,E),m(T,E)):E.isMeshStandardMaterial?(a(T,E),_(T,E),E.isMeshPhysicalMaterial&&x(T,E,U)):E.isMeshMatcapMaterial?(a(T,E),b(T,E)):E.isMeshDepthMaterial?a(T,E):E.isMeshDistanceMaterial?(a(T,E),R(T,E)):E.isMeshNormalMaterial?a(T,E):E.isLineBasicMaterial?(l(T,E),E.isLineDashedMaterial&&u(T,E)):E.isPointsMaterial?f(T,E,w,D):E.isSpriteMaterial?p(T,E):E.isShadowMaterial?(T.color.value.copy(E.color),T.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}function a(T,E){T.opacity.value=E.opacity,E.color&&T.diffuse.value.copy(E.color),E.emissive&&T.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(T.map.value=E.map,t(E.map,T.mapTransform)),E.alphaMap&&(T.alphaMap.value=E.alphaMap,t(E.alphaMap,T.alphaMapTransform)),E.bumpMap&&(T.bumpMap.value=E.bumpMap,t(E.bumpMap,T.bumpMapTransform),T.bumpScale.value=E.bumpScale,E.side===Ir&&(T.bumpScale.value*=-1)),E.normalMap&&(T.normalMap.value=E.normalMap,t(E.normalMap,T.normalMapTransform),T.normalScale.value.copy(E.normalScale),E.side===Ir&&T.normalScale.value.negate()),E.displacementMap&&(T.displacementMap.value=E.displacementMap,t(E.displacementMap,T.displacementMapTransform),T.displacementScale.value=E.displacementScale,T.displacementBias.value=E.displacementBias),E.emissiveMap&&(T.emissiveMap.value=E.emissiveMap,t(E.emissiveMap,T.emissiveMapTransform)),E.specularMap&&(T.specularMap.value=E.specularMap,t(E.specularMap,T.specularMapTransform)),E.alphaTest>0&&(T.alphaTest.value=E.alphaTest);const w=e.get(E),D=w.envMap,U=w.envMapRotation;D&&(T.envMap.value=D,Mf.copy(U),Mf.x*=-1,Mf.y*=-1,Mf.z*=-1,D.isCubeTexture&&D.isRenderTargetTexture===!1&&(Mf.y*=-1,Mf.z*=-1),T.envMapRotation.value.setFromMatrix4(ez.makeRotationFromEuler(Mf)),T.flipEnvMap.value=D.isCubeTexture&&D.isRenderTargetTexture===!1?-1:1,T.reflectivity.value=E.reflectivity,T.ior.value=E.ior,T.refractionRatio.value=E.refractionRatio),E.lightMap&&(T.lightMap.value=E.lightMap,T.lightMapIntensity.value=E.lightMapIntensity,t(E.lightMap,T.lightMapTransform)),E.aoMap&&(T.aoMap.value=E.aoMap,T.aoMapIntensity.value=E.aoMapIntensity,t(E.aoMap,T.aoMapTransform))}function l(T,E){T.diffuse.value.copy(E.color),T.opacity.value=E.opacity,E.map&&(T.map.value=E.map,t(E.map,T.mapTransform))}function u(T,E){T.dashSize.value=E.dashSize,T.totalSize.value=E.dashSize+E.gapSize,T.scale.value=E.scale}function f(T,E,w,D){T.diffuse.value.copy(E.color),T.opacity.value=E.opacity,T.size.value=E.size*w,T.scale.value=D*.5,E.map&&(T.map.value=E.map,t(E.map,T.uvTransform)),E.alphaMap&&(T.alphaMap.value=E.alphaMap,t(E.alphaMap,T.alphaMapTransform)),E.alphaTest>0&&(T.alphaTest.value=E.alphaTest)}function p(T,E){T.diffuse.value.copy(E.color),T.opacity.value=E.opacity,T.rotation.value=E.rotation,E.map&&(T.map.value=E.map,t(E.map,T.mapTransform)),E.alphaMap&&(T.alphaMap.value=E.alphaMap,t(E.alphaMap,T.alphaMapTransform)),E.alphaTest>0&&(T.alphaTest.value=E.alphaTest)}function m(T,E){T.specular.value.copy(E.specular),T.shininess.value=Math.max(E.shininess,1e-4)}function v(T,E){E.gradientMap&&(T.gradientMap.value=E.gradientMap)}function _(T,E){T.metalness.value=E.metalness,E.metalnessMap&&(T.metalnessMap.value=E.metalnessMap,t(E.metalnessMap,T.metalnessMapTransform)),T.roughness.value=E.roughness,E.roughnessMap&&(T.roughnessMap.value=E.roughnessMap,t(E.roughnessMap,T.roughnessMapTransform)),E.envMap&&(T.envMapIntensity.value=E.envMapIntensity)}function x(T,E,w){T.ior.value=E.ior,E.sheen>0&&(T.sheenColor.value.copy(E.sheenColor).multiplyScalar(E.sheen),T.sheenRoughness.value=E.sheenRoughness,E.sheenColorMap&&(T.sheenColorMap.value=E.sheenColorMap,t(E.sheenColorMap,T.sheenColorMapTransform)),E.sheenRoughnessMap&&(T.sheenRoughnessMap.value=E.sheenRoughnessMap,t(E.sheenRoughnessMap,T.sheenRoughnessMapTransform))),E.clearcoat>0&&(T.clearcoat.value=E.clearcoat,T.clearcoatRoughness.value=E.clearcoatRoughness,E.clearcoatMap&&(T.clearcoatMap.value=E.clearcoatMap,t(E.clearcoatMap,T.clearcoatMapTransform)),E.clearcoatRoughnessMap&&(T.clearcoatRoughnessMap.value=E.clearcoatRoughnessMap,t(E.clearcoatRoughnessMap,T.clearcoatRoughnessMapTransform)),E.clearcoatNormalMap&&(T.clearcoatNormalMap.value=E.clearcoatNormalMap,t(E.clearcoatNormalMap,T.clearcoatNormalMapTransform),T.clearcoatNormalScale.value.copy(E.clearcoatNormalScale),E.side===Ir&&T.clearcoatNormalScale.value.negate())),E.dispersion>0&&(T.dispersion.value=E.dispersion),E.iridescence>0&&(T.iridescence.value=E.iridescence,T.iridescenceIOR.value=E.iridescenceIOR,T.iridescenceThicknessMinimum.value=E.iridescenceThicknessRange[0],T.iridescenceThicknessMaximum.value=E.iridescenceThicknessRange[1],E.iridescenceMap&&(T.iridescenceMap.value=E.iridescenceMap,t(E.iridescenceMap,T.iridescenceMapTransform)),E.iridescenceThicknessMap&&(T.iridescenceThicknessMap.value=E.iridescenceThicknessMap,t(E.iridescenceThicknessMap,T.iridescenceThicknessMapTransform))),E.transmission>0&&(T.transmission.value=E.transmission,T.transmissionSamplerMap.value=w.texture,T.transmissionSamplerSize.value.set(w.width,w.height),E.transmissionMap&&(T.transmissionMap.value=E.transmissionMap,t(E.transmissionMap,T.transmissionMapTransform)),T.thickness.value=E.thickness,E.thicknessMap&&(T.thicknessMap.value=E.thicknessMap,t(E.thicknessMap,T.thicknessMapTransform)),T.attenuationDistance.value=E.attenuationDistance,T.attenuationColor.value.copy(E.attenuationColor)),E.anisotropy>0&&(T.anisotropyVector.value.set(E.anisotropy*Math.cos(E.anisotropyRotation),E.anisotropy*Math.sin(E.anisotropyRotation)),E.anisotropyMap&&(T.anisotropyMap.value=E.anisotropyMap,t(E.anisotropyMap,T.anisotropyMapTransform))),T.specularIntensity.value=E.specularIntensity,T.specularColor.value.copy(E.specularColor),E.specularColorMap&&(T.specularColorMap.value=E.specularColorMap,t(E.specularColorMap,T.specularColorMapTransform)),E.specularIntensityMap&&(T.specularIntensityMap.value=E.specularIntensityMap,t(E.specularIntensityMap,T.specularIntensityMapTransform))}function b(T,E){E.matcap&&(T.matcap.value=E.matcap)}function R(T,E){const w=e.get(E).light;T.referencePosition.value.setFromMatrixPosition(w.matrixWorld),T.nearDistance.value=w.shadow.camera.near,T.farDistance.value=w.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function nz(s,e,t,n){let i={},a={},l=[];const u=s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS);function f(w,D){const U=D.program;n.uniformBlockBinding(w,U)}function p(w,D){let U=i[w.id];U===void 0&&(b(w),U=m(w),i[w.id]=U,w.addEventListener("dispose",T));const I=D.program;n.updateUBOMapping(w,I);const O=e.render.frame;a[w.id]!==O&&(_(w),a[w.id]=O)}function m(w){const D=v();w.__bindingPointIndex=D;const U=s.createBuffer(),I=w.__size,O=w.usage;return s.bindBuffer(s.UNIFORM_BUFFER,U),s.bufferData(s.UNIFORM_BUFFER,I,O),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,D,U),U}function v(){for(let w=0;w<u;w++)if(l.indexOf(w)===-1)return l.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function _(w){const D=i[w.id],U=w.uniforms,I=w.__cache;s.bindBuffer(s.UNIFORM_BUFFER,D);for(let O=0,P=U.length;O<P;O++){const B=Array.isArray(U[O])?U[O]:[U[O]];for(let N=0,z=B.length;N<z;N++){const q=B[N];if(x(q,O,N,I)===!0){const Y=q.__offset,Q=Array.isArray(q.value)?q.value:[q.value];let Z=0;for(let ae=0;ae<Q.length;ae++){const G=Q[ae],ee=R(G);typeof G=="number"||typeof G=="boolean"?(q.__data[0]=G,s.bufferSubData(s.UNIFORM_BUFFER,Y+Z,q.__data)):G.isMatrix3?(q.__data[0]=G.elements[0],q.__data[1]=G.elements[1],q.__data[2]=G.elements[2],q.__data[3]=0,q.__data[4]=G.elements[3],q.__data[5]=G.elements[4],q.__data[6]=G.elements[5],q.__data[7]=0,q.__data[8]=G.elements[6],q.__data[9]=G.elements[7],q.__data[10]=G.elements[8],q.__data[11]=0):(G.toArray(q.__data,Z),Z+=ee.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,Y,q.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}function x(w,D,U,I){const O=w.value,P=D+"_"+U;if(I[P]===void 0)return typeof O=="number"||typeof O=="boolean"?I[P]=O:I[P]=O.clone(),!0;{const B=I[P];if(typeof O=="number"||typeof O=="boolean"){if(B!==O)return I[P]=O,!0}else if(B.equals(O)===!1)return B.copy(O),!0}return!1}function b(w){const D=w.uniforms;let U=0;const I=16;for(let P=0,B=D.length;P<B;P++){const N=Array.isArray(D[P])?D[P]:[D[P]];for(let z=0,q=N.length;z<q;z++){const Y=N[z],Q=Array.isArray(Y.value)?Y.value:[Y.value];for(let Z=0,ae=Q.length;Z<ae;Z++){const G=Q[Z],ee=R(G),ie=U%I,fe=ie%ee.boundary,ce=ie+fe;U+=fe,ce!==0&&I-ce<ee.storage&&(U+=I-ce),Y.__data=new Float32Array(ee.storage/Float32Array.BYTES_PER_ELEMENT),Y.__offset=U,U+=ee.storage}}}const O=U%I;return O>0&&(U+=I-O),w.__size=U,w.__cache={},this}function R(w){const D={boundary:0,storage:0};return typeof w=="number"||typeof w=="boolean"?(D.boundary=4,D.storage=4):w.isVector2?(D.boundary=8,D.storage=8):w.isVector3||w.isColor?(D.boundary=16,D.storage=12):w.isVector4?(D.boundary=16,D.storage=16):w.isMatrix3?(D.boundary=48,D.storage=48):w.isMatrix4?(D.boundary=64,D.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),D}function T(w){const D=w.target;D.removeEventListener("dispose",T);const U=l.indexOf(D.__bindingPointIndex);l.splice(U,1),s.deleteBuffer(i[D.id]),delete i[D.id],delete a[D.id]}function E(){for(const w in i)s.deleteBuffer(i[w]);l=[],i={},a={}}return{bind:f,update:p,dispose:E}}class sM{constructor(e={}){const{canvas:t=WA(),context:n=null,depth:i=!0,stencil:a=!1,alpha:l=!1,antialias:u=!1,premultipliedAlpha:f=!0,preserveDrawingBuffer:p=!1,powerPreference:m="default",failIfMajorPerformanceCaveat:v=!1,reversedDepthBuffer:_=!1}=e;this.isWebGLRenderer=!0;let x;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");x=n.getContextAttributes().alpha}else x=l;const b=new Uint32Array(4),R=new Int32Array(4);let T=null,E=null;const w=[],D=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=yl,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const U=this;let I=!1;this._outputColorSpace=zi;let O=0,P=0,B=null,N=-1,z=null;const q=new kn,Y=new kn;let Q=null;const Z=new Nt(0);let ae=0,G=t.width,ee=t.height,ie=1,fe=null,ce=null;const H=new kn(0,0,G,ee),W=new kn(0,0,G,ee);let re=!1;const de=new Yd;let ge=!1,oe=!1;const he=new Qt,Ee=new ne,We=new kn,rt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let st=!1;function et(){return B===null?ie:1}let se=n;function Ie(X,ue){return t.getContext(X,ue)}try{const X={alpha:!0,depth:i,stencil:a,antialias:u,premultipliedAlpha:f,preserveDrawingBuffer:p,powerPreference:m,failIfMajorPerformanceCaveat:v};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${cg}`),t.addEventListener("webglcontextlost",at,!1),t.addEventListener("webglcontextrestored",Tt,!1),t.addEventListener("webglcontextcreationerror",it,!1),se===null){const ue="webgl2";if(se=Ie(ue,X),se===null)throw Ie(ue)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(X){throw console.error("THREE.WebGLRenderer: "+X.message),X}let Oe,Ue,Le,ze,Pe,Fe,Ne,yt,j,V,ve,Be,De,Ae,gt,ct,_t,bt,ke,Xe,lt,le,Te,ut;function pe(){Oe=new pL(se),Oe.init(),le=new q2(se,Oe),Ue=new oL(se,Oe,e,le),Le=new j4(se,Oe),Ue.reversedDepthBuffer&&_&&Le.buffers.depth.setReversed(!0),ze=new vL(se),Pe=new z4,Fe=new Z4(se,Oe,Le,Pe,Ue,le,ze),Ne=new uL(U),yt=new dL(U),j=new bD(se),Te=new rL(se,j),V=new mL(se,j,ze,Te),ve=new _L(se,V,j,ze),ke=new yL(se,Ue,Fe),ct=new lL(Pe),Be=new L4(U,Ne,yt,Oe,Ue,Te,ct),De=new tz(U,Pe),Ae=new B4,gt=new k4(Oe),bt=new aL(U,Ne,yt,Le,ve,x,f),_t=new q4(U,ve,Ue),ut=new nz(se,ze,Ue,Le),Xe=new sL(se,Oe,ze),lt=new gL(se,Oe,ze),ze.programs=Be.programs,U.capabilities=Ue,U.extensions=Oe,U.properties=Pe,U.renderLists=Ae,U.shadowMap=_t,U.state=Le,U.info=ze}pe();const _e=new $4(U,se);this.xr=_e,this.getContext=function(){return se},this.getContextAttributes=function(){return se.getContextAttributes()},this.forceContextLoss=function(){const X=Oe.get("WEBGL_lose_context");X&&X.loseContext()},this.forceContextRestore=function(){const X=Oe.get("WEBGL_lose_context");X&&X.restoreContext()},this.getPixelRatio=function(){return ie},this.setPixelRatio=function(X){X!==void 0&&(ie=X,this.setSize(G,ee,!1))},this.getSize=function(X){return X.set(G,ee)},this.setSize=function(X,ue,me=!0){if(_e.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}G=X,ee=ue,t.width=Math.floor(X*ie),t.height=Math.floor(ue*ie),me===!0&&(t.style.width=X+"px",t.style.height=ue+"px"),this.setViewport(0,0,X,ue)},this.getDrawingBufferSize=function(X){return X.set(G*ie,ee*ie).floor()},this.setDrawingBufferSize=function(X,ue,me){G=X,ee=ue,ie=me,t.width=Math.floor(X*me),t.height=Math.floor(ue*me),this.setViewport(0,0,X,ue)},this.getCurrentViewport=function(X){return X.copy(q)},this.getViewport=function(X){return X.copy(H)},this.setViewport=function(X,ue,me,ye){X.isVector4?H.set(X.x,X.y,X.z,X.w):H.set(X,ue,me,ye),Le.viewport(q.copy(H).multiplyScalar(ie).round())},this.getScissor=function(X){return X.copy(W)},this.setScissor=function(X,ue,me,ye){X.isVector4?W.set(X.x,X.y,X.z,X.w):W.set(X,ue,me,ye),Le.scissor(Y.copy(W).multiplyScalar(ie).round())},this.getScissorTest=function(){return re},this.setScissorTest=function(X){Le.setScissorTest(re=X)},this.setOpaqueSort=function(X){fe=X},this.setTransparentSort=function(X){ce=X},this.getClearColor=function(X){return X.copy(bt.getClearColor())},this.setClearColor=function(){bt.setClearColor(...arguments)},this.getClearAlpha=function(){return bt.getClearAlpha()},this.setClearAlpha=function(){bt.setClearAlpha(...arguments)},this.clear=function(X=!0,ue=!0,me=!0){let ye=0;if(X){let te=!1;if(B!==null){const Je=B.texture.format;te=Je===Wy||Je===qy||Je===pg}if(te){const Je=B.texture.type,Qe=Je===Pr||Je===Ml||Je===Ud||Je===Dd||Je===Xy||Je===Yy,ot=bt.getClearColor(),dt=bt.getClearAlpha(),St=ot.r,Dt=ot.g,At=ot.b;Qe?(b[0]=St,b[1]=Dt,b[2]=At,b[3]=dt,se.clearBufferuiv(se.COLOR,0,b)):(R[0]=St,R[1]=Dt,R[2]=At,R[3]=dt,se.clearBufferiv(se.COLOR,0,R))}else ye|=se.COLOR_BUFFER_BIT}ue&&(ye|=se.DEPTH_BUFFER_BIT),me&&(ye|=se.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),se.clear(ye)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",at,!1),t.removeEventListener("webglcontextrestored",Tt,!1),t.removeEventListener("webglcontextcreationerror",it,!1),bt.dispose(),Ae.dispose(),gt.dispose(),Pe.dispose(),Ne.dispose(),yt.dispose(),ve.dispose(),Te.dispose(),ut.dispose(),Be.dispose(),_e.dispose(),_e.removeEventListener("sessionstart",An),_e.removeEventListener("sessionend",ai),ci.stop()};function at(X){X.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function Tt(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1;const X=ze.autoReset,ue=_t.enabled,me=_t.autoUpdate,ye=_t.needsUpdate,te=_t.type;pe(),ze.autoReset=X,_t.enabled=ue,_t.autoUpdate=me,_t.needsUpdate=ye,_t.type=te}function it(X){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",X.statusMessage)}function Ge(X){const ue=X.target;ue.removeEventListener("dispose",Ge),xt(ue)}function xt(X){wt(X),Pe.remove(X)}function wt(X){const ue=Pe.get(X).programs;ue!==void 0&&(ue.forEach(function(me){Be.releaseProgram(me)}),X.isShaderMaterial&&Be.releaseShaderCache(X))}this.renderBufferDirect=function(X,ue,me,ye,te,Je){ue===null&&(ue=rt);const Qe=te.isMesh&&te.matrixWorld.determinant()<0,ot=$(X,ue,me,ye,te);Le.setMaterial(ye,Qe);let dt=me.index,St=1;if(ye.wireframe===!0){if(dt=V.getWireframeAttribute(me),dt===void 0)return;St=2}const Dt=me.drawRange,At=me.attributes.position;let Ht=Dt.start*St,$t=(Dt.start+Dt.count)*St;Je!==null&&(Ht=Math.max(Ht,Je.start*St),$t=Math.min($t,(Je.start+Je.count)*St)),dt!==null?(Ht=Math.max(Ht,0),$t=Math.min($t,dt.count)):At!=null&&(Ht=Math.max(Ht,0),$t=Math.min($t,At.count));const kt=$t-Ht;if(kt<0||kt===1/0)return;Te.setup(te,ye,ot,me,dt);let sn,Ft=Xe;if(dt!==null&&(sn=j.get(dt),Ft=lt,Ft.setIndex(sn)),te.isMesh)ye.wireframe===!0?(Le.setLineWidth(ye.wireframeLinewidth*et()),Ft.setMode(se.LINES)):Ft.setMode(se.TRIANGLES);else if(te.isLine){let Ct=ye.linewidth;Ct===void 0&&(Ct=1),Le.setLineWidth(Ct*et()),te.isLineSegments?Ft.setMode(se.LINES):te.isLineLoop?Ft.setMode(se.LINE_LOOP):Ft.setMode(se.LINE_STRIP)}else te.isPoints?Ft.setMode(se.POINTS):te.isSprite&&Ft.setMode(se.TRIANGLES);if(te.isBatchedMesh)if(te._multiDrawInstances!==null)ng("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Ft.renderMultiDrawInstances(te._multiDrawStarts,te._multiDrawCounts,te._multiDrawCount,te._multiDrawInstances);else if(Oe.get("WEBGL_multi_draw"))Ft.renderMultiDraw(te._multiDrawStarts,te._multiDrawCounts,te._multiDrawCount);else{const Ct=te._multiDrawStarts,cn=te._multiDrawCounts,on=te._multiDrawCount,En=dt?j.get(dt).bytesPerElement:1,fn=Pe.get(ye).currentProgram.getUniforms();for(let pn=0;pn<on;pn++)fn.setValue(se,"_gl_DrawID",pn),Ft.render(Ct[pn]/En,cn[pn])}else if(te.isInstancedMesh)Ft.renderInstances(Ht,kt,te.count);else if(me.isInstancedBufferGeometry){const Ct=me._maxInstanceCount!==void 0?me._maxInstanceCount:1/0,cn=Math.min(me.instanceCount,Ct);Ft.renderInstances(Ht,kt,cn)}else Ft.render(Ht,kt)};function Ut(X,ue,me){X.transparent===!0&&X.side===ur&&X.forceSinglePass===!1?(X.side=Ir,X.needsUpdate=!0,Un(X,ue,me),X.side=xl,X.needsUpdate=!0,Un(X,ue,me),X.side=ur):Un(X,ue,me)}this.compile=function(X,ue,me=null){me===null&&(me=X),E=gt.get(me),E.init(ue),D.push(E),me.traverseVisible(function(te){te.isLight&&te.layers.test(ue.layers)&&(E.pushLight(te),te.castShadow&&E.pushShadow(te))}),X!==me&&X.traverseVisible(function(te){te.isLight&&te.layers.test(ue.layers)&&(E.pushLight(te),te.castShadow&&E.pushShadow(te))}),E.setupLights();const ye=new Set;return X.traverse(function(te){if(!(te.isMesh||te.isPoints||te.isLine||te.isSprite))return;const Je=te.material;if(Je)if(Array.isArray(Je))for(let Qe=0;Qe<Je.length;Qe++){const ot=Je[Qe];Ut(ot,me,te),ye.add(ot)}else Ut(Je,me,te),ye.add(Je)}),E=D.pop(),ye},this.compileAsync=function(X,ue,me=null){const ye=this.compile(X,ue,me);return new Promise(te=>{function Je(){if(ye.forEach(function(Qe){Pe.get(Qe).currentProgram.isReady()&&ye.delete(Qe)}),ye.size===0){te(X);return}setTimeout(Je,10)}Oe.get("KHR_parallel_shader_compile")!==null?Je():setTimeout(Je,10)})};let Pt=null;function yn(X){Pt&&Pt(X)}function An(){ci.stop()}function ai(){ci.start()}const ci=new G2;ci.setAnimationLoop(yn),typeof self<"u"&&ci.setContext(self),this.setAnimationLoop=function(X){Pt=X,_e.setAnimationLoop(X),X===null?ci.stop():ci.start()},_e.addEventListener("sessionstart",An),_e.addEventListener("sessionend",ai),this.render=function(X,ue){if(ue!==void 0&&ue.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(I===!0)return;if(X.matrixWorldAutoUpdate===!0&&X.updateMatrixWorld(),ue.parent===null&&ue.matrixWorldAutoUpdate===!0&&ue.updateMatrixWorld(),_e.enabled===!0&&_e.isPresenting===!0&&(_e.cameraAutoUpdate===!0&&_e.updateCamera(ue),ue=_e.getCamera()),X.isScene===!0&&X.onBeforeRender(U,X,ue,B),E=gt.get(X,D.length),E.init(ue),D.push(E),he.multiplyMatrices(ue.projectionMatrix,ue.matrixWorldInverse),de.setFromProjectionMatrix(he,bs,ue.reversedDepth),oe=this.localClippingEnabled,ge=ct.init(this.clippingPlanes,oe),T=Ae.get(X,w.length),T.init(),w.push(T),_e.enabled===!0&&_e.isPresenting===!0){const Je=U.xr.getDepthSensingMesh();Je!==null&&Ti(Je,ue,-1/0,U.sortObjects)}Ti(X,ue,0,U.sortObjects),T.finish(),U.sortObjects===!0&&T.sort(fe,ce),st=_e.enabled===!1||_e.isPresenting===!1||_e.hasDepthSensing()===!1,st&&bt.addToRenderList(T,X),this.info.render.frame++,ge===!0&&ct.beginShadows();const me=E.state.shadowsArray;_t.render(me,X,ue),ge===!0&&ct.endShadows(),this.info.autoReset===!0&&this.info.reset();const ye=T.opaque,te=T.transmissive;if(E.setupLights(),ue.isArrayCamera){const Je=ue.cameras;if(te.length>0)for(let Qe=0,ot=Je.length;Qe<ot;Qe++){const dt=Je[Qe];Ai(ye,te,X,dt)}st&&bt.render(X);for(let Qe=0,ot=Je.length;Qe<ot;Qe++){const dt=Je[Qe];mi(T,X,dt,dt.viewport)}}else te.length>0&&Ai(ye,te,X,ue),st&&bt.render(X),mi(T,X,ue);B!==null&&P===0&&(Fe.updateMultisampleRenderTarget(B),Fe.updateRenderTargetMipmap(B)),X.isScene===!0&&X.onAfterRender(U,X,ue),Te.resetDefaultState(),N=-1,z=null,D.pop(),D.length>0?(E=D[D.length-1],ge===!0&&ct.setGlobalState(U.clippingPlanes,E.state.camera)):E=null,w.pop(),w.length>0?T=w[w.length-1]:T=null};function Ti(X,ue,me,ye){if(X.visible===!1)return;if(X.layers.test(ue.layers)){if(X.isGroup)me=X.renderOrder;else if(X.isLOD)X.autoUpdate===!0&&X.update(ue);else if(X.isLight)E.pushLight(X),X.castShadow&&E.pushShadow(X);else if(X.isSprite){if(!X.frustumCulled||de.intersectsSprite(X)){ye&&We.setFromMatrixPosition(X.matrixWorld).applyMatrix4(he);const Qe=ve.update(X),ot=X.material;ot.visible&&T.push(X,Qe,ot,me,We.z,null)}}else if((X.isMesh||X.isLine||X.isPoints)&&(!X.frustumCulled||de.intersectsObject(X))){const Qe=ve.update(X),ot=X.material;if(ye&&(X.boundingSphere!==void 0?(X.boundingSphere===null&&X.computeBoundingSphere(),We.copy(X.boundingSphere.center)):(Qe.boundingSphere===null&&Qe.computeBoundingSphere(),We.copy(Qe.boundingSphere.center)),We.applyMatrix4(X.matrixWorld).applyMatrix4(he)),Array.isArray(ot)){const dt=Qe.groups;for(let St=0,Dt=dt.length;St<Dt;St++){const At=dt[St],Ht=ot[At.materialIndex];Ht&&Ht.visible&&T.push(X,Qe,Ht,me,We.z,At)}}else ot.visible&&T.push(X,Qe,ot,me,We.z,null)}}const Je=X.children;for(let Qe=0,ot=Je.length;Qe<ot;Qe++)Ti(Je[Qe],ue,me,ye)}function mi(X,ue,me,ye){const te=X.opaque,Je=X.transmissive,Qe=X.transparent;E.setupLightsView(me),ge===!0&&ct.setGlobalState(U.clippingPlanes,me),ye&&Le.viewport(q.copy(ye)),te.length>0&&ri(te,ue,me),Je.length>0&&ri(Je,ue,me),Qe.length>0&&ri(Qe,ue,me),Le.buffers.depth.setTest(!0),Le.buffers.depth.setMask(!0),Le.buffers.color.setMask(!0),Le.setPolygonOffset(!1)}function Ai(X,ue,me,ye){if((me.isScene===!0?me.overrideMaterial:null)!==null)return;E.state.transmissionRenderTarget[ye.id]===void 0&&(E.state.transmissionRenderTarget[ye.id]=new Ks(1,1,{generateMipmaps:!0,type:Oe.has("EXT_color_buffer_half_float")||Oe.has("EXT_color_buffer_float")?Ia:Pr,minFilter:Zs,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:On.workingColorSpace}));const Je=E.state.transmissionRenderTarget[ye.id],Qe=ye.viewport||q;Je.setSize(Qe.z*U.transmissionResolutionScale,Qe.w*U.transmissionResolutionScale);const ot=U.getRenderTarget(),dt=U.getActiveCubeFace(),St=U.getActiveMipmapLevel();U.setRenderTarget(Je),U.getClearColor(Z),ae=U.getClearAlpha(),ae<1&&U.setClearColor(16777215,.5),U.clear(),st&&bt.render(me);const Dt=U.toneMapping;U.toneMapping=yl;const At=ye.viewport;if(ye.viewport!==void 0&&(ye.viewport=void 0),E.setupLightsView(ye),ge===!0&&ct.setGlobalState(U.clippingPlanes,ye),ri(X,me,ye),Fe.updateMultisampleRenderTarget(Je),Fe.updateRenderTargetMipmap(Je),Oe.has("WEBGL_multisampled_render_to_texture")===!1){let Ht=!1;for(let $t=0,kt=ue.length;$t<kt;$t++){const sn=ue[$t],Ft=sn.object,Ct=sn.geometry,cn=sn.material,on=sn.group;if(cn.side===ur&&Ft.layers.test(ye.layers)){const En=cn.side;cn.side=Ir,cn.needsUpdate=!0,Xt(Ft,me,ye,Ct,cn,on),cn.side=En,cn.needsUpdate=!0,Ht=!0}}Ht===!0&&(Fe.updateMultisampleRenderTarget(Je),Fe.updateRenderTargetMipmap(Je))}U.setRenderTarget(ot,dt,St),U.setClearColor(Z,ae),At!==void 0&&(ye.viewport=At),U.toneMapping=Dt}function ri(X,ue,me){const ye=ue.isScene===!0?ue.overrideMaterial:null;for(let te=0,Je=X.length;te<Je;te++){const Qe=X[te],ot=Qe.object,dt=Qe.geometry,St=Qe.group;let Dt=Qe.material;Dt.allowOverride===!0&&ye!==null&&(Dt=ye),ot.layers.test(me.layers)&&Xt(ot,ue,me,dt,Dt,St)}}function Xt(X,ue,me,ye,te,Je){X.onBeforeRender(U,ue,me,ye,te,Je),X.modelViewMatrix.multiplyMatrices(me.matrixWorldInverse,X.matrixWorld),X.normalMatrix.getNormalMatrix(X.modelViewMatrix),te.onBeforeRender(U,ue,me,ye,X,Je),te.transparent===!0&&te.side===ur&&te.forceSinglePass===!1?(te.side=Ir,te.needsUpdate=!0,U.renderBufferDirect(me,ue,ye,te,X,Je),te.side=xl,te.needsUpdate=!0,U.renderBufferDirect(me,ue,ye,te,X,Je),te.side=ur):U.renderBufferDirect(me,ue,ye,te,X,Je),X.onAfterRender(U,ue,me,ye,te,Je)}function Un(X,ue,me){ue.isScene!==!0&&(ue=rt);const ye=Pe.get(X),te=E.state.lights,Je=E.state.shadowsArray,Qe=te.state.version,ot=Be.getParameters(X,te.state,Je,ue,me),dt=Be.getProgramCacheKey(ot);let St=ye.programs;ye.environment=X.isMeshStandardMaterial?ue.environment:null,ye.fog=ue.fog,ye.envMap=(X.isMeshStandardMaterial?yt:Ne).get(X.envMap||ye.environment),ye.envMapRotation=ye.environment!==null&&X.envMap===null?ue.environmentRotation:X.envMapRotation,St===void 0&&(X.addEventListener("dispose",Ge),St=new Map,ye.programs=St);let Dt=St.get(dt);if(Dt!==void 0){if(ye.currentProgram===Dt&&ye.lightsStateVersion===Qe)return k(X,ot),Dt}else ot.uniforms=Be.getUniforms(X),X.onBeforeCompile(ot,U),Dt=Be.acquireProgram(ot,dt),St.set(dt,Dt),ye.uniforms=ot.uniforms;const At=ye.uniforms;return(!X.isShaderMaterial&&!X.isRawShaderMaterial||X.clipping===!0)&&(At.clippingPlanes=ct.uniform),k(X,ot),ye.needsLights=qe(X),ye.lightsStateVersion=Qe,ye.needsLights&&(At.ambientLightColor.value=te.state.ambient,At.lightProbe.value=te.state.probe,At.directionalLights.value=te.state.directional,At.directionalLightShadows.value=te.state.directionalShadow,At.spotLights.value=te.state.spot,At.spotLightShadows.value=te.state.spotShadow,At.rectAreaLights.value=te.state.rectArea,At.ltc_1.value=te.state.rectAreaLTC1,At.ltc_2.value=te.state.rectAreaLTC2,At.pointLights.value=te.state.point,At.pointLightShadows.value=te.state.pointShadow,At.hemisphereLights.value=te.state.hemi,At.directionalShadowMap.value=te.state.directionalShadowMap,At.directionalShadowMatrix.value=te.state.directionalShadowMatrix,At.spotShadowMap.value=te.state.spotShadowMap,At.spotLightMatrix.value=te.state.spotLightMatrix,At.spotLightMap.value=te.state.spotLightMap,At.pointShadowMap.value=te.state.pointShadowMap,At.pointShadowMatrix.value=te.state.pointShadowMatrix),ye.currentProgram=Dt,ye.uniformsList=null,Dt}function Jt(X){if(X.uniformsList===null){const ue=X.currentProgram.getUniforms();X.uniformsList=Gv.seqWithValue(ue.seq,X.uniforms)}return X.uniformsList}function k(X,ue){const me=Pe.get(X);me.outputColorSpace=ue.outputColorSpace,me.batching=ue.batching,me.batchingColor=ue.batchingColor,me.instancing=ue.instancing,me.instancingColor=ue.instancingColor,me.instancingMorph=ue.instancingMorph,me.skinning=ue.skinning,me.morphTargets=ue.morphTargets,me.morphNormals=ue.morphNormals,me.morphColors=ue.morphColors,me.morphTargetsCount=ue.morphTargetsCount,me.numClippingPlanes=ue.numClippingPlanes,me.numIntersection=ue.numClipIntersection,me.vertexAlphas=ue.vertexAlphas,me.vertexTangents=ue.vertexTangents,me.toneMapping=ue.toneMapping}function $(X,ue,me,ye,te){ue.isScene!==!0&&(ue=rt),Fe.resetTextureUnits();const Je=ue.fog,Qe=ye.isMeshStandardMaterial?ue.environment:null,ot=B===null?U.outputColorSpace:B.isXRRenderTarget===!0?B.texture.colorSpace:fa,dt=(ye.isMeshStandardMaterial?yt:Ne).get(ye.envMap||Qe),St=ye.vertexColors===!0&&!!me.attributes.color&&me.attributes.color.itemSize===4,Dt=!!me.attributes.tangent&&(!!ye.normalMap||ye.anisotropy>0),At=!!me.morphAttributes.position,Ht=!!me.morphAttributes.normal,$t=!!me.morphAttributes.color;let kt=yl;ye.toneMapped&&(B===null||B.isXRRenderTarget===!0)&&(kt=U.toneMapping);const sn=me.morphAttributes.position||me.morphAttributes.normal||me.morphAttributes.color,Ft=sn!==void 0?sn.length:0,Ct=Pe.get(ye),cn=E.state.lights;if(ge===!0&&(oe===!0||X!==z)){const _n=X===z&&ye.id===N;ct.setState(ye,X,_n)}let on=!1;ye.version===Ct.__version?(Ct.needsLights&&Ct.lightsStateVersion!==cn.state.version||Ct.outputColorSpace!==ot||te.isBatchedMesh&&Ct.batching===!1||!te.isBatchedMesh&&Ct.batching===!0||te.isBatchedMesh&&Ct.batchingColor===!0&&te.colorTexture===null||te.isBatchedMesh&&Ct.batchingColor===!1&&te.colorTexture!==null||te.isInstancedMesh&&Ct.instancing===!1||!te.isInstancedMesh&&Ct.instancing===!0||te.isSkinnedMesh&&Ct.skinning===!1||!te.isSkinnedMesh&&Ct.skinning===!0||te.isInstancedMesh&&Ct.instancingColor===!0&&te.instanceColor===null||te.isInstancedMesh&&Ct.instancingColor===!1&&te.instanceColor!==null||te.isInstancedMesh&&Ct.instancingMorph===!0&&te.morphTexture===null||te.isInstancedMesh&&Ct.instancingMorph===!1&&te.morphTexture!==null||Ct.envMap!==dt||ye.fog===!0&&Ct.fog!==Je||Ct.numClippingPlanes!==void 0&&(Ct.numClippingPlanes!==ct.numPlanes||Ct.numIntersection!==ct.numIntersection)||Ct.vertexAlphas!==St||Ct.vertexTangents!==Dt||Ct.morphTargets!==At||Ct.morphNormals!==Ht||Ct.morphColors!==$t||Ct.toneMapping!==kt||Ct.morphTargetsCount!==Ft)&&(on=!0):(on=!0,Ct.__version=ye.version);let En=Ct.currentProgram;on===!0&&(En=Un(ye,ue,te));let fn=!1,pn=!1,Rn=!1;const Ot=En.getUniforms(),Yn=Ct.uniforms;if(Le.useProgram(En.program)&&(fn=!0,pn=!0,Rn=!0),ye.id!==N&&(N=ye.id,pn=!0),fn||z!==X){Le.buffers.depth.getReversed()&&X.reversedDepth!==!0&&(X._reversedDepth=!0,X.updateProjectionMatrix()),Ot.setValue(se,"projectionMatrix",X.projectionMatrix),Ot.setValue(se,"viewMatrix",X.matrixWorldInverse);const Pn=Ot.map.cameraPosition;Pn!==void 0&&Pn.setValue(se,Ee.setFromMatrixPosition(X.matrixWorld)),Ue.logarithmicDepthBuffer&&Ot.setValue(se,"logDepthBufFC",2/(Math.log(X.far+1)/Math.LN2)),(ye.isMeshPhongMaterial||ye.isMeshToonMaterial||ye.isMeshLambertMaterial||ye.isMeshBasicMaterial||ye.isMeshStandardMaterial||ye.isShaderMaterial)&&Ot.setValue(se,"isOrthographic",X.isOrthographicCamera===!0),z!==X&&(z=X,pn=!0,Rn=!0)}if(te.isSkinnedMesh){Ot.setOptional(se,te,"bindMatrix"),Ot.setOptional(se,te,"bindMatrixInverse");const _n=te.skeleton;_n&&(_n.boneTexture===null&&_n.computeBoneTexture(),Ot.setValue(se,"boneTexture",_n.boneTexture,Fe))}te.isBatchedMesh&&(Ot.setOptional(se,te,"batchingTexture"),Ot.setValue(se,"batchingTexture",te._matricesTexture,Fe),Ot.setOptional(se,te,"batchingIdTexture"),Ot.setValue(se,"batchingIdTexture",te._indirectTexture,Fe),Ot.setOptional(se,te,"batchingColorTexture"),te._colorsTexture!==null&&Ot.setValue(se,"batchingColorTexture",te._colorsTexture,Fe));const ti=me.morphAttributes;if((ti.position!==void 0||ti.normal!==void 0||ti.color!==void 0)&&ke.update(te,me,En),(pn||Ct.receiveShadow!==te.receiveShadow)&&(Ct.receiveShadow=te.receiveShadow,Ot.setValue(se,"receiveShadow",te.receiveShadow)),ye.isMeshGouraudMaterial&&ye.envMap!==null&&(Yn.envMap.value=dt,Yn.flipEnvMap.value=dt.isCubeTexture&&dt.isRenderTargetTexture===!1?-1:1),ye.isMeshStandardMaterial&&ye.envMap===null&&ue.environment!==null&&(Yn.envMapIntensity.value=ue.environmentIntensity),pn&&(Ot.setValue(se,"toneMappingExposure",U.toneMappingExposure),Ct.needsLights&&Me(Yn,Rn),Je&&ye.fog===!0&&De.refreshFogUniforms(Yn,Je),De.refreshMaterialUniforms(Yn,ye,ie,ee,E.state.transmissionRenderTarget[X.id]),Gv.upload(se,Jt(Ct),Yn,Fe)),ye.isShaderMaterial&&ye.uniformsNeedUpdate===!0&&(Gv.upload(se,Jt(Ct),Yn,Fe),ye.uniformsNeedUpdate=!1),ye.isSpriteMaterial&&Ot.setValue(se,"center",te.center),Ot.setValue(se,"modelViewMatrix",te.modelViewMatrix),Ot.setValue(se,"normalMatrix",te.normalMatrix),Ot.setValue(se,"modelMatrix",te.matrixWorld),ye.isShaderMaterial||ye.isRawShaderMaterial){const _n=ye.uniformsGroups;for(let Pn=0,Hr=_n.length;Pn<Hr;Pn++){const ki=_n[Pn];ut.update(ki,En),ut.bind(ki,En)}}return En}function Me(X,ue){X.ambientLightColor.needsUpdate=ue,X.lightProbe.needsUpdate=ue,X.directionalLights.needsUpdate=ue,X.directionalLightShadows.needsUpdate=ue,X.pointLights.needsUpdate=ue,X.pointLightShadows.needsUpdate=ue,X.spotLights.needsUpdate=ue,X.spotLightShadows.needsUpdate=ue,X.rectAreaLights.needsUpdate=ue,X.hemisphereLights.needsUpdate=ue}function qe(X){return X.isMeshLambertMaterial||X.isMeshToonMaterial||X.isMeshPhongMaterial||X.isMeshStandardMaterial||X.isShadowMaterial||X.isShaderMaterial&&X.lights===!0}this.getActiveCubeFace=function(){return O},this.getActiveMipmapLevel=function(){return P},this.getRenderTarget=function(){return B},this.setRenderTargetTextures=function(X,ue,me){const ye=Pe.get(X);ye.__autoAllocateDepthBuffer=X.resolveDepthBuffer===!1,ye.__autoAllocateDepthBuffer===!1&&(ye.__useRenderToTexture=!1),Pe.get(X.texture).__webglTexture=ue,Pe.get(X.depthTexture).__webglTexture=ye.__autoAllocateDepthBuffer?void 0:me,ye.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(X,ue){const me=Pe.get(X);me.__webglFramebuffer=ue,me.__useDefaultFramebuffer=ue===void 0};const tt=se.createFramebuffer();this.setRenderTarget=function(X,ue=0,me=0){B=X,O=ue,P=me;let ye=!0,te=null,Je=!1,Qe=!1;if(X){const dt=Pe.get(X);if(dt.__useDefaultFramebuffer!==void 0)Le.bindFramebuffer(se.FRAMEBUFFER,null),ye=!1;else if(dt.__webglFramebuffer===void 0)Fe.setupRenderTarget(X);else if(dt.__hasExternalTextures)Fe.rebindTextures(X,Pe.get(X.texture).__webglTexture,Pe.get(X.depthTexture).__webglTexture);else if(X.depthBuffer){const At=X.depthTexture;if(dt.__boundDepthTexture!==At){if(At!==null&&Pe.has(At)&&(X.width!==At.image.width||X.height!==At.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Fe.setupDepthRenderbuffer(X)}}const St=X.texture;(St.isData3DTexture||St.isDataArrayTexture||St.isCompressedArrayTexture)&&(Qe=!0);const Dt=Pe.get(X).__webglFramebuffer;X.isWebGLCubeRenderTarget?(Array.isArray(Dt[ue])?te=Dt[ue][me]:te=Dt[ue],Je=!0):X.samples>0&&Fe.useMultisampledRTT(X)===!1?te=Pe.get(X).__webglMultisampledFramebuffer:Array.isArray(Dt)?te=Dt[me]:te=Dt,q.copy(X.viewport),Y.copy(X.scissor),Q=X.scissorTest}else q.copy(H).multiplyScalar(ie).floor(),Y.copy(W).multiplyScalar(ie).floor(),Q=re;if(me!==0&&(te=tt),Le.bindFramebuffer(se.FRAMEBUFFER,te)&&ye&&Le.drawBuffers(X,te),Le.viewport(q),Le.scissor(Y),Le.setScissorTest(Q),Je){const dt=Pe.get(X.texture);se.framebufferTexture2D(se.FRAMEBUFFER,se.COLOR_ATTACHMENT0,se.TEXTURE_CUBE_MAP_POSITIVE_X+ue,dt.__webglTexture,me)}else if(Qe){const dt=ue;for(let St=0;St<X.textures.length;St++){const Dt=Pe.get(X.textures[St]);se.framebufferTextureLayer(se.FRAMEBUFFER,se.COLOR_ATTACHMENT0+St,Dt.__webglTexture,me,dt)}}else if(X!==null&&me!==0){const dt=Pe.get(X.texture);se.framebufferTexture2D(se.FRAMEBUFFER,se.COLOR_ATTACHMENT0,se.TEXTURE_2D,dt.__webglTexture,me)}N=-1},this.readRenderTargetPixels=function(X,ue,me,ye,te,Je,Qe,ot=0){if(!(X&&X.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let dt=Pe.get(X).__webglFramebuffer;if(X.isWebGLCubeRenderTarget&&Qe!==void 0&&(dt=dt[Qe]),dt){Le.bindFramebuffer(se.FRAMEBUFFER,dt);try{const St=X.textures[ot],Dt=St.format,At=St.type;if(!Ue.textureFormatReadable(Dt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ue.textureTypeReadable(At)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ue>=0&&ue<=X.width-ye&&me>=0&&me<=X.height-te&&(X.textures.length>1&&se.readBuffer(se.COLOR_ATTACHMENT0+ot),se.readPixels(ue,me,ye,te,le.convert(Dt),le.convert(At),Je))}finally{const St=B!==null?Pe.get(B).__webglFramebuffer:null;Le.bindFramebuffer(se.FRAMEBUFFER,St)}}},this.readRenderTargetPixelsAsync=async function(X,ue,me,ye,te,Je,Qe,ot=0){if(!(X&&X.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let dt=Pe.get(X).__webglFramebuffer;if(X.isWebGLCubeRenderTarget&&Qe!==void 0&&(dt=dt[Qe]),dt)if(ue>=0&&ue<=X.width-ye&&me>=0&&me<=X.height-te){Le.bindFramebuffer(se.FRAMEBUFFER,dt);const St=X.textures[ot],Dt=St.format,At=St.type;if(!Ue.textureFormatReadable(Dt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ue.textureTypeReadable(At))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Ht=se.createBuffer();se.bindBuffer(se.PIXEL_PACK_BUFFER,Ht),se.bufferData(se.PIXEL_PACK_BUFFER,Je.byteLength,se.STREAM_READ),X.textures.length>1&&se.readBuffer(se.COLOR_ATTACHMENT0+ot),se.readPixels(ue,me,ye,te,le.convert(Dt),le.convert(At),0);const $t=B!==null?Pe.get(B).__webglFramebuffer:null;Le.bindFramebuffer(se.FRAMEBUFFER,$t);const kt=se.fenceSync(se.SYNC_GPU_COMMANDS_COMPLETE,0);return se.flush(),await qw(se,kt,4),se.bindBuffer(se.PIXEL_PACK_BUFFER,Ht),se.getBufferSubData(se.PIXEL_PACK_BUFFER,0,Je),se.deleteBuffer(Ht),se.deleteSync(kt),Je}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(X,ue=null,me=0){const ye=Math.pow(2,-me),te=Math.floor(X.image.width*ye),Je=Math.floor(X.image.height*ye),Qe=ue!==null?ue.x:0,ot=ue!==null?ue.y:0;Fe.setTexture2D(X,0),se.copyTexSubImage2D(se.TEXTURE_2D,me,0,0,Qe,ot,te,Je),Le.unbindTexture()};const $e=se.createFramebuffer(),Mt=se.createFramebuffer();this.copyTextureToTexture=function(X,ue,me=null,ye=null,te=0,Je=null){Je===null&&(te!==0?(ng("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Je=te,te=0):Je=0);let Qe,ot,dt,St,Dt,At,Ht,$t,kt;const sn=X.isCompressedTexture?X.mipmaps[Je]:X.image;if(me!==null)Qe=me.max.x-me.min.x,ot=me.max.y-me.min.y,dt=me.isBox3?me.max.z-me.min.z:1,St=me.min.x,Dt=me.min.y,At=me.isBox3?me.min.z:0;else{const ti=Math.pow(2,-te);Qe=Math.floor(sn.width*ti),ot=Math.floor(sn.height*ti),X.isDataArrayTexture?dt=sn.depth:X.isData3DTexture?dt=Math.floor(sn.depth*ti):dt=1,St=0,Dt=0,At=0}ye!==null?(Ht=ye.x,$t=ye.y,kt=ye.z):(Ht=0,$t=0,kt=0);const Ft=le.convert(ue.format),Ct=le.convert(ue.type);let cn;ue.isData3DTexture?(Fe.setTexture3D(ue,0),cn=se.TEXTURE_3D):ue.isDataArrayTexture||ue.isCompressedArrayTexture?(Fe.setTexture2DArray(ue,0),cn=se.TEXTURE_2D_ARRAY):(Fe.setTexture2D(ue,0),cn=se.TEXTURE_2D),se.pixelStorei(se.UNPACK_FLIP_Y_WEBGL,ue.flipY),se.pixelStorei(se.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ue.premultiplyAlpha),se.pixelStorei(se.UNPACK_ALIGNMENT,ue.unpackAlignment);const on=se.getParameter(se.UNPACK_ROW_LENGTH),En=se.getParameter(se.UNPACK_IMAGE_HEIGHT),fn=se.getParameter(se.UNPACK_SKIP_PIXELS),pn=se.getParameter(se.UNPACK_SKIP_ROWS),Rn=se.getParameter(se.UNPACK_SKIP_IMAGES);se.pixelStorei(se.UNPACK_ROW_LENGTH,sn.width),se.pixelStorei(se.UNPACK_IMAGE_HEIGHT,sn.height),se.pixelStorei(se.UNPACK_SKIP_PIXELS,St),se.pixelStorei(se.UNPACK_SKIP_ROWS,Dt),se.pixelStorei(se.UNPACK_SKIP_IMAGES,At);const Ot=X.isDataArrayTexture||X.isData3DTexture,Yn=ue.isDataArrayTexture||ue.isData3DTexture;if(X.isDepthTexture){const ti=Pe.get(X),_n=Pe.get(ue),Pn=Pe.get(ti.__renderTarget),Hr=Pe.get(_n.__renderTarget);Le.bindFramebuffer(se.READ_FRAMEBUFFER,Pn.__webglFramebuffer),Le.bindFramebuffer(se.DRAW_FRAMEBUFFER,Hr.__webglFramebuffer);for(let ki=0;ki<dt;ki++)Ot&&(se.framebufferTextureLayer(se.READ_FRAMEBUFFER,se.COLOR_ATTACHMENT0,Pe.get(X).__webglTexture,te,At+ki),se.framebufferTextureLayer(se.DRAW_FRAMEBUFFER,se.COLOR_ATTACHMENT0,Pe.get(ue).__webglTexture,Je,kt+ki)),se.blitFramebuffer(St,Dt,Qe,ot,Ht,$t,Qe,ot,se.DEPTH_BUFFER_BIT,se.NEAREST);Le.bindFramebuffer(se.READ_FRAMEBUFFER,null),Le.bindFramebuffer(se.DRAW_FRAMEBUFFER,null)}else if(te!==0||X.isRenderTargetTexture||Pe.has(X)){const ti=Pe.get(X),_n=Pe.get(ue);Le.bindFramebuffer(se.READ_FRAMEBUFFER,$e),Le.bindFramebuffer(se.DRAW_FRAMEBUFFER,Mt);for(let Pn=0;Pn<dt;Pn++)Ot?se.framebufferTextureLayer(se.READ_FRAMEBUFFER,se.COLOR_ATTACHMENT0,ti.__webglTexture,te,At+Pn):se.framebufferTexture2D(se.READ_FRAMEBUFFER,se.COLOR_ATTACHMENT0,se.TEXTURE_2D,ti.__webglTexture,te),Yn?se.framebufferTextureLayer(se.DRAW_FRAMEBUFFER,se.COLOR_ATTACHMENT0,_n.__webglTexture,Je,kt+Pn):se.framebufferTexture2D(se.DRAW_FRAMEBUFFER,se.COLOR_ATTACHMENT0,se.TEXTURE_2D,_n.__webglTexture,Je),te!==0?se.blitFramebuffer(St,Dt,Qe,ot,Ht,$t,Qe,ot,se.COLOR_BUFFER_BIT,se.NEAREST):Yn?se.copyTexSubImage3D(cn,Je,Ht,$t,kt+Pn,St,Dt,Qe,ot):se.copyTexSubImage2D(cn,Je,Ht,$t,St,Dt,Qe,ot);Le.bindFramebuffer(se.READ_FRAMEBUFFER,null),Le.bindFramebuffer(se.DRAW_FRAMEBUFFER,null)}else Yn?X.isDataTexture||X.isData3DTexture?se.texSubImage3D(cn,Je,Ht,$t,kt,Qe,ot,dt,Ft,Ct,sn.data):ue.isCompressedArrayTexture?se.compressedTexSubImage3D(cn,Je,Ht,$t,kt,Qe,ot,dt,Ft,sn.data):se.texSubImage3D(cn,Je,Ht,$t,kt,Qe,ot,dt,Ft,Ct,sn):X.isDataTexture?se.texSubImage2D(se.TEXTURE_2D,Je,Ht,$t,Qe,ot,Ft,Ct,sn.data):X.isCompressedTexture?se.compressedTexSubImage2D(se.TEXTURE_2D,Je,Ht,$t,sn.width,sn.height,Ft,sn.data):se.texSubImage2D(se.TEXTURE_2D,Je,Ht,$t,Qe,ot,Ft,Ct,sn);se.pixelStorei(se.UNPACK_ROW_LENGTH,on),se.pixelStorei(se.UNPACK_IMAGE_HEIGHT,En),se.pixelStorei(se.UNPACK_SKIP_PIXELS,fn),se.pixelStorei(se.UNPACK_SKIP_ROWS,pn),se.pixelStorei(se.UNPACK_SKIP_IMAGES,Rn),Je===0&&ue.generateMipmaps&&se.generateMipmap(cn),Le.unbindTexture()},this.initRenderTarget=function(X){Pe.get(X).__webglFramebuffer===void 0&&Fe.setupRenderTarget(X)},this.initTexture=function(X){X.isCubeTexture?Fe.setTextureCube(X,0):X.isData3DTexture?Fe.setTexture3D(X,0):X.isDataArrayTexture||X.isCompressedArrayTexture?Fe.setTexture2DArray(X,0):Fe.setTexture2D(X,0),Le.unbindTexture()},this.resetState=function(){O=0,P=0,B=null,Le.reset(),Te.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return bs}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=On._getDrawingBufferColorSpace(e),t.unpackColorSpace=On._getUnpackColorSpace()}}const iz=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:pS,AddEquation:hc,AddOperation:TA,AdditiveAnimationBlendMode:xS,AdditiveBlending:Bx,AgXToneMapping:UA,AlphaFormat:vS,AlwaysCompare:YA,AlwaysDepth:jv,AlwaysStencilFunc:Vx,AmbientLight:U2,AnimationAction:F2,AnimationClip:Vd,AnimationLoader:yU,AnimationMixer:kU,AnimationObjectGroup:GU,AnimationUtils:pU,ArcCurve:a2,ArrayCamera:I2,ArrowHelper:pD,AttachedBindMode:Hx,Audio:B2,AudioAnalyser:DU,AudioContext:JS,AudioListener:CU,AudioLoader:TU,AxesHelper:mD,BackSide:Ir,BasicDepthPacking:BA,BasicShadowMap:rA,BatchedMesh:t2,Bone:e_,BooleanKeyframeTrack:Kf,Box2:JU,Box3:ca,Box3Helper:hD,BoxGeometry:Zf,BoxHelper:fD,BufferAttribute:ii,BufferGeometry:vn,BufferGeometryLoader:L2,ByteType:Vy,Cache:gl,Camera:Qy,CameraHelper:cD,CanvasTexture:B3,CapsuleGeometry:a_,CatmullRomCurve3:r2,CineonToneMapping:CA,CircleGeometry:r_,ClampToEdgeWrapping:ta,Clock:$S,Color:Nt,ColorKeyframeTrack:YS,ColorManagement:On,CompressedArrayTexture:z3,CompressedCubeTexture:I3,CompressedTexture:i_,CompressedTextureLoader:_U,ConeGeometry:xg,ConstantAlphaFactor:MA,ConstantColorFactor:xA,Controls:vD,CubeCamera:QA,CubeReflectionMapping:Sl,CubeRefractionMapping:vc,CubeTexture:mg,CubeTextureLoader:C2,CubeUVReflectionMapping:Xd,CubicBezierCurve:PS,CubicBezierCurve3:s2,CubicInterpolant:E2,CullFaceBack:Ix,CullFaceFront:aA,CullFaceFrontBack:KC,CullFaceNone:iA,Curve:Lo,CurvePath:l2,CustomBlending:sA,CustomToneMapping:wA,CylinderGeometry:_g,Cylindrical:QU,Data3DTexture:Ky,DataArrayTexture:Zy,DataTexture:No,DataTextureLoader:qS,DataUtils:Lf,DecrementStencilOp:sw,DecrementWrapStencilOp:lw,DefaultLoadingManager:R2,DepthFormat:Nd,DepthStencilFormat:Od,DepthTexture:zS,DetachedBindMode:NA,DirectionalLight:KS,DirectionalLightHelper:uD,DiscreteInterpolant:T2,DodecahedronGeometry:s_,DoubleSide:ur,DstAlphaFactor:mA,DstColorFactor:vA,DynamicCopyUsage:bw,DynamicDrawUsage:vw,DynamicReadUsage:xw,EdgesGeometry:i2,EllipseCurve:o_,EqualCompare:GA,EqualDepth:Kv,EqualStencilFunc:hw,EquirectangularReflectionMapping:Cd,EquirectangularRefractionMapping:Qm,Euler:ns,EventDispatcher:bl,ExternalTexture:IS,ExtrudeGeometry:l_,FileLoader:Br,Float16BufferAttribute:d3,Float32BufferAttribute:Vt,FloatType:Vi,Fog:$y,FogExp2:Jy,FramebufferTexture:L3,FrontSide:xl,Frustum:Yd,FrustumArray:t_,GLBufferAttribute:jU,GLSL1:Tw,GLSL3:kx,GreaterCompare:VA,GreaterDepth:Jv,GreaterEqualCompare:XA,GreaterEqualDepth:Qv,GreaterEqualStencilFunc:gw,GreaterStencilFunc:pw,GridHelper:oD,Group:gu,HalfFloatType:Ia,HemisphereLight:w2,HemisphereLightHelper:sD,IcosahedronGeometry:Sg,ImageBitmapLoader:z2,ImageLoader:sg,ImageUtils:jA,IncrementStencilOp:rw,IncrementWrapStencilOp:ow,InstancedBufferAttribute:xc,InstancedBufferGeometry:QS,InstancedInterleavedBuffer:WU,InstancedMesh:NS,Int16BufferAttribute:f3,Int32BufferAttribute:h3,Int8BufferAttribute:l3,IntType:hg,InterleavedBuffer:vg,InterleavedBufferAttribute:_c,Interpolant:Wd,InterpolateDiscrete:Ld,InterpolateLinear:zd,InterpolateSmooth:Fv,InterpolationSamplingMode:Cw,InterpolationSamplingType:Rw,InvertStencilOp:uw,KeepStencilOp:Cf,KeyframeTrack:Js,LOD:e2,LatheGeometry:u_,Layers:Fd,LessCompare:HA,LessDepth:Zv,LessEqualCompare:bS,LessEqualDepth:Gf,LessEqualStencilFunc:dw,LessStencilFunc:fw,Light:bc,LightProbe:O2,Line:yu,Line3:tD,LineBasicMaterial:cr,LineCurve:FS,LineCurve3:o2,LineDashedMaterial:S2,LineLoop:OS,LineSegments:Oo,LinearFilter:Wn,LinearInterpolant:XS,LinearMipMapLinearFilter:Gx,LinearMipMapNearestFilter:$C,LinearMipmapLinearFilter:Zs,LinearMipmapNearestFilter:Ed,LinearSRGBColorSpace:fa,LinearToneMapping:AA,LinearTransfer:$m,Loader:fr,LoaderUtils:mc,LoadingManager:y_,LoopOnce:OA,LoopPingPong:zA,LoopRepeat:LA,MOUSE:Af,Material:ba,MaterialLoader:__,MathUtils:Pd,Matrix2:aM,Matrix3:dn,Matrix4:Qt,MaxEquation:cA,Mesh:Si,MeshBasicMaterial:zr,MeshDepthMaterial:g_,MeshDistanceMaterial:v_,MeshLambertMaterial:_2,MeshMatcapMaterial:x2,MeshNormalMaterial:y2,MeshPhongMaterial:g2,MeshPhysicalMaterial:Qs,MeshStandardMaterial:qd,MeshToonMaterial:v2,MinEquation:uA,MirroredRepeatWrapping:wd,MixOperation:EA,MultiplyBlending:Fx,MultiplyOperation:fg,NearestFilter:Sa,NearestMipMapLinearFilter:JC,NearestMipMapNearestFilter:QC,NearestMipmapLinearFilter:Df,NearestMipmapNearestFilter:Gy,NeutralToneMapping:DA,NeverCompare:FA,NeverDepth:Wv,NeverStencilFunc:cw,NoBlending:vl,NoColorSpace:pu,NoToneMapping:yl,NormalAnimationBlendMode:jy,NormalBlending:Bf,NotEqualCompare:kA,NotEqualDepth:$v,NotEqualStencilFunc:mw,NumberKeyframeTrack:kf,Object3D:Xn,ObjectLoader:bU,ObjectSpaceNormalMap:PA,OctahedronGeometry:Mg,OneFactor:hA,OneMinusConstantAlphaFactor:bA,OneMinusConstantColorFactor:SA,OneMinusDstAlphaFactor:gA,OneMinusDstColorFactor:yA,OneMinusSrcAlphaFactor:qv,OneMinusSrcColorFactor:pA,OrthographicCamera:_l,PCFShadowMap:Hy,PCFSoftShadowMap:Fm,PMREMGenerator:Qx,Path:Ny,PerspectiveCamera:Zi,Plane:du,PlaneGeometry:zo,PlaneHelper:dD,PointLight:ZS,PointLightHelper:aD,Points:LS,PointsMaterial:n_,PolarGridHelper:lD,PolyhedronGeometry:Mc,PositionalAudio:UU,PropertyBinding:qn,PropertyMixer:P2,QuadraticBezierCurve:HS,QuadraticBezierCurve3:GS,Quaternion:ua,QuaternionKeyframeTrack:Xf,QuaternionLinearInterpolant:A2,RED_GREEN_RGTC2_Format:Ay,RED_RGTC1_Format:Ey,REVISION:cg,RGBADepthPacking:MS,RGBAFormat:na,RGBAIntegerFormat:Wy,RGBA_ASTC_10x10_Format:yy,RGBA_ASTC_10x5_Format:my,RGBA_ASTC_10x6_Format:gy,RGBA_ASTC_10x8_Format:vy,RGBA_ASTC_12x10_Format:_y,RGBA_ASTC_12x12_Format:xy,RGBA_ASTC_4x4_Format:oy,RGBA_ASTC_5x4_Format:ly,RGBA_ASTC_5x5_Format:uy,RGBA_ASTC_6x5_Format:cy,RGBA_ASTC_6x6_Format:fy,RGBA_ASTC_8x5_Format:hy,RGBA_ASTC_8x6_Format:dy,RGBA_ASTC_8x8_Format:py,RGBA_BPTC_Format:Sy,RGBA_ETC2_EAC_Format:sy,RGBA_PVRTC_2BPPV1_Format:iy,RGBA_PVRTC_4BPPV1_Format:ny,RGBA_S3TC_DXT1_Format:Gm,RGBA_S3TC_DXT3_Format:Vm,RGBA_S3TC_DXT5_Format:km,RGBDepthPacking:tw,RGBFormat:yS,RGBIntegerFormat:ew,RGB_BPTC_SIGNED_Format:My,RGB_BPTC_UNSIGNED_Format:by,RGB_ETC1_Format:ay,RGB_ETC2_Format:ry,RGB_PVRTC_2BPPV1_Format:ty,RGB_PVRTC_4BPPV1_Format:ey,RGB_S3TC_DXT1_Format:Hm,RGDepthPacking:nw,RGFormat:_S,RGIntegerFormat:qy,RawShaderMaterial:m2,Ray:jf,Raycaster:iM,RectAreaLight:D2,RedFormat:dg,RedIntegerFormat:pg,ReinhardToneMapping:RA,RenderTarget:TS,RenderTarget3D:XU,RepeatWrapping:yc,ReplaceStencilOp:aw,ReverseSubtractEquation:lA,RingGeometry:c_,SIGNED_RED_GREEN_RGTC2_Format:Ry,SIGNED_RED_RGTC1_Format:Ty,SRGBColorSpace:zi,SRGBTransfer:ui,Scene:gg,ShaderChunk:xn,ShaderLib:Uo,ShaderMaterial:Fr,ShadowMaterial:p2,Shape:Ff,ShapeGeometry:f_,ShapePath:gD,ShapeUtils:Do,ShortType:ky,Skeleton:yg,SkeletonHelper:iD,SkinnedMesh:DS,Source:dc,Sphere:Ma,SphereGeometry:bg,Spherical:Zx,SphericalHarmonics3:N2,SplineCurve:VS,SpotLight:jS,SpotLightHelper:nD,Sprite:$A,SpriteMaterial:US,SrcAlphaFactor:Yv,SrcAlphaSaturateFactor:_A,SrcColorFactor:dA,StaticCopyUsage:Mw,StaticDrawUsage:eg,StaticReadUsage:_w,StereoCamera:AU,StreamCopyUsage:Ew,StreamDrawUsage:yw,StreamReadUsage:Sw,StringKeyframeTrack:Qf,SubtractEquation:oA,SubtractiveBlending:Px,TOUCH:Rf,TangentSpaceNormalMap:Sc,TetrahedronGeometry:h_,Texture:Zn,TextureLoader:Eg,TextureUtils:MD,Timer:ZU,TimestampQuery:Aw,TorusGeometry:d_,TorusKnotGeometry:p_,Triangle:ts,TriangleFanDrawMode:Cy,TriangleStripDrawMode:SS,TrianglesDrawMode:IA,TubeGeometry:m_,UVMapping:gc,Uint16BufferAttribute:AS,Uint32BufferAttribute:RS,Uint8BufferAttribute:u3,Uint8ClampedBufferAttribute:c3,Uniform:nM,UniformsGroup:qU,UniformsLib:It,UniformsUtils:CS,UnsignedByteType:Pr,UnsignedInt101111Type:gS,UnsignedInt248Type:Dd,UnsignedInt5999Type:mS,UnsignedIntType:Ml,UnsignedShort4444Type:Xy,UnsignedShort5551Type:Yy,UnsignedShortType:Ud,VSMShadowMap:wo,Vector2:ht,Vector3:ne,Vector4:kn,VectorKeyframeTrack:Yf,VideoFrameTexture:O3,VideoTexture:n2,WebGL3DRenderTarget:Qw,WebGLArrayRenderTarget:Kw,WebGLCoordinateSystem:bs,WebGLCubeRenderTarget:wS,WebGLRenderTarget:Ks,WebGLRenderer:sM,WebGLUtils:q2,WebGPUCoordinateSystem:Id,WebXRController:Hv,WireframeGeometry:d2,WrapAroundEnding:Jm,ZeroCurvatureEnding:Nf,ZeroFactor:fA,ZeroSlopeEnding:Of,ZeroStencilOp:iw,createCanvasElement:WA},Symbol.toStringTag,{value:"Module"}));var sx={exports:{}},ox={},lx={exports:{}},ux={};var sT;function az(){if(sT)return ux;sT=1;var s=Wf();function e(v,_){return v===_&&(v!==0||1/v===1/_)||v!==v&&_!==_}var t=typeof Object.is=="function"?Object.is:e,n=s.useState,i=s.useEffect,a=s.useLayoutEffect,l=s.useDebugValue;function u(v,_){var x=_(),b=n({inst:{value:x,getSnapshot:_}}),R=b[0].inst,T=b[1];return a(function(){R.value=x,R.getSnapshot=_,f(R)&&T({inst:R})},[v,x,_]),i(function(){return f(R)&&T({inst:R}),v(function(){f(R)&&T({inst:R})})},[v]),l(x),x}function f(v){var _=v.getSnapshot;v=v.value;try{var x=_();return!t(v,x)}catch{return!0}}function p(v,_){return _()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:u;return ux.useSyncExternalStore=s.useSyncExternalStore!==void 0?s.useSyncExternalStore:m,ux}var oT;function rz(){return oT||(oT=1,lx.exports=az()),lx.exports}var lT;function sz(){if(lT)return ox;lT=1;var s=Wf(),e=rz();function t(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var n=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,a=s.useRef,l=s.useEffect,u=s.useMemo,f=s.useDebugValue;return ox.useSyncExternalStoreWithSelector=function(p,m,v,_,x){var b=a(null);if(b.current===null){var R={hasValue:!1,value:null};b.current=R}else R=b.current;b=u(function(){function E(O){if(!w){if(w=!0,D=O,O=_(O),x!==void 0&&R.hasValue){var P=R.value;if(x(P,O))return U=P}return U=O}if(P=U,n(D,O))return P;var B=_(O);return x!==void 0&&x(P,B)?(D=O,P):(D=O,U=B)}var w=!1,D,U,I=v===void 0?null:v;return[function(){return E(m())},I===null?void 0:function(){return E(I())}]},[m,v,_,x]);var T=i(p,b[0],b[1]);return l(function(){R.hasValue=!0,R.value=T},[T]),f(T),T},ox}var uT;function oz(){return uT||(uT=1,sx.exports=sz()),sx.exports}var lz=oz();const uz=dS(lz),cT=s=>{let e;const t=new Set,n=(p,m)=>{const v=typeof p=="function"?p(e):p;if(!Object.is(v,e)){const _=e;e=m??(typeof v!="object"||v===null)?v:Object.assign({},e,v),t.forEach(x=>x(e,_))}},i=()=>e,u={setState:n,getState:i,getInitialState:()=>f,subscribe:p=>(t.add(p),()=>t.delete(p))},f=e=s(n,i,u);return u},cz=(s=>s?cT(s):cT),{useSyncExternalStoreWithSelector:fz}=uz,hz=s=>s;function dz(s,e=hz,t){const n=fz(s.subscribe,s.getState,s.getInitialState,e,t);return PC.useDebugValue(n),n}const fT=(s,e)=>{const t=cz(s),n=(i,a=e)=>dz(t,i,a);return Object.assign(n,t),n},W2=((s,e)=>s?fT(s,e):fT),pz=s=>typeof s=="object"&&typeof s.then=="function",If=[];function j2(s,e,t=(n,i)=>n===i){if(s===e)return!0;if(!s||!e)return!1;const n=s.length;if(e.length!==n)return!1;for(let i=0;i<n;i++)if(!t(s[i],e[i]))return!1;return!0}function Z2(s,e=null,t=!1,n={}){e===null&&(e=[s]);for(const a of If)if(j2(e,a.keys,a.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(a,"error"))throw a.error;if(Object.prototype.hasOwnProperty.call(a,"response"))return n.lifespan&&n.lifespan>0&&(a.timeout&&clearTimeout(a.timeout),a.timeout=setTimeout(a.remove,n.lifespan)),a.response;if(!t)throw a.promise}const i={keys:e,equal:n.equal,remove:()=>{const a=If.indexOf(i);a!==-1&&If.splice(a,1)},promise:(pz(s)?s:s(...e)).then(a=>{i.response=a,n.lifespan&&n.lifespan>0&&(i.timeout=setTimeout(i.remove,n.lifespan))}).catch(a=>i.error=a)};if(If.push(i),!t)throw i.promise}const K2=(s,e,t)=>Z2(s,e,!1,t),mz=(s,e,t)=>{Z2(s,e,!0,t)},gz=s=>{if(s===void 0||s.length===0)If.splice(0,If.length);else{const e=If.find(t=>j2(s,t.keys,t.equal));e&&e.remove()}};var cx={exports:{}},fx={exports:{}},hx={exports:{}},dx={};var hT;function vz(){return hT||(hT=1,(function(s){function e(G,ee){var ie=G.length;G.push(ee);e:for(;0<ie;){var fe=ie-1>>>1,ce=G[fe];if(0<i(ce,ee))G[fe]=ee,G[ie]=ce,ie=fe;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var ee=G[0],ie=G.pop();if(ie!==ee){G[0]=ie;e:for(var fe=0,ce=G.length,H=ce>>>1;fe<H;){var W=2*(fe+1)-1,re=G[W],de=W+1,ge=G[de];if(0>i(re,ie))de<ce&&0>i(ge,re)?(G[fe]=ge,G[de]=ie,fe=de):(G[fe]=re,G[W]=ie,fe=W);else if(de<ce&&0>i(ge,ie))G[fe]=ge,G[de]=ie,fe=de;else break e}}return ee}function i(G,ee){var ie=G.sortIndex-ee.sortIndex;return ie!==0?ie:G.id-ee.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;s.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();s.unstable_now=function(){return l.now()-u}}var f=[],p=[],m=1,v=null,_=3,x=!1,b=!1,R=!1,T=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;function D(G){for(var ee=t(p);ee!==null;){if(ee.callback===null)n(p);else if(ee.startTime<=G)n(p),ee.sortIndex=ee.expirationTime,e(f,ee);else break;ee=t(p)}}function U(G){if(R=!1,D(G),!b)if(t(f)!==null)b=!0,Z();else{var ee=t(p);ee!==null&&ae(U,ee.startTime-G)}}var I=!1,O=-1,P=5,B=-1;function N(){return!(s.unstable_now()-B<P)}function z(){if(I){var G=s.unstable_now();B=G;var ee=!0;try{e:{b=!1,R&&(R=!1,E(O),O=-1),x=!0;var ie=_;try{t:{for(D(G),v=t(f);v!==null&&!(v.expirationTime>G&&N());){var fe=v.callback;if(typeof fe=="function"){v.callback=null,_=v.priorityLevel;var ce=fe(v.expirationTime<=G);if(G=s.unstable_now(),typeof ce=="function"){v.callback=ce,D(G),ee=!0;break t}v===t(f)&&n(f),D(G)}else n(f);v=t(f)}if(v!==null)ee=!0;else{var H=t(p);H!==null&&ae(U,H.startTime-G),ee=!1}}break e}finally{v=null,_=ie,x=!1}ee=void 0}}finally{ee?q():I=!1}}}var q;if(typeof w=="function")q=function(){w(z)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,Q=Y.port2;Y.port1.onmessage=z,q=function(){Q.postMessage(null)}}else q=function(){T(z,0)};function Z(){I||(I=!0,q())}function ae(G,ee){O=T(function(){G(s.unstable_now())},ee)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(G){G.callback=null},s.unstable_continueExecution=function(){b||x||(b=!0,Z())},s.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<G?Math.floor(1e3/G):5},s.unstable_getCurrentPriorityLevel=function(){return _},s.unstable_getFirstCallbackNode=function(){return t(f)},s.unstable_next=function(G){switch(_){case 1:case 2:case 3:var ee=3;break;default:ee=_}var ie=_;_=ee;try{return G()}finally{_=ie}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(G,ee){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ie=_;_=G;try{return ee()}finally{_=ie}},s.unstable_scheduleCallback=function(G,ee,ie){var fe=s.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?fe+ie:fe):ie=fe,G){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=ie+ce,G={id:m++,callback:ee,priorityLevel:G,startTime:ie,expirationTime:ce,sortIndex:-1},ie>fe?(G.sortIndex=ie,e(p,G),t(f)===null&&G===t(p)&&(R?(E(O),O=-1):R=!0,ae(U,ie-fe))):(G.sortIndex=ce,e(f,G),b||x||(b=!0,Z())),G},s.unstable_shouldYield=N,s.unstable_wrapCallback=function(G){var ee=_;return function(){var ie=_;_=ee;try{return G.apply(this,arguments)}finally{_=ie}}}})(dx)),dx}var dT;function Q2(){return dT||(dT=1,hx.exports=vz()),hx.exports}var pT;function yz(){return pT||(pT=1,(function(s){s.exports=function(e){function t(c,h,y,M){return new yp(c,h,y,M)}function n(){}function i(c){var h="https://react.dev/errors/"+c;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)h+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+c+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(c){return c===null||typeof c!="object"?null:(c=Tp&&c[Tp]||c["@@iterator"],typeof c=="function"?c:null)}function l(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===Xl?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case Lu:return"Fragment";case ds:return"Portal";case Ep:return"Profiler";case bp:return"StrictMode";case gh:return"Suspense";case Jo:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case Ls:return(c.displayName||"Context")+".Provider";case Qo:return(c._context.displayName||"Context")+".Consumer";case zu:var h=c.render;return c=c.displayName,c||(c=h.displayName||h.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case Pc:return h=c.displayName||null,h!==null?h:l(c.type)||"Memo";case ps:h=c._payload,c=c._init;try{return l(c(h))}catch{}}return null}function u(c){if(vh===void 0)try{throw Error()}catch(y){var h=y.stack.trim().match(/\n( *(at )?)/);vh=h&&h[1]||"",Ap=-1<y.stack.indexOf(`
    at`)?" (<anonymous>)":-1<y.stack.indexOf("@")?"@unknown:0:0":""}return`
`+vh+c+Ap}function f(c,h){if(!c||$o)return"";$o=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var M={DetermineComponentFrameRoot:function(){try{if(h){var zt=function(){throw Error()};if(Object.defineProperty(zt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(zt,[])}catch(ln){var Bt=ln}Reflect.construct(c,[],zt)}else{try{zt.call()}catch(ln){Bt=ln}c.call(zt.prototype)}}else{try{throw Error()}catch(ln){Bt=ln}(zt=c())&&typeof zt.catch=="function"&&zt.catch(function(){})}}catch(ln){if(ln&&Bt&&typeof ln.stack=="string")return[ln.stack,Bt.stack]}return[null,null]}};M.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(M.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(M.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var L=M.DetermineComponentFrameRoot(),J=L[0],xe=L[1];if(J&&xe){var we=J.split(`
`),pt=xe.split(`
`);for(C=M=0;M<we.length&&!we[M].includes("DetermineComponentFrameRoot");)M++;for(;C<pt.length&&!pt[C].includes("DetermineComponentFrameRoot");)C++;if(M===we.length||C===pt.length)for(M=we.length-1,C=pt.length-1;1<=M&&0<=C&&we[M]!==pt[C];)C--;for(;1<=M&&0<=C;M--,C--)if(we[M]!==pt[C]){if(M!==1||C!==1)do if(M--,C--,0>C||we[M]!==pt[C]){var Rt=`
`+we[M].replace(" at new "," at ");return c.displayName&&Rt.includes("<anonymous>")&&(Rt=Rt.replace("<anonymous>",c.displayName)),Rt}while(1<=M&&0<=C);break}}}finally{$o=!1,Error.prepareStackTrace=y}return(y=c?c.displayName||c.name:"")?u(y):""}function p(c){switch(c.tag){case 26:case 27:case 5:return u(c.type);case 16:return u("Lazy");case 13:return u("Suspense");case 19:return u("SuspenseList");case 0:case 15:return c=f(c.type,!1),c;case 11:return c=f(c.type.render,!1),c;case 1:return c=f(c.type,!0),c;default:return""}}function m(c){try{var h="";do h+=p(c),c=c.return;while(c);return h}catch(y){return`
Error generating stack: `+y.message+`
`+y.stack}}function v(c){var h=c,y=c;if(c.alternate)for(;h.return;)h=h.return;else{c=h;do h=c,(h.flags&4098)!==0&&(y=h.return),c=h.return;while(c)}return h.tag===3?y:null}function _(c){if(v(c)!==c)throw Error(i(188))}function x(c){var h=c.alternate;if(!h){if(h=v(c),h===null)throw Error(i(188));return h!==c?null:c}for(var y=c,M=h;;){var C=y.return;if(C===null)break;var L=C.alternate;if(L===null){if(M=C.return,M!==null){y=M;continue}break}if(C.child===L.child){for(L=C.child;L;){if(L===y)return _(C),c;if(L===M)return _(C),h;L=L.sibling}throw Error(i(188))}if(y.return!==M.return)y=C,M=L;else{for(var J=!1,xe=C.child;xe;){if(xe===y){J=!0,y=C,M=L;break}if(xe===M){J=!0,M=C,y=L;break}xe=xe.sibling}if(!J){for(xe=L.child;xe;){if(xe===y){J=!0,y=L,M=C;break}if(xe===M){J=!0,M=L,y=C;break}xe=xe.sibling}if(!J)throw Error(i(189))}}if(y.alternate!==M)throw Error(i(190))}if(y.tag!==3)throw Error(i(188));return y.stateNode.current===y?c:h}function b(c){var h=c.tag;if(h===5||h===26||h===27||h===6)return c;for(c=c.child;c!==null;){if(h=b(c),h!==null)return h;c=c.sibling}return null}function R(c){var h=c.tag;if(h===5||h===26||h===27||h===6)return c;for(c=c.child;c!==null;){if(c.tag!==4&&(h=R(c),h!==null))return h;c=c.sibling}return null}function T(c){return{current:c}}function E(c){0>go||(c.current=Wc[go],Wc[go]=null,go--)}function w(c,h){go++,Wc[go]=c.current,c.current=h}function D(c){return c>>>=0,c===0?32:31-(jc(c)/h0|0)|0}function U(c){var h=c&42;if(h!==0)return h;switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return c&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return c}}function I(c,h){var y=c.pendingLanes;if(y===0)return 0;var M=0,C=c.suspendedLanes,L=c.pingedLanes,J=c.warmLanes;c=c.finishedLanes!==0;var xe=y&134217727;return xe!==0?(y=xe&~C,y!==0?M=U(y):(L&=xe,L!==0?M=U(L):c||(J=xe&~J,J!==0&&(M=U(J))))):(xe=y&~C,xe!==0?M=U(xe):L!==0?M=U(L):c||(J=y&~J,J!==0&&(M=U(J)))),M===0?0:h!==0&&h!==M&&(h&C)===0&&(C=M&-M,J=h&-h,C>=J||C===32&&(J&4194176)!==0)?h:M}function O(c,h){return(c.pendingLanes&~(c.suspendedLanes&~c.pingedLanes)&h)===0}function P(c,h){switch(c){case 1:case 2:case 4:case 8:return h+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function B(){var c=Fu;return Fu<<=1,(Fu&4194176)===0&&(Fu=128),c}function N(){var c=Zc;return Zc<<=1,(Zc&62914560)===0&&(Zc=4194304),c}function z(c){for(var h=[],y=0;31>y;y++)h.push(c);return h}function q(c,h){c.pendingLanes|=h,h!==268435456&&(c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0)}function Y(c,h,y,M,C,L){var J=c.pendingLanes;c.pendingLanes=y,c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0,c.expiredLanes&=y,c.entangledLanes&=y,c.errorRecoveryDisabledLanes&=y,c.shellSuspendCounter=0;var xe=c.entanglements,we=c.expirationTimes,pt=c.hiddenUpdates;for(y=J&~y;0<y;){var Rt=31-Ja(y),zt=1<<Rt;xe[Rt]=0,we[Rt]=-1;var Bt=pt[Rt];if(Bt!==null)for(pt[Rt]=null,Rt=0;Rt<Bt.length;Rt++){var ln=Bt[Rt];ln!==null&&(ln.lane&=-536870913)}y&=~zt}M!==0&&Q(c,M,0),L!==0&&C===0&&c.tag!==0&&(c.suspendedLanes|=L&~(J&~h))}function Q(c,h,y){c.pendingLanes|=h,c.suspendedLanes&=~h;var M=31-Ja(h);c.entangledLanes|=h,c.entanglements[M]=c.entanglements[M]|1073741824|y&4194218}function Z(c,h){var y=c.entangledLanes|=h;for(c=c.entanglements;y;){var M=31-Ja(y),C=1<<M;C&h|c[M]&h&&(c[M]|=h),y&=~C}}function ae(c){return c&=-c,2<c?8<c?(c&134217727)!==0?32:268435456:8:2}function G(c){if($a&&typeof $a.onCommitFiberRoot=="function")try{$a.onCommitFiberRoot(Gu,c,void 0,(c.current.flags&128)===128)}catch{}}function ee(c){if(typeof g0=="function"&&im(c),$a&&typeof $a.setStrictMode=="function")try{$a.setStrictMode(Gu,c)}catch{}}function ie(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}function fe(c,h){if(typeof c=="object"&&c!==null){var y=Lh.get(c);return y!==void 0?y:(h={value:c,source:h,stack:m(h)},Lh.set(c,h),h)}return{value:c,source:h,stack:m(h)}}function ce(c,h){_i[Ui++]=Jc,_i[Ui++]=Qc,Qc=c,Jc=h}function H(c,h,y){Sr[Mr++]=Fs,Sr[Mr++]=Wr,Sr[Mr++]=ms,ms=c;var M=Fs;c=Wr;var C=32-Ja(M)-1;M&=~(1<<C),y+=1;var L=32-Ja(h)+C;if(30<L){var J=C-C%5;L=(M&(1<<J)-1).toString(32),M>>=J,C-=J,Fs=1<<32-Ja(h)+C|y<<C|M,Wr=L+c}else Fs=1<<L|y<<C|M,Wr=c}function W(c){c.return!==null&&(ce(c,1),H(c,1,0))}function re(c){for(;c===Qc;)Qc=_i[--Ui],_i[Ui]=null,Jc=_i[--Ui],_i[Ui]=null;for(;c===ms;)ms=Sr[--Mr],Sr[Mr]=null,Wr=Sr[--Mr],Sr[Mr]=null,Fs=Sr[--Mr],Sr[Mr]=null}function de(c,h){w(gs,h),w($c,c),w(oa,null),c=Yl(h),E(oa),w(oa,c)}function ge(){E(oa),E($c),E(gs)}function oe(c){c.memoizedState!==null&&w(Vu,c);var h=oa.current,y=Yg(h,c.type);h!==y&&(w($c,c),w(oa,y))}function he(c){$c.current===c&&(E(oa),E($c)),Vu.current===c&&(E(Vu),Is?nn._currentValue=Qa:nn._currentValue2=Qa)}function Ee(c){var h=Error(i(418,""));throw se(fe(h,c)),ef}function We(c,h){if(!Ga)throw Error(i(175));U_(c.stateNode,c.type,c.memoizedProps,h,c)||Ee(c)}function rt(c){for(Da=c.return;Da;)switch(Da.tag){case 3:case 27:jr=!0;return;case 5:case 13:jr=!1;return;default:Da=Da.return}}function st(c){if(!Ga||c!==Da)return!1;if(!Fn)return rt(c),Fn=!0,!1;var h=!1;if(va?c.tag!==3&&c.tag!==27&&(c.tag!==5||o0(c.type)&&!nl(c.type,c.memoizedProps))&&(h=!0):c.tag!==3&&(c.tag!==5||o0(c.type)&&!nl(c.type,c.memoizedProps))&&(h=!0),h&&_a&&Ee(c),rt(c),c.tag===13){if(!Ga)throw Error(i(316));if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(i(317));_a=r0(c)}else _a=Da?Xp(c.stateNode):null;return!0}function et(){Ga&&(_a=Da=null,Fn=!1)}function se(c){br===null?br=[c]:br.push(c)}function Ie(){for(var c=al,h=ku=al=0;h<c;){var y=Er[h];Er[h++]=null;var M=Er[h];Er[h++]=null;var C=Er[h];Er[h++]=null;var L=Er[h];if(Er[h++]=null,M!==null&&C!==null){var J=M.pending;J===null?C.next=C:(C.next=J.next,J.next=C),M.pending=C}L!==0&&ze(y,C,L)}}function Oe(c,h,y,M){Er[al++]=c,Er[al++]=h,Er[al++]=y,Er[al++]=M,ku|=M,c.lanes|=M,c=c.alternate,c!==null&&(c.lanes|=M)}function Ue(c,h,y,M){return Oe(c,h,y,M),Pe(c)}function Le(c,h){return Oe(c,null,null,h),Pe(c)}function ze(c,h,y){c.lanes|=y;var M=c.alternate;M!==null&&(M.lanes|=y);for(var C=!1,L=c.return;L!==null;)L.childLanes|=y,M=L.alternate,M!==null&&(M.childLanes|=y),L.tag===22&&(c=L.stateNode,c===null||c._visibility&1||(C=!0)),c=L,L=L.return;C&&h!==null&&c.tag===3&&(L=c.stateNode,C=31-Ja(y),L=L.hiddenUpdates,c=L[C],c===null?L[C]=[h]:c.push(h),h.lane=y|536870912)}function Pe(c){if(50<nu)throw nu=0,Xa=null,Error(i(185));for(var h=c.return;h!==null;)c=h,h=c.return;return c.tag===3?c.stateNode:null}function Fe(c){c!==Zl&&c.next===null&&(Zl===null?Xu=Zl=c:Zl=Zl.next=c),nf=!0,tf||(tf=!0,Be(yt))}function Ne(c,h){if(!vs&&nf){vs=!0;do for(var y=!1,M=Xu;M!==null;){if(c!==0){var C=M.pendingLanes;if(C===0)var L=0;else{var J=M.suspendedLanes,xe=M.pingedLanes;L=(1<<31-Ja(42|c)+1)-1,L&=C&~(J&~xe),L=L&201326677?L&201326677|1:L?L|2:0}L!==0&&(y=!0,ve(M,L))}else L=Mn,L=I(M,M===Tn?L:0),(L&3)===0||O(M,L)||(y=!0,ve(M,L));M=M.next}while(y);vs=!1}}function yt(){nf=tf=!1;var c=0;rl!==0&&(il()&&(c=rl),rl=0);for(var h=ya(),y=null,M=Xu;M!==null;){var C=M.next,L=j(M,h);L===0?(M.next=null,y===null?Xu=C:y.next=C,C===null&&(Zl=y)):(y=M,(c!==0||(L&3)!==0)&&(nf=!0)),M=C}Ne(c)}function j(c,h){for(var y=c.suspendedLanes,M=c.pingedLanes,C=c.expirationTimes,L=c.pendingLanes&-62914561;0<L;){var J=31-Ja(L),xe=1<<J,we=C[J];we===-1?((xe&y)===0||(xe&M)!==0)&&(C[J]=P(xe,h)):we<=h&&(c.expiredLanes|=xe),L&=~xe}if(h=Tn,y=Mn,y=I(c,c===h?y:0),M=c.callbackNode,y===0||c===h&&oi===2||c.cancelPendingCommit!==null)return M!==null&&M!==null&&Kc(M),c.callbackNode=null,c.callbackPriority=0;if((y&3)===0||O(c,y)){if(h=y&-y,h===c.callbackPriority)return h;switch(M!==null&&Kc(M),ae(y)){case 2:case 8:y=m0;break;case 32:y=Nh;break;case 268435456:y=Oh;break;default:y=Nh}return M=V.bind(null,c),y=Hu(y,M),c.callbackPriority=h,c.callbackNode=y,h}return M!==null&&M!==null&&Kc(M),c.callbackPriority=2,c.callbackNode=null,2}function V(c,h){var y=c.callbackNode;if(ra()&&c.callbackNode!==y)return null;var M=Mn;return M=I(c,c===Tn?M:0),M===0?null:(Oc(c,M,h),j(c,ya()),c.callbackNode!=null&&c.callbackNode===y?V.bind(null,c):null)}function ve(c,h){if(ra())return null;Oc(c,h,!0)}function Be(c){Yi?Sh(function(){(jt&6)!==0?Hu(nm,c):c()}):Hu(nm,c)}function De(){return rl===0&&(rl=B()),rl}function Ae(c,h){if(af===null){var y=af=[];zh=0,er=De(),sl={status:"pending",value:void 0,then:function(M){y.push(M)}}}return zh++,h.then(gt,gt),h}function gt(){if(--zh===0&&af!==null){sl!==null&&(sl.status="fulfilled");var c=af;af=null,er=0,sl=null;for(var h=0;h<c.length;h++)(0,c[h])()}}function ct(c,h){var y=[],M={status:"pending",value:null,reason:null,then:function(C){y.push(C)}};return c.then(function(){M.status="fulfilled",M.value=h;for(var C=0;C<y.length;C++)(0,y[C])(h)},function(C){for(M.status="rejected",M.reason=C,C=0;C<y.length;C++)(0,y[C])(void 0)}),M}function _t(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bt(c,h){c=c.updateQueue,h.updateQueue===c&&(h.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,callbacks:null})}function ke(c){return{lane:c,tag:0,payload:null,callback:null,next:null}}function Xe(c,h,y){var M=c.updateQueue;if(M===null)return null;if(M=M.shared,(jt&2)!==0){var C=M.pending;return C===null?h.next=h:(h.next=C.next,C.next=h),M.pending=h,h=Pe(c),ze(c,null,y),h}return Oe(c,M,h,y),Pe(c)}function lt(c,h,y){if(h=h.updateQueue,h!==null&&(h=h.shared,(y&4194176)!==0)){var M=h.lanes;M&=c.pendingLanes,y|=M,h.lanes=y,Z(c,y)}}function le(c,h){var y=c.updateQueue,M=c.alternate;if(M!==null&&(M=M.updateQueue,y===M)){var C=null,L=null;if(y=y.firstBaseUpdate,y!==null){do{var J={lane:y.lane,tag:y.tag,payload:y.payload,callback:null,next:null};L===null?C=L=J:L=L.next=J,y=y.next}while(y!==null);L===null?C=L=h:L=L.next=h}else C=L=h;y={baseState:M.baseState,firstBaseUpdate:C,lastBaseUpdate:L,shared:M.shared,callbacks:M.callbacks},c.updateQueue=y;return}c=y.lastBaseUpdate,c===null?y.firstBaseUpdate=h:c.next=h,y.lastBaseUpdate=h}function Te(){if(Yu){var c=sl;if(c!==null)throw c}}function ut(c,h,y,M){Yu=!1;var C=c.updateQueue;vo=!1;var L=C.firstBaseUpdate,J=C.lastBaseUpdate,xe=C.shared.pending;if(xe!==null){C.shared.pending=null;var we=xe,pt=we.next;we.next=null,J===null?L=pt:J.next=pt,J=we;var Rt=c.alternate;Rt!==null&&(Rt=Rt.updateQueue,xe=Rt.lastBaseUpdate,xe!==J&&(xe===null?Rt.firstBaseUpdate=pt:xe.next=pt,Rt.lastBaseUpdate=we))}if(L!==null){var zt=C.baseState;J=0,Rt=pt=we=null,xe=L;do{var Bt=xe.lane&-536870913,ln=Bt!==xe.lane;if(ln?(Mn&Bt)===Bt:(M&Bt)===Bt){Bt!==0&&Bt===er&&(Yu=!0),Rt!==null&&(Rt=Rt.next={lane:0,tag:xe.tag,payload:xe.payload,callback:null,next:null});e:{var ar=c,lf=xe;Bt=h;var iu=y;switch(lf.tag){case 1:if(ar=lf.payload,typeof ar=="function"){zt=ar.call(iu,zt,Bt);break e}zt=ar;break e;case 3:ar.flags=ar.flags&-65537|128;case 0:if(ar=lf.payload,Bt=typeof ar=="function"?ar.call(iu,zt,Bt):ar,Bt==null)break e;zt=kl({},zt,Bt);break e;case 2:vo=!0}}Bt=xe.callback,Bt!==null&&(c.flags|=64,ln&&(c.flags|=8192),ln=C.callbacks,ln===null?C.callbacks=[Bt]:ln.push(Bt))}else ln={lane:Bt,tag:xe.tag,payload:xe.payload,callback:xe.callback,next:null},Rt===null?(pt=Rt=ln,we=zt):Rt=Rt.next=ln,J|=Bt;if(xe=xe.next,xe===null){if(xe=C.shared.pending,xe===null)break;ln=xe,xe=ln.next,ln.next=null,C.lastBaseUpdate=ln,C.shared.pending=null}}while(!0);Rt===null&&(we=zt),C.baseState=we,C.firstBaseUpdate=pt,C.lastBaseUpdate=Rt,L===null&&(C.shared.lanes=0),Cr|=J,c.lanes=J,c.memoizedState=zt}}function pe(c,h){if(typeof c!="function")throw Error(i(191,c));c.call(h)}function _e(c,h){var y=c.callbacks;if(y!==null)for(c.callbacks=null,c=0;c<y.length;c++)pe(y[c],h)}function at(c,h){if(xr(c,h))return!0;if(typeof c!="object"||c===null||typeof h!="object"||h===null)return!1;var y=Object.keys(c),M=Object.keys(h);if(y.length!==M.length)return!1;for(M=0;M<y.length;M++){var C=y[M];if(!rf.call(h,C)||!xr(c[C],h[C]))return!1}return!0}function Tt(c){return c=c.status,c==="fulfilled"||c==="rejected"}function it(){}function Ge(c,h,y){switch(y=c[y],y===void 0?c.push(h):y!==h&&(h.then(it,it),h=y),h.status){case"fulfilled":return h.value;case"rejected":throw c=h.reason,c===ni?Error(i(483)):c;default:if(typeof h.status=="string")h.then(it,it);else{if(c=Tn,c!==null&&100<c.shellSuspendCounter)throw Error(i(482));c=h,c.status="pending",c.then(function(M){if(h.status==="pending"){var C=h;C.status="fulfilled",C.value=M}},function(M){if(h.status==="pending"){var C=h;C.status="rejected",C.reason=M}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw c=h.reason,c===ni?Error(i(483)):c}throw Kl=h,ni}}function xt(){if(Kl===null)throw Error(i(459));var c=Kl;return Kl=null,c}function wt(c){var h=Zr;return Zr+=1,Hs===null&&(Hs=[]),Ge(Hs,c,h)}function Ut(c,h){h=h.props.ref,c.ref=h!==void 0?h:null}function Pt(c,h){throw h.$$typeof===Mp?Error(i(525)):(c=Object.prototype.toString.call(h),Error(i(31,c==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":c)))}function yn(c){var h=c._init;return h(c._payload)}function An(c){function h(je,Re){if(c){var Ke=je.deletions;Ke===null?(je.deletions=[Re],je.flags|=16):Ke.push(Re)}}function y(je,Re){if(!c)return null;for(;Re!==null;)h(je,Re),Re=Re.sibling;return null}function M(je){for(var Re=new Map;je!==null;)je.key!==null?Re.set(je.key,je):Re.set(je.index,je),je=je.sibling;return Re}function C(je,Re){return je=wa(je,Re),je.index=0,je.sibling=null,je}function L(je,Re,Ke){return je.index=Ke,c?(Ke=je.alternate,Ke!==null?(Ke=Ke.index,Ke<Re?(je.flags|=33554434,Re):Ke):(je.flags|=33554434,Re)):(je.flags|=1048576,Re)}function J(je){return c&&je.alternate===null&&(je.flags|=33554434),je}function xe(je,Re,Ke,Et){return Re===null||Re.tag!==6?(Re=Ko(Ke,je.mode,Et),Re.return=je,Re):(Re=C(Re,Ke),Re.return=je,Re)}function we(je,Re,Ke,Et){var qt=Ke.type;return qt===Lu?Rt(je,Re,Ke.props.children,Et,Ke.key):Re!==null&&(Re.elementType===qt||typeof qt=="object"&&qt!==null&&qt.$$typeof===ps&&yn(qt)===Re.type)?(Re=C(Re,Ke.props),Ut(Re,Ke),Re.return=je,Re):(Re=Yr(Ke.type,Ke.key,Ke.props,null,je.mode,Et),Ut(Re,Ke),Re.return=je,Re)}function pt(je,Re,Ke,Et){return Re===null||Re.tag!==4||Re.stateNode.containerInfo!==Ke.containerInfo||Re.stateNode.implementation!==Ke.implementation?(Re=Ou(Ke,je.mode,Et),Re.return=je,Re):(Re=C(Re,Ke.children||[]),Re.return=je,Re)}function Rt(je,Re,Ke,Et,qt){return Re===null||Re.tag!==7?(Re=co(Ke,je.mode,Et,qt),Re.return=je,Re):(Re=C(Re,Ke),Re.return=je,Re)}function zt(je,Re,Ke){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return Re=Ko(""+Re,je.mode,Ke),Re.return=je,Re;if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case fo:return Ke=Yr(Re.type,Re.key,Re.props,null,je.mode,Ke),Ut(Ke,Re),Ke.return=je,Ke;case ds:return Re=Ou(Re,je.mode,Ke),Re.return=je,Re;case ps:var Et=Re._init;return Re=Et(Re._payload),zt(je,Re,Ke)}if(el(Re)||a(Re))return Re=co(Re,je.mode,Ke,null),Re.return=je,Re;if(typeof Re.then=="function")return zt(je,wt(Re),Ke);if(Re.$$typeof===Ls)return zt(je,Cc(je,Re),Ke);Pt(je,Re)}return null}function Bt(je,Re,Ke,Et){var qt=Re!==null?Re.key:null;if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number"||typeof Ke=="bigint")return qt!==null?null:xe(je,Re,""+Ke,Et);if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case fo:return Ke.key===qt?we(je,Re,Ke,Et):null;case ds:return Ke.key===qt?pt(je,Re,Ke,Et):null;case ps:return qt=Ke._init,Ke=qt(Ke._payload),Bt(je,Re,Ke,Et)}if(el(Ke)||a(Ke))return qt!==null?null:Rt(je,Re,Ke,Et,null);if(typeof Ke.then=="function")return Bt(je,Re,wt(Ke),Et);if(Ke.$$typeof===Ls)return Bt(je,Re,Cc(je,Ke),Et);Pt(je,Ke)}return null}function ln(je,Re,Ke,Et,qt){if(typeof Et=="string"&&Et!==""||typeof Et=="number"||typeof Et=="bigint")return je=je.get(Ke)||null,xe(Re,je,""+Et,qt);if(typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case fo:return je=je.get(Et.key===null?Ke:Et.key)||null,we(Re,je,Et,qt);case ds:return je=je.get(Et.key===null?Ke:Et.key)||null,pt(Re,je,Et,qt);case ps:var hi=Et._init;return Et=hi(Et._payload),ln(je,Re,Ke,Et,qt)}if(el(Et)||a(Et))return je=je.get(Ke)||null,Rt(Re,je,Et,qt,null);if(typeof Et.then=="function")return ln(je,Re,Ke,wt(Et),qt);if(Et.$$typeof===Ls)return ln(je,Re,Ke,Cc(Re,Et),qt);Pt(Re,Et)}return null}function ar(je,Re,Ke,Et){for(var qt=null,hi=null,an=Re,Gn=Re=0,$i=null;an!==null&&Gn<Ke.length;Gn++){an.index>Gn?($i=an,an=null):$i=an.sibling;var Vn=Bt(je,an,Ke[Gn],Et);if(Vn===null){an===null&&(an=$i);break}c&&an&&Vn.alternate===null&&h(je,an),Re=L(Vn,Re,Gn),hi===null?qt=Vn:hi.sibling=Vn,hi=Vn,an=$i}if(Gn===Ke.length)return y(je,an),Fn&&ce(je,Gn),qt;if(an===null){for(;Gn<Ke.length;Gn++)an=zt(je,Ke[Gn],Et),an!==null&&(Re=L(an,Re,Gn),hi===null?qt=an:hi.sibling=an,hi=an);return Fn&&ce(je,Gn),qt}for(an=M(an);Gn<Ke.length;Gn++)$i=ln(an,je,Gn,Ke[Gn],Et),$i!==null&&(c&&$i.alternate!==null&&an.delete($i.key===null?Gn:$i.key),Re=L($i,Re,Gn),hi===null?qt=$i:hi.sibling=$i,hi=$i);return c&&an.forEach(function(Eo){return h(je,Eo)}),Fn&&ce(je,Gn),qt}function lf(je,Re,Ke,Et){if(Ke==null)throw Error(i(151));for(var qt=null,hi=null,an=Re,Gn=Re=0,$i=null,Vn=Ke.next();an!==null&&!Vn.done;Gn++,Vn=Ke.next()){an.index>Gn?($i=an,an=null):$i=an.sibling;var Eo=Bt(je,an,Vn.value,Et);if(Eo===null){an===null&&(an=$i);break}c&&an&&Eo.alternate===null&&h(je,an),Re=L(Eo,Re,Gn),hi===null?qt=Eo:hi.sibling=Eo,hi=Eo,an=$i}if(Vn.done)return y(je,an),Fn&&ce(je,Gn),qt;if(an===null){for(;!Vn.done;Gn++,Vn=Ke.next())Vn=zt(je,Vn.value,Et),Vn!==null&&(Re=L(Vn,Re,Gn),hi===null?qt=Vn:hi.sibling=Vn,hi=Vn);return Fn&&ce(je,Gn),qt}for(an=M(an);!Vn.done;Gn++,Vn=Ke.next())Vn=ln(an,je,Gn,Vn.value,Et),Vn!==null&&(c&&Vn.alternate!==null&&an.delete(Vn.key===null?Gn:Vn.key),Re=L(Vn,Re,Gn),hi===null?qt=Vn:hi.sibling=Vn,hi=Vn);return c&&an.forEach(function(Xh){return h(je,Xh)}),Fn&&ce(je,Gn),qt}function iu(je,Re,Ke,Et){if(typeof Ke=="object"&&Ke!==null&&Ke.type===Lu&&Ke.key===null&&(Ke=Ke.props.children),typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case fo:e:{for(var qt=Ke.key;Re!==null;){if(Re.key===qt){if(qt=Ke.type,qt===Lu){if(Re.tag===7){y(je,Re.sibling),Et=C(Re,Ke.props.children),Et.return=je,je=Et;break e}}else if(Re.elementType===qt||typeof qt=="object"&&qt!==null&&qt.$$typeof===ps&&yn(qt)===Re.type){y(je,Re.sibling),Et=C(Re,Ke.props),Ut(Et,Ke),Et.return=je,je=Et;break e}y(je,Re);break}else h(je,Re);Re=Re.sibling}Ke.type===Lu?(Et=co(Ke.props.children,je.mode,Et,Ke.key),Et.return=je,je=Et):(Et=Yr(Ke.type,Ke.key,Ke.props,null,je.mode,Et),Ut(Et,Ke),Et.return=je,je=Et)}return J(je);case ds:e:{for(qt=Ke.key;Re!==null;){if(Re.key===qt)if(Re.tag===4&&Re.stateNode.containerInfo===Ke.containerInfo&&Re.stateNode.implementation===Ke.implementation){y(je,Re.sibling),Et=C(Re,Ke.children||[]),Et.return=je,je=Et;break e}else{y(je,Re);break}else h(je,Re);Re=Re.sibling}Et=Ou(Ke,je.mode,Et),Et.return=je,je=Et}return J(je);case ps:return qt=Ke._init,Ke=qt(Ke._payload),iu(je,Re,Ke,Et)}if(el(Ke))return ar(je,Re,Ke,Et);if(a(Ke)){if(qt=a(Ke),typeof qt!="function")throw Error(i(150));return Ke=qt.call(Ke),lf(je,Re,Ke,Et)}if(typeof Ke.then=="function")return iu(je,Re,wt(Ke),Et);if(Ke.$$typeof===Ls)return iu(je,Re,Cc(je,Ke),Et);Pt(je,Ke)}return typeof Ke=="string"&&Ke!==""||typeof Ke=="number"||typeof Ke=="bigint"?(Ke=""+Ke,Re!==null&&Re.tag===6?(y(je,Re.sibling),Et=C(Re,Ke),Et.return=je,je=Et):(y(je,Re),Et=Ko(Ke,je.mode,Et),Et.return=je,je=Et),J(je)):y(je,Re)}return function(je,Re,Ke,Et){try{Zr=0;var qt=iu(je,Re,Ke,Et);return Hs=null,qt}catch(an){if(an===ni)throw an;var hi=t(29,an,null,je.mode);return hi.lanes=Et,hi.return=je,hi}}}function ai(c,h){c=ys,w(Tr,c),w(Gs,h),ys=c|h.baseLanes}function ci(){w(Tr,ys),w(Gs,Gs.current)}function Ti(){ys=Tr.current,E(Gs),E(Tr)}function mi(c){var h=c.alternate;w(qi,qi.current&1),w(Ar,c),Kr===null&&(h===null||Gs.current!==null||h.memoizedState!==null)&&(Kr=c)}function Ai(c){if(c.tag===22){if(w(qi,qi.current),w(Ar,c),Kr===null){var h=c.alternate;h!==null&&h.memoizedState!==null&&(Kr=c)}}else ri()}function ri(){w(qi,qi.current),w(Ar,Ar.current)}function Xt(c){E(Ar),Kr===c&&(Kr=null),E(qi)}function Un(c){for(var h=c;h!==null;){if(h.tag===13){var y=h.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||Ah(y)||qc(y)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function Jt(){throw Error(i(321))}function k(c,h){if(h===null)return!1;for(var y=0;y<h.length&&y<c.length;y++)if(!xr(c[y],h[y]))return!1;return!0}function $(c,h,y,M,C,L){return Vs=L,mn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Kt.H=c===null||c.memoizedState===null?Wi:Na,yo=!1,L=y(M,C),yo=!1,xi&&(L=qe(h,y,M,C)),Me(c),L}function Me(c){Kt.H=Hn;var h=jn!==null&&jn.next!==null;if(Vs=0,Bi=jn=mn=null,Qr=!1,Di=0,qu=null,h)throw Error(i(300));c===null||Pi||(c=c.dependencies,c!==null&&Fo(c)&&(Pi=!0))}function qe(c,h,y,M){mn=c;var C=0;do{if(xi&&(qu=null),Di=0,xi=!1,25<=C)throw Error(i(301));if(C+=1,Bi=jn=null,c.updateQueue!=null){var L=c.updateQueue;L.lastEffect=null,L.events=null,L.stores=null,L.memoCache!=null&&(L.memoCache.index=0)}Kt.H=ll,L=h(y,M)}while(xi);return L}function tt(){var c=Kt.H,h=c.useState()[0];return h=typeof h.then=="function"?ye(h):h,c=c.useState()[0],(jn!==null?jn.memoizedState:null)!==c&&(mn.flags|=1024),h}function $e(){var c=sf!==0;return sf=0,c}function Mt(c,h,y){h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~y}function X(c){if(Qr){for(c=c.memoizedState;c!==null;){var h=c.queue;h!==null&&(h.pending=null),c=c.next}Qr=!1}Vs=0,Bi=jn=mn=null,xi=!1,Di=sf=0,qu=null}function ue(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bi===null?mn.memoizedState=Bi=c:Bi=Bi.next=c,Bi}function me(){if(jn===null){var c=mn.alternate;c=c!==null?c.memoizedState:null}else c=jn.next;var h=Bi===null?mn.memoizedState:Bi.next;if(h!==null)Bi=h,jn=c;else{if(c===null)throw mn.alternate===null?Error(i(467)):Error(i(310));jn=c,c={memoizedState:jn.memoizedState,baseState:jn.baseState,baseQueue:jn.baseQueue,queue:jn.queue,next:null},Bi===null?mn.memoizedState=Bi=c:Bi=Bi.next=c}return Bi}function ye(c){var h=Di;return Di+=1,qu===null&&(qu=[]),c=Ge(qu,c,h),h=mn,(Bi===null?h.memoizedState:Bi.next)===null&&(h=h.alternate,Kt.H=h===null||h.memoizedState===null?Wi:Na),c}function te(c){if(c!==null&&typeof c=="object"){if(typeof c.then=="function")return ye(c);if(c.$$typeof===Ls)return pa(c)}throw Error(i(438,String(c)))}function Je(c){var h=null,y=mn.updateQueue;if(y!==null&&(h=y.memoCache),h==null){var M=mn.alternate;M!==null&&(M=M.updateQueue,M!==null&&(M=M.memoCache,M!=null&&(h={data:M.data.map(function(C){return C.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),y===null&&(y=Bh(),mn.updateQueue=y),y.memoCache=h,y=h.data[h.index],y===void 0)for(y=h.data[h.index]=Array(c),M=0;M<c;M++)y[M]=Xg;return h.index++,y}function Qe(c,h){return typeof h=="function"?h(c):h}function ot(c){var h=me();return dt(h,jn,c)}function dt(c,h,y){var M=c.queue;if(M===null)throw Error(i(311));M.lastRenderedReducer=y;var C=c.baseQueue,L=M.pending;if(L!==null){if(C!==null){var J=C.next;C.next=L.next,L.next=J}h.baseQueue=C=L,M.pending=null}if(L=c.baseState,C===null)c.memoizedState=L;else{h=C.next;var xe=J=null,we=null,pt=h,Rt=!1;do{var zt=pt.lane&-536870913;if(zt!==pt.lane?(Mn&zt)===zt:(Vs&zt)===zt){var Bt=pt.revertLane;if(Bt===0)we!==null&&(we=we.next={lane:0,revertLane:0,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null}),zt===er&&(Rt=!0);else if((Vs&Bt)===Bt){pt=pt.next,Bt===er&&(Rt=!0);continue}else zt={lane:0,revertLane:pt.revertLane,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null},we===null?(xe=we=zt,J=L):we=we.next=zt,mn.lanes|=Bt,Cr|=Bt;zt=pt.action,yo&&y(L,zt),L=pt.hasEagerState?pt.eagerState:y(L,zt)}else Bt={lane:zt,revertLane:pt.revertLane,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null},we===null?(xe=we=Bt,J=L):we=we.next=Bt,mn.lanes|=zt,Cr|=zt;pt=pt.next}while(pt!==null&&pt!==h);if(we===null?J=L:we.next=xe,!xr(L,c.memoizedState)&&(Pi=!0,Rt&&(y=sl,y!==null)))throw y;c.memoizedState=L,c.baseState=J,c.baseQueue=we,M.lastRenderedState=L}return C===null&&(M.lanes=0),[c.memoizedState,M.dispatch]}function St(c){var h=me(),y=h.queue;if(y===null)throw Error(i(311));y.lastRenderedReducer=c;var M=y.dispatch,C=y.pending,L=h.memoizedState;if(C!==null){y.pending=null;var J=C=C.next;do L=c(L,J.action),J=J.next;while(J!==C);xr(L,h.memoizedState)||(Pi=!0),h.memoizedState=L,h.baseQueue===null&&(h.baseState=L),y.lastRenderedState=L}return[L,M]}function Dt(c,h,y){var M=mn,C=me(),L=Fn;if(L){if(y===void 0)throw Error(i(407));y=y()}else y=h();var J=!xr((jn||C).memoizedState,y);if(J&&(C.memoizedState=y,Pi=!0),C=C.queue,as($t.bind(null,M,C,c),[c]),C.getSnapshot!==h||J||Bi!==null&&Bi.memoizedState.tag&1){if(M.flags|=2048,ki(9,Ht.bind(null,M,C,y,h),{destroy:void 0},null),Tn===null)throw Error(i(349));L||(Vs&60)!==0||At(M,h,y)}return y}function At(c,h,y){c.flags|=16384,c={getSnapshot:h,value:y},h=mn.updateQueue,h===null?(h=Bh(),mn.updateQueue=h,h.stores=[c]):(y=h.stores,y===null?h.stores=[c]:y.push(c))}function Ht(c,h,y,M){h.value=y,h.getSnapshot=M,kt(h)&&sn(c)}function $t(c,h,y){return y(function(){kt(h)&&sn(c)})}function kt(c){var h=c.getSnapshot;c=c.value;try{var y=h();return!xr(c,y)}catch{return!0}}function sn(c){var h=Le(c,2);h!==null&&Ca(h,c,2)}function Ft(c){var h=ue();if(typeof c=="function"){var y=c;if(c=y(),yo){ee(!0);try{y()}finally{ee(!1)}}}return h.memoizedState=h.baseState=c,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qe,lastRenderedState:c},h}function Ct(c,h,y,M){return c.baseState=y,dt(c,jn,typeof M=="function"?M:Qe)}function cn(c,h,y,M,C){if(As(c))throw Error(i(485));if(c=h.action,c!==null){var L={payload:C,action:c,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(J){L.listeners.push(J)}};Kt.T!==null?y(!0):L.isTransition=!1,M(L),y=h.pending,y===null?(L.next=h.pending=L,on(h,L)):(L.next=y.next,h.pending=y.next=L)}}function on(c,h){var y=h.action,M=h.payload,C=c.state;if(h.isTransition){var L=Kt.T,J={};Kt.T=J;try{var xe=y(C,M),we=Kt.S;we!==null&&we(J,xe),En(c,h,xe)}catch(pt){pn(c,h,pt)}finally{Kt.T=L}}else try{L=y(C,M),En(c,h,L)}catch(pt){pn(c,h,pt)}}function En(c,h,y){y!==null&&typeof y=="object"&&typeof y.then=="function"?y.then(function(M){fn(c,h,M)},function(M){return pn(c,h,M)}):fn(c,h,y)}function fn(c,h,y){h.status="fulfilled",h.value=y,Rn(h),c.state=y,h=c.pending,h!==null&&(y=h.next,y===h?c.pending=null:(y=y.next,h.next=y,on(c,y)))}function pn(c,h,y){var M=c.pending;if(c.pending=null,M!==null){M=M.next;do h.status="rejected",h.reason=y,Rn(h),h=h.next;while(h!==M)}c.action=null}function Rn(c){c=c.listeners;for(var h=0;h<c.length;h++)(0,c[h])()}function Ot(c,h){return h}function Yn(c,h){if(Fn){var y=Tn.formState;if(y!==null){e:{var M=mn;if(Fn){if(_a){var C=Qg(_a,jr);if(C){_a=Xp(C),M=Jg(C);break e}}Ee(M)}M=!1}M&&(h=y[0])}}y=ue(),y.memoizedState=y.baseState=h,M={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ot,lastRenderedState:h},y.queue=M,y=Ul.bind(null,mn,M),M.dispatch=y,M=Ft(!1);var L=Dl.bind(null,mn,!1,M.queue);return M=ue(),C={state:h,dispatch:null,action:c,pending:null},M.queue=C,y=cn.bind(null,mn,C,L,y),C.dispatch=y,M.memoizedState=c,[h,y,!1]}function ti(c){var h=me();return _n(h,jn,c)}function _n(c,h,y){h=dt(c,h,Ot)[0],c=ot(Qe)[0],h=typeof h=="object"&&h!==null&&typeof h.then=="function"?ye(h):h;var M=me(),C=M.queue,L=C.dispatch;return y!==M.memoizedState&&(mn.flags|=2048,ki(9,Pn.bind(null,C,y),{destroy:void 0},null)),[h,L,c]}function Pn(c,h){c.action=h}function Hr(c){var h=me(),y=jn;if(y!==null)return _n(h,y,c);me(),h=h.memoizedState,y=me();var M=y.queue.dispatch;return y.memoizedState=c,[h,M,!1]}function ki(c,h,y,M){return c={tag:c,create:h,inst:y,deps:M,next:null},h=mn.updateQueue,h===null&&(h=Bh(),mn.updateQueue=h),y=h.lastEffect,y===null?h.lastEffect=c.next=c:(M=y.next,y.next=c,c.next=M,h.lastEffect=c),c}function is(){return me().memoizedState}function El(c,h,y,M){var C=ue();mn.flags|=c,C.memoizedState=ki(1|h,y,{destroy:void 0},M===void 0?null:M)}function Io(c,h,y,M){var C=me();M=M===void 0?null:M;var L=C.memoizedState.inst;jn!==null&&M!==null&&k(M,jn.memoizedState.deps)?C.memoizedState=ki(h,y,L,M):(mn.flags|=c,C.memoizedState=ki(1|h,y,L,M))}function Tl(c,h){El(8390656,8,c,h)}function as(c,h){Io(2048,8,c,h)}function Ec(c,h){return Io(4,2,c,h)}function Al(c,h){return Io(4,4,c,h)}function Gr(c,h){if(typeof h=="function"){c=c();var y=h(c);return function(){typeof y=="function"?y():h(null)}}if(h!=null)return c=c(),h.current=c,function(){h.current=null}}function ha(c,h,y){y=y!=null?y.concat([c]):null,Io(4,4,Gr.bind(null,h,c),y)}function rs(){}function Rl(c,h){var y=me();h=h===void 0?null:h;var M=y.memoizedState;return h!==null&&k(h,M[1])?M[0]:(y.memoizedState=[c,h],c)}function hr(c,h){var y=me();h=h===void 0?null:h;var M=y.memoizedState;if(h!==null&&k(h,M[1]))return M[0];if(M=c(),yo){ee(!0);try{c()}finally{ee(!1)}}return y.memoizedState=[M,h],M}function Vr(c,h,y){return y===void 0||(Vs&1073741824)!==0?c.memoizedState=h:(c.memoizedState=y,c=Us(),mn.lanes|=c,Cr|=c,y)}function Cl(c,h,y,M){return xr(y,h)?y:Gs.current!==null?(c=Vr(c,y,M),xr(c,h)||(Pi=!0),c):(Vs&42)===0?(Pi=!0,c.memoizedState=y):(c=Us(),mn.lanes|=c,Cr|=c,h)}function wl(c,h,y,M,C){var L=Qi();Ua(L!==0&&8>L?L:8);var J=Kt.T,xe={};Kt.T=xe,Dl(c,!1,h,y);try{var we=C(),pt=Kt.S;if(pt!==null&&pt(xe,we),we!==null&&typeof we=="object"&&typeof we.then=="function"){var Rt=ct(we,M);kr(c,h,Rt,Ha(c))}else kr(c,h,M,Ha(c))}catch(zt){kr(c,h,{then:function(){},status:"rejected",reason:zt},Ha())}finally{Ua(L),Kt.T=J}}function Bo(c){var h=c.memoizedState;if(h!==null)return h;h={memoizedState:Qa,baseState:Qa,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qe,lastRenderedState:Qa},next:null};var y={};return h.next={memoizedState:y,baseState:y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qe,lastRenderedState:y},next:null},c.memoizedState=h,c=c.alternate,c!==null&&(c.memoizedState=h),h}function ss(){return pa(nn)}function dr(){return me().memoizedState}function Aa(){return me().memoizedState}function $s(c){for(var h=c.return;h!==null;){switch(h.tag){case 24:case 3:var y=Ha();c=ke(y);var M=Xe(h,c,y);M!==null&&(Ca(M,h,y),lt(M,h,y)),h={cache:eh()},c.payload=h;return}h=h.return}}function os(c,h,y){var M=Ha();y={lane:M,revertLane:0,action:y,hasEagerState:!1,eagerState:null,next:null},As(c)?ls(h,y):(y=Ue(c,h,y,M),y!==null&&(Ca(y,c,M),eo(y,h,M)))}function Ul(c,h,y){var M=Ha();kr(c,h,y,M)}function kr(c,h,y,M){var C={lane:M,revertLane:0,action:y,hasEagerState:!1,eagerState:null,next:null};if(As(c))ls(h,C);else{var L=c.alternate;if(c.lanes===0&&(L===null||L.lanes===0)&&(L=h.lastRenderedReducer,L!==null))try{var J=h.lastRenderedState,xe=L(J,y);if(C.hasEagerState=!0,C.eagerState=xe,xr(xe,J))return Oe(c,h,C,0),Tn===null&&Ie(),!1}catch{}if(y=Ue(c,h,C,M),y!==null)return Ca(y,c,M),eo(y,h,M),!0}return!1}function Dl(c,h,y,M){if(M={lane:2,revertLane:De(),action:M,hasEagerState:!1,eagerState:null,next:null},As(c)){if(h)throw Error(i(479))}else h=Ue(c,y,M,2),h!==null&&Ca(h,c,2)}function As(c){var h=c.alternate;return c===mn||h!==null&&h===mn}function ls(c,h){xi=Qr=!0;var y=c.pending;y===null?h.next=h:(h.next=y.next,y.next=h),c.pending=h}function eo(c,h,y){if((y&4194176)!==0){var M=h.lanes;M&=c.pendingLanes,y|=M,h.lanes=y,Z(c,y)}}function gi(c,h,y,M){h=c.memoizedState,y=y(M,h),y=y==null?h:kl({},h,y),c.memoizedState=y,c.lanes===0&&(c.updateQueue.baseState=y)}function us(c,h,y,M,C,L,J){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(M,L,J):h.prototype&&h.prototype.isPureReactComponent?!at(y,M)||!at(C,L):!0}function to(c,h,y,M){c=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(y,M),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(y,M),h.state!==c&&Ph.enqueueReplaceState(h,h.state,null)}function Ba(c,h){var y=h;if("ref"in h){y={};for(var M in h)M!=="ref"&&(y[M]=h[M])}if(c=c.defaultProps){y===h&&(y=kl({},y));for(var C in c)y[C]===void 0&&(y[C]=c[C])}return y}function Rs(c,h){try{var y=c.onUncaughtError;y(h.value,{componentStack:h.stack})}catch(M){setTimeout(function(){throw M})}}function Nl(c,h,y){try{var M=c.onCaughtError;M(y.value,{componentStack:y.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function cs(c,h,y){return y=ke(y),y.tag=3,y.payload={element:null},y.callback=function(){Rs(c,h)},y}function Cs(c){return c=ke(c),c.tag=3,c}function Ki(c,h,y,M){var C=y.type.getDerivedStateFromError;if(typeof C=="function"){var L=M.value;c.payload=function(){return C(L)},c.callback=function(){Nl(h,y,M)}}var J=y.stateNode;J!==null&&typeof J.componentDidCatch=="function"&&(c.callback=function(){Nl(h,y,M),typeof C!="function"&&(Ur===null?Ur=new Set([this]):Ur.add(this));var xe=M.stack;this.componentDidCatch(M.value,{componentStack:xe!==null?xe:""})})}function Jf(c,h,y,M,C){if(y.flags|=32768,M!==null&&typeof M=="object"&&typeof M.then=="function"){if(h=y.alternate,h!==null&&Ll(h,y,C,!0),y=Ar.current,y!==null){switch(y.tag){case 13:return Kr===null?Ka():y.alternate===null&&In===0&&(In=3),y.flags&=-257,y.flags|=65536,y.lanes=C,M===Ih?y.flags|=16384:(h=y.updateQueue,h===null?y.updateQueue=new Set([M]):h.add(M),ph(c,M,C)),!1;case 22:return y.flags|=65536,M===Ih?y.flags|=16384:(h=y.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([M])},y.updateQueue=h):(y=h.retryQueue,y===null?h.retryQueue=new Set([M]):y.add(M)),ph(c,M,C)),!1}throw Error(i(435,y.tag))}return ph(c,M,C),Ka(),!1}if(Fn)return h=Ar.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=C,M!==ef&&(c=Error(i(422),{cause:M}),se(fe(c,y)))):(M!==ef&&(h=Error(i(423),{cause:M}),se(fe(h,y))),c=c.current.alternate,c.flags|=65536,C&=-C,c.lanes|=C,M=fe(M,y),C=cs(c.stateNode,M,C),le(c,C),In!==4&&(In=2)),!1;var L=Error(i(520),{cause:M});if(L=fe(L,y),ju===null?ju=[L]:ju.push(L),In!==4&&(In=2),h===null)return!0;M=fe(M,y),y=h;do{switch(y.tag){case 3:return y.flags|=65536,c=C&-C,y.lanes|=c,c=cs(y.stateNode,M,c),le(y,c),!1;case 1:if(h=y.type,L=y.stateNode,(y.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(Ur===null||!Ur.has(L))))return y.flags|=65536,C&=-C,y.lanes|=C,C=Cs(C),Ki(C,c,y,M),le(y,C),!1}y=y.return}while(y!==null);return!1}function Ri(c,h,y,M){h.child=c===null?rm(h,null,y,M):ol(h,c.child,y,M)}function Ol(c,h,y,M,C){y=y.render;var L=h.ref;if("ref"in M){var J={};for(var xe in M)xe!=="ref"&&(J[xe]=M[xe])}else J=M;return zl(h),M=$(c,h,y,J,L,C),xe=$e(),c!==null&&!Pi?(Mt(c,h,C),no(c,h,C)):(Fn&&xe&&W(h),h.flags|=1,Ri(c,h,M,C),h.child)}function Tc(c,h,y,M,C){if(c===null){var L=y.type;return typeof L=="function"&&!lo(L)&&L.defaultProps===void 0&&y.compare===null?(h.tag=15,h.type=L,_u(c,h,L,M,C)):(c=Yr(y.type,null,M,h,h.mode,C),c.ref=h.ref,c.return=h,h.child=c)}if(L=c.child,!ip(c,C)){var J=L.memoizedProps;if(y=y.compare,y=y!==null?y:at,y(J,M)&&c.ref===h.ref)return no(c,h,C)}return h.flags|=1,c=wa(L,M),c.ref=h.ref,c.return=h,h.child=c}function _u(c,h,y,M,C){if(c!==null){var L=c.memoizedProps;if(at(L,M)&&c.ref===h.ref)if(Pi=!1,h.pendingProps=M=L,ip(c,C))(c.flags&131072)!==0&&(Pi=!0);else return h.lanes=c.lanes,no(c,h,C)}return Xr(c,h,y,M,C)}function da(c,h,y){var M=h.pendingProps,C=M.children,L=(h.stateNode._pendingVisibility&2)!==0,J=c!==null?c.memoizedState:null;if(Xi(c,h),M.mode==="hidden"||L){if((h.flags&128)!==0){if(M=J!==null?J.baseLanes|y:y,c!==null){for(C=h.child=c.child,L=0;C!==null;)L=L|C.lanes|C.childLanes,C=C.sibling;h.childLanes=L&~M}else h.childLanes=0,h.child=null;return Wa(c,h,M,y)}if((y&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},c!==null&&th(h,J!==null?J.cachePool:null),J!==null?ai(h,J):ci(),Ai(h);else return h.lanes=h.childLanes=536870912,Wa(c,h,J!==null?J.baseLanes|y:y,y)}else J!==null?(th(h,J.cachePool),ai(h,J),ri(),h.memoizedState=null):(c!==null&&th(h,null),ci(),ri());return Ri(c,h,C,y),h.child}function Wa(c,h,y,M){var C=Ho();return C=C===null?null:{parent:Is?Kn._currentValue:Kn._currentValue2,pool:C},h.memoizedState={baseLanes:y,cachePool:C},c!==null&&th(h,null),ci(),Ai(h),c!==null&&Ll(c,h,M,!0),null}function Xi(c,h){var y=h.ref;if(y===null)c!==null&&c.ref!==null&&(h.flags|=2097664);else{if(typeof y!="function"&&typeof y!="object")throw Error(i(284));(c===null||c.ref!==y)&&(h.flags|=2097664)}}function Xr(c,h,y,M,C){return zl(h),y=$(c,h,y,M,void 0,C),M=$e(),c!==null&&!Pi?(Mt(c,h,C),no(c,h,C)):(Fn&&M&&W(h),h.flags|=1,Ri(c,h,y,C),h.child)}function Ac(c,h,y,M,C,L){return zl(h),h.updateQueue=null,y=qe(h,M,y,C),Me(c),M=$e(),c!==null&&!Pi?(Mt(c,h,L),no(c,h,L)):(Fn&&M&&W(h),h.flags|=1,Ri(c,h,y,L),h.child)}function Jd(c,h,y,M,C){if(zl(h),h.stateNode===null){var L=jl,J=y.contextType;typeof J=="object"&&J!==null&&(L=pa(J)),L=new y(M,L),h.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,L.updater=Ph,h.stateNode=L,L._reactInternals=h,L=h.stateNode,L.props=M,L.state=h.memoizedState,L.refs={},_t(h),J=y.contextType,L.context=typeof J=="object"&&J!==null?pa(J):jl,L.state=h.memoizedState,J=y.getDerivedStateFromProps,typeof J=="function"&&(gi(h,y,J,M),L.state=h.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(J=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),J!==L.state&&Ph.enqueueReplaceState(L,L.state,null),ut(h,M,L,C),Te(),L.state=h.memoizedState),typeof L.componentDidMount=="function"&&(h.flags|=4194308),M=!0}else if(c===null){L=h.stateNode;var xe=h.memoizedProps,we=Ba(y,xe);L.props=we;var pt=L.context,Rt=y.contextType;J=jl,typeof Rt=="object"&&Rt!==null&&(J=pa(Rt));var zt=y.getDerivedStateFromProps;Rt=typeof zt=="function"||typeof L.getSnapshotBeforeUpdate=="function",xe=h.pendingProps!==xe,Rt||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(xe||pt!==J)&&to(h,L,M,J),vo=!1;var Bt=h.memoizedState;L.state=Bt,ut(h,M,L,C),Te(),pt=h.memoizedState,xe||Bt!==pt||vo?(typeof zt=="function"&&(gi(h,y,zt,M),pt=h.memoizedState),(we=vo||us(h,y,we,M,Bt,pt,J))?(Rt||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(h.flags|=4194308)):(typeof L.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=M,h.memoizedState=pt),L.props=M,L.state=pt,L.context=J,M=we):(typeof L.componentDidMount=="function"&&(h.flags|=4194308),M=!1)}else{L=h.stateNode,bt(c,h),J=h.memoizedProps,Rt=Ba(y,J),L.props=Rt,zt=h.pendingProps,Bt=L.context,pt=y.contextType,we=jl,typeof pt=="object"&&pt!==null&&(we=pa(pt)),xe=y.getDerivedStateFromProps,(pt=typeof xe=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(J!==zt||Bt!==we)&&to(h,L,M,we),vo=!1,Bt=h.memoizedState,L.state=Bt,ut(h,M,L,C),Te();var ln=h.memoizedState;J!==zt||Bt!==ln||vo||c!==null&&c.dependencies!==null&&Fo(c.dependencies)?(typeof xe=="function"&&(gi(h,y,xe,M),ln=h.memoizedState),(Rt=vo||us(h,y,Rt,M,Bt,ln,we)||c!==null&&c.dependencies!==null&&Fo(c.dependencies))?(pt||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(M,ln,we),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(M,ln,we)),typeof L.componentDidUpdate=="function"&&(h.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof L.componentDidUpdate!="function"||J===c.memoizedProps&&Bt===c.memoizedState||(h.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||J===c.memoizedProps&&Bt===c.memoizedState||(h.flags|=1024),h.memoizedProps=M,h.memoizedState=ln),L.props=M,L.state=ln,L.context=we,M=Rt):(typeof L.componentDidUpdate!="function"||J===c.memoizedProps&&Bt===c.memoizedState||(h.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||J===c.memoizedProps&&Bt===c.memoizedState||(h.flags|=1024),M=!1)}return L=M,Xi(c,h),M=(h.flags&128)!==0,L||M?(L=h.stateNode,y=M&&typeof y.getDerivedStateFromError!="function"?null:L.render(),h.flags|=1,c!==null&&M?(h.child=ol(h,c.child,null,C),h.child=ol(h,null,y,C)):Ri(c,h,y,C),h.memoizedState=L.state,c=h.child):c=no(c,h,C),c}function Rg(c,h,y,M){return et(),h.flags|=256,Ri(c,h,y,M),h.child}function $d(c){return{baseLanes:c,cachePool:Ng()}}function ep(c,h,y){return c=c!==null?c.childLanes&~y:0,h&&(c|=ir),c}function Cg(c,h,y){var M=h.pendingProps,C=!1,L=(h.flags&128)!==0,J;if((J=L)||(J=c!==null&&c.memoizedState===null?!1:(qi.current&2)!==0),J&&(C=!0,h.flags&=-129),J=(h.flags&32)!==0,h.flags&=-33,c===null){if(Fn){if(C?mi(h):ri(),Fn){var xe=_a,we;(we=xe)&&(xe=i0(xe,jr),xe!==null?(h.memoizedState={dehydrated:xe,treeContext:ms!==null?{id:Fs,overflow:Wr}:null,retryLane:536870912},we=t(18,null,null,0),we.stateNode=xe,we.return=h,h.child=we,Da=h,_a=null,we=!0):we=!1),we||Ee(h)}if(xe=h.memoizedState,xe!==null&&(xe=xe.dehydrated,xe!==null))return qc(xe)?h.lanes=16:h.lanes=536870912,null;Xt(h)}return xe=M.children,M=M.fallback,C?(ri(),C=h.mode,xe=tp({mode:"hidden",children:xe},C),M=co(M,C,y,null),xe.return=h,M.return=h,xe.sibling=M,h.child=xe,C=h.child,C.memoizedState=$d(y),C.childLanes=ep(c,J,y),h.memoizedState=Oa,M):(mi(h),Rc(h,xe))}if(we=c.memoizedState,we!==null&&(xe=we.dehydrated,xe!==null)){if(L)h.flags&256?(mi(h),h.flags&=-257,h=np(c,h,y)):h.memoizedState!==null?(ri(),h.child=c.child,h.flags|=128,h=null):(ri(),C=M.fallback,xe=h.mode,M=tp({mode:"visible",children:M.children},xe),C=co(C,xe,y,null),C.flags|=2,M.return=h,C.return=h,M.sibling=C,h.child=M,ol(h,c.child,null,y),M=h.child,M.memoizedState=$d(y),M.childLanes=ep(c,J,y),h.memoizedState=Oa,h=C);else if(mi(h),qc(xe))J=Kg(xe).digest,M=Error(i(419)),M.stack="",M.digest=J,se({value:M,source:null,stack:null}),h=np(c,h,y);else if(Pi||Ll(c,h,y,!1),J=(y&c.childLanes)!==0,Pi||J){if(J=Tn,J!==null){if(M=y&-y,(M&42)!==0)M=1;else switch(M){case 2:M=1;break;case 8:M=4;break;case 32:M=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:M=64;break;case 268435456:M=134217728;break;default:M=0}if(M=(M&(J.suspendedLanes|y))!==0?0:M,M!==0&&M!==we.retryLane)throw we.retryLane=M,Le(c,M),Ca(J,c,M),y0}Ah(xe)||Ka(),h=np(c,h,y)}else Ah(xe)?(h.flags|=128,h.child=c.child,h=Gl.bind(null,c),w_(xe,h),h=null):(c=we.treeContext,Ga&&(_a=e0(xe),Da=h,Fn=!0,br=null,jr=!1,c!==null&&(Sr[Mr++]=Fs,Sr[Mr++]=Wr,Sr[Mr++]=ms,Fs=c.id,Wr=c.overflow,ms=h)),h=Rc(h,M.children),h.flags|=4096);return h}return C?(ri(),C=M.fallback,xe=h.mode,we=c.child,L=we.sibling,M=wa(we,{mode:"hidden",children:M.children}),M.subtreeFlags=we.subtreeFlags&31457280,L!==null?C=wa(L,C):(C=co(C,xe,y,null),C.flags|=2),C.return=h,M.return=h,M.sibling=C,h.child=M,M=C,C=h.child,xe=c.child.memoizedState,xe===null?xe=$d(y):(we=xe.cachePool,we!==null?(L=Is?Kn._currentValue:Kn._currentValue2,we=we.parent!==L?{parent:L,pool:L}:we):we=Ng(),xe={baseLanes:xe.baseLanes|y,cachePool:we}),C.memoizedState=xe,C.childLanes=ep(c,J,y),h.memoizedState=Oa,M):(mi(h),y=c.child,c=y.sibling,y=wa(y,{mode:"visible",children:M.children}),y.return=h,y.sibling=null,c!==null&&(J=h.deletions,J===null?(h.deletions=[c],h.flags|=16):J.push(c)),h.child=y,h.memoizedState=null,y)}function Rc(c,h){return h=tp({mode:"visible",children:h},c.mode),h.return=c,c.child=h}function tp(c,h){return mh(c,h,0,null)}function np(c,h,y){return ol(h,c.child,null,y),c=Rc(h,h.pendingProps.children),c.flags|=2,h.memoizedState=null,c}function wg(c,h,y){c.lanes|=h;var M=c.alternate;M!==null&&(M.lanes|=h),ap(c.return,h,y)}function $f(c,h,y,M,C){var L=c.memoizedState;L===null?c.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:M,tail:y,tailMode:C}:(L.isBackwards=h,L.rendering=null,L.renderingStartTime=0,L.last=M,L.tail=y,L.tailMode=C)}function Ug(c,h,y){var M=h.pendingProps,C=M.revealOrder,L=M.tail;if(Ri(c,h,M.children,y),M=qi.current,(M&2)!==0)M=M&1|2,h.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=h.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&wg(c,y,h);else if(c.tag===19)wg(c,y,h);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===h)break e;for(;c.sibling===null;){if(c.return===null||c.return===h)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}M&=1}switch(w(qi,M),C){case"forwards":for(y=h.child,C=null;y!==null;)c=y.alternate,c!==null&&Un(c)===null&&(C=y),y=y.sibling;y=C,y===null?(C=h.child,h.child=null):(C=y.sibling,y.sibling=null),$f(h,!1,C,y,L);break;case"backwards":for(y=null,C=h.child,h.child=null;C!==null;){if(c=C.alternate,c!==null&&Un(c)===null){h.child=C;break}c=C.sibling,C.sibling=y,y=C,C=c}$f(h,!0,y,null,L);break;case"together":$f(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function no(c,h,y){if(c!==null&&(h.dependencies=c.dependencies),Cr|=h.lanes,(y&h.childLanes)===0)if(c!==null){if(Ll(c,h,y,!1),(y&h.childLanes)===0)return null}else return null;if(c!==null&&h.child!==c.child)throw Error(i(153));if(h.child!==null){for(c=h.child,y=wa(c,c.pendingProps),h.child=y,y.return=h;c.sibling!==null;)c=c.sibling,y=y.sibling=wa(c,c.pendingProps),y.return=h;y.sibling=null}return h.child}function ip(c,h){return(c.lanes&h)!==0?!0:(c=c.dependencies,!!(c!==null&&Fo(c)))}function A_(c,h,y){switch(h.tag){case 3:de(h,h.stateNode.containerInfo),Po(h,Kn,c.memoizedState.cache),et();break;case 27:case 5:oe(h);break;case 4:de(h,h.stateNode.containerInfo);break;case 10:Po(h,h.type,h.memoizedProps.value);break;case 13:var M=h.memoizedState;if(M!==null)return M.dehydrated!==null?(mi(h),h.flags|=128,null):(y&h.child.childLanes)!==0?Cg(c,h,y):(mi(h),c=no(c,h,y),c!==null?c.sibling:null);mi(h);break;case 19:var C=(c.flags&128)!==0;if(M=(y&h.childLanes)!==0,M||(Ll(c,h,y,!1),M=(y&h.childLanes)!==0),C){if(M)return Ug(c,h,y);h.flags|=128}if(C=h.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),w(qi,qi.current),M)break;return null;case 22:case 23:return h.lanes=0,da(c,h,y);case 24:Po(h,Kn,c.memoizedState.cache)}return no(c,h,y)}function Dg(c,h,y){if(c!==null)if(c.memoizedProps!==h.pendingProps)Pi=!0;else{if(!ip(c,y)&&(h.flags&128)===0)return Pi=!1,A_(c,h,y);Pi=(c.flags&131072)!==0}else Pi=!1,Fn&&(h.flags&1048576)!==0&&H(h,Jc,h.index);switch(h.lanes=0,h.tag){case 16:e:{c=h.pendingProps;var M=h.elementType,C=M._init;if(M=C(M._payload),h.type=M,typeof M=="function")lo(M)?(c=Ba(M,c),h.tag=1,h=Jd(null,h,M,c,y)):(h.tag=0,h=Xr(null,h,M,c,y));else{if(M!=null){if(C=M.$$typeof,C===zu){h.tag=11,h=Ol(null,h,M,c,y);break e}else if(C===Pc){h.tag=14,h=Tc(null,h,M,c,y);break e}}throw h=l(M)||M,Error(i(306,h,""))}}return h;case 0:return Xr(c,h,h.type,h.pendingProps,y);case 1:return M=h.type,C=Ba(M,h.pendingProps),Jd(c,h,M,C,y);case 3:e:{if(de(h,h.stateNode.containerInfo),c===null)throw Error(i(387));var L=h.pendingProps;C=h.memoizedState,M=C.element,bt(c,h),ut(h,L,null,y);var J=h.memoizedState;if(L=J.cache,Po(h,Kn,L),L!==C.cache&&rp(h,[Kn],y,!0),Te(),L=J.element,Ga&&C.isDehydrated)if(C={element:L,isDehydrated:!1,cache:J.cache},h.updateQueue.baseState=C,h.memoizedState=C,h.flags&256){h=Rg(c,h,L,y);break e}else if(L!==M){M=fe(Error(i(424)),h),se(M),h=Rg(c,h,L,y);break e}else for(Ga&&(_a=$g(h.stateNode.containerInfo),Da=h,Fn=!0,br=null,jr=!0),y=rm(h,null,L,y),h.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling;else{if(et(),L===M){h=no(c,h,y);break e}Ri(c,h,L,y)}h=h.child}return h;case 26:if(_r)return Xi(c,h),c===null?(y=Dh(h.type,null,h.pendingProps,null))?h.memoizedState=y:Fn||(h.stateNode=D_(h.type,h.pendingProps,gs.current,h)):h.memoizedState=Dh(h.type,c.memoizedProps,h.pendingProps,c.memoizedState),null;case 27:if(va)return oe(h),c===null&&va&&Fn&&(M=h.stateNode=tm(h.type,h.pendingProps,gs.current,oa.current,!1),Da=h,jr=!0,_a=Rh(M)),M=h.pendingProps.children,c!==null||Fn?Ri(c,h,M,y):h.child=ol(h,null,M,y),Xi(c,h),h.child;case 5:return c===null&&Fn&&(l0(h.type,h.pendingProps,oa.current),(C=M=_a)&&(M=t0(M,h.type,h.pendingProps,jr),M!==null?(h.stateNode=M,Da=h,_a=Rh(M),jr=!1,C=!0):C=!1),C||Ee(h)),oe(h),C=h.type,L=h.pendingProps,J=c!==null?c.memoizedProps:null,M=L.children,nl(C,L)?M=null:J!==null&&nl(C,J)&&(h.flags|=32),h.memoizedState!==null&&(C=$(c,h,tt,null,null,y),Is?nn._currentValue=C:nn._currentValue2=C),Xi(c,h),Ri(c,h,M,y),h.child;case 6:return c===null&&Fn&&(u0(h.pendingProps,oa.current),(c=y=_a)&&(y=n0(y,h.pendingProps,jr),y!==null?(h.stateNode=y,Da=h,_a=null,c=!0):c=!1),c||Ee(h)),null;case 13:return Cg(c,h,y);case 4:return de(h,h.stateNode.containerInfo),M=h.pendingProps,c===null?h.child=ol(h,null,M,y):Ri(c,h,M,y),h.child;case 11:return Ol(c,h,h.type,h.pendingProps,y);case 7:return Ri(c,h,h.pendingProps,y),h.child;case 8:return Ri(c,h,h.pendingProps.children,y),h.child;case 12:return Ri(c,h,h.pendingProps.children,y),h.child;case 10:return M=h.pendingProps,Po(h,h.type,M.value),Ri(c,h,M.children,y),h.child;case 9:return C=h.type._context,M=h.pendingProps.children,zl(h),C=pa(C),M=M(C),h.flags|=1,Ri(c,h,M,y),h.child;case 14:return Tc(c,h,h.type,h.pendingProps,y);case 15:return _u(c,h,h.type,h.pendingProps,y);case 19:return Ug(c,h,y);case 22:return da(c,h,y);case 24:return zl(h),M=pa(Kn),c===null?(C=Ho(),C===null&&(C=Tn,L=eh(),C.pooledCache=L,L.refCount++,L!==null&&(C.pooledCacheLanes|=y),C=L),h.memoizedState={parent:M,cache:C},_t(h),Po(h,Kn,C)):((c.lanes&y)!==0&&(bt(c,h),ut(h,null,null,y),Te()),C=c.memoizedState,L=h.memoizedState,C.parent!==M?(C={parent:M,cache:M},h.memoizedState=C,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=C),Po(h,Kn,M)):(M=L.cache,Po(h,Kn,M),M!==C.cache&&rp(h,[Kn],y,!0))),Ri(c,h,h.pendingProps.children,y),h.child;case 29:throw h.pendingProps}throw Error(i(156,h.tag))}function Po(c,h,y){Is?(w(tr,h._currentValue),h._currentValue=y):(w(tr,h._currentValue2),h._currentValue2=y)}function io(c){var h=tr.current;Is?c._currentValue=h:c._currentValue2=h,E(tr)}function ap(c,h,y){for(;c!==null;){var M=c.alternate;if((c.childLanes&h)!==h?(c.childLanes|=h,M!==null&&(M.childLanes|=h)):M!==null&&(M.childLanes&h)!==h&&(M.childLanes|=h),c===y)break;c=c.return}}function rp(c,h,y,M){var C=c.child;for(C!==null&&(C.return=c);C!==null;){var L=C.dependencies;if(L!==null){var J=C.child;L=L.firstContext;e:for(;L!==null;){var xe=L;L=C;for(var we=0;we<h.length;we++)if(xe.context===h[we]){L.lanes|=y,xe=L.alternate,xe!==null&&(xe.lanes|=y),ap(L.return,y,c),M||(J=null);break e}L=xe.next}}else if(C.tag===18){if(J=C.return,J===null)throw Error(i(341));J.lanes|=y,L=J.alternate,L!==null&&(L.lanes|=y),ap(J,y,c),J=null}else J=C.child;if(J!==null)J.return=C;else for(J=C;J!==null;){if(J===c){J=null;break}if(C=J.sibling,C!==null){C.return=J.return,J=C;break}J=J.return}C=J}}function Ll(c,h,y,M){c=null;for(var C=h,L=!1;C!==null;){if(!L){if((C.flags&524288)!==0)L=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var J=C.alternate;if(J===null)throw Error(i(387));if(J=J.memoizedProps,J!==null){var xe=C.type;xr(C.pendingProps.value,J.value)||(c!==null?c.push(xe):c=[xe])}}else if(C===Vu.current){if(J=C.alternate,J===null)throw Error(i(387));J.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(c!==null?c.push(nn):c=[nn])}C=C.return}c!==null&&rp(h,c,y,M),h.flags|=262144}function Fo(c){for(c=c.firstContext;c!==null;){var h=c.context;if(!xr(Is?h._currentValue:h._currentValue2,c.memoizedValue))return!0;c=c.next}return!1}function zl(c){ul=c,Ni=null,c=c.dependencies,c!==null&&(c.firstContext=null)}function pa(c){return sp(ul,c)}function Cc(c,h){return ul===null&&zl(c),sp(c,h)}function sp(c,h){var y=Is?h._currentValue:h._currentValue2;if(h={context:h,memoizedValue:y,next:null},Ni===null){if(c===null)throw Error(i(308));Ni=h,c.dependencies={lanes:0,firstContext:h},c.flags|=524288}else Ni=Ni.next=h;return y}function eh(){return{controller:new _0,data:new Map,refCount:0}}function xu(c){c.refCount--,c.refCount===0&&_o(Ql,function(){c.controller.abort()})}function Ho(){var c=xo.current;return c!==null?c:Tn.pooledCache}function th(c,h){h===null?w(xo,xo.current):w(xo,h.pool)}function Ng(){var c=Ho();return c===null?null:{parent:Is?Kn._currentValue:Kn._currentValue2,pool:c}}function pr(c){c.flags|=4}function op(c,h){if(c!==null&&c.child===h.child)return!1;if((h.flags&16)!==0)return!0;for(c=h.child;c!==null;){if((c.flags&13878)!==0||(c.subtreeFlags&13878)!==0)return!0;c=c.sibling}return!1}function nh(c,h,y,M){if(ga)for(y=h.child;y!==null;){if(y.tag===5||y.tag===6)zs(c,y.stateNode);else if(!(y.tag===4||va&&y.tag===27)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===h)break;for(;y.sibling===null;){if(y.return===null||y.return===h)return;y=y.return}y.sibling.return=y.return,y=y.sibling}else if(vr)for(var C=h.child;C!==null;){if(C.tag===5){var L=C.stateNode;y&&M&&(L=Vp(L,C.type,C.memoizedProps)),zs(c,L)}else if(C.tag===6)L=C.stateNode,y&&M&&(L=kp(L,C.memoizedProps)),zs(c,L);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)L=C.child,L!==null&&(L.return=C),nh(c,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===h)break;for(;C.sibling===null;){if(C.return===null||C.return===h)return;C=C.return}C.sibling.return=C.return,C=C.sibling}}function Su(c,h,y,M){if(vr)for(var C=h.child;C!==null;){if(C.tag===5){var L=C.stateNode;y&&M&&(L=Vp(L,C.type,C.memoizedProps)),Hp(c,L)}else if(C.tag===6)L=C.stateNode,y&&M&&(L=kp(L,C.memoizedProps)),Hp(c,L);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)L=C.child,L!==null&&(L.return=C),Su(c,C,!(C.memoizedProps!==null&&C.memoizedProps.mode==="manual"),!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===h)break;for(;C.sibling===null;){if(C.return===null||C.return===h)return;C=C.return}C.sibling.return=C.return,C=C.sibling}}function Mu(c,h){if(vr&&op(c,h)){c=h.stateNode;var y=c.containerInfo,M=Th();Su(M,h,!1,!1),c.pendingChildren=M,pr(h),Zg(y,M)}}function lp(c,h,y,M){if(ga)c.memoizedProps!==M&&pr(h);else if(vr){var C=c.stateNode,L=c.memoizedProps;if((c=op(c,h))||L!==M){var J=oa.current;L=Fp(C,y,L,M,!c,null),L===C?h.stateNode=C:(ho(L,y,M,J)&&pr(h),h.stateNode=L,c?nh(L,h,!1,!1):pr(h))}else h.stateNode=C}}function bu(c,h,y){if(qg(h,y)){if(c.flags|=16777216,!po(h,y))if(Lc())c.flags|=8192;else throw Kl=Ih,am}else c.flags&=-16777217}function up(c,h){if(c0(h)){if(c.flags|=16777216,!$p(h))if(Lc())c.flags|=8192;else throw Kl=Ih,am}else c.flags&=-16777217}function wc(c,h){h!==null&&(c.flags|=4),c.flags&16384&&(h=c.tag!==22?N():536870912,c.lanes|=h,Mo|=h)}function Il(c,h){if(!Fn)switch(c.tailMode){case"hidden":h=c.tail;for(var y=null;h!==null;)h.alternate!==null&&(y=h),h=h.sibling;y===null?c.tail=null:y.sibling=null;break;case"collapsed":y=c.tail;for(var M=null;y!==null;)y.alternate!==null&&(M=y),y=y.sibling;M===null?h||c.tail===null?c.tail=null:c.tail.sibling=null:M.sibling=null}}function vi(c){var h=c.alternate!==null&&c.alternate.child===c.child,y=0,M=0;if(h)for(var C=c.child;C!==null;)y|=C.lanes|C.childLanes,M|=C.subtreeFlags&31457280,M|=C.flags&31457280,C.return=c,C=C.sibling;else for(C=c.child;C!==null;)y|=C.lanes|C.childLanes,M|=C.subtreeFlags,M|=C.flags,C.return=c,C=C.sibling;return c.subtreeFlags|=M,c.childLanes=y,h}function Og(c,h,y){var M=h.pendingProps;switch(re(h),h.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vi(h),null;case 1:return vi(h),null;case 3:return y=h.stateNode,M=null,c!==null&&(M=c.memoizedState.cache),h.memoizedState.cache!==M&&(h.flags|=2048),io(Kn),ge(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(c===null||c.child===null)&&(st(h)?pr(h):c===null||c.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,br!==null&&(ro(br),br=null))),Mu(c,h),vi(h),null;case 26:if(_r){y=h.type;var C=h.memoizedState;return c===null?(pr(h),C!==null?(vi(h),up(h,C)):(vi(h),bu(h,y,M))):C?C!==c.memoizedState?(pr(h),vi(h),up(h,C)):(vi(h),h.flags&=-16777217):(ga?c.memoizedProps!==M&&pr(h):lp(c,h,y,M),vi(h),bu(h,y,M)),null}case 27:if(va){if(he(h),y=gs.current,C=h.type,c!==null&&h.stateNode!=null)ga?c.memoizedProps!==M&&pr(h):lp(c,h,C,M);else{if(!M){if(h.stateNode===null)throw Error(i(166));return vi(h),null}c=oa.current,st(h)?We(h,c):(c=tm(C,M,y,c,!0),h.stateNode=c,pr(h))}return vi(h),null}case 5:if(he(h),y=h.type,c!==null&&h.stateNode!=null)lp(c,h,y,M);else{if(!M){if(h.stateNode===null)throw Error(i(166));return vi(h),null}c=oa.current,st(h)?We(h,c):(C=Cp(y,M,gs.current,c,h),nh(C,h,!1,!1),h.stateNode=C,ho(C,y,M,c)&&pr(h))}return vi(h),bu(h,h.type,h.pendingProps),null;case 6:if(c&&h.stateNode!=null)y=c.memoizedProps,ga?y!==M&&pr(h):vr&&(y!==M?(h.stateNode=_h(M,gs.current,oa.current,h),pr(h)):h.stateNode=c.stateNode);else{if(typeof M!="string"&&h.stateNode===null)throw Error(i(166));if(c=gs.current,y=oa.current,st(h)){if(!Ga)throw Error(i(176));if(c=h.stateNode,y=h.memoizedProps,M=null,C=Da,C!==null)switch(C.tag){case 27:case 5:M=C.memoizedProps}a0(c,y,h,M)||Ee(h)}else h.stateNode=_h(M,c,y,h)}return vi(h),null;case 13:if(M=h.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(C=st(h),M!==null&&M.dehydrated!==null){if(c===null){if(!C)throw Error(i(318));if(!Ga)throw Error(i(344));if(C=h.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(i(317));Bu(C,h)}else et(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;vi(h),C=!1}else br!==null&&(ro(br),br=null),C=!0;if(!C)return h.flags&256?(Xt(h),h):(Xt(h),null)}if(Xt(h),(h.flags&128)!==0)return h.lanes=y,h;if(y=M!==null,c=c!==null&&c.memoizedState!==null,y){M=h.child,C=null,M.alternate!==null&&M.alternate.memoizedState!==null&&M.alternate.memoizedState.cachePool!==null&&(C=M.alternate.memoizedState.cachePool.pool);var L=null;M.memoizedState!==null&&M.memoizedState.cachePool!==null&&(L=M.memoizedState.cachePool.pool),L!==C&&(M.flags|=2048)}return y!==c&&y&&(h.child.flags|=8192),wc(h,h.updateQueue),vi(h),null;case 4:return ge(),Mu(c,h),c===null&&Dp(h.stateNode.containerInfo),vi(h),null;case 10:return io(h.type),vi(h),null;case 19:if(E(qi),C=h.memoizedState,C===null)return vi(h),null;if(M=(h.flags&128)!==0,L=C.rendering,L===null)if(M)Il(C,!1);else{if(In!==0||c!==null&&(c.flags&128)!==0)for(c=h.child;c!==null;){if(L=Un(c),L!==null){for(h.flags|=128,Il(C,!1),c=L.updateQueue,h.updateQueue=c,wc(h,c),h.subtreeFlags=0,c=y,y=h.child;y!==null;)uo(y,c),y=y.sibling;return w(qi,qi.current&1|2),h.child}c=c.sibling}C.tail!==null&&ya()>bi&&(h.flags|=128,M=!0,Il(C,!1),h.lanes=4194304)}else{if(!M)if(c=Un(L),c!==null){if(h.flags|=128,M=!0,c=c.updateQueue,h.updateQueue=c,wc(h,c),Il(C,!0),C.tail===null&&C.tailMode==="hidden"&&!L.alternate&&!Fn)return vi(h),null}else 2*ya()-C.renderingStartTime>bi&&y!==536870912&&(h.flags|=128,M=!0,Il(C,!1),h.lanes=4194304);C.isBackwards?(L.sibling=h.child,h.child=L):(c=C.last,c!==null?c.sibling=L:h.child=L,C.last=L)}return C.tail!==null?(h=C.tail,C.rendering=h,C.tail=h.sibling,C.renderingStartTime=ya(),h.sibling=null,c=qi.current,w(qi,M?c&1|2:c&1),h):(vi(h),null);case 22:case 23:return Xt(h),Ti(),M=h.memoizedState!==null,c!==null?c.memoizedState!==null!==M&&(h.flags|=8192):M&&(h.flags|=8192),M?(y&536870912)!==0&&(h.flags&128)===0&&(vi(h),h.subtreeFlags&6&&(h.flags|=8192)):vi(h),y=h.updateQueue,y!==null&&wc(h,y.retryQueue),y=null,c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),M=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(M=h.memoizedState.cachePool.pool),M!==y&&(h.flags|=2048),c!==null&&E(xo),null;case 24:return y=null,c!==null&&(y=c.memoizedState.cache),h.memoizedState.cache!==y&&(h.flags|=2048),io(Kn),vi(h),null;case 25:return null}throw Error(i(156,h.tag))}function Lg(c,h){switch(re(h),h.tag){case 1:return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 3:return io(Kn),ge(),c=h.flags,(c&65536)!==0&&(c&128)===0?(h.flags=c&-65537|128,h):null;case 26:case 27:case 5:return he(h),null;case 13:if(Xt(h),c=h.memoizedState,c!==null&&c.dehydrated!==null){if(h.alternate===null)throw Error(i(340));et()}return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 19:return E(qi),null;case 4:return ge(),null;case 10:return io(h.type),null;case 22:case 23:return Xt(h),Ti(),c!==null&&E(xo),c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 24:return io(Kn),null;case 25:return null;default:return null}}function cp(c,h){switch(re(h),h.tag){case 3:io(Kn),ge();break;case 26:case 27:case 5:he(h);break;case 4:ge();break;case 13:Xt(h);break;case 19:E(qi);break;case 10:io(h.type);break;case 22:case 23:Xt(h),Ti(),c!==null&&E(xo);break;case 24:io(Kn)}}function Uc(c,h){try{var y=h.updateQueue,M=y!==null?y.lastEffect:null;if(M!==null){var C=M.next;y=C;do{if((y.tag&c)===c){M=void 0;var L=y.create,J=y.inst;M=L(),J.destroy=M}y=y.next}while(y!==C)}}catch(xe){Cn(h,h.return,xe)}}function Go(c,h,y){try{var M=h.updateQueue,C=M!==null?M.lastEffect:null;if(C!==null){var L=C.next;M=L;do{if((M.tag&c)===c){var J=M.inst,xe=J.destroy;if(xe!==void 0){J.destroy=void 0,C=h;var we=y;try{xe()}catch(pt){Cn(C,we,pt)}}}M=M.next}while(M!==L)}}catch(pt){Cn(h,h.return,pt)}}function zg(c){var h=c.updateQueue;if(h!==null){var y=c.stateNode;try{_e(h,y)}catch(M){Cn(c,c.return,M)}}}function Ig(c,h,y){y.props=Ba(c.type,c.memoizedProps),y.state=c.memoizedState;try{y.componentWillUnmount()}catch(M){Cn(c,h,M)}}function Bl(c,h){try{var y=c.ref;if(y!==null){var M=c.stateNode;switch(c.tag){case 26:case 27:case 5:var C=Iu(M);break;default:C=M}typeof y=="function"?c.refCleanup=y(C):y.current=C}}catch(L){Cn(c,h,L)}}function yi(c,h){var y=c.ref,M=c.refCleanup;if(y!==null)if(typeof M=="function")try{M()}catch(C){Cn(c,h,C)}finally{c.refCleanup=null,c=c.alternate,c!=null&&(c.refCleanup=null)}else if(typeof y=="function")try{y(null)}catch(C){Cn(c,h,C)}else y.current=null}function Eu(c){var h=c.type,y=c.memoizedProps,M=c.stateNode;try{C_(M,h,y,c)}catch(C){Cn(c,c.return,C)}}function fp(c,h,y){try{zp(c.stateNode,c.type,y,h,c)}catch(M){Cn(c,c.return,M)}}function hp(c){return c.tag===5||c.tag===3||(_r?c.tag===26:!1)||(va?c.tag===27:!1)||c.tag===4}function ih(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||hp(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&(!va||c.tag!==27)&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function ah(c,h,y){var M=c.tag;if(M===5||M===6)c=c.stateNode,h?Bp(y,c,h):Wg(y,c);else if(!(M===4||va&&M===27)&&(c=c.child,c!==null))for(ah(c,h,y),c=c.sibling;c!==null;)ah(c,h,y),c=c.sibling}function Tu(c,h,y){var M=c.tag;if(M===5||M===6)c=c.stateNode,h?Ip(y,c,h):Lp(y,c);else if(!(M===4||va&&M===27)&&(c=c.child,c!==null))for(Tu(c,h,y),c=c.sibling;c!==null;)Tu(c,h,y),c=c.sibling}function Bg(c,h,y){c=c.containerInfo;try{Gp(c,y)}catch(M){Cn(h,h.return,M)}}function Au(c,h){for(tl(c.containerInfo),Oi=h;Oi!==null;)if(c=Oi,h=c.child,(c.subtreeFlags&1028)!==0&&h!==null)h.return=c,Oi=h;else for(;Oi!==null;){c=Oi;var y=c.alternate;switch(h=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((h&1024)!==0&&y!==null){h=void 0;var M=c,C=y.memoizedProps;y=y.memoizedState;var L=M.stateNode;try{var J=Ba(M.type,C,M.elementType===M.type);h=L.getSnapshotBeforeUpdate(J,y),L.__reactInternalSnapshotBeforeUpdate=h}catch(xe){Cn(M,M.return,xe)}}break;case 3:(h&1024)!==0&&ga&&Eh(c.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((h&1024)!==0)throw Error(i(163))}if(h=c.sibling,h!==null){h.return=c.return,Oi=h;break}Oi=c.return}return J=Jl,Jl=!1,J}function rh(c,h,y){var M=y.flags;switch(y.tag){case 0:case 11:case 15:ws(c,y),M&4&&Uc(5,y);break;case 1:if(ws(c,y),M&4)if(c=y.stateNode,h===null)try{c.componentDidMount()}catch(xe){Cn(y,y.return,xe)}else{var C=Ba(y.type,h.memoizedProps);h=h.memoizedState;try{c.componentDidUpdate(C,h,c.__reactInternalSnapshotBeforeUpdate)}catch(xe){Cn(y,y.return,xe)}}M&64&&zg(y),M&512&&Bl(y,y.return);break;case 3:if(ws(c,y),M&64&&(M=y.updateQueue,M!==null)){if(c=null,y.child!==null)switch(y.child.tag){case 27:case 5:c=Iu(y.child.stateNode);break;case 1:c=y.child.stateNode}try{_e(M,c)}catch(xe){Cn(y,y.return,xe)}}break;case 26:if(_r){ws(c,y),M&512&&Bl(y,y.return);break}case 27:case 5:ws(c,y),h===null&&M&4&&Eu(y),M&512&&Bl(y,y.return);break;case 12:ws(c,y);break;case 13:ws(c,y),M&4&&Vo(c,y);break;case 22:if(C=y.memoizedState!==null||Ji,!C){h=h!==null&&h.memoizedState!==null||Mi;var L=Ji,J=Mi;Ji=C,(Mi=h)&&!J?Xo(c,y,(y.subtreeFlags&8772)!==0):ws(c,y),Ji=L,Mi=J}M&512&&(y.memoizedProps.mode==="manual"?Bl(y,y.return):yi(y,y.return));break;default:ws(c,y)}}function Ru(c){var h=c.alternate;h!==null&&(c.alternate=null,Ru(h)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(h=c.stateNode,h!==null&&Np(h)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function mr(c,h,y){for(y=y.child;y!==null;)sh(c,h,y),y=y.sibling}function sh(c,h,y){if($a&&typeof $a.onCommitFiberUnmount=="function")try{$a.onCommitFiberUnmount(Gu,y)}catch{}switch(y.tag){case 26:if(_r){Mi||yi(y,h),mr(c,h,y),y.memoizedState?jp(y.memoizedState):y.stateNode&&Qp(y.stateNode);break}case 27:if(va){Mi||yi(y,h);var M=Fi,C=nr;Fi=y.stateNode,mr(c,h,y),f0(y.stateNode),Fi=M,nr=C;break}case 5:Mi||yi(y,h);case 6:if(ga){if(M=Fi,C=nr,Fi=null,mr(c,h,y),Fi=M,nr=C,Fi!==null)if(nr)try{Ii(Fi,y.stateNode)}catch(L){Cn(y,h,L)}else try{Va(Fi,y.stateNode)}catch(L){Cn(y,h,L)}}else mr(c,h,y);break;case 18:ga&&Fi!==null&&(nr?Yp(Fi,y.stateNode):s0(Fi,y.stateNode));break;case 4:ga?(M=Fi,C=nr,Fi=y.stateNode.containerInfo,nr=!0,mr(c,h,y),Fi=M,nr=C):(vr&&Bg(y.stateNode,y,Th()),mr(c,h,y));break;case 0:case 11:case 14:case 15:Mi||Go(2,y,h),Mi||Go(4,y,h),mr(c,h,y);break;case 1:Mi||(yi(y,h),M=y.stateNode,typeof M.componentWillUnmount=="function"&&Ig(y,h,M)),mr(c,h,y);break;case 21:mr(c,h,y);break;case 22:Mi||yi(y,h),Mi=(M=Mi)||y.memoizedState!==null,mr(c,h,y),Mi=M;break;default:mr(c,h,y)}}function Vo(c,h){if(Ga&&h.memoizedState===null&&(c=h.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null))))try{wh(c)}catch(y){Cn(h,h.return,y)}}function Cu(c){switch(c.tag){case 13:case 19:var h=c.stateNode;return h===null&&(h=c.stateNode=new Wu),h;case 22:return c=c.stateNode,h=c._retryCache,h===null&&(h=c._retryCache=new Wu),h;default:throw Error(i(435,c.tag))}}function Dc(c,h){var y=Cu(c);h.forEach(function(M){var C=vp.bind(null,c,M);y.has(M)||(y.add(M),M.then(C,C))})}function Pa(c,h){var y=h.deletions;if(y!==null)for(var M=0;M<y.length;M++){var C=y[M],L=c,J=h;if(ga){var xe=J;e:for(;xe!==null;){switch(xe.tag){case 27:case 5:Fi=xe.stateNode,nr=!1;break e;case 3:Fi=xe.stateNode.containerInfo,nr=!0;break e;case 4:Fi=xe.stateNode.containerInfo,nr=!0;break e}xe=xe.return}if(Fi===null)throw Error(i(160));sh(L,J,C),Fi=null,nr=!1}else sh(L,J,C);L=C.alternate,L!==null&&(L.return=null),C.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)ko(h,c),h=h.sibling}function ko(c,h){var y=c.alternate,M=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:Pa(h,c),ja(c),M&4&&(Go(3,c,c.return),Uc(3,c),Go(5,c,c.return));break;case 1:Pa(h,c),ja(c),M&512&&(Mi||y===null||yi(y,y.return)),M&64&&Ji&&(c=c.updateQueue,c!==null&&(M=c.callbacks,M!==null&&(y=c.shared.hiddenCallbacks,c.shared.hiddenCallbacks=y===null?M:y.concat(M))));break;case 26:if(_r){var C=ka;Pa(h,c),ja(c),M&512&&(Mi||y===null||yi(y,y.return)),M&4&&(M=y!==null?y.memoizedState:null,h=c.memoizedState,y===null?h===null?c.stateNode===null?c.stateNode=Zp(C,c.type,c.memoizedProps,c):Kp(C,c.type,c.stateNode):c.stateNode=Wp(C,h,c.memoizedProps):M!==h?(M===null?y.stateNode!==null&&Qp(y.stateNode):jp(M),h===null?Kp(C,c.type,c.stateNode):Wp(C,h,c.memoizedProps)):h===null&&c.stateNode!==null&&fp(c,c.memoizedProps,y.memoizedProps));break}case 27:if(va&&M&4&&c.alternate===null){C=c.stateNode;var L=c.memoizedProps;try{N_(C),O_(c.type,L,C,c)}catch(Rt){Cn(c,c.return,Rt)}}case 5:if(Pa(h,c),ja(c),M&512&&(Mi||y===null||yi(y,y.return)),ga){if(c.flags&32){h=c.stateNode;try{Xc(h)}catch(Rt){Cn(c,c.return,Rt)}}M&4&&c.stateNode!=null&&(h=c.memoizedProps,fp(c,h,y!==null?y.memoizedProps:h)),M&1024&&(cl=!0)}break;case 6:if(Pa(h,c),ja(c),M&4&&ga){if(c.stateNode===null)throw Error(i(162));M=c.memoizedProps,y=y!==null?y.memoizedProps:M,h=c.stateNode;try{jg(h,y,M)}catch(Rt){Cn(c,c.return,Rt)}}break;case 3:if(_r?(Jp(),C=ka,ka=Uh(h.containerInfo),Pa(h,c),ka=C):Pa(h,c),ja(c),M&4){if(ga&&Ga&&y!==null&&y.memoizedState.isDehydrated)try{Ch(h.containerInfo)}catch(Rt){Cn(c,c.return,Rt)}if(vr){M=h.containerInfo,y=h.pendingChildren;try{Gp(M,y)}catch(Rt){Cn(c,c.return,Rt)}}}cl&&(cl=!1,dp(c));break;case 4:_r?(y=ka,ka=Uh(c.stateNode.containerInfo),Pa(h,c),ja(c),ka=y):(Pa(h,c),ja(c)),M&4&&vr&&Bg(c.stateNode,c,c.stateNode.pendingChildren);break;case 12:Pa(h,c),ja(c);break;case 13:Pa(h,c),ja(c),c.child.flags&8192&&c.memoizedState!==null!=(y!==null&&y.memoizedState!==null)&&(ks=ya()),M&4&&(M=c.updateQueue,M!==null&&(c.updateQueue=null,Dc(c,M)));break;case 22:M&512&&(Mi||y===null||yi(y,y.return)),C=c.memoizedState!==null;var J=y!==null&&y.memoizedState!==null,xe=Ji,we=Mi;if(Ji=xe||C,Mi=we||J,Pa(h,c),Mi=we,Ji=xe,ja(c),h=c.stateNode,h._current=c,h._visibility&=-3,h._visibility|=h._pendingVisibility&2,M&8192&&(h._visibility=C?h._visibility&-2:h._visibility|1,C&&(h=Ji||Mi,y===null||J||h||wu(c)),ga&&(c.memoizedProps===null||c.memoizedProps.mode!=="manual"))){e:if(y=null,ga)for(h=c;;){if(h.tag===5||_r&&h.tag===26||va&&h.tag===27){if(y===null){J=y=h;try{L=J.stateNode,C?Yc(L):Pp(J.stateNode,J.memoizedProps)}catch(Rt){Cn(J,J.return,Rt)}}}else if(h.tag===6){if(y===null){J=h;try{var pt=J.stateNode;C?bh(pt):mo(pt,J.memoizedProps)}catch(Rt){Cn(J,J.return,Rt)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===c)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break e;for(;h.sibling===null;){if(h.return===null||h.return===c)break e;y===h&&(y=null),h=h.return}y===h&&(y=null),h.sibling.return=h.return,h=h.sibling}}M&4&&(M=c.updateQueue,M!==null&&(y=M.retryQueue,y!==null&&(M.retryQueue=null,Dc(c,y))));break;case 19:Pa(h,c),ja(c),M&4&&(M=c.updateQueue,M!==null&&(c.updateQueue=null,Dc(c,M)));break;case 21:break;default:Pa(h,c),ja(c)}}function ja(c){var h=c.flags;if(h&2){try{if(ga&&(!va||c.tag!==27)){e:{for(var y=c.return;y!==null;){if(hp(y)){var M=y;break e}y=y.return}throw Error(i(160))}switch(M.tag){case 27:if(va){var C=M.stateNode,L=ih(c);Tu(c,L,C);break}case 5:var J=M.stateNode;M.flags&32&&(Xc(J),M.flags&=-33);var xe=ih(c);Tu(c,xe,J);break;case 3:case 4:var we=M.stateNode.containerInfo,pt=ih(c);ah(c,pt,we);break;default:throw Error(i(161))}}}catch(Rt){Cn(c,c.return,Rt)}c.flags&=-3}h&4096&&(c.flags&=-4097)}function dp(c){if(c.subtreeFlags&1024)for(c=c.child;c!==null;){var h=c;dp(h),h.tag===5&&h.flags&1024&&si(h.stateNode),c=c.sibling}}function ws(c,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)rh(c,h.alternate,h),h=h.sibling}function wu(c){for(c=c.child;c!==null;){var h=c;switch(h.tag){case 0:case 11:case 14:case 15:Go(4,h,h.return),wu(h);break;case 1:yi(h,h.return);var y=h.stateNode;typeof y.componentWillUnmount=="function"&&Ig(h,h.return,y),wu(h);break;case 26:case 27:case 5:yi(h,h.return),wu(h);break;case 22:yi(h,h.return),h.memoizedState===null&&wu(h);break;default:wu(h)}c=c.sibling}}function Xo(c,h,y){for(y=y&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var M=h.alternate,C=c,L=h,J=L.flags;switch(L.tag){case 0:case 11:case 15:Xo(C,L,y),Uc(4,L);break;case 1:if(Xo(C,L,y),M=L,C=M.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(pt){Cn(M,M.return,pt)}if(M=L,C=M.updateQueue,C!==null){var xe=M.stateNode;try{var we=C.shared.hiddenCallbacks;if(we!==null)for(C.shared.hiddenCallbacks=null,C=0;C<we.length;C++)pe(we[C],xe)}catch(pt){Cn(M,M.return,pt)}}y&&J&64&&zg(L),Bl(L,L.return);break;case 26:case 27:case 5:Xo(C,L,y),y&&M===null&&J&4&&Eu(L),Bl(L,L.return);break;case 12:Xo(C,L,y);break;case 13:Xo(C,L,y),y&&J&4&&Vo(C,L);break;case 22:L.memoizedState===null&&Xo(C,L,y),Bl(L,L.return);break;default:Xo(C,L,y)}h=h.sibling}}function pp(c,h){var y=null;c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),c=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(c=h.memoizedState.cachePool.pool),c!==y&&(c!=null&&c.refCount++,y!=null&&xu(y))}function oh(c,h){c=null,h.alternate!==null&&(c=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==c&&(h.refCount++,c!=null&&xu(c))}function ao(c,h,y,M){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)lh(c,h,y,M),h=h.sibling}function lh(c,h,y,M){var C=h.flags;switch(h.tag){case 0:case 11:case 15:ao(c,h,y,M),C&2048&&Uc(9,h);break;case 3:ao(c,h,y,M),C&2048&&(c=null,h.alternate!==null&&(c=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==c&&(h.refCount++,c!=null&&xu(c)));break;case 12:if(C&2048){ao(c,h,y,M),c=h.stateNode;try{var L=h.memoizedProps,J=L.id,xe=L.onPostCommit;typeof xe=="function"&&xe(J,h.alternate===null?"mount":"update",c.passiveEffectDuration,-0)}catch(we){Cn(h,h.return,we)}}else ao(c,h,y,M);break;case 23:break;case 22:L=h.stateNode,h.memoizedState!==null?L._visibility&4?ao(c,h,y,M):Yo(c,h):L._visibility&4?ao(c,h,y,M):(L._visibility|=4,Ra(c,h,y,M,(h.subtreeFlags&10256)!==0)),C&2048&&pp(h.alternate,h);break;case 24:ao(c,h,y,M),C&2048&&oh(h.alternate,h);break;default:ao(c,h,y,M)}}function Ra(c,h,y,M,C){for(C=C&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;){var L=c,J=h,xe=y,we=M,pt=J.flags;switch(J.tag){case 0:case 11:case 15:Ra(L,J,xe,we,C),Uc(8,J);break;case 23:break;case 22:var Rt=J.stateNode;J.memoizedState!==null?Rt._visibility&4?Ra(L,J,xe,we,C):Yo(L,J):(Rt._visibility|=4,Ra(L,J,xe,we,C)),C&&pt&2048&&pp(J.alternate,J);break;case 24:Ra(L,J,xe,we,C),C&&pt&2048&&oh(J.alternate,J);break;default:Ra(L,J,xe,we,C)}h=h.sibling}}function Yo(c,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var y=c,M=h,C=M.flags;switch(M.tag){case 22:Yo(y,M),C&2048&&pp(M.alternate,M);break;case 24:Yo(y,M),C&2048&&oh(M.alternate,M);break;default:Yo(y,M)}h=h.sibling}}function ia(c){if(c.subtreeFlags&$l)for(c=c.child;c!==null;)Pl(c),c=c.sibling}function Pl(c){switch(c.tag){case 26:ia(c),c.flags&$l&&(c.memoizedState!==null?em(ka,c.memoizedState,c.memoizedProps):Ci(c.type,c.memoizedProps));break;case 5:ia(c),c.flags&$l&&Ci(c.type,c.memoizedProps);break;case 3:case 4:if(_r){var h=ka;ka=Uh(c.stateNode.containerInfo),ia(c),ka=h}else ia(c);break;case 22:c.memoizedState===null&&(h=c.alternate,h!==null&&h.memoizedState!==null?(h=$l,$l=16777216,ia(c),$l=h):ia(c));break;default:ia(c)}}function uh(c){var h=c.alternate;if(h!==null&&(c=h.child,c!==null)){h.child=null;do h=c.sibling,c.sibling=null,c=h;while(c!==null)}}function qo(c){var h=c.deletions;if((c.flags&16)!==0){if(h!==null)for(var y=0;y<h.length;y++){var M=h[y];Oi=M,Wo(M,c)}uh(c)}if(c.subtreeFlags&10256)for(c=c.child;c!==null;)Nc(c),c=c.sibling}function Nc(c){switch(c.tag){case 0:case 11:case 15:qo(c),c.flags&2048&&Go(9,c,c.return);break;case 3:qo(c);break;case 12:qo(c);break;case 22:var h=c.stateNode;c.memoizedState!==null&&h._visibility&4&&(c.return===null||c.return.tag!==13)?(h._visibility&=-5,Uu(c)):qo(c);break;default:qo(c)}}function Uu(c){var h=c.deletions;if((c.flags&16)!==0){if(h!==null)for(var y=0;y<h.length;y++){var M=h[y];Oi=M,Wo(M,c)}uh(c)}for(c=c.child;c!==null;){switch(h=c,h.tag){case 0:case 11:case 15:Go(8,h,h.return),Uu(h);break;case 22:y=h.stateNode,y._visibility&4&&(y._visibility&=-5,Uu(h));break;default:Uu(h)}c=c.sibling}}function Wo(c,h){for(;Oi!==null;){var y=Oi;switch(y.tag){case 0:case 11:case 15:Go(8,y,h);break;case 23:case 22:if(y.memoizedState!==null&&y.memoizedState.cachePool!==null){var M=y.memoizedState.cachePool.pool;M!=null&&M.refCount++}break;case 24:xu(y.memoizedState.cache)}if(M=y.child,M!==null)M.return=y,Oi=M;else e:for(y=c;Oi!==null;){M=Oi;var C=M.sibling,L=M.return;if(Ru(M),M===y){Oi=null;break e}if(C!==null){C.return=L,Oi=C;break e}Oi=L}}}function ch(c){var h=Up(c);if(h!=null){if(typeof h.memoizedProps["data-testname"]!="string")throw Error(i(364));return h}if(c=Wl(c),c===null)throw Error(i(362));return c.stateNode.current}function Du(c,h){var y=c.tag;switch(h.$$typeof){case of:if(c.type===h.value)return!0;break;case Gh:e:{for(h=h.value,c=[c,0],y=0;y<c.length;){var M=c[y++],C=M.tag,L=c[y++],J=h[L];if(C!==5&&C!==26&&C!==27||!Ps(M)){for(;J!=null&&Du(M,J);)L++,J=h[L];if(L===h.length){h=!0;break e}else for(M=M.child;M!==null;)c.push(M,L),M=M.sibling}}h=!1}return h;case Vh:if((y===5||y===26||y===27)&&R_(c.stateNode,h.value))return!0;break;case Qn:if((y===5||y===6||y===26||y===27)&&(c=kc(c),c!==null&&0<=c.indexOf(h.value)))return!0;break;case zn:if((y===5||y===26||y===27)&&(c=c.memoizedProps["data-testname"],typeof c=="string"&&c.toLowerCase()===h.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function jo(c){switch(c.$$typeof){case of:return"<"+(l(c.value)||"Unknown")+">";case Gh:return":has("+(jo(c)||"")+")";case Vh:return'[role="'+c.value+'"]';case Qn:return'"'+c.value+'"';case zn:return'[data-testname="'+c.value+'"]';default:throw Error(i(365))}}function Pg(c,h){var y=[];c=[c,0];for(var M=0;M<c.length;){var C=c[M++],L=C.tag,J=c[M++],xe=h[J];if(L!==5&&L!==26&&L!==27||!Ps(C)){for(;xe!=null&&Du(C,xe);)J++,xe=h[J];if(J===h.length)y.push(C);else for(C=C.child;C!==null;)c.push(C,J),C=C.sibling}}return y}function Fa(c,h){if(!Bs)throw Error(i(363));c=ch(c),c=Pg(c,h),h=[],c=Array.from(c);for(var y=0;y<c.length;){var M=c[y++],C=M.tag;if(C===5||C===26||C===27)Ps(M)||h.push(M.stateNode);else for(M=M.child;M!==null;)c.push(M),M=M.sibling}return h}function Ha(){if((jt&2)!==0&&Mn!==0)return Mn&-Mn;if(Kt.T!==null){var c=er;return c!==0?c:De()}return qr()}function Us(){ir===0&&(ir=(Mn&536870912)===0||Fn?B():536870912);var c=Ar.current;return c!==null&&(c.flags|=32),ir}function Ca(c,h,y){(c===Tn&&oi===2||c.cancelPendingCommit!==null)&&(hs(c,0),fs(c,Mn,ir,!1)),q(c,y),((jt&2)===0||c!==Tn)&&(c===Tn&&((jt&2)===0&&(_s|=y),In===4&&fs(c,Mn,ir,!1)),Fe(c))}function Oc(c,h,y){if((jt&6)!==0)throw Error(i(327));var M=!y&&(h&60)===0&&(h&c.expiredLanes)===0||O(c,h),C=M?Os(c,h):Ds(c,h,!0),L=M;do{if(C===0){Rr&&!M&&fs(c,h,0,!1);break}else if(C===6)fs(c,h,0,!Jn);else{if(y=c.current.alternate,L&&!Fg(y)){C=Ds(c,h,!1),L=!1;continue}if(C===2){if(L=h,c.errorRecoveryDisabledLanes&L)var J=0;else J=c.pendingLanes&-536870913,J=J!==0?J:J&536870912?536870912:0;if(J!==0){h=J;e:{var xe=c;C=ju;var we=Ga&&xe.current.memoizedState.isDehydrated;if(we&&(hs(xe,J).flags|=256),J=Ds(xe,J,!1),J!==2){if(So&&!we){xe.errorRecoveryDisabledLanes|=L,_s|=L,C=4;break e}L=wr,wr=C,L!==null&&ro(L)}C=J}if(L=!1,C!==2)continue}}if(C===1){hs(c,0),fs(c,h,0,!0);break}e:{switch(M=c,C){case 0:case 1:throw Error(i(345));case 4:if((h&4194176)===h){fs(M,h,ir,!Jn);break e}break;case 2:wr=null;break;case 3:case 5:break;default:throw Error(i(329))}if(M.finishedWork=y,M.finishedLanes=h,(h&62914560)===h&&(L=ks+300-ya(),10<L)){if(fs(M,h,ir,!Jn),I(M,0)!==0)break e;M.timeoutHandle=wp(fh.bind(null,M,y,wr,xs,Zu,h,ir,_s,Mo,Jn,2,-0,0),L);break e}fh(M,y,wr,xs,Zu,h,ir,_s,Mo,Jn,0,-0,0)}}break}while(!0);Fe(c)}function ro(c){wr===null?wr=c:wr.push.apply(wr,c)}function fh(c,h,y,M,C,L,J,xe,we,pt,Rt,zt,Bt){var ln=h.subtreeFlags;if((ln&8192||(ln&16785408)===16785408)&&(yr(),Pl(h),h=xh(),h!==null)){c.cancelPendingCommit=h(fi.bind(null,c,y,M,C,J,xe,we,1,zt,Bt)),fs(c,L,J,!pt);return}fi(c,y,M,C,J,xe,we,Rt,zt,Bt)}function Fg(c){for(var h=c;;){var y=h.tag;if((y===0||y===11||y===15)&&h.flags&16384&&(y=h.updateQueue,y!==null&&(y=y.stores,y!==null)))for(var M=0;M<y.length;M++){var C=y[M],L=C.getSnapshot;C=C.value;try{if(!xr(L(),C))return!1}catch{return!1}}if(y=h.child,h.subtreeFlags&16384&&y!==null)y.return=h,h=y;else{if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function fs(c,h,y,M){h&=~La,h&=~_s,c.suspendedLanes|=h,c.pingedLanes&=~h,M&&(c.warmLanes|=h),M=c.expirationTimes;for(var C=h;0<C;){var L=31-Ja(C),J=1<<L;M[L]=-1,C&=~J}y!==0&&Q(c,y,h)}function mp(){return(jt&6)===0?(Ne(0),!1):!0}function Za(){if(un!==null){if(oi===0)var c=un.return;else c=un,Ni=ul=null,X(c),Hs=null,Zr=0,c=un;for(;c!==null;)cp(c.alternate,c),c=c.return;un=null}}function hs(c,h){c.finishedWork=null,c.finishedLanes=0;var y=c.timeoutHandle;y!==ql&&(c.timeoutHandle=ql,Vc(y)),y=c.cancelPendingCommit,y!==null&&(c.cancelPendingCommit=null,y()),Za(),Tn=c,un=y=wa(c.current,null),Mn=h,oi=0,Hi=null,Jn=!1,Rr=O(c,h),So=!1,Mo=ir=La=_s=Cr=In=0,wr=ju=null,Zu=!1,(h&8)!==0&&(h|=h&32);var M=c.entangledLanes;if(M!==0)for(c=c.entanglements,M&=h;0<M;){var C=31-Ja(M),L=1<<C;h|=c[C],M&=~L}return ys=h,Ie(),y}function Fl(c,h){mn=null,Kt.H=Hn,h===ni?(h=xt(),oi=3):h===am?(h=xt(),oi=4):oi=h===y0?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,Hi=h,un===null&&(In=1,Rs(c,fe(h,c.current)))}function Lc(){var c=Ar.current;return c===null?!0:(Mn&4194176)===Mn?Kr===null:(Mn&62914560)===Mn||(Mn&536870912)!==0?c===Kr:!1}function Nu(){var c=Kt.H;return Kt.H=Hn,c===null?Hn:c}function gr(){var c=Kt.A;return Kt.A=Hh,c}function Ka(){In=4,Jn||(Mn&4194176)!==Mn&&Ar.current!==null||(Rr=!0),(Cr&134217727)===0&&(_s&134217727)===0||Tn===null||fs(Tn,Mn,ir,!1)}function Ds(c,h,y){var M=jt;jt|=2;var C=Nu(),L=gr();(Tn!==c||Mn!==h)&&(xs=null,hs(c,h)),h=!1;var J=In;e:do try{if(oi!==0&&un!==null){var xe=un,we=Hi;switch(oi){case 8:Za(),J=6;break e;case 3:case 2:case 6:Ar.current===null&&(h=!0);var pt=oi;if(oi=0,Hi=null,Zo(c,xe,we,pt),y&&Rr){J=0;break e}break;default:pt=oi,oi=0,Hi=null,Zo(c,xe,we,pt)}}Ns(),J=In;break}catch(Rt){Fl(c,Rt)}while(!0);return h&&c.shellSuspendCounter++,Ni=ul=null,jt=M,Kt.H=C,Kt.A=L,un===null&&(Tn=null,Mn=0,Ie()),J}function Ns(){for(;un!==null;)gp(un)}function Os(c,h){var y=jt;jt|=2;var M=Nu(),C=gr();Tn!==c||Mn!==h?(xs=null,bi=ya()+500,hs(c,h)):Rr=O(c,h);e:do try{if(oi!==0&&un!==null){h=un;var L=Hi;t:switch(oi){case 1:oi=0,Hi=null,Zo(c,h,L,1);break;case 2:if(Tt(L)){oi=0,Hi=null,hh(h);break}h=function(){oi===2&&Tn===c&&(oi=7),Fe(c)},L.then(h,h);break e;case 3:oi=7;break e;case 4:oi=5;break e;case 7:Tt(L)?(oi=0,Hi=null,hh(h)):(oi=0,Hi=null,Zo(c,h,L,7));break;case 5:var J=null;switch(un.tag){case 26:J=un.memoizedState;case 5:case 27:var xe=un,we=xe.type,pt=xe.pendingProps;if(J?$p(J):po(we,pt)){oi=0,Hi=null;var Rt=xe.sibling;if(Rt!==null)un=Rt;else{var zt=xe.return;zt!==null?(un=zt,zc(zt)):un=null}break t}}oi=0,Hi=null,Zo(c,h,L,5);break;case 6:oi=0,Hi=null,Zo(c,h,L,6);break;case 8:Za(),In=6;break e;default:throw Error(i(462))}}so();break}catch(Bt){Fl(c,Bt)}while(!0);return Ni=ul=null,Kt.H=M,Kt.A=C,jt=y,un!==null?0:(Tn=null,Mn=0,Ie(),In)}function so(){for(;un!==null&&!d0();)gp(un)}function gp(c){var h=Dg(c.alternate,c,ys);c.memoizedProps=c.pendingProps,h===null?zc(c):un=h}function hh(c){var h=c,y=h.alternate;switch(h.tag){case 15:case 0:h=Ac(y,h,h.pendingProps,h.type,void 0,Mn);break;case 11:h=Ac(y,h,h.pendingProps,h.type.render,h.ref,Mn);break;case 5:X(h);default:cp(y,h),h=un=uo(h,ys),h=Dg(y,h,ys)}c.memoizedProps=c.pendingProps,h===null?zc(c):un=h}function Zo(c,h,y,M){Ni=ul=null,X(h),Hs=null,Zr=0;var C=h.return;try{if(Jf(c,C,h,y,Mn)){In=1,Rs(c,fe(y,c.current)),un=null;return}}catch(L){if(C!==null)throw un=C,L;In=1,Rs(c,fe(y,c.current)),un=null;return}h.flags&32768?(Fn||M===1?c=!0:Rr||(Mn&536870912)!==0?c=!1:(Jn=c=!0,(M===2||M===3||M===6)&&(M=Ar.current,M!==null&&M.tag===13&&(M.flags|=16384))),aa(h,c)):zc(h)}function zc(c){var h=c;do{if((h.flags&32768)!==0){aa(h,Jn);return}c=h.return;var y=Og(h.alternate,h,ys);if(y!==null){un=y;return}if(h=h.sibling,h!==null){un=h;return}un=h=c}while(h!==null);In===0&&(In=5)}function aa(c,h){do{var y=Lg(c.alternate,c);if(y!==null){y.flags&=32767,un=y;return}if(y=c.return,y!==null&&(y.flags|=32768,y.subtreeFlags=0,y.deletions=null),!h&&(c=c.sibling,c!==null)){un=c;return}un=c=y}while(c!==null);In=6,un=null}function fi(c,h,y,M,C,L,J,xe,we,pt){var Rt=Kt.T,zt=Qi();try{Ua(2),Kt.T=null,Dn(c,h,y,M,zt,C,L,J,xe,we,pt)}finally{Kt.T=Rt,Ua(zt)}}function Dn(c,h,y,M,C,L,J,xe){do ra();while(bo!==null);if((jt&6)!==0)throw Error(i(327));var we=c.finishedWork;if(M=c.finishedLanes,we===null)return null;if(c.finishedWork=null,c.finishedLanes=0,we===c.current)throw Error(i(177));c.callbackNode=null,c.callbackPriority=0,c.cancelPendingCommit=null;var pt=we.lanes|we.childLanes;if(pt|=ku,Y(c,M,pt,L,J,xe),c===Tn&&(un=Tn=null,Mn=0),(we.subtreeFlags&10256)===0&&(we.flags&10256)===0||Jr||(Jr=!0,kh=pt,tu=y,Ic(Nh,function(){return ra(),null})),y=(we.flags&15990)!==0,(we.subtreeFlags&15990)!==0||y?(y=Kt.T,Kt.T=null,L=Qi(),Ua(2),J=jt,jt|=4,Au(c,we),ko(we,c),Rp(c.containerInfo),c.current=we,rh(c,we.alternate,we),p0(),jt=J,Ua(L),Kt.T=y):c.current=we,Jr?(Jr=!1,bo=c,eu=M):oo(c,pt),pt=c.pendingLanes,pt===0&&(Ur=null),G(we.stateNode),Fe(c),h!==null)for(C=c.onRecoverableError,we=0;we<h.length;we++)pt=h[we],C(pt.value,{componentStack:pt.stack});return(eu&3)!==0&&ra(),pt=c.pendingLanes,(M&4194218)!==0&&(pt&42)!==0?c===Xa?nu++:(nu=0,Xa=c):nu=0,Ne(0),null}function oo(c,h){(c.pooledCacheLanes&=h)===0&&(h=c.pooledCache,h!=null&&(c.pooledCache=null,xu(h)))}function ra(){if(bo!==null){var c=bo,h=kh;kh=0;var y=ae(eu),M=32>y?32:y;y=Kt.T;var C=Qi();try{if(Ua(M),Kt.T=null,bo===null)var L=!1;else{M=tu,tu=null;var J=bo,xe=eu;if(bo=null,eu=0,(jt&6)!==0)throw Error(i(331));var we=jt;if(jt|=4,Nc(J.current),lh(J,J.current,xe,M),jt=we,Ne(0,!1),$a&&typeof $a.onPostCommitFiberRoot=="function")try{$a.onPostCommitFiberRoot(Gu,J)}catch{}L=!0}return L}finally{Ua(C),Kt.T=y,oo(c,h)}}return!1}function dh(c,h,y){h=fe(y,h),h=cs(c.stateNode,h,2),c=Xe(c,h,2),c!==null&&(q(c,2),Fe(c))}function Cn(c,h,y){if(c.tag===3)dh(c,c,y);else for(;h!==null;){if(h.tag===3){dh(h,c,y);break}else if(h.tag===1){var M=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(Ur===null||!Ur.has(M))){c=fe(y,c),y=Cs(2),M=Xe(h,y,2),M!==null&&(Ki(y,M,h,c),q(M,2),Fe(M));break}}h=h.return}}function ph(c,h,y){var M=c.pingCache;if(M===null){M=c.pingCache=new wn;var C=new Set;M.set(h,C)}else C=M.get(h),C===void 0&&(C=new Set,M.set(h,C));C.has(y)||(So=!0,C.add(y),c=Hg.bind(null,c,h,y),h.then(c,c))}function Hg(c,h,y){var M=c.pingCache;M!==null&&M.delete(h),c.pingedLanes|=c.suspendedLanes&y,c.warmLanes&=~y,Tn===c&&(Mn&y)===y&&(In===4||In===3&&(Mn&62914560)===Mn&&300>ya()-ks?(jt&2)===0&&hs(c,0):La|=y,Mo===Mn&&(Mo=0)),Fe(c)}function Hl(c,h){h===0&&(h=N()),c=Le(c,h),c!==null&&(q(c,h),Fe(c))}function Gl(c){var h=c.memoizedState,y=0;h!==null&&(y=h.retryLane),Hl(c,y)}function vp(c,h){var y=0;switch(c.tag){case 13:var M=c.stateNode,C=c.memoizedState;C!==null&&(y=C.retryLane);break;case 19:M=c.stateNode;break;case 22:M=c.stateNode._retryCache;break;default:throw Error(i(314))}M!==null&&M.delete(h),Hl(c,y)}function Ic(c,h){return Hu(c,h)}function yp(c,h,y,M){this.tag=c,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lo(c){return c=c.prototype,!(!c||!c.isReactComponent)}function wa(c,h){var y=c.alternate;return y===null?(y=t(c.tag,h,c.key,c.mode),y.elementType=c.elementType,y.type=c.type,y.stateNode=c.stateNode,y.alternate=c,c.alternate=y):(y.pendingProps=h,y.type=c.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=c.flags&31457280,y.childLanes=c.childLanes,y.lanes=c.lanes,y.child=c.child,y.memoizedProps=c.memoizedProps,y.memoizedState=c.memoizedState,y.updateQueue=c.updateQueue,h=c.dependencies,y.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},y.sibling=c.sibling,y.index=c.index,y.ref=c.ref,y.refCleanup=c.refCleanup,y}function uo(c,h){c.flags&=31457282;var y=c.alternate;return y===null?(c.childLanes=0,c.lanes=h,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=y.childLanes,c.lanes=y.lanes,c.child=y.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=y.memoizedProps,c.memoizedState=y.memoizedState,c.updateQueue=y.updateQueue,c.type=y.type,h=y.dependencies,c.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),c}function Yr(c,h,y,M,C,L){var J=0;if(M=c,typeof c=="function")lo(c)&&(J=1);else if(typeof c=="string")J=_r&&va?qp(c,y,oa.current)?26:Pu(c)?27:5:_r?qp(c,y,oa.current)?26:5:va&&Pu(c)?27:5;else e:switch(c){case Lu:return co(y.children,C,L,h);case bp:J=8,C|=24;break;case Ep:return c=t(12,y,h,C|2),c.elementType=Ep,c.lanes=L,c;case gh:return c=t(13,y,h,C),c.elementType=gh,c.lanes=L,c;case Jo:return c=t(19,y,h,C),c.elementType=Jo,c.lanes=L,c;case Fc:return mh(y,C,L,h);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case kg:case Ls:J=10;break e;case Qo:J=9;break e;case zu:J=11;break e;case Pc:J=14;break e;case ps:J=16,M=null;break e}J=29,y=Error(i(130,c===null?"null":typeof c,"")),M=null}return h=t(J,y,h,C),h.elementType=c,h.type=M,h.lanes=L,h}function co(c,h,y,M){return c=t(7,c,M,h),c.lanes=y,c}function mh(c,h,y,M){c=t(22,c,M,h),c.elementType=Fc,c.lanes=y;var C={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var L=C._current;if(L===null)throw Error(i(456));if((C._pendingVisibility&2)===0){var J=Le(L,2);J!==null&&(C._pendingVisibility|=2,Ca(J,L,2))}},attach:function(){var L=C._current;if(L===null)throw Error(i(456));if((C._pendingVisibility&2)!==0){var J=Le(L,2);J!==null&&(C._pendingVisibility&=-3,Ca(J,L,2))}}};return c.stateNode=C,c}function Ko(c,h,y){return c=t(6,c,null,h),c.lanes=y,c}function Ou(c,h,y){return h=t(4,c.children!==null?c.children:[],c.key,h),h.lanes=y,h.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},h}function Vl(c,h,y,M,C,L,J,xe){this.tag=1,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ql,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=z(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=z(0),this.hiddenUpdates=z(null),this.identifierPrefix=M,this.onUncaughtError=C,this.onCaughtError=L,this.onRecoverableError=J,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=xe,this.incompleteTransitions=new Map}function sa(c,h,y,M,C,L,J,xe,we,pt,Rt,zt){return c=new Vl(c,h,y,J,xe,we,pt,zt),h=1,L===!0&&(h|=24),L=t(3,null,null,h),c.current=L,L.stateNode=c,h=eh(),h.refCount++,c.pooledCache=h,h.refCount++,L.memoizedState={element:M,isDehydrated:y,cache:h},_t(L),c}function Bc(c){return c?(c=jl,c):jl}function _p(c){var h=c._reactInternals;if(h===void 0)throw typeof c.render=="function"?Error(i(188)):(c=Object.keys(c).join(","),Error(i(268,c)));return c=x(h),c=c!==null?b(c):null,c===null?null:Iu(c.stateNode)}function Gg(c,h,y,M,C,L){C=Bc(C),M.context===null?M.context=C:M.pendingContext=C,M=ke(h),M.payload={element:y},L=L===void 0?null:L,L!==null&&(M.callback=L),y=Xe(c,M,h),y!==null&&(Ca(y,c,h),lt(y,c,h))}function Vg(c,h){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var y=c.retryLane;c.retryLane=y!==0&&y<h?y:h}}function xp(c,h){Vg(c,h),(c=c.alternate)&&Vg(c,h)}var Wt={},Sp=Wf(),ma=Q2(),kl=Object.assign,Mp=Symbol.for("react.element"),fo=Symbol.for("react.transitional.element"),ds=Symbol.for("react.portal"),Lu=Symbol.for("react.fragment"),bp=Symbol.for("react.strict_mode"),Ep=Symbol.for("react.profiler"),kg=Symbol.for("react.provider"),Qo=Symbol.for("react.consumer"),Ls=Symbol.for("react.context"),zu=Symbol.for("react.forward_ref"),gh=Symbol.for("react.suspense"),Jo=Symbol.for("react.suspense_list"),Pc=Symbol.for("react.memo"),ps=Symbol.for("react.lazy"),Fc=Symbol.for("react.offscreen"),Xg=Symbol.for("react.memo_cache_sentinel"),Tp=Symbol.iterator,Xl=Symbol.for("react.client.reference"),Kt=Sp.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,vh,Ap,$o=!1,el=Array.isArray,yh=e.rendererVersion,Hc=e.rendererPackageName,Gc=e.extraDevToolsConfig,Iu=e.getPublicInstance,Yl=e.getRootHostContext,Yg=e.getChildHostContext,tl=e.prepareForCommit,Rp=e.resetAfterCommit,Cp=e.createInstance,zs=e.appendInitialChild,ho=e.finalizeInitialChildren,nl=e.shouldSetTextContent,_h=e.createTextInstance,wp=e.scheduleTimeout,Vc=e.cancelTimeout,ql=e.noTimeout,Is=e.isPrimaryRenderer;e.warnsIfNotActing;var ga=e.supportsMutation,vr=e.supportsPersistence,Ga=e.supportsHydration,Up=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var Dp=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Ua=e.setCurrentUpdatePriority,Qi=e.getCurrentUpdatePriority,qr=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var il=e.shouldAttemptEagerTransition,Np=e.detachDeletedInstance;e.requestPostPaintCallback;var qg=e.maySuspendCommit,po=e.preloadInstance,yr=e.startSuspendingCommit,Ci=e.suspendInstance,xh=e.waitForCommitToBeReady,Qa=e.NotPendingTransition,nn=e.HostTransitionContext,si=e.resetFormInstance;e.bindToConsole;var Yi=e.supportsMicrotasks,Sh=e.scheduleMicrotask,Bs=e.supportsTestSelectors,Wl=e.findFiberRoot,Mh=e.getBoundingRect,kc=e.getTextContent,Ps=e.isHiddenSubtree,R_=e.matchAccessibilityRole,wi=e.setFocusIfFocusable,Op=e.setupIntersectionObserver,Lp=e.appendChild,Wg=e.appendChildToContainer,jg=e.commitTextUpdate,C_=e.commitMount,zp=e.commitUpdate,Ip=e.insertBefore,Bp=e.insertInContainerBefore,Va=e.removeChild,Ii=e.removeChildFromContainer,Xc=e.resetTextContent,Yc=e.hideInstance,bh=e.hideTextInstance,Pp=e.unhideInstance,mo=e.unhideTextInstance,Eh=e.clearContainer,Fp=e.cloneInstance,Th=e.createContainerChildSet,Hp=e.appendChildToContainerChildSet,Zg=e.finalizeContainerChildren,Gp=e.replaceContainerChildren,Vp=e.cloneHiddenInstance,kp=e.cloneHiddenTextInstance,Ah=e.isSuspenseInstancePending,qc=e.isSuspenseInstanceFallback,Kg=e.getSuspenseInstanceFallbackErrorDetails,w_=e.registerSuspenseInstanceRetry,Qg=e.canHydrateFormStateMarker,Jg=e.isFormStateMarkerMatching,Xp=e.getNextHydratableSibling,Rh=e.getFirstHydratableChild,$g=e.getFirstHydratableChildWithinContainer,e0=e.getFirstHydratableChildWithinSuspenseInstance,t0=e.canHydrateInstance,n0=e.canHydrateTextInstance,i0=e.canHydrateSuspenseInstance,U_=e.hydrateInstance,a0=e.hydrateTextInstance,Bu=e.hydrateSuspenseInstance,r0=e.getNextHydratableInstanceAfterSuspenseInstance,Ch=e.commitHydratedContainer,wh=e.commitHydratedSuspenseInstance,s0=e.clearSuspenseBoundary,Yp=e.clearSuspenseBoundaryFromContainer,o0=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var l0=e.validateHydratableInstance,u0=e.validateHydratableTextInstance,_r=e.supportsResources,qp=e.isHostHoistableType,Uh=e.getHoistableRoot,Dh=e.getResource,Wp=e.acquireResource,jp=e.releaseResource,Zp=e.hydrateHoistable,Kp=e.mountHoistable,Qp=e.unmountHoistable,D_=e.createHoistableInstance,Jp=e.prepareToCommitHoistables,c0=e.mayResourceSuspendCommit,$p=e.preloadResource,em=e.suspendResource,va=e.supportsSingletons,tm=e.resolveSingletonInstance,N_=e.clearSingleton,O_=e.acquireSingletonInstance,f0=e.releaseSingletonInstance,Pu=e.isHostSingletonType,Wc=[],go=-1,jl={},Ja=Math.clz32?Math.clz32:D,jc=Math.log,h0=Math.LN2,Fu=128,Zc=4194304,Hu=ma.unstable_scheduleCallback,Kc=ma.unstable_cancelCallback,d0=ma.unstable_shouldYield,p0=ma.unstable_requestPaint,ya=ma.unstable_now,nm=ma.unstable_ImmediatePriority,m0=ma.unstable_UserBlockingPriority,Nh=ma.unstable_NormalPriority,Oh=ma.unstable_IdlePriority,g0=ma.log,im=ma.unstable_setDisableYieldValue,Gu=null,$a=null,xr=typeof Object.is=="function"?Object.is:ie,Lh=new WeakMap,_i=[],Ui=0,Qc=null,Jc=0,Sr=[],Mr=0,ms=null,Fs=1,Wr="",oa=T(null),$c=T(null),gs=T(null),Vu=T(null),Da=null,_a=null,Fn=!1,br=null,jr=!1,ef=Error(i(519)),Er=[],al=0,ku=0,Xu=null,Zl=null,tf=!1,nf=!1,vs=!1,rl=0,af=null,zh=0,er=0,sl=null,vo=!1,Yu=!1,rf=Object.prototype.hasOwnProperty,ni=Error(i(460)),am=Error(i(474)),Ih={then:function(){}},Kl=null,Hs=null,Zr=0,ol=An(!0),rm=An(!1),Gs=T(null),Tr=T(0),Ar=T(null),Kr=null,qi=T(0),Vs=0,mn=null,jn=null,Bi=null,Qr=!1,xi=!1,yo=!1,sf=0,Di=0,qu=null,v0=0,Bh=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},Hn={readContext:pa,use:te,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useLayoutEffect:Jt,useInsertionEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useSyncExternalStore:Jt,useId:Jt};Hn.useCacheRefresh=Jt,Hn.useMemoCache=Jt,Hn.useHostTransitionStatus=Jt,Hn.useFormState=Jt,Hn.useActionState=Jt,Hn.useOptimistic=Jt;var Wi={readContext:pa,use:te,useCallback:function(c,h){return ue().memoizedState=[c,h===void 0?null:h],c},useContext:pa,useEffect:Tl,useImperativeHandle:function(c,h,y){y=y!=null?y.concat([c]):null,El(4194308,4,Gr.bind(null,h,c),y)},useLayoutEffect:function(c,h){return El(4194308,4,c,h)},useInsertionEffect:function(c,h){El(4,2,c,h)},useMemo:function(c,h){var y=ue();h=h===void 0?null:h;var M=c();if(yo){ee(!0);try{c()}finally{ee(!1)}}return y.memoizedState=[M,h],M},useReducer:function(c,h,y){var M=ue();if(y!==void 0){var C=y(h);if(yo){ee(!0);try{y(h)}finally{ee(!1)}}}else C=h;return M.memoizedState=M.baseState=C,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:C},M.queue=c,c=c.dispatch=os.bind(null,mn,c),[M.memoizedState,c]},useRef:function(c){var h=ue();return c={current:c},h.memoizedState=c},useState:function(c){c=Ft(c);var h=c.queue,y=Ul.bind(null,mn,h);return h.dispatch=y,[c.memoizedState,y]},useDebugValue:rs,useDeferredValue:function(c,h){var y=ue();return Vr(y,c,h)},useTransition:function(){var c=Ft(!1);return c=wl.bind(null,mn,c.queue,!0,!1),ue().memoizedState=c,[!1,c]},useSyncExternalStore:function(c,h,y){var M=mn,C=ue();if(Fn){if(y===void 0)throw Error(i(407));y=y()}else{if(y=h(),Tn===null)throw Error(i(349));(Mn&60)!==0||At(M,h,y)}C.memoizedState=y;var L={value:y,getSnapshot:h};return C.queue=L,Tl($t.bind(null,M,L,c),[c]),M.flags|=2048,ki(9,Ht.bind(null,M,L,y,h),{destroy:void 0},null),y},useId:function(){var c=ue(),h=Tn.identifierPrefix;if(Fn){var y=Wr,M=Fs;y=(M&~(1<<32-Ja(M)-1)).toString(32)+y,h=":"+h+"R"+y,y=sf++,0<y&&(h+="H"+y.toString(32)),h+=":"}else y=v0++,h=":"+h+"r"+y.toString(32)+":";return c.memoizedState=h},useCacheRefresh:function(){return ue().memoizedState=$s.bind(null,mn)}};Wi.useMemoCache=Je,Wi.useHostTransitionStatus=ss,Wi.useFormState=Yn,Wi.useActionState=Yn,Wi.useOptimistic=function(c){var h=ue();h.memoizedState=h.baseState=c;var y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=y,h=Dl.bind(null,mn,!0,y),y.dispatch=h,[c,h]};var Na={readContext:pa,use:te,useCallback:Rl,useContext:pa,useEffect:as,useImperativeHandle:ha,useInsertionEffect:Ec,useLayoutEffect:Al,useMemo:hr,useReducer:ot,useRef:is,useState:function(){return ot(Qe)},useDebugValue:rs,useDeferredValue:function(c,h){var y=me();return Cl(y,jn.memoizedState,c,h)},useTransition:function(){var c=ot(Qe)[0],h=me().memoizedState;return[typeof c=="boolean"?c:ye(c),h]},useSyncExternalStore:Dt,useId:dr};Na.useCacheRefresh=Aa,Na.useMemoCache=Je,Na.useHostTransitionStatus=ss,Na.useFormState=ti,Na.useActionState=ti,Na.useOptimistic=function(c,h){var y=me();return Ct(y,jn,c,h)};var ll={readContext:pa,use:te,useCallback:Rl,useContext:pa,useEffect:as,useImperativeHandle:ha,useInsertionEffect:Ec,useLayoutEffect:Al,useMemo:hr,useReducer:St,useRef:is,useState:function(){return St(Qe)},useDebugValue:rs,useDeferredValue:function(c,h){var y=me();return jn===null?Vr(y,c,h):Cl(y,jn.memoizedState,c,h)},useTransition:function(){var c=St(Qe)[0],h=me().memoizedState;return[typeof c=="boolean"?c:ye(c),h]},useSyncExternalStore:Dt,useId:dr};ll.useCacheRefresh=Aa,ll.useMemoCache=Je,ll.useHostTransitionStatus=ss,ll.useFormState=Hr,ll.useActionState=Hr,ll.useOptimistic=function(c,h){var y=me();return jn!==null?Ct(y,jn,c,h):(y.baseState=c,[c,y.queue.dispatch])};var Ph={isMounted:function(c){return(c=c._reactInternals)?v(c)===c:!1},enqueueSetState:function(c,h,y){c=c._reactInternals;var M=Ha(),C=ke(M);C.payload=h,y!=null&&(C.callback=y),h=Xe(c,C,M),h!==null&&(Ca(h,c,M),lt(h,c,M))},enqueueReplaceState:function(c,h,y){c=c._reactInternals;var M=Ha(),C=ke(M);C.tag=1,C.payload=h,y!=null&&(C.callback=y),h=Xe(c,C,M),h!==null&&(Ca(h,c,M),lt(h,c,M))},enqueueForceUpdate:function(c,h){c=c._reactInternals;var y=Ha(),M=ke(y);M.tag=2,h!=null&&(M.callback=h),h=Xe(c,M,y),h!==null&&(Ca(h,c,y),lt(h,c,y))}},sm=typeof reportError=="function"?reportError:function(c){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof c=="object"&&c!==null&&typeof c.message=="string"?String(c.message):String(c),error:c});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",c);return}console.error(c)},y0=Error(i(461)),Pi=!1,Oa={dehydrated:null,treeContext:null,retryLane:0},tr=T(null),ul=null,Ni=null,_0=typeof AbortController<"u"?AbortController:function(){var c=[],h=this.signal={aborted:!1,addEventListener:function(y,M){c.push(M)}};this.abort=function(){h.aborted=!0,c.forEach(function(y){return y()})}},_o=ma.unstable_scheduleCallback,Ql=ma.unstable_NormalPriority,Kn={$$typeof:Ls,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Fh=Kt.S;Kt.S=function(c,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&Ae(c,h),Fh!==null&&Fh(c,h)};var xo=T(null),Ji=!1,Mi=!1,cl=!1,Wu=typeof WeakSet=="function"?WeakSet:Set,Oi=null,Jl=!1,Fi=null,nr=!1,ka=null,$l=8192,Hh={getCacheForType:function(c){var h=pa(Kn),y=h.data.get(c);return y===void 0&&(y=c(),h.data.set(c,y)),y}},of=0,Gh=1,Vh=2,zn=3,Qn=4;if(typeof Symbol=="function"&&Symbol.for){var gn=Symbol.for;of=gn("selector.component"),Gh=gn("selector.has_pseudo_class"),Vh=gn("selector.role"),zn=gn("selector.test_id"),Qn=gn("selector.text")}var wn=typeof WeakMap=="function"?WeakMap:Map,jt=0,Tn=null,un=null,Mn=0,oi=0,Hi=null,Jn=!1,Rr=!1,So=!1,ys=0,In=0,Cr=0,_s=0,La=0,ir=0,Mo=0,ju=null,wr=null,Zu=!1,ks=0,bi=1/0,xs=null,Ur=null,Jr=!1,bo=null,eu=0,kh=0,tu=null,nu=0,Xa=null;return Wt.attemptContinuousHydration=function(c){if(c.tag===13){var h=Le(c,67108864);h!==null&&Ca(h,c,67108864),xp(c,67108864)}},Wt.attemptHydrationAtCurrentPriority=function(c){if(c.tag===13){var h=Ha(),y=Le(c,h);y!==null&&Ca(y,c,h),xp(c,h)}},Wt.attemptSynchronousHydration=function(c){switch(c.tag){case 3:if(c=c.stateNode,c.current.memoizedState.isDehydrated){var h=U(c.pendingLanes);if(h!==0){for(c.pendingLanes|=2,c.entangledLanes|=2;h;){var y=1<<31-Ja(h);c.entanglements[1]|=y,h&=~y}Fe(c),(jt&6)===0&&(bi=ya()+500,Ne(0))}}break;case 13:h=Le(c,2),h!==null&&Ca(h,c,2),mp(),xp(c,2)}},Wt.batchedUpdates=function(c,h){return c(h)},Wt.createComponentSelector=function(c){return{$$typeof:of,value:c}},Wt.createContainer=function(c,h,y,M,C,L,J,xe,we,pt){return sa(c,h,!1,null,y,M,L,J,xe,we,pt,null)},Wt.createHasPseudoClassSelector=function(c){return{$$typeof:Gh,value:c}},Wt.createHydrationContainer=function(c,h,y,M,C,L,J,xe,we,pt,Rt,zt,Bt){return c=sa(y,M,!0,c,C,L,xe,we,pt,Rt,zt,Bt),c.context=Bc(null),y=c.current,M=Ha(),C=ke(M),C.callback=h??null,Xe(y,C,M),c.current.lanes=M,q(c,M),Fe(c),c},Wt.createPortal=function(c,h,y){var M=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ds,key:M==null?null:""+M,children:c,containerInfo:h,implementation:y}},Wt.createRoleSelector=function(c){return{$$typeof:Vh,value:c}},Wt.createTestNameSelector=function(c){return{$$typeof:zn,value:c}},Wt.createTextSelector=function(c){return{$$typeof:Qn,value:c}},Wt.defaultOnCaughtError=function(c){console.error(c)},Wt.defaultOnRecoverableError=function(c){sm(c)},Wt.defaultOnUncaughtError=function(c){sm(c)},Wt.deferredUpdates=function(c){var h=Kt.T,y=Qi();try{return Ua(32),Kt.T=null,c()}finally{Ua(y),Kt.T=h}},Wt.discreteUpdates=function(c,h,y,M,C){var L=Kt.T,J=Qi();try{return Ua(2),Kt.T=null,c(h,y,M,C)}finally{Ua(J),Kt.T=L,jt===0&&(bi=ya()+500)}},Wt.findAllNodes=Fa,Wt.findBoundingRects=function(c,h){if(!Bs)throw Error(i(363));h=Fa(c,h),c=[];for(var y=0;y<h.length;y++)c.push(Mh(h[y]));for(h=c.length-1;0<h;h--){y=c[h];for(var M=y.x,C=M+y.width,L=y.y,J=L+y.height,xe=h-1;0<=xe;xe--)if(h!==xe){var we=c[xe],pt=we.x,Rt=pt+we.width,zt=we.y,Bt=zt+we.height;if(M>=pt&&L>=zt&&C<=Rt&&J<=Bt){c.splice(h,1);break}else if(M!==pt||y.width!==we.width||Bt<L||zt>J){if(!(L!==zt||y.height!==we.height||Rt<M||pt>C)){pt>M&&(we.width+=pt-M,we.x=M),Rt<C&&(we.width=C-pt),c.splice(h,1);break}}else{zt>L&&(we.height+=zt-L,we.y=L),Bt<J&&(we.height=J-zt),c.splice(h,1);break}}}return c},Wt.findHostInstance=_p,Wt.findHostInstanceWithNoPortals=function(c){return c=x(c),c=c!==null?R(c):null,c===null?null:Iu(c.stateNode)},Wt.findHostInstanceWithWarning=function(c){return _p(c)},Wt.flushPassiveEffects=ra,Wt.flushSyncFromReconciler=function(c){var h=jt;jt|=1;var y=Kt.T,M=Qi();try{if(Ua(2),Kt.T=null,c)return c()}finally{Ua(M),Kt.T=y,jt=h,(jt&6)===0&&Ne(0)}},Wt.flushSyncWork=mp,Wt.focusWithin=function(c,h){if(!Bs)throw Error(i(363));for(c=ch(c),h=Pg(c,h),h=Array.from(h),c=0;c<h.length;){var y=h[c++],M=y.tag;if(!Ps(y)){if((M===5||M===26||M===27)&&wi(y.stateNode))return!0;for(y=y.child;y!==null;)h.push(y),y=y.sibling}}return!1},Wt.getFindAllNodesFailureDescription=function(c,h){if(!Bs)throw Error(i(363));var y=0,M=[];c=[ch(c),0];for(var C=0;C<c.length;){var L=c[C++],J=L.tag,xe=c[C++],we=h[xe];if((J!==5&&J!==26&&J!==27||!Ps(L))&&(Du(L,we)&&(M.push(jo(we)),xe++,xe>y&&(y=xe)),xe<h.length))for(L=L.child;L!==null;)c.push(L,xe),L=L.sibling}if(y<h.length){for(c=[];y<h.length;y++)c.push(jo(h[y]));return`findAllNodes was able to match part of the selector:
  `+(M.join(" > ")+`

No matching component was found for:
  `)+c.join(" > ")}return null},Wt.getPublicRootInstance=function(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 27:case 5:return Iu(c.child.stateNode);default:return c.child.stateNode}},Wt.injectIntoDevTools=function(){var c={bundleType:0,version:yh,rendererPackageName:Hc,currentDispatcherRef:Kt,findFiberByHostInstance:Up,reconcilerVersion:"19.0.0"};if(Gc!==null&&(c.rendererConfig=Gc),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")c=!1;else{var h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(h.isDisabled||!h.supportsFiber)c=!0;else{try{Gu=h.inject(c),$a=h}catch{}c=!!h.checkDCE}}return c},Wt.isAlreadyRendering=function(){return!1},Wt.observeVisibleRects=function(c,h,y,M){if(!Bs)throw Error(i(363));c=Fa(c,h);var C=Op(c,y,M).disconnect;return{disconnect:function(){C()}}},Wt.shouldError=function(){return null},Wt.shouldSuspend=function(){return!1},Wt.startHostTransition=function(c,h,y,M){if(c.tag!==5)throw Error(i(476));var C=Bo(c).queue;wl(c,C,h,Qa,y===null?n:function(){var L=Bo(c).next.queue;return kr(c,L,{},Ha()),y(M)})},Wt.updateContainer=function(c,h,y,M){var C=h.current,L=Ha();return Gg(C,L,c,h,y,M),L},Wt.updateContainerSync=function(c,h,y,M){return h.tag===0&&ra(),Gg(h.current,2,c,h,y,M),2},Wt},s.exports.default=s.exports,Object.defineProperty(s.exports,"__esModule",{value:!0})})(fx)),fx.exports}var mT;function _z(){return mT||(mT=1,cx.exports=yz()),cx.exports}var xz=_z();const Sz=dS(xz);var gT=Q2();function oM(s,e,t){if(!s)return;if(t(s)===!0)return s;let n=e?s.return:s.child;for(;n;){const i=oM(n,e,t);if(i)return i;n=e?null:n.sibling}}function J2(s){try{return Object.defineProperties(s,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return s}}const lM=J2(Ye.createContext(null));class $2 extends Ye.Component{render(){return Ye.createElement(lM.Provider,{value:this._reactInternals},this.props.children)}}function eR(){const s=Ye.useContext(lM);if(s===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=Ye.useId();return Ye.useMemo(()=>{for(const t of[s,s?.alternate]){if(!t)continue;const n=oM(t,!1,i=>{let a=i.memoizedState;for(;a;){if(a.memoizedState===e)return!0;a=a.next}});if(n)return n}},[s,e])}const Mz=Symbol.for("react.context"),bz=s=>s!==null&&typeof s=="object"&&"$$typeof"in s&&s.$$typeof===Mz;function Ez(){const s=eR(),[e]=Ye.useState(()=>new Map);e.clear();let t=s;for(;t;){const n=t.type;bz(n)&&n!==lM&&!e.has(n)&&e.set(n,Ye.use(J2(n))),t=t.return}return e}function Tz(){const s=Ez();return Ye.useMemo(()=>Array.from(s.keys()).reduce((e,t)=>n=>Ye.createElement(e,null,Ye.createElement(t.Provider,{...n,value:s.get(t)})),e=>Ye.createElement($2,{...e})),[s])}function tR(s){let e=s.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const nR=s=>s&&s.isOrthographicCamera,Az=s=>s&&s.hasOwnProperty("current"),Rz=s=>s!=null&&(typeof s=="string"||typeof s=="number"||s.isColor),Tg=((s,e)=>typeof window<"u"&&(((s=window.document)==null?void 0:s.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?Ye.useLayoutEffect:Ye.useEffect;function uM(s){const e=Ye.useRef(s);return Tg(()=>{e.current=s},[s]),e}function Cz(){const s=eR(),e=Tz();return Ye.useMemo(()=>({children:t})=>{const i=!!oM(s,!0,a=>a.type===Ye.StrictMode)?Ye.StrictMode:Ye.Fragment;return Lt.jsx(i,{children:Lt.jsx(e,{children:t})})},[s,e])}function wz({set:s}){return Tg(()=>(s(new Promise(()=>null)),()=>s(!1)),[s]),null}const Uz=(s=>(s=class extends Ye.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},s.getDerivedStateFromError=()=>({error:!0}),s))();function iR(s){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(s)?Math.min(Math.max(s[0],t),s[1]):s}function vd(s){var e;return(e=s.__r3f)==null?void 0:e.root.getState()}const Li={obj:s=>s===Object(s)&&!Li.arr(s)&&typeof s!="function",fun:s=>typeof s=="function",str:s=>typeof s=="string",num:s=>typeof s=="number",boo:s=>typeof s=="boolean",und:s=>s===void 0,nul:s=>s===null,arr:s=>Array.isArray(s),equ(s,e,{arrays:t="shallow",objects:n="reference",strict:i=!0}={}){if(typeof s!=typeof e||!!s!=!!e)return!1;if(Li.str(s)||Li.num(s)||Li.boo(s))return s===e;const a=Li.obj(s);if(a&&n==="reference")return s===e;const l=Li.arr(s);if(l&&t==="reference")return s===e;if((l||a)&&s===e)return!0;let u;for(u in s)if(!(u in e))return!1;if(a&&t==="shallow"&&n==="shallow"){for(u in i?e:s)if(!Li.equ(s[u],e[u],{strict:i,objects:"reference"}))return!1}else for(u in i?e:s)if(s[u]!==e[u])return!1;if(Li.und(u)){if(l&&s.length===0&&e.length===0||a&&Object.keys(s).length===0&&Object.keys(e).length===0)return!0;if(s!==e)return!1}return!0}};function Dz(s){const e={nodes:{},materials:{},meshes:{}};return s&&s.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function Nz(s){s.type!=="Scene"&&(s.dispose==null||s.dispose());for(const e in s){const t=s[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const aR=["children","key","ref"];function Oz(s){const e={};for(const t in s)aR.includes(t)||(e[t]=s[t]);return e}function Oy(s,e,t,n){const i=s;let a=i?.__r3f;return a||(a={root:e,type:t,parent:null,children:[],props:Oz(n),object:i,eventCount:0,handlers:{},isHidden:!1},i&&(i.__r3f=a)),a}function og(s,e){if(!e.includes("-"))return{root:s,key:e,target:s[e]};if(e in s)return{root:s,key:e,target:s[e]};let t=s;const n=e.split("-");for(const i of n){if(typeof t!="object"||t===null){if(t!==void 0){const a=n.slice(n.indexOf(i)).join("-");return{root:t,key:a,target:void 0}}return{root:s,key:e,target:void 0}}e=i,s=t,t=t[e]}return{root:s,key:e,target:t}}const vT=/-\d+$/;function Ly(s,e){if(Li.str(e.props.attach)){if(vT.test(e.props.attach)){const i=e.props.attach.replace(vT,""),{root:a,key:l}=og(s.object,i);Array.isArray(a[l])||(a[l]=[])}const{root:t,key:n}=og(s.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else Li.fun(e.props.attach)&&(e.previousAttach=e.props.attach(s.object,e.object))}function zy(s,e){if(Li.str(e.props.attach)){const{root:t,key:n}=og(s.object,e.props.attach),i=e.previousAttach;i===void 0?delete t[n]:t[n]=i}else e.previousAttach==null||e.previousAttach(s.object,e.object);delete e.previousAttach}const $x=[...aR,"args","dispose","attach","object","onUpdate","dispose"],yT=new Map;function Lz(s){let e=yT.get(s.constructor);try{e||(e=new s.constructor,yT.set(s.constructor,e))}catch{}return e}function zz(s,e){const t={};for(const n in e)if(!$x.includes(n)&&!Li.equ(e[n],s.props[n])){t[n]=e[n];for(const i in e)i.startsWith(`${n}-`)&&(t[i]=e[i])}for(const n in s.props){if($x.includes(n)||e.hasOwnProperty(n))continue;const{root:i,key:a}=og(s.object,n);if(i.constructor&&i.constructor.length===0){const l=Lz(i);Li.und(l)||(t[a]=l[a])}else t[a]=0}return t}const Iz=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],Bz=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function ml(s,e){var t;const n=s.__r3f,i=n&&tR(n).getState(),a=n?.eventCount;for(const u in e){let f=e[u];if($x.includes(u))continue;if(n&&Bz.test(u)){typeof f=="function"?n.handlers[u]=f:delete n.handlers[u],n.eventCount=Object.keys(n.handlers).length;continue}if(f===void 0)continue;let{root:p,key:m,target:v}=og(s,u);if(v===void 0&&(typeof p!="object"||p===null))throw Error(`R3F: Cannot set "${u}". Ensure it is an object before setting "${m}".`);if(v instanceof Fd&&f instanceof Fd)v.mask=f.mask;else if(v instanceof Nt&&Rz(f))v.set(f);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&typeof v.copy=="function"&&f!=null&&f.constructor&&v.constructor===f.constructor)v.copy(f);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&Array.isArray(f))typeof v.fromArray=="function"?v.fromArray(f):v.set(...f);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&typeof f=="number")typeof v.setScalar=="function"?v.setScalar(f):v.set(f);else{var l;p[m]=f,i&&!i.linear&&Iz.includes(m)&&(l=p[m])!=null&&l.isTexture&&p[m].format===na&&p[m].type===Pr&&(p[m].colorSpace=zi)}}if(n!=null&&n.parent&&i!=null&&i.internal&&(t=n.object)!=null&&t.isObject3D&&a!==n.eventCount){const u=n.object,f=i.internal.interaction.indexOf(u);f>-1&&i.internal.interaction.splice(f,1),n.eventCount&&u.raycast!==null&&i.internal.interaction.push(u)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&Zd(n),s}function Zd(s){var e;if(!s.parent)return;s.props.onUpdate==null||s.props.onUpdate(s.object);const t=(e=s.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function rR(s,e){s.manual||(nR(s)?(s.left=e.width/-2,s.right=e.width/2,s.top=e.height/2,s.bottom=e.height/-2):s.aspect=e.width/e.height,s.updateProjectionMatrix())}const Or=s=>s?.isObject3D;function wv(s){return(s.eventObject||s.object).uuid+"/"+s.index+s.instanceId}function sR(s,e,t,n){const i=t.get(e);i&&(t.delete(e),t.size===0&&(s.delete(n),i.target.releasePointerCapture(n)))}function Pz(s,e){const{internal:t}=s.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,i)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((n,i)=>{sR(t.capturedMap,e,n,i)})}function Fz(s){function e(f){const{internal:p}=s.getState(),m=f.offsetX-p.initialClick[0],v=f.offsetY-p.initialClick[1];return Math.round(Math.sqrt(m*m+v*v))}function t(f){return f.filter(p=>["Move","Over","Enter","Out","Leave"].some(m=>{var v;return(v=p.__r3f)==null?void 0:v.handlers["onPointer"+m]}))}function n(f,p){const m=s.getState(),v=new Set,_=[],x=p?p(m.internal.interaction):m.internal.interaction;for(let E=0;E<x.length;E++){const w=vd(x[E]);w&&(w.raycaster.camera=void 0)}m.previousRoot||m.events.compute==null||m.events.compute(f,m);function b(E){const w=vd(E);if(!w||!w.events.enabled||w.raycaster.camera===null)return[];if(w.raycaster.camera===void 0){var D;w.events.compute==null||w.events.compute(f,w,(D=w.previousRoot)==null?void 0:D.getState()),w.raycaster.camera===void 0&&(w.raycaster.camera=null)}return w.raycaster.camera?w.raycaster.intersectObject(E,!0):[]}let R=x.flatMap(b).sort((E,w)=>{const D=vd(E.object),U=vd(w.object);return!D||!U?E.distance-w.distance:U.events.priority-D.events.priority||E.distance-w.distance}).filter(E=>{const w=wv(E);return v.has(w)?!1:(v.add(w),!0)});m.events.filter&&(R=m.events.filter(R,m));for(const E of R){let w=E.object;for(;w;){var T;(T=w.__r3f)!=null&&T.eventCount&&_.push({...E,eventObject:w}),w=w.parent}}if("pointerId"in f&&m.internal.capturedMap.has(f.pointerId))for(let E of m.internal.capturedMap.get(f.pointerId).values())v.has(wv(E.intersection))||_.push(E.intersection);return _}function i(f,p,m,v){if(f.length){const _={stopped:!1};for(const x of f){let b=vd(x.object);if(b||x.object.traverseAncestors(R=>{const T=vd(R);if(T)return b=T,!1}),b){const{raycaster:R,pointer:T,camera:E,internal:w}=b,D=new ne(T.x,T.y,0).unproject(E),U=N=>{var z,q;return(z=(q=w.capturedMap.get(N))==null?void 0:q.has(x.eventObject))!=null?z:!1},I=N=>{const z={intersection:x,target:p.target};w.capturedMap.has(N)?w.capturedMap.get(N).set(x.eventObject,z):w.capturedMap.set(N,new Map([[x.eventObject,z]])),p.target.setPointerCapture(N)},O=N=>{const z=w.capturedMap.get(N);z&&sR(w.capturedMap,x.eventObject,z,N)};let P={};for(let N in p){let z=p[N];typeof z!="function"&&(P[N]=z)}let B={...x,...P,pointer:T,intersections:f,stopped:_.stopped,delta:m,unprojectedPoint:D,ray:R.ray,camera:E,stopPropagation(){const N="pointerId"in p&&w.capturedMap.get(p.pointerId);if((!N||N.has(x.eventObject))&&(B.stopped=_.stopped=!0,w.hovered.size&&Array.from(w.hovered.values()).find(z=>z.eventObject===x.eventObject))){const z=f.slice(0,f.indexOf(x));a([...z,x])}},target:{hasPointerCapture:U,setPointerCapture:I,releasePointerCapture:O},currentTarget:{hasPointerCapture:U,setPointerCapture:I,releasePointerCapture:O},nativeEvent:p};if(v(B),_.stopped===!0)break}}}return f}function a(f){const{internal:p}=s.getState();for(const m of p.hovered.values())if(!f.length||!f.find(v=>v.object===m.object&&v.index===m.index&&v.instanceId===m.instanceId)){const _=m.eventObject.__r3f;if(p.hovered.delete(wv(m)),_!=null&&_.eventCount){const x=_.handlers,b={...m,intersections:f};x.onPointerOut==null||x.onPointerOut(b),x.onPointerLeave==null||x.onPointerLeave(b)}}}function l(f,p){for(let m=0;m<p.length;m++){const v=p[m].__r3f;v==null||v.handlers.onPointerMissed==null||v.handlers.onPointerMissed(f)}}function u(f){switch(f){case"onPointerLeave":case"onPointerCancel":return()=>a([]);case"onLostPointerCapture":return p=>{const{internal:m}=s.getState();"pointerId"in p&&m.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{m.capturedMap.has(p.pointerId)&&(m.capturedMap.delete(p.pointerId),a([]))})}}return function(m){const{onPointerMissed:v,internal:_}=s.getState();_.lastEvent.current=m;const x=f==="onPointerMove",b=f==="onClick"||f==="onContextMenu"||f==="onDoubleClick",T=n(m,x?t:void 0),E=b?e(m):0;f==="onPointerDown"&&(_.initialClick=[m.offsetX,m.offsetY],_.initialHits=T.map(D=>D.eventObject)),b&&!T.length&&E<=2&&(l(m,_.interaction),v&&v(m)),x&&a(T);function w(D){const U=D.eventObject,I=U.__r3f;if(!(I!=null&&I.eventCount))return;const O=I.handlers;if(x){if(O.onPointerOver||O.onPointerEnter||O.onPointerOut||O.onPointerLeave){const P=wv(D),B=_.hovered.get(P);B?B.stopped&&D.stopPropagation():(_.hovered.set(P,D),O.onPointerOver==null||O.onPointerOver(D),O.onPointerEnter==null||O.onPointerEnter(D))}O.onPointerMove==null||O.onPointerMove(D)}else{const P=O[f];P?(!b||_.initialHits.includes(U))&&(l(m,_.interaction.filter(B=>!_.initialHits.includes(B))),P(D)):b&&_.initialHits.includes(U)&&l(m,_.interaction.filter(B=>!_.initialHits.includes(B)))}}i(T,m,E,w)}}return{handlePointer:u}}const _T=s=>!!(s!=null&&s.render),cM=Ye.createContext(null),Hz=(s,e)=>{const t=W2((u,f)=>{const p=new ne,m=new ne,v=new ne;function _(E=f().camera,w=m,D=f().size){const{width:U,height:I,top:O,left:P}=D,B=U/I;w.isVector3?v.copy(w):v.set(...w);const N=E.getWorldPosition(p).distanceTo(v);if(nR(E))return{width:U/E.zoom,height:I/E.zoom,top:O,left:P,factor:1,distance:N,aspect:B};{const z=E.fov*Math.PI/180,q=2*Math.tan(z/2)*N,Y=q*(U/I);return{width:Y,height:q,top:O,left:P,factor:U/Y,distance:N,aspect:B}}}let x;const b=E=>u(w=>({performance:{...w.performance,current:E}})),R=new ht;return{set:u,get:f,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(E=1)=>s(f(),E),advance:(E,w)=>e(E,w,f()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new $S,pointer:R,mouse:R,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const E=f();x&&clearTimeout(x),E.performance.current!==E.performance.min&&b(E.performance.min),x=setTimeout(()=>b(f().performance.max),E.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:_},setEvents:E=>u(w=>({...w,events:{...w.events,...E}})),setSize:(E,w,D=0,U=0)=>{const I=f().camera,O={width:E,height:w,top:D,left:U};u(P=>({size:O,viewport:{...P.viewport,..._(I,m,O)}}))},setDpr:E=>u(w=>{const D=iR(E);return{viewport:{...w.viewport,dpr:D,initialDpr:w.viewport.initialDpr||D}}}),setFrameloop:(E="always")=>{const w=f().clock;w.stop(),w.elapsedTime=0,E!=="never"&&(w.start(),w.elapsedTime=0),u(()=>({frameloop:E}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:Ye.createRef(),active:!1,frames:0,priority:0,subscribe:(E,w,D)=>{const U=f().internal;return U.priority=U.priority+(w>0?1:0),U.subscribers.push({ref:E,priority:w,store:D}),U.subscribers=U.subscribers.sort((I,O)=>I.priority-O.priority),()=>{const I=f().internal;I!=null&&I.subscribers&&(I.priority=I.priority-(w>0?1:0),I.subscribers=I.subscribers.filter(O=>O.ref!==E))}}}}}),n=t.getState();let i=n.size,a=n.viewport.dpr,l=n.camera;return t.subscribe(()=>{const{camera:u,size:f,viewport:p,gl:m,set:v}=t.getState();if(f.width!==i.width||f.height!==i.height||p.dpr!==a){i=f,a=p.dpr,rR(u,f),p.dpr>0&&m.setPixelRatio(p.dpr);const _=typeof HTMLCanvasElement<"u"&&m.domElement instanceof HTMLCanvasElement;m.setSize(f.width,f.height,_)}u!==l&&(l=u,v(_=>({viewport:{..._.viewport,..._.viewport.getCurrentViewport(u)}})))}),t.subscribe(u=>s(u)),t};function fM(){const s=Ye.useContext(cM);if(!s)throw new Error("R3F: Hooks can only be used within the Canvas component!");return s}function xa(s=t=>t,e){return fM()(s,e)}function Kd(s,e=0){const t=fM(),n=t.getState().internal.subscribe,i=uM(s);return Tg(()=>n(i,e,t),[e,n,t]),null}const xT=new WeakMap,Gz=s=>{var e;return typeof s=="function"&&(s==null||(e=s.prototype)==null?void 0:e.constructor)===s};function oR(s,e){return function(t,...n){let i;return Gz(t)?(i=xT.get(t),i||(i=new t,xT.set(t,i))):i=t,s&&s(i),Promise.all(n.map(a=>new Promise((l,u)=>i.load(a,f=>{Or(f?.scene)&&Object.assign(f,Dz(f.scene)),l(f)},e,f=>u(new Error(`Could not load ${a}: ${f?.message}`))))))}}function Ts(s,e,t,n){const i=Array.isArray(e)?e:[e],a=K2(oR(t,n),[s,...i],{equal:Li.equ});return Array.isArray(e)?a:a[0]}Ts.preload=function(s,e,t){const n=Array.isArray(e)?e:[e];return mz(oR(t),[s,...n])};Ts.clear=function(s,e){const t=Array.isArray(e)?e:[e];return gz([s,...t])};var Vz={version:"9.4.2"};function kz(s){const e=Sz(s);return e.injectIntoDevTools(),e}const lR=0,kd={},Xz=/^three(?=[A-Z])/,S_=s=>`${s[0].toUpperCase()}${s.slice(1)}`;let Yz=0;const qz=s=>typeof s=="function";function uR(s){if(qz(s)){const e=`${Yz++}`;return kd[e]=s,e}else Object.assign(kd,s)}function cR(s,e){const t=S_(s),n=kd[t];if(s!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(s==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function Wz(s,e,t){var n;return s=S_(s)in kd?s:s.replace(Xz,""),cR(s,e),s==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,Oy(e.object,t,s,e)}function jz(s){if(!s.isHidden){var e;s.props.attach&&(e=s.parent)!=null&&e.object?zy(s.parent,s):Or(s.object)&&(s.object.visible=!1),s.isHidden=!0,Zd(s)}}function fR(s){if(s.isHidden){var e;s.props.attach&&(e=s.parent)!=null&&e.object?Ly(s.parent,s):Or(s.object)&&s.props.visible!==!1&&(s.object.visible=!0),s.isHidden=!1,Zd(s)}}function hM(s,e,t){const n=e.root.getState();if(!(!s.parent&&s.object!==n.scene)){if(!e.object){var i,a;const l=kd[S_(e.type)];e.object=(i=e.props.object)!=null?i:new l(...(a=e.props.args)!=null?a:[]),e.object.__r3f=e}if(ml(e.object,e.props),e.props.attach)Ly(s,e);else if(Or(e.object)&&Or(s.object)){const l=s.object.children.indexOf(t?.object);if(t&&l!==-1){const u=s.object.children.indexOf(e.object);if(u!==-1){s.object.children.splice(u,1);const f=u<l?l-1:l;s.object.children.splice(f,0,e.object)}else e.object.parent=s.object,s.object.children.splice(l,0,e.object),e.object.dispatchEvent({type:"added"}),s.object.dispatchEvent({type:"childadded",child:e.object})}else s.object.add(e.object)}for(const l of e.children)hM(e,l);Zd(e)}}function px(s,e){e&&(e.parent=s,s.children.push(e),hM(s,e))}function ST(s,e,t){if(!e||!t)return;e.parent=s;const n=s.children.indexOf(t);n!==-1?s.children.splice(n,0,e):s.children.push(e),hM(s,e,t)}function hR(s){if(typeof s.dispose=="function"){const e=()=>{try{s.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():gT.unstable_scheduleCallback(gT.unstable_IdlePriority,e)}}function eS(s,e,t){if(!e)return;e.parent=null;const n=s.children.indexOf(e);n!==-1&&s.children.splice(n,1),e.props.attach?zy(s,e):Or(e.object)&&Or(s.object)&&(s.object.remove(e.object),Pz(tR(e),e.object));const i=e.props.dispose!==null&&t!==!1;for(let a=e.children.length-1;a>=0;a--){const l=e.children[a];eS(e,l,i)}e.children.length=0,delete e.object.__r3f,i&&e.type!=="primitive"&&e.object.type!=="Scene"&&hR(e.object),t===void 0&&Zd(e)}function Zz(s,e){for(const t of[s,s.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const Vv=[];function Kz(){for(const[t]of Vv){const n=t.parent;if(n){t.props.attach?zy(n,t):Or(t.object)&&Or(n.object)&&n.object.remove(t.object);for(const i of t.children)i.props.attach?zy(t,i):Or(i.object)&&Or(t.object)&&t.object.remove(i.object)}t.isHidden&&fR(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&hR(t.object)}for(const[t,n,i]of Vv){t.props=n;const a=t.parent;if(a){var s,e;const l=kd[S_(t.type)];t.object=(s=t.props.object)!=null?s:new l(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,Zz(i,t.object),ml(t.object,t.props),t.props.attach?Ly(a,t):Or(t.object)&&Or(a.object)&&a.object.add(t.object);for(const u of t.children)u.props.attach?Ly(t,u):Or(u.object)&&Or(t.object)&&t.object.add(u.object);Zd(t)}}Vv.length=0}const mx=()=>{},MT={};let Uv=lR;const Qz=0,Jz=4,Iy=kz({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:Wz,removeChild:eS,appendChild:px,appendInitialChild:px,insertBefore:ST,appendChildToContainer(s,e){const t=s.getState().scene.__r3f;!e||!t||px(t,e)},removeChildFromContainer(s,e){const t=s.getState().scene.__r3f;!e||!t||eS(t,e)},insertInContainerBefore(s,e,t){const n=s.getState().scene.__r3f;!e||!t||!n||ST(n,e,t)},getRootHostContext:()=>MT,getChildHostContext:()=>MT,commitUpdate(s,e,t,n,i){var a,l,u;cR(e,n);let f=!1;if((s.type==="primitive"&&t.object!==n.object||((a=n.args)==null?void 0:a.length)!==((l=t.args)==null?void 0:l.length)||(u=n.args)!=null&&u.some((m,v)=>{var _;return m!==((_=t.args)==null?void 0:_[v])}))&&(f=!0),f)Vv.push([s,{...n},i]);else{const m=zz(s,n);Object.keys(m).length&&(Object.assign(s.props,m),ml(s.object,m))}(i.sibling===null||(i.flags&Jz)===Qz)&&Kz()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:s=>s?.object,prepareForCommit:()=>null,preparePortalMount:s=>Oy(s.getState().scene,s,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:jz,unhideInstance:fR,createTextInstance:mx,hideTextInstance:mx,unhideTextInstance:mx,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:Ye.createContext(null),setCurrentUpdatePriority(s){Uv=s},getCurrentUpdatePriority(){return Uv},resolveUpdatePriority(){var s;if(Uv!==lR)return Uv;switch(typeof window<"u"&&((s=window.event)==null?void 0:s.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Pv.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Pv.ContinuousEventPriority;default:return Pv.DefaultEventPriority}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:Vz.version}),qf=new Map,yd={objects:"shallow",strict:!1};function $z(s,e){if(!e&&typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement&&s.parentElement){const{width:t,height:n,top:i,left:a}=s.parentElement.getBoundingClientRect();return{width:t,height:n,top:i,left:a}}else if(!e&&typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas)return{width:s.width,height:s.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function eI(s){const e=qf.get(s),t=e?.fiber,n=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,a=n||Hz(iS,ET),l=t||Iy.createContainer(a,Pv.ConcurrentRoot,null,!1,null,"",i,i,i,null);e||qf.set(s,{fiber:l,store:a});let u,f,p=!1,m=null;return{async configure(v={}){let _;m=new Promise(H=>_=H);let{gl:x,size:b,scene:R,events:T,onCreated:E,shadows:w=!1,linear:D=!1,flat:U=!1,legacy:I=!1,orthographic:O=!1,frameloop:P="always",dpr:B=[1,2],performance:N,raycaster:z,camera:q,onPointerMissed:Y}=v,Q=a.getState(),Z=Q.gl;if(!Q.gl){const H={canvas:s,powerPreference:"high-performance",antialias:!0,alpha:!0},W=typeof x=="function"?await x(H):x;_T(W)?Z=W:Z=new sM({...H,...x}),Q.set({gl:Z})}let ae=Q.raycaster;ae||Q.set({raycaster:ae=new iM});const{params:G,...ee}=z||{};if(Li.equ(ee,ae,yd)||ml(ae,{...ee}),Li.equ(G,ae.params,yd)||ml(ae,{params:{...ae.params,...G}}),!Q.camera||Q.camera===f&&!Li.equ(f,q,yd)){f=q;const H=q?.isCamera,W=H?q:O?new _l(0,0,0,0,.1,1e3):new Zi(75,0,.1,1e3);H||(W.position.z=5,q&&(ml(W,q),W.manual||("aspect"in q||"left"in q||"right"in q||"bottom"in q||"top"in q)&&(W.manual=!0,W.updateProjectionMatrix())),!Q.camera&&!(q!=null&&q.rotation)&&W.lookAt(0,0,0)),Q.set({camera:W}),ae.camera=W}if(!Q.scene){let H;R!=null&&R.isScene?(H=R,Oy(H,a,"",{})):(H=new gg,Oy(H,a,"",{}),R&&ml(H,R)),Q.set({scene:H})}T&&!Q.events.handlers&&Q.set({events:T(a)});const ie=$z(s,b);if(Li.equ(ie,Q.size,yd)||Q.setSize(ie.width,ie.height,ie.top,ie.left),B&&Q.viewport.dpr!==iR(B)&&Q.setDpr(B),Q.frameloop!==P&&Q.setFrameloop(P),Q.onPointerMissed||Q.set({onPointerMissed:Y}),N&&!Li.equ(N,Q.performance,yd)&&Q.set(H=>({performance:{...H.performance,...N}})),!Q.xr){var fe;const H=(de,ge)=>{const oe=a.getState();oe.frameloop!=="never"&&ET(de,!0,oe,ge)},W=()=>{const de=a.getState();de.gl.xr.enabled=de.gl.xr.isPresenting,de.gl.xr.setAnimationLoop(de.gl.xr.isPresenting?H:null),de.gl.xr.isPresenting||iS(de)},re={connect(){const de=a.getState().gl;de.xr.addEventListener("sessionstart",W),de.xr.addEventListener("sessionend",W)},disconnect(){const de=a.getState().gl;de.xr.removeEventListener("sessionstart",W),de.xr.removeEventListener("sessionend",W)}};typeof((fe=Z.xr)==null?void 0:fe.addEventListener)=="function"&&re.connect(),Q.set({xr:re})}if(Z.shadowMap){const H=Z.shadowMap.enabled,W=Z.shadowMap.type;if(Z.shadowMap.enabled=!!w,Li.boo(w))Z.shadowMap.type=Fm;else if(Li.str(w)){var ce;const re={basic:rA,percentage:Hy,soft:Fm,variance:wo};Z.shadowMap.type=(ce=re[w])!=null?ce:Fm}else Li.obj(w)&&Object.assign(Z.shadowMap,w);(H!==Z.shadowMap.enabled||W!==Z.shadowMap.type)&&(Z.shadowMap.needsUpdate=!0)}return On.enabled=!I,p||(Z.outputColorSpace=D?fa:zi,Z.toneMapping=U?yl:pS),Q.legacy!==I&&Q.set(()=>({legacy:I})),Q.linear!==D&&Q.set(()=>({linear:D})),Q.flat!==U&&Q.set(()=>({flat:U})),x&&!Li.fun(x)&&!_T(x)&&!Li.equ(x,Z,yd)&&ml(Z,x),u=E,p=!0,_(),this},render(v){return!p&&!m&&this.configure(),m.then(()=>{Iy.updateContainer(Lt.jsx(tI,{store:a,children:v,onCreated:u,rootElement:s}),l,null,()=>{})}),a},unmount(){dR(s)}}}function tI({store:s,children:e,onCreated:t,rootElement:n}){return Tg(()=>{const i=s.getState();i.set(a=>({internal:{...a.internal,active:!0}})),t&&t(i),s.getState().events.connected||i.events.connect==null||i.events.connect(n)},[]),Lt.jsx(cM.Provider,{value:s,children:e})}function dR(s,e){const t=qf.get(s),n=t?.fiber;if(n){const i=t?.store.getState();i&&(i.internal.active=!1),Iy.updateContainer(null,n,null,()=>{i&&setTimeout(()=>{try{var a,l,u,f;i.events.disconnect==null||i.events.disconnect(),(a=i.gl)==null||(l=a.renderLists)==null||l.dispose==null||l.dispose(),(u=i.gl)==null||u.forceContextLoss==null||u.forceContextLoss(),(f=i.gl)!=null&&f.xr&&i.xr.disconnect(),Nz(i.scene),qf.delete(s)}catch{}},500)})}}function nI(s,e,t){return Lt.jsx(iI,{children:s,container:e,state:t})}function iI({state:s={},children:e,container:t}){const{events:n,size:i,...a}=s,l=fM(),[u]=Ye.useState(()=>new iM),[f]=Ye.useState(()=>new ht),p=uM((v,_)=>{let x;if(_.camera&&i){const b=_.camera;x=v.viewport.getCurrentViewport(b,new ne,i),b!==v.camera&&rR(b,i)}return{...v,..._,scene:t,raycaster:u,pointer:f,mouse:f,previousRoot:l,events:{...v.events,..._.events,...n},size:{...v.size,...i},viewport:{...v.viewport,...x},setEvents:b=>_.set(R=>({...R,events:{...R.events,...b}}))}}),m=Ye.useMemo(()=>{const v=W2((x,b)=>({...a,set:x,get:b})),_=x=>v.setState(b=>p.current(x,b));return _(l.getState()),l.subscribe(_),v},[l,t]);return Lt.jsx(Lt.Fragment,{children:Iy.createPortal(Lt.jsx(cM.Provider,{value:m,children:e}),m,null)})}const aI=new Set,rI=new Set,sI=new Set;function gx(s,e){if(s.size)for(const{callback:t}of s.values())t(e)}function Wm(s,e){switch(s){case"before":return gx(aI,e);case"after":return gx(rI,e);case"tail":return gx(sI,e)}}let vx,yx;function tS(s,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof s=="number"&&(n=s-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=s),vx=e.internal.subscribers;for(let i=0;i<vx.length;i++)yx=vx[i],yx.ref.current(yx.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let By=!1,nS=!1,_x,bT,_d;function pR(s){bT=requestAnimationFrame(pR),By=!0,_x=0,Wm("before",s),nS=!0;for(const t of qf.values()){var e;_d=t.store.getState(),_d.internal.active&&(_d.frameloop==="always"||_d.internal.frames>0)&&!((e=_d.gl.xr)!=null&&e.isPresenting)&&(_x+=tS(s,_d))}if(nS=!1,Wm("after",s),_x===0)return Wm("tail",s),By=!1,cancelAnimationFrame(bT)}function iS(s,e=1){var t;if(!s)return qf.forEach(n=>iS(n.store.getState(),e));(t=s.gl.xr)!=null&&t.isPresenting||!s.internal.active||s.frameloop==="never"||(e>1?s.internal.frames=Math.min(60,s.internal.frames+e):nS?s.internal.frames=2:s.internal.frames=1,By||(By=!0,requestAnimationFrame(pR)))}function ET(s,e=!0,t,n){if(e&&Wm("before",s),t)tS(s,t,n);else for(const i of qf.values())tS(s,i.store.getState());e&&Wm("after",s)}const xx={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function oI(s){const{handlePointer:e}=Fz(s);return{priority:1,enabled:!0,compute(t,n,i){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(xx).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:i}=s.getState();(t=i.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{const{set:n,events:i}=s.getState();if(i.disconnect==null||i.disconnect(),n(a=>({events:{...a.events,connected:t}})),i.handlers)for(const a in i.handlers){const l=i.handlers[a],[u,f]=xx[a];t.addEventListener(u,l,{passive:f})}},disconnect:()=>{const{set:t,events:n}=s.getState();if(n.connected){if(n.handlers)for(const i in n.handlers){const a=n.handlers[i],[l]=xx[i];n.connected.removeEventListener(l,a)}t(i=>({events:{...i.events,connected:void 0}}))}}}}function TT(s,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>s(...n),e)}}function lI({debounce:s,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,l]=Ye.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),u=Ye.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a,orientationHandler:null}),f=s?typeof s=="number"?s:s.scroll:null,p=s?typeof s=="number"?s:s.resize:null,m=Ye.useRef(!1);Ye.useEffect(()=>(m.current=!0,()=>{m.current=!1}));const[v,_,x]=Ye.useMemo(()=>{const E=()=>{if(!u.current.element)return;const{left:w,top:D,width:U,height:I,bottom:O,right:P,x:B,y:N}=u.current.element.getBoundingClientRect(),z={left:w,top:D,width:U,height:I,bottom:O,right:P,x:B,y:N};u.current.element instanceof HTMLElement&&n&&(z.height=u.current.element.offsetHeight,z.width=u.current.element.offsetWidth),Object.freeze(z),m.current&&!hI(u.current.lastBounds,z)&&l(u.current.lastBounds=z)};return[E,p?TT(E,p):E,f?TT(E,f):E]},[l,n,f,p]);function b(){u.current.scrollContainers&&(u.current.scrollContainers.forEach(E=>E.removeEventListener("scroll",x,!0)),u.current.scrollContainers=null),u.current.resizeObserver&&(u.current.resizeObserver.disconnect(),u.current.resizeObserver=null),u.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",u.current.orientationHandler))}function R(){u.current.element&&(u.current.resizeObserver=new i(x),u.current.resizeObserver.observe(u.current.element),e&&u.current.scrollContainers&&u.current.scrollContainers.forEach(E=>E.addEventListener("scroll",x,{capture:!0,passive:!0})),u.current.orientationHandler=()=>{x()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",u.current.orientationHandler))}const T=E=>{!E||E===u.current.element||(b(),u.current.element=E,u.current.scrollContainers=mR(E),R())};return cI(x,!!e),uI(_),Ye.useEffect(()=>{b(),R()},[e,x,_]),Ye.useEffect(()=>b,[]),[T,a,v]}function uI(s){Ye.useEffect(()=>{const e=s;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[s])}function cI(s,e){Ye.useEffect(()=>{if(e){const t=s;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[s,e])}function mR(s){const e=[];if(!s||s===document.body)return e;const{overflow:t,overflowX:n,overflowY:i}=window.getComputedStyle(s);return[t,n,i].some(a=>a==="auto"||a==="scroll")&&e.push(s),[...e,...mR(s.parentElement)]}const fI=["x","y","top","bottom","left","right","width","height"],hI=(s,e)=>fI.every(t=>s[t]===e[t]);function dI({ref:s,children:e,fallback:t,resize:n,style:i,gl:a,events:l=oI,eventSource:u,eventPrefix:f,shadows:p,linear:m,flat:v,legacy:_,orthographic:x,frameloop:b,dpr:R,performance:T,raycaster:E,camera:w,scene:D,onPointerMissed:U,onCreated:I,...O}){Ye.useMemo(()=>uR(iz),[]);const P=Cz(),[B,N]=lI({scroll:!0,debounce:{scroll:50,resize:0},...n}),z=Ye.useRef(null),q=Ye.useRef(null);Ye.useImperativeHandle(s,()=>z.current);const Y=uM(U),[Q,Z]=Ye.useState(!1),[ae,G]=Ye.useState(!1);if(Q)throw Q;if(ae)throw ae;const ee=Ye.useRef(null);Tg(()=>{const fe=z.current;if(N.width>0&&N.height>0&&fe){ee.current||(ee.current=eI(fe));async function ce(){await ee.current.configure({gl:a,scene:D,events:l,shadows:p,linear:m,flat:v,legacy:_,orthographic:x,frameloop:b,dpr:R,performance:T,raycaster:E,camera:w,size:N,onPointerMissed:(...H)=>Y.current==null?void 0:Y.current(...H),onCreated:H=>{H.events.connect==null||H.events.connect(u?Az(u)?u.current:u:q.current),f&&H.setEvents({compute:(W,re)=>{const de=W[f+"X"],ge=W[f+"Y"];re.pointer.set(de/re.size.width*2-1,-(ge/re.size.height)*2+1),re.raycaster.setFromCamera(re.pointer,re.camera)}}),I?.(H)}}),ee.current.render(Lt.jsx(P,{children:Lt.jsx(Uz,{set:G,children:Lt.jsx(Ye.Suspense,{fallback:Lt.jsx(wz,{set:Z}),children:e??null})})}))}ce()}}),Ye.useEffect(()=>{const fe=z.current;if(fe)return()=>dR(fe)},[]);const ie=u?"none":"auto";return Lt.jsx("div",{ref:q,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ie,...i},...O,children:Lt.jsx("div",{ref:B,style:{width:"100%",height:"100%"},children:Lt.jsx("canvas",{ref:z,style:{display:"block"},children:t})})})}function pI(s){return Lt.jsx($2,{children:Lt.jsx(dI,{...s})})}function lg(){return lg=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},lg.apply(null,arguments)}function mI(s,e="pointer",t="auto",n=document.body){Ye.useEffect(()=>{if(s)return n.style.cursor=e,()=>{n.style.cursor=t}},[s])}const gR=parseInt(cg.replace(/\D+/g,""));var js=Uint8Array,pc=Uint16Array,aS=Uint32Array,vR=new js([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yR=new js([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),gI=new js([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_R=function(s,e){for(var t=new pc(31),n=0;n<31;++n)t[n]=e+=1<<s[n-1];for(var i=new aS(t[30]),n=1;n<30;++n)for(var a=t[n];a<t[n+1];++a)i[a]=a-t[n]<<5|n;return[t,i]},xR=_R(vR,2),SR=xR[0],vI=xR[1];SR[28]=258,vI[258]=28;var yI=_R(yR,0),_I=yI[0],rS=new pc(32768);for(var Ei=0;Ei<32768;++Ei){var cc=(Ei&43690)>>>1|(Ei&21845)<<1;cc=(cc&52428)>>>2|(cc&13107)<<2,cc=(cc&61680)>>>4|(cc&3855)<<4,rS[Ei]=((cc&65280)>>>8|(cc&255)<<8)>>>1}var jm=(function(s,e,t){for(var n=s.length,i=0,a=new pc(e);i<n;++i)++a[s[i]-1];var l=new pc(e);for(i=0;i<e;++i)l[i]=l[i-1]+a[i-1]<<1;var u;if(t){u=new pc(1<<e);var f=15-e;for(i=0;i<n;++i)if(s[i])for(var p=i<<4|s[i],m=e-s[i],v=l[s[i]-1]++<<m,_=v|(1<<m)-1;v<=_;++v)u[rS[v]>>>f]=p}else for(u=new pc(n),i=0;i<n;++i)s[i]&&(u[i]=rS[l[s[i]-1]++]>>>15-s[i]);return u}),Ag=new js(288);for(var Ei=0;Ei<144;++Ei)Ag[Ei]=8;for(var Ei=144;Ei<256;++Ei)Ag[Ei]=9;for(var Ei=256;Ei<280;++Ei)Ag[Ei]=7;for(var Ei=280;Ei<288;++Ei)Ag[Ei]=8;var MR=new js(32);for(var Ei=0;Ei<32;++Ei)MR[Ei]=5;var xI=jm(Ag,9,1),SI=jm(MR,5,1),Sx=function(s){for(var e=s[0],t=1;t<s.length;++t)s[t]>e&&(e=s[t]);return e},Co=function(s,e,t){var n=e/8|0;return(s[n]|s[n+1]<<8)>>(e&7)&t},Mx=function(s,e){var t=e/8|0;return(s[t]|s[t+1]<<8|s[t+2]<<16)>>(e&7)},MI=function(s){return(s/8|0)+(s&7&&1)},bI=function(s,e,t){(t==null||t>s.length)&&(t=s.length);var n=new(s instanceof pc?pc:s instanceof aS?aS:js)(t-e);return n.set(s.subarray(e,t)),n},EI=function(s,e,t){var n=s.length;if(!n||t&&!t.l&&n<5)return e||new js(0);var i=!e||t,a=!t||t.i;t||(t={}),e||(e=new js(n*3));var l=function(oe){var he=e.length;if(oe>he){var Ee=new js(Math.max(he*2,oe));Ee.set(e),e=Ee}},u=t.f||0,f=t.p||0,p=t.b||0,m=t.l,v=t.d,_=t.m,x=t.n,b=n*8;do{if(!m){t.f=u=Co(s,f,1);var R=Co(s,f+1,3);if(f+=3,R)if(R==1)m=xI,v=SI,_=9,x=5;else if(R==2){var D=Co(s,f,31)+257,U=Co(s,f+10,15)+4,I=D+Co(s,f+5,31)+1;f+=14;for(var O=new js(I),P=new js(19),B=0;B<U;++B)P[gI[B]]=Co(s,f+B*3,7);f+=U*3;for(var N=Sx(P),z=(1<<N)-1,q=jm(P,N,1),B=0;B<I;){var Y=q[Co(s,f,z)];f+=Y&15;var T=Y>>>4;if(T<16)O[B++]=T;else{var Q=0,Z=0;for(T==16?(Z=3+Co(s,f,3),f+=2,Q=O[B-1]):T==17?(Z=3+Co(s,f,7),f+=3):T==18&&(Z=11+Co(s,f,127),f+=7);Z--;)O[B++]=Q}}var ae=O.subarray(0,D),G=O.subarray(D);_=Sx(ae),x=Sx(G),m=jm(ae,_,1),v=jm(G,x,1)}else throw"invalid block type";else{var T=MI(f)+4,E=s[T-4]|s[T-3]<<8,w=T+E;if(w>n){if(a)throw"unexpected EOF";break}i&&l(p+E),e.set(s.subarray(T,w),p),t.b=p+=E,t.p=f=w*8;continue}if(f>b){if(a)throw"unexpected EOF";break}}i&&l(p+131072);for(var ee=(1<<_)-1,ie=(1<<x)-1,fe=f;;fe=f){var Q=m[Mx(s,f)&ee],ce=Q>>>4;if(f+=Q&15,f>b){if(a)throw"unexpected EOF";break}if(!Q)throw"invalid length/literal";if(ce<256)e[p++]=ce;else if(ce==256){fe=f,m=null;break}else{var H=ce-254;if(ce>264){var B=ce-257,W=vR[B];H=Co(s,f,(1<<W)-1)+SR[B],f+=W}var re=v[Mx(s,f)&ie],de=re>>>4;if(!re)throw"invalid distance";f+=re&15;var G=_I[de];if(de>3){var W=yR[de];G+=Mx(s,f)&(1<<W)-1,f+=W}if(f>b){if(a)throw"unexpected EOF";break}i&&l(p+131072);for(var ge=p+H;p<ge;p+=4)e[p]=e[p-G],e[p+1]=e[p+1-G],e[p+2]=e[p+2-G],e[p+3]=e[p+3-G];p=ge}}t.l=m,t.p=fe,t.b=p,m&&(u=1,t.m=_,t.d=v,t.n=x)}while(!u);return p==e.length?e:bI(e,0,p)},TI=new js(0),AI=function(s){if((s[0]&15)!=8||s[0]>>>4>7||(s[0]<<8|s[1])%31)throw"invalid zlib data";if(s[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Dv(s,e){return EI((AI(s),s.subarray(2,-4)),e)}var RI=typeof TextDecoder<"u"&&new TextDecoder,CI=0;try{RI.decode(TI,{stream:!0}),CI=1}catch{}const wI=s=>s&&s.isCubeTexture;class UI extends Si{constructor(e,t){var n,i;const a=wI(e),u=((i=a?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?i:1024)/4,f=Math.floor(Math.log2(u)),p=Math.pow(2,f),m=3*Math.max(p,112),v=4*p,_=[a?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/m}`,`#define CUBEUV_TEXEL_HEIGHT ${1/v}`,`#define CUBEUV_MAX_MIP ${f}.0`],x=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,b=_.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${gR>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,R={map:{value:e},height:{value:t?.height||15},radius:{value:t?.radius||100}},T=new Sg(1,16),E=new Fr({uniforms:R,fragmentShader:b,vertexShader:x,side:ur});super(T,E)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var DI=Object.defineProperty,NI=(s,e,t)=>e in s?DI(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,OI=(s,e,t)=>(NI(s,e+"",t),t);class LI{constructor(){OI(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const a=i.indexOf(t);a!==-1&&i.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let a=0,l=i.length;a<l;a++)i[a].call(this,e);e.target=null}}}var zI=Object.defineProperty,II=(s,e,t)=>e in s?zI(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,en=(s,e,t)=>(II(s,typeof e!="symbol"?e+"":e,t),t);const Nv=new jf,AT=new du,BI=Math.cos(70*(Math.PI/180)),RT=(s,e)=>(s%e+e)%e;let PI=class extends LI{constructor(e,t){super(),en(this,"object"),en(this,"domElement"),en(this,"enabled",!0),en(this,"target",new ne),en(this,"minDistance",0),en(this,"maxDistance",1/0),en(this,"minZoom",0),en(this,"maxZoom",1/0),en(this,"minPolarAngle",0),en(this,"maxPolarAngle",Math.PI),en(this,"minAzimuthAngle",-1/0),en(this,"maxAzimuthAngle",1/0),en(this,"enableDamping",!1),en(this,"dampingFactor",.05),en(this,"enableZoom",!0),en(this,"zoomSpeed",1),en(this,"enableRotate",!0),en(this,"rotateSpeed",1),en(this,"enablePan",!0),en(this,"panSpeed",1),en(this,"screenSpacePanning",!0),en(this,"keyPanSpeed",7),en(this,"zoomToCursor",!1),en(this,"autoRotate",!1),en(this,"autoRotateSpeed",2),en(this,"reverseOrbit",!1),en(this,"reverseHorizontalOrbit",!1),en(this,"reverseVerticalOrbit",!1),en(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),en(this,"mouseButtons",{LEFT:Af.ROTATE,MIDDLE:Af.DOLLY,RIGHT:Af.PAN}),en(this,"touches",{ONE:Rf.ROTATE,TWO:Rf.DOLLY_PAN}),en(this,"target0"),en(this,"position0"),en(this,"zoom0"),en(this,"_domElementKeyEvents",null),en(this,"getPolarAngle"),en(this,"getAzimuthalAngle"),en(this,"setPolarAngle"),en(this,"setAzimuthalAngle"),en(this,"getDistance"),en(this,"getZoomScale"),en(this,"listenToKeyEvents"),en(this,"stopListenToKeyEvents"),en(this,"saveState"),en(this,"reset"),en(this,"update"),en(this,"connect"),en(this,"dispose"),en(this,"dollyIn"),en(this,"dollyOut"),en(this,"getScale"),en(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>m.phi,this.getAzimuthalAngle=()=>m.theta,this.setPolarAngle=le=>{let Te=RT(le,2*Math.PI),ut=m.phi;ut<0&&(ut+=2*Math.PI),Te<0&&(Te+=2*Math.PI);let pe=Math.abs(Te-ut);2*Math.PI-pe<pe&&(Te<ut?Te+=2*Math.PI:ut+=2*Math.PI),v.phi=Te-ut,n.update()},this.setAzimuthalAngle=le=>{let Te=RT(le,2*Math.PI),ut=m.theta;ut<0&&(ut+=2*Math.PI),Te<0&&(Te+=2*Math.PI);let pe=Math.abs(Te-ut);2*Math.PI-pe<pe&&(Te<ut?Te+=2*Math.PI:ut+=2*Math.PI),v.theta=Te-ut,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=le=>{le.addEventListener("keydown",Ae),this._domElementKeyEvents=le},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Ae),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),f=u.NONE},this.update=(()=>{const le=new ne,Te=new ne(0,1,0),ut=new ua().setFromUnitVectors(e.up,Te),pe=ut.clone().invert(),_e=new ne,at=new ua,Tt=2*Math.PI;return function(){const Ge=n.object.position;ut.setFromUnitVectors(e.up,Te),pe.copy(ut).invert(),le.copy(Ge).sub(n.target),le.applyQuaternion(ut),m.setFromVector3(le),n.autoRotate&&f===u.NONE&&Z(Y()),n.enableDamping?(m.theta+=v.theta*n.dampingFactor,m.phi+=v.phi*n.dampingFactor):(m.theta+=v.theta,m.phi+=v.phi);let xt=n.minAzimuthAngle,wt=n.maxAzimuthAngle;isFinite(xt)&&isFinite(wt)&&(xt<-Math.PI?xt+=Tt:xt>Math.PI&&(xt-=Tt),wt<-Math.PI?wt+=Tt:wt>Math.PI&&(wt-=Tt),xt<=wt?m.theta=Math.max(xt,Math.min(wt,m.theta)):m.theta=m.theta>(xt+wt)/2?Math.max(xt,m.theta):Math.min(wt,m.theta)),m.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,m.phi)),m.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(x,n.dampingFactor):n.target.add(x),n.zoomToCursor&&N||n.object.isOrthographicCamera?m.radius=re(m.radius):m.radius=re(m.radius*_),le.setFromSpherical(m),le.applyQuaternion(pe),Ge.copy(n.target).add(le),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(v.theta*=1-n.dampingFactor,v.phi*=1-n.dampingFactor,x.multiplyScalar(1-n.dampingFactor)):(v.set(0,0,0),x.set(0,0,0));let Ut=!1;if(n.zoomToCursor&&N){let Pt=null;if(n.object instanceof Zi&&n.object.isPerspectiveCamera){const yn=le.length();Pt=re(yn*_);const An=yn-Pt;n.object.position.addScaledVector(P,An),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const yn=new ne(B.x,B.y,0);yn.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/_)),n.object.updateProjectionMatrix(),Ut=!0;const An=new ne(B.x,B.y,0);An.unproject(n.object),n.object.position.sub(An).add(yn),n.object.updateMatrixWorld(),Pt=le.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;Pt!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(Pt).add(n.object.position):(Nv.origin.copy(n.object.position),Nv.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Nv.direction))<BI?e.lookAt(n.target):(AT.setFromNormalAndCoplanarPoint(n.object.up,n.target),Nv.intersectPlane(AT,n.target))))}else n.object instanceof _l&&n.object.isOrthographicCamera&&(Ut=_!==1,Ut&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/_)),n.object.updateProjectionMatrix()));return _=1,N=!1,Ut||_e.distanceToSquared(n.object.position)>p||8*(1-at.dot(n.object.quaternion))>p?(n.dispatchEvent(i),_e.copy(n.object.position),at.copy(n.object.quaternion),Ut=!1,!0):!1}})(),this.connect=le=>{n.domElement=le,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",_t),n.domElement.addEventListener("pointerdown",yt),n.domElement.addEventListener("pointercancel",V),n.domElement.addEventListener("wheel",De)},this.dispose=()=>{var le,Te,ut,pe,_e,at;n.domElement&&(n.domElement.style.touchAction="auto"),(le=n.domElement)==null||le.removeEventListener("contextmenu",_t),(Te=n.domElement)==null||Te.removeEventListener("pointerdown",yt),(ut=n.domElement)==null||ut.removeEventListener("pointercancel",V),(pe=n.domElement)==null||pe.removeEventListener("wheel",De),(_e=n.domElement)==null||_e.ownerDocument.removeEventListener("pointermove",j),(at=n.domElement)==null||at.ownerDocument.removeEventListener("pointerup",V),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",Ae)};const n=this,i={type:"change"},a={type:"start"},l={type:"end"},u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let f=u.NONE;const p=1e-6,m=new Zx,v=new Zx;let _=1;const x=new ne,b=new ht,R=new ht,T=new ht,E=new ht,w=new ht,D=new ht,U=new ht,I=new ht,O=new ht,P=new ne,B=new ht;let N=!1;const z=[],q={};function Y(){return 2*Math.PI/60/60*n.autoRotateSpeed}function Q(){return Math.pow(.95,n.zoomSpeed)}function Z(le){n.reverseOrbit||n.reverseHorizontalOrbit?v.theta+=le:v.theta-=le}function ae(le){n.reverseOrbit||n.reverseVerticalOrbit?v.phi+=le:v.phi-=le}const G=(()=>{const le=new ne;return function(ut,pe){le.setFromMatrixColumn(pe,0),le.multiplyScalar(-ut),x.add(le)}})(),ee=(()=>{const le=new ne;return function(ut,pe){n.screenSpacePanning===!0?le.setFromMatrixColumn(pe,1):(le.setFromMatrixColumn(pe,0),le.crossVectors(n.object.up,le)),le.multiplyScalar(ut),x.add(le)}})(),ie=(()=>{const le=new ne;return function(ut,pe){const _e=n.domElement;if(_e&&n.object instanceof Zi&&n.object.isPerspectiveCamera){const at=n.object.position;le.copy(at).sub(n.target);let Tt=le.length();Tt*=Math.tan(n.object.fov/2*Math.PI/180),G(2*ut*Tt/_e.clientHeight,n.object.matrix),ee(2*pe*Tt/_e.clientHeight,n.object.matrix)}else _e&&n.object instanceof _l&&n.object.isOrthographicCamera?(G(ut*(n.object.right-n.object.left)/n.object.zoom/_e.clientWidth,n.object.matrix),ee(pe*(n.object.top-n.object.bottom)/n.object.zoom/_e.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function fe(le){n.object instanceof Zi&&n.object.isPerspectiveCamera||n.object instanceof _l&&n.object.isOrthographicCamera?_=le:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function ce(le){fe(_/le)}function H(le){fe(_*le)}function W(le){if(!n.zoomToCursor||!n.domElement)return;N=!0;const Te=n.domElement.getBoundingClientRect(),ut=le.clientX-Te.left,pe=le.clientY-Te.top,_e=Te.width,at=Te.height;B.x=ut/_e*2-1,B.y=-(pe/at)*2+1,P.set(B.x,B.y,1).unproject(n.object).sub(n.object.position).normalize()}function re(le){return Math.max(n.minDistance,Math.min(n.maxDistance,le))}function de(le){b.set(le.clientX,le.clientY)}function ge(le){W(le),U.set(le.clientX,le.clientY)}function oe(le){E.set(le.clientX,le.clientY)}function he(le){R.set(le.clientX,le.clientY),T.subVectors(R,b).multiplyScalar(n.rotateSpeed);const Te=n.domElement;Te&&(Z(2*Math.PI*T.x/Te.clientHeight),ae(2*Math.PI*T.y/Te.clientHeight)),b.copy(R),n.update()}function Ee(le){I.set(le.clientX,le.clientY),O.subVectors(I,U),O.y>0?ce(Q()):O.y<0&&H(Q()),U.copy(I),n.update()}function We(le){w.set(le.clientX,le.clientY),D.subVectors(w,E).multiplyScalar(n.panSpeed),ie(D.x,D.y),E.copy(w),n.update()}function rt(le){W(le),le.deltaY<0?H(Q()):le.deltaY>0&&ce(Q()),n.update()}function st(le){let Te=!1;switch(le.code){case n.keys.UP:ie(0,n.keyPanSpeed),Te=!0;break;case n.keys.BOTTOM:ie(0,-n.keyPanSpeed),Te=!0;break;case n.keys.LEFT:ie(n.keyPanSpeed,0),Te=!0;break;case n.keys.RIGHT:ie(-n.keyPanSpeed,0),Te=!0;break}Te&&(le.preventDefault(),n.update())}function et(){if(z.length==1)b.set(z[0].pageX,z[0].pageY);else{const le=.5*(z[0].pageX+z[1].pageX),Te=.5*(z[0].pageY+z[1].pageY);b.set(le,Te)}}function se(){if(z.length==1)E.set(z[0].pageX,z[0].pageY);else{const le=.5*(z[0].pageX+z[1].pageX),Te=.5*(z[0].pageY+z[1].pageY);E.set(le,Te)}}function Ie(){const le=z[0].pageX-z[1].pageX,Te=z[0].pageY-z[1].pageY,ut=Math.sqrt(le*le+Te*Te);U.set(0,ut)}function Oe(){n.enableZoom&&Ie(),n.enablePan&&se()}function Ue(){n.enableZoom&&Ie(),n.enableRotate&&et()}function Le(le){if(z.length==1)R.set(le.pageX,le.pageY);else{const ut=lt(le),pe=.5*(le.pageX+ut.x),_e=.5*(le.pageY+ut.y);R.set(pe,_e)}T.subVectors(R,b).multiplyScalar(n.rotateSpeed);const Te=n.domElement;Te&&(Z(2*Math.PI*T.x/Te.clientHeight),ae(2*Math.PI*T.y/Te.clientHeight)),b.copy(R)}function ze(le){if(z.length==1)w.set(le.pageX,le.pageY);else{const Te=lt(le),ut=.5*(le.pageX+Te.x),pe=.5*(le.pageY+Te.y);w.set(ut,pe)}D.subVectors(w,E).multiplyScalar(n.panSpeed),ie(D.x,D.y),E.copy(w)}function Pe(le){const Te=lt(le),ut=le.pageX-Te.x,pe=le.pageY-Te.y,_e=Math.sqrt(ut*ut+pe*pe);I.set(0,_e),O.set(0,Math.pow(I.y/U.y,n.zoomSpeed)),ce(O.y),U.copy(I)}function Fe(le){n.enableZoom&&Pe(le),n.enablePan&&ze(le)}function Ne(le){n.enableZoom&&Pe(le),n.enableRotate&&Le(le)}function yt(le){var Te,ut;n.enabled!==!1&&(z.length===0&&((Te=n.domElement)==null||Te.ownerDocument.addEventListener("pointermove",j),(ut=n.domElement)==null||ut.ownerDocument.addEventListener("pointerup",V)),bt(le),le.pointerType==="touch"?gt(le):ve(le))}function j(le){n.enabled!==!1&&(le.pointerType==="touch"?ct(le):Be(le))}function V(le){var Te,ut,pe;ke(le),z.length===0&&((Te=n.domElement)==null||Te.releasePointerCapture(le.pointerId),(ut=n.domElement)==null||ut.ownerDocument.removeEventListener("pointermove",j),(pe=n.domElement)==null||pe.ownerDocument.removeEventListener("pointerup",V)),n.dispatchEvent(l),f=u.NONE}function ve(le){let Te;switch(le.button){case 0:Te=n.mouseButtons.LEFT;break;case 1:Te=n.mouseButtons.MIDDLE;break;case 2:Te=n.mouseButtons.RIGHT;break;default:Te=-1}switch(Te){case Af.DOLLY:if(n.enableZoom===!1)return;ge(le),f=u.DOLLY;break;case Af.ROTATE:if(le.ctrlKey||le.metaKey||le.shiftKey){if(n.enablePan===!1)return;oe(le),f=u.PAN}else{if(n.enableRotate===!1)return;de(le),f=u.ROTATE}break;case Af.PAN:if(le.ctrlKey||le.metaKey||le.shiftKey){if(n.enableRotate===!1)return;de(le),f=u.ROTATE}else{if(n.enablePan===!1)return;oe(le),f=u.PAN}break;default:f=u.NONE}f!==u.NONE&&n.dispatchEvent(a)}function Be(le){if(n.enabled!==!1)switch(f){case u.ROTATE:if(n.enableRotate===!1)return;he(le);break;case u.DOLLY:if(n.enableZoom===!1)return;Ee(le);break;case u.PAN:if(n.enablePan===!1)return;We(le);break}}function De(le){n.enabled===!1||n.enableZoom===!1||f!==u.NONE&&f!==u.ROTATE||(le.preventDefault(),n.dispatchEvent(a),rt(le),n.dispatchEvent(l))}function Ae(le){n.enabled===!1||n.enablePan===!1||st(le)}function gt(le){switch(Xe(le),z.length){case 1:switch(n.touches.ONE){case Rf.ROTATE:if(n.enableRotate===!1)return;et(),f=u.TOUCH_ROTATE;break;case Rf.PAN:if(n.enablePan===!1)return;se(),f=u.TOUCH_PAN;break;default:f=u.NONE}break;case 2:switch(n.touches.TWO){case Rf.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Oe(),f=u.TOUCH_DOLLY_PAN;break;case Rf.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Ue(),f=u.TOUCH_DOLLY_ROTATE;break;default:f=u.NONE}break;default:f=u.NONE}f!==u.NONE&&n.dispatchEvent(a)}function ct(le){switch(Xe(le),f){case u.TOUCH_ROTATE:if(n.enableRotate===!1)return;Le(le),n.update();break;case u.TOUCH_PAN:if(n.enablePan===!1)return;ze(le),n.update();break;case u.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Fe(le),n.update();break;case u.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Ne(le),n.update();break;default:f=u.NONE}}function _t(le){n.enabled!==!1&&le.preventDefault()}function bt(le){z.push(le)}function ke(le){delete q[le.pointerId];for(let Te=0;Te<z.length;Te++)if(z[Te].pointerId==le.pointerId){z.splice(Te,1);return}}function Xe(le){let Te=q[le.pointerId];Te===void 0&&(Te=new ht,q[le.pointerId]=Te),Te.set(le.pageX,le.pageY)}function lt(le){const Te=le.pointerId===z[0].pointerId?z[1]:z[0];return q[Te.pointerId]}this.dollyIn=(le=Q())=>{H(le),n.update()},this.dollyOut=(le=Q())=>{ce(le),n.update()},this.getScale=()=>_,this.setScale=le=>{fe(le),n.update()},this.getZoomScale=()=>Q(),t!==void 0&&this.connect(t),this.update()}};class FI extends qS{constructor(e){super(e),this.type=Ia}parse(e){const l=function(B,N){switch(B){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(N||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(N||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(N||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(N||""))}},v=function(B,N,z){N=N||1024;let Y=B.pos,Q=-1,Z=0,ae="",G=String.fromCharCode.apply(null,new Uint16Array(B.subarray(Y,Y+128)));for(;0>(Q=G.indexOf(`
`))&&Z<N&&Y<B.byteLength;)ae+=G,Z+=G.length,Y+=128,G+=String.fromCharCode.apply(null,new Uint16Array(B.subarray(Y,Y+128)));return-1<Q?(B.pos+=Z+Q+1,ae+G.slice(0,Q)):!1},_=function(B){const N=/^#\?(\S+)/,z=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,q=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,Y=/^\s*FORMAT=(\S+)\s*$/,Q=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,Z={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let ae,G;for((B.pos>=B.byteLength||!(ae=v(B)))&&l(1,"no header found"),(G=ae.match(N))||l(3,"bad initial token"),Z.valid|=1,Z.programtype=G[1],Z.string+=ae+`
`;ae=v(B),ae!==!1;){if(Z.string+=ae+`
`,ae.charAt(0)==="#"){Z.comments+=ae+`
`;continue}if((G=ae.match(z))&&(Z.gamma=parseFloat(G[1])),(G=ae.match(q))&&(Z.exposure=parseFloat(G[1])),(G=ae.match(Y))&&(Z.valid|=2,Z.format=G[1]),(G=ae.match(Q))&&(Z.valid|=4,Z.height=parseInt(G[1],10),Z.width=parseInt(G[2],10)),Z.valid&2&&Z.valid&4)break}return Z.valid&2||l(3,"missing format specifier"),Z.valid&4||l(3,"missing image size specifier"),Z},x=function(B,N,z){const q=N;if(q<8||q>32767||B[0]!==2||B[1]!==2||B[2]&128)return new Uint8Array(B);q!==(B[2]<<8|B[3])&&l(3,"wrong scanline width");const Y=new Uint8Array(4*N*z);Y.length||l(4,"unable to allocate buffer space");let Q=0,Z=0;const ae=4*q,G=new Uint8Array(4),ee=new Uint8Array(ae);let ie=z;for(;ie>0&&Z<B.byteLength;){Z+4>B.byteLength&&l(1),G[0]=B[Z++],G[1]=B[Z++],G[2]=B[Z++],G[3]=B[Z++],(G[0]!=2||G[1]!=2||(G[2]<<8|G[3])!=q)&&l(3,"bad rgbe scanline format");let fe=0,ce;for(;fe<ae&&Z<B.byteLength;){ce=B[Z++];const W=ce>128;if(W&&(ce-=128),(ce===0||fe+ce>ae)&&l(3,"bad scanline data"),W){const re=B[Z++];for(let de=0;de<ce;de++)ee[fe++]=re}else ee.set(B.subarray(Z,Z+ce),fe),fe+=ce,Z+=ce}const H=q;for(let W=0;W<H;W++){let re=0;Y[Q]=ee[W+re],re+=q,Y[Q+1]=ee[W+re],re+=q,Y[Q+2]=ee[W+re],re+=q,Y[Q+3]=ee[W+re],Q+=4}ie--}return Y},b=function(B,N,z,q){const Y=B[N+3],Q=Math.pow(2,Y-128)/255;z[q+0]=B[N+0]*Q,z[q+1]=B[N+1]*Q,z[q+2]=B[N+2]*Q,z[q+3]=1},R=function(B,N,z,q){const Y=B[N+3],Q=Math.pow(2,Y-128)/255;z[q+0]=Lf.toHalfFloat(Math.min(B[N+0]*Q,65504)),z[q+1]=Lf.toHalfFloat(Math.min(B[N+1]*Q,65504)),z[q+2]=Lf.toHalfFloat(Math.min(B[N+2]*Q,65504)),z[q+3]=Lf.toHalfFloat(1)},T=new Uint8Array(e);T.pos=0;const E=_(T),w=E.width,D=E.height,U=x(T.subarray(T.pos),w,D);let I,O,P;switch(this.type){case Vi:P=U.length/4;const B=new Float32Array(P*4);for(let z=0;z<P;z++)b(U,z*4,B,z*4);I=B,O=Vi;break;case Ia:P=U.length/4;const N=new Uint16Array(P*4);for(let z=0;z<P;z++)R(U,z*4,N,z*4);I=N,O=Ia;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:w,height:D,data:I,header:E.string,gamma:E.gamma,exposure:E.exposure,type:O}}setDataType(e){return this.type=e,this}load(e,t,n,i){function a(l,u){switch(l.type){case Vi:case Ia:"colorSpace"in l?l.colorSpace="srgb-linear":l.encoding=3e3,l.minFilter=Wn,l.magFilter=Wn,l.generateMipmaps=!1,l.flipY=!0;break}t&&t(l,u)}return super.load(e,a,n,i)}}const Dm=gR>=152;class HI extends qS{constructor(e){super(e),this.type=Ia}parse(e){const N=Math.pow(2.7182818,2.2);function z(k,$){for(var Me=0,qe=0;qe<65536;++qe)(qe==0||k[qe>>3]&1<<(qe&7))&&($[Me++]=qe);for(var tt=Me-1;Me<65536;)$[Me++]=0;return tt}function q(k){for(var $=0;$<16384;$++)k[$]={},k[$].len=0,k[$].lit=0,k[$].p=null}const Y={l:0,c:0,lc:0};function Q(k,$,Me,qe,tt){for(;Me<k;)$=$<<8|lt(qe,tt),Me+=8;Me-=k,Y.l=$>>Me&(1<<k)-1,Y.c=$,Y.lc=Me}const Z=new Array(59);function ae(k){for(var $=0;$<=58;++$)Z[$]=0;for(var $=0;$<65537;++$)Z[k[$]]+=1;for(var Me=0,$=58;$>0;--$){var qe=Me+Z[$]>>1;Z[$]=Me,Me=qe}for(var $=0;$<65537;++$){var tt=k[$];tt>0&&(k[$]=tt|Z[tt]++<<6)}}function G(k,$,Me,qe,tt,$e,Mt){for(var X=Me,ue=0,me=0;tt<=$e;tt++){if(X.value-Me.value>qe)return!1;Q(6,ue,me,k,X);var ye=Y.l;if(ue=Y.c,me=Y.lc,Mt[tt]=ye,ye==63){if(X.value-Me.value>qe)throw"Something wrong with hufUnpackEncTable";Q(8,ue,me,k,X);var te=Y.l+6;if(ue=Y.c,me=Y.lc,tt+te>$e+1)throw"Something wrong with hufUnpackEncTable";for(;te--;)Mt[tt++]=0;tt--}else if(ye>=59){var te=ye-59+2;if(tt+te>$e+1)throw"Something wrong with hufUnpackEncTable";for(;te--;)Mt[tt++]=0;tt--}}ae(Mt)}function ee(k){return k&63}function ie(k){return k>>6}function fe(k,$,Me,qe){for(;$<=Me;$++){var tt=ie(k[$]),$e=ee(k[$]);if(tt>>$e)throw"Invalid table entry";if($e>14){var Mt=qe[tt>>$e-14];if(Mt.len)throw"Invalid table entry";if(Mt.lit++,Mt.p){var X=Mt.p;Mt.p=new Array(Mt.lit);for(var ue=0;ue<Mt.lit-1;++ue)Mt.p[ue]=X[ue]}else Mt.p=new Array(1);Mt.p[Mt.lit-1]=$}else if($e)for(var me=0,ue=1<<14-$e;ue>0;ue--){var Mt=qe[(tt<<14-$e)+me];if(Mt.len||Mt.p)throw"Invalid table entry";Mt.len=$e,Mt.lit=$,me++}}return!0}const ce={c:0,lc:0};function H(k,$,Me,qe){k=k<<8|lt(Me,qe),$+=8,ce.c=k,ce.lc=$}const W={c:0,lc:0};function re(k,$,Me,qe,tt,$e,Mt,X,ue,me){if(k==$){qe<8&&(H(Me,qe,tt,Mt),Me=ce.c,qe=ce.lc),qe-=8;var ye=Me>>qe,ye=new Uint8Array([ye])[0];if(ue.value+ye>me)return!1;for(var te=X[ue.value-1];ye-- >0;)X[ue.value++]=te}else if(ue.value<me)X[ue.value++]=k;else return!1;W.c=Me,W.lc=qe}function de(k){return k&65535}function ge(k){var $=de(k);return $>32767?$-65536:$}const oe={a:0,b:0};function he(k,$){var Me=ge(k),qe=ge($),tt=qe,$e=Me+(tt&1)+(tt>>1),Mt=$e,X=$e-tt;oe.a=Mt,oe.b=X}function Ee(k,$){var Me=de(k),qe=de($),tt=Me-(qe>>1)&65535,$e=qe+tt-32768&65535;oe.a=$e,oe.b=tt}function We(k,$,Me,qe,tt,$e,Mt){for(var X=Mt<16384,ue=Me>tt?tt:Me,me=1,ye;me<=ue;)me<<=1;for(me>>=1,ye=me,me>>=1;me>=1;){for(var te=0,Je=te+$e*(tt-ye),Qe=$e*me,ot=$e*ye,dt=qe*me,St=qe*ye,Dt,At,Ht,$t;te<=Je;te+=ot){for(var kt=te,sn=te+qe*(Me-ye);kt<=sn;kt+=St){var Ft=kt+dt,Ct=kt+Qe,cn=Ct+dt;X?(he(k[kt+$],k[Ct+$]),Dt=oe.a,Ht=oe.b,he(k[Ft+$],k[cn+$]),At=oe.a,$t=oe.b,he(Dt,At),k[kt+$]=oe.a,k[Ft+$]=oe.b,he(Ht,$t),k[Ct+$]=oe.a,k[cn+$]=oe.b):(Ee(k[kt+$],k[Ct+$]),Dt=oe.a,Ht=oe.b,Ee(k[Ft+$],k[cn+$]),At=oe.a,$t=oe.b,Ee(Dt,At),k[kt+$]=oe.a,k[Ft+$]=oe.b,Ee(Ht,$t),k[Ct+$]=oe.a,k[cn+$]=oe.b)}if(Me&me){var Ct=kt+Qe;X?he(k[kt+$],k[Ct+$]):Ee(k[kt+$],k[Ct+$]),Dt=oe.a,k[Ct+$]=oe.b,k[kt+$]=Dt}}if(tt&me)for(var kt=te,sn=te+qe*(Me-ye);kt<=sn;kt+=St){var Ft=kt+dt;X?he(k[kt+$],k[Ft+$]):Ee(k[kt+$],k[Ft+$]),Dt=oe.a,k[Ft+$]=oe.b,k[kt+$]=Dt}ye=me,me>>=1}return te}function rt(k,$,Me,qe,tt,$e,Mt,X,ue,me){for(var ye=0,te=0,Je=X,Qe=Math.trunc(tt.value+($e+7)/8);tt.value<Qe;)for(H(ye,te,Me,tt),ye=ce.c,te=ce.lc;te>=14;){var ot=ye>>te-14&16383,dt=$[ot];if(dt.len)te-=dt.len,re(dt.lit,Mt,ye,te,Me,qe,tt,ue,me,Je),ye=W.c,te=W.lc;else{if(!dt.p)throw"hufDecode issues";var St;for(St=0;St<dt.lit;St++){for(var Dt=ee(k[dt.p[St]]);te<Dt&&tt.value<Qe;)H(ye,te,Me,tt),ye=ce.c,te=ce.lc;if(te>=Dt&&ie(k[dt.p[St]])==(ye>>te-Dt&(1<<Dt)-1)){te-=Dt,re(dt.p[St],Mt,ye,te,Me,qe,tt,ue,me,Je),ye=W.c,te=W.lc;break}}if(St==dt.lit)throw"hufDecode issues"}}var At=8-$e&7;for(ye>>=At,te-=At;te>0;){var dt=$[ye<<14-te&16383];if(dt.len)te-=dt.len,re(dt.lit,Mt,ye,te,Me,qe,tt,ue,me,Je),ye=W.c,te=W.lc;else throw"hufDecode issues"}return!0}function st(k,$,Me,qe,tt,$e){var Mt={value:0},X=Me.value,ue=Xe($,Me),me=Xe($,Me);Me.value+=4;var ye=Xe($,Me);if(Me.value+=4,ue<0||ue>=65537||me<0||me>=65537)throw"Something wrong with HUF_ENCSIZE";var te=new Array(65537),Je=new Array(16384);q(Je);var Qe=qe-(Me.value-X);if(G(k,$,Me,Qe,ue,me,te),ye>8*(qe-(Me.value-X)))throw"Something wrong with hufUncompress";fe(te,ue,me,Je),rt(te,Je,k,$,Me,ye,me,$e,tt,Mt)}function et(k,$,Me){for(var qe=0;qe<Me;++qe)$[qe]=k[$[qe]]}function se(k){for(var $=1;$<k.length;$++){var Me=k[$-1]+k[$]-128;k[$]=Me}}function Ie(k,$){for(var Me=0,qe=Math.floor((k.length+1)/2),tt=0,$e=k.length-1;!(tt>$e||($[tt++]=k[Me++],tt>$e));)$[tt++]=k[qe++]}function Oe(k){for(var $=k.byteLength,Me=new Array,qe=0,tt=new DataView(k);$>0;){var $e=tt.getInt8(qe++);if($e<0){var Mt=-$e;$-=Mt+1;for(var X=0;X<Mt;X++)Me.push(tt.getUint8(qe++))}else{var Mt=$e;$-=2;for(var ue=tt.getUint8(qe++),X=0;X<Mt+1;X++)Me.push(ue)}}return Me}function Ue(k,$,Me,qe,tt,$e){var Ft=new DataView($e.buffer),Mt=Me[k.idx[0]].width,X=Me[k.idx[0]].height,ue=3,me=Math.floor(Mt/8),ye=Math.ceil(Mt/8),te=Math.ceil(X/8),Je=Mt-(ye-1)*8,Qe=X-(te-1)*8,ot={value:0},dt=new Array(ue),St=new Array(ue),Dt=new Array(ue),At=new Array(ue),Ht=new Array(ue);for(let fn=0;fn<ue;++fn)Ht[fn]=$[k.idx[fn]],dt[fn]=fn<1?0:dt[fn-1]+ye*te,St[fn]=new Float32Array(64),Dt[fn]=new Uint16Array(64),At[fn]=new Uint16Array(ye*64);for(let fn=0;fn<te;++fn){var $t=8;fn==te-1&&($t=Qe);var kt=8;for(let Rn=0;Rn<ye;++Rn){Rn==ye-1&&(kt=Je);for(let Ot=0;Ot<ue;++Ot)Dt[Ot].fill(0),Dt[Ot][0]=tt[dt[Ot]++],Le(ot,qe,Dt[Ot]),ze(Dt[Ot],St[Ot]),Pe(St[Ot]);Fe(St);for(let Ot=0;Ot<ue;++Ot)Ne(St[Ot],At[Ot],Rn*64)}let pn=0;for(let Rn=0;Rn<ue;++Rn){const Ot=Me[k.idx[Rn]].type;for(let Yn=8*fn;Yn<8*fn+$t;++Yn){pn=Ht[Rn][Yn];for(let ti=0;ti<me;++ti){const _n=ti*64+(Yn&7)*8;Ft.setUint16(pn+0*Ot,At[Rn][_n+0],!0),Ft.setUint16(pn+2*Ot,At[Rn][_n+1],!0),Ft.setUint16(pn+4*Ot,At[Rn][_n+2],!0),Ft.setUint16(pn+6*Ot,At[Rn][_n+3],!0),Ft.setUint16(pn+8*Ot,At[Rn][_n+4],!0),Ft.setUint16(pn+10*Ot,At[Rn][_n+5],!0),Ft.setUint16(pn+12*Ot,At[Rn][_n+6],!0),Ft.setUint16(pn+14*Ot,At[Rn][_n+7],!0),pn+=16*Ot}}if(me!=ye)for(let Yn=8*fn;Yn<8*fn+$t;++Yn){const ti=Ht[Rn][Yn]+8*me*2*Ot,_n=me*64+(Yn&7)*8;for(let Pn=0;Pn<kt;++Pn)Ft.setUint16(ti+Pn*2*Ot,At[Rn][_n+Pn],!0)}}}for(var sn=new Uint16Array(Mt),Ft=new DataView($e.buffer),Ct=0;Ct<ue;++Ct){Me[k.idx[Ct]].decoded=!0;var cn=Me[k.idx[Ct]].type;if(Me[Ct].type==2)for(var on=0;on<X;++on){const fn=Ht[Ct][on];for(var En=0;En<Mt;++En)sn[En]=Ft.getUint16(fn+En*2*cn,!0);for(var En=0;En<Mt;++En)Ft.setFloat32(fn+En*2*cn,_e(sn[En]),!0)}}}function Le(k,$,Me){for(var qe,tt=1;tt<64;)qe=$[k.value],qe==65280?tt=64:qe>>8==255?tt+=qe&255:(Me[tt]=qe,tt++),k.value++}function ze(k,$){$[0]=_e(k[0]),$[1]=_e(k[1]),$[2]=_e(k[5]),$[3]=_e(k[6]),$[4]=_e(k[14]),$[5]=_e(k[15]),$[6]=_e(k[27]),$[7]=_e(k[28]),$[8]=_e(k[2]),$[9]=_e(k[4]),$[10]=_e(k[7]),$[11]=_e(k[13]),$[12]=_e(k[16]),$[13]=_e(k[26]),$[14]=_e(k[29]),$[15]=_e(k[42]),$[16]=_e(k[3]),$[17]=_e(k[8]),$[18]=_e(k[12]),$[19]=_e(k[17]),$[20]=_e(k[25]),$[21]=_e(k[30]),$[22]=_e(k[41]),$[23]=_e(k[43]),$[24]=_e(k[9]),$[25]=_e(k[11]),$[26]=_e(k[18]),$[27]=_e(k[24]),$[28]=_e(k[31]),$[29]=_e(k[40]),$[30]=_e(k[44]),$[31]=_e(k[53]),$[32]=_e(k[10]),$[33]=_e(k[19]),$[34]=_e(k[23]),$[35]=_e(k[32]),$[36]=_e(k[39]),$[37]=_e(k[45]),$[38]=_e(k[52]),$[39]=_e(k[54]),$[40]=_e(k[20]),$[41]=_e(k[22]),$[42]=_e(k[33]),$[43]=_e(k[38]),$[44]=_e(k[46]),$[45]=_e(k[51]),$[46]=_e(k[55]),$[47]=_e(k[60]),$[48]=_e(k[21]),$[49]=_e(k[34]),$[50]=_e(k[37]),$[51]=_e(k[47]),$[52]=_e(k[50]),$[53]=_e(k[56]),$[54]=_e(k[59]),$[55]=_e(k[61]),$[56]=_e(k[35]),$[57]=_e(k[36]),$[58]=_e(k[48]),$[59]=_e(k[49]),$[60]=_e(k[57]),$[61]=_e(k[58]),$[62]=_e(k[62]),$[63]=_e(k[63])}function Pe(k){const $=.5*Math.cos(.7853975),Me=.5*Math.cos(3.14159/16),qe=.5*Math.cos(3.14159/8),tt=.5*Math.cos(3*3.14159/16),$e=.5*Math.cos(5*3.14159/16),Mt=.5*Math.cos(3*3.14159/8),X=.5*Math.cos(7*3.14159/16);for(var ue=new Array(4),me=new Array(4),ye=new Array(4),te=new Array(4),Je=0;Je<8;++Je){var Qe=Je*8;ue[0]=qe*k[Qe+2],ue[1]=Mt*k[Qe+2],ue[2]=qe*k[Qe+6],ue[3]=Mt*k[Qe+6],me[0]=Me*k[Qe+1]+tt*k[Qe+3]+$e*k[Qe+5]+X*k[Qe+7],me[1]=tt*k[Qe+1]-X*k[Qe+3]-Me*k[Qe+5]-$e*k[Qe+7],me[2]=$e*k[Qe+1]-Me*k[Qe+3]+X*k[Qe+5]+tt*k[Qe+7],me[3]=X*k[Qe+1]-$e*k[Qe+3]+tt*k[Qe+5]-Me*k[Qe+7],ye[0]=$*(k[Qe+0]+k[Qe+4]),ye[3]=$*(k[Qe+0]-k[Qe+4]),ye[1]=ue[0]+ue[3],ye[2]=ue[1]-ue[2],te[0]=ye[0]+ye[1],te[1]=ye[3]+ye[2],te[2]=ye[3]-ye[2],te[3]=ye[0]-ye[1],k[Qe+0]=te[0]+me[0],k[Qe+1]=te[1]+me[1],k[Qe+2]=te[2]+me[2],k[Qe+3]=te[3]+me[3],k[Qe+4]=te[3]-me[3],k[Qe+5]=te[2]-me[2],k[Qe+6]=te[1]-me[1],k[Qe+7]=te[0]-me[0]}for(var ot=0;ot<8;++ot)ue[0]=qe*k[16+ot],ue[1]=Mt*k[16+ot],ue[2]=qe*k[48+ot],ue[3]=Mt*k[48+ot],me[0]=Me*k[8+ot]+tt*k[24+ot]+$e*k[40+ot]+X*k[56+ot],me[1]=tt*k[8+ot]-X*k[24+ot]-Me*k[40+ot]-$e*k[56+ot],me[2]=$e*k[8+ot]-Me*k[24+ot]+X*k[40+ot]+tt*k[56+ot],me[3]=X*k[8+ot]-$e*k[24+ot]+tt*k[40+ot]-Me*k[56+ot],ye[0]=$*(k[ot]+k[32+ot]),ye[3]=$*(k[ot]-k[32+ot]),ye[1]=ue[0]+ue[3],ye[2]=ue[1]-ue[2],te[0]=ye[0]+ye[1],te[1]=ye[3]+ye[2],te[2]=ye[3]-ye[2],te[3]=ye[0]-ye[1],k[0+ot]=te[0]+me[0],k[8+ot]=te[1]+me[1],k[16+ot]=te[2]+me[2],k[24+ot]=te[3]+me[3],k[32+ot]=te[3]-me[3],k[40+ot]=te[2]-me[2],k[48+ot]=te[1]-me[1],k[56+ot]=te[0]-me[0]}function Fe(k){for(var $=0;$<64;++$){var Me=k[0][$],qe=k[1][$],tt=k[2][$];k[0][$]=Me+1.5747*tt,k[1][$]=Me-.1873*qe-.4682*tt,k[2][$]=Me+1.8556*qe}}function Ne(k,$,Me){for(var qe=0;qe<64;++qe)$[Me+qe]=Lf.toHalfFloat(yt(k[qe]))}function yt(k){return k<=1?Math.sign(k)*Math.pow(Math.abs(k),2.2):Math.sign(k)*Math.pow(N,Math.abs(k)-1)}function j(k){return new DataView(k.array.buffer,k.offset.value,k.size)}function V(k){var $=k.viewer.buffer.slice(k.offset.value,k.offset.value+k.size),Me=new Uint8Array(Oe($)),qe=new Uint8Array(Me.length);return se(Me),Ie(Me,qe),new DataView(qe.buffer)}function ve(k){var $=k.array.slice(k.offset.value,k.offset.value+k.size),Me=Dv($),qe=new Uint8Array(Me.length);return se(Me),Ie(Me,qe),new DataView(qe.buffer)}function Be(k){for(var $=k.viewer,Me={value:k.offset.value},qe=new Uint16Array(k.width*k.scanlineBlockSize*(k.channels*k.type)),tt=new Uint8Array(8192),$e=0,Mt=new Array(k.channels),X=0;X<k.channels;X++)Mt[X]={},Mt[X].start=$e,Mt[X].end=Mt[X].start,Mt[X].nx=k.width,Mt[X].ny=k.lines,Mt[X].size=k.type,$e+=Mt[X].nx*Mt[X].ny*Mt[X].size;var ue=at($,Me),me=at($,Me);if(me>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(ue<=me)for(var X=0;X<me-ue+1;X++)tt[X+ue]=le($,Me);var ye=new Uint16Array(65536),te=z(tt,ye),Je=Xe($,Me);st(k.array,$,Me,Je,qe,$e);for(var X=0;X<k.channels;++X)for(var Qe=Mt[X],ot=0;ot<Mt[X].size;++ot)We(qe,Qe.start+ot,Qe.nx,Qe.size,Qe.ny,Qe.nx*Qe.size,te);et(ye,qe,$e);for(var dt=0,St=new Uint8Array(qe.buffer.byteLength),Dt=0;Dt<k.lines;Dt++)for(var At=0;At<k.channels;At++){var Qe=Mt[At],Ht=Qe.nx*Qe.size,$t=new Uint8Array(qe.buffer,Qe.end*2,Ht*2);St.set($t,dt),dt+=Ht*2,Qe.end+=Ht}return new DataView(St.buffer)}function De(k){var $=k.array.slice(k.offset.value,k.offset.value+k.size),Me=Dv($);const qe=k.lines*k.channels*k.width,tt=k.type==1?new Uint16Array(qe):new Uint32Array(qe);let $e=0,Mt=0;const X=new Array(4);for(let ue=0;ue<k.lines;ue++)for(let me=0;me<k.channels;me++){let ye=0;switch(k.type){case 1:X[0]=$e,X[1]=X[0]+k.width,$e=X[1]+k.width;for(let te=0;te<k.width;++te){const Je=Me[X[0]++]<<8|Me[X[1]++];ye+=Je,tt[Mt]=ye,Mt++}break;case 2:X[0]=$e,X[1]=X[0]+k.width,X[2]=X[1]+k.width,$e=X[2]+k.width;for(let te=0;te<k.width;++te){const Je=Me[X[0]++]<<24|Me[X[1]++]<<16|Me[X[2]++]<<8;ye+=Je,tt[Mt]=ye,Mt++}break}}return new DataView(tt.buffer)}function Ae(k){var $=k.viewer,Me={value:k.offset.value},qe=new Uint8Array(k.width*k.lines*(k.channels*k.type*2)),tt={version:Te($,Me),unknownUncompressedSize:Te($,Me),unknownCompressedSize:Te($,Me),acCompressedSize:Te($,Me),dcCompressedSize:Te($,Me),rleCompressedSize:Te($,Me),rleUncompressedSize:Te($,Me),rleRawSize:Te($,Me),totalAcUncompressedCount:Te($,Me),totalDcUncompressedCount:Te($,Me),acCompression:Te($,Me)};if(tt.version<2)throw"EXRLoader.parse: "+ri.compression+" version "+tt.version+" is unsupported";for(var $e=new Array,Mt=at($,Me)-2;Mt>0;){var X=gt($.buffer,Me),ue=le($,Me),me=ue>>2&3,ye=(ue>>4)-1,te=new Int8Array([ye])[0],Je=le($,Me);$e.push({name:X,index:te,type:Je,compression:me}),Mt-=X.length+3}for(var Qe=ri.channels,ot=new Array(k.channels),dt=0;dt<k.channels;++dt){var St=ot[dt]={},Dt=Qe[dt];St.name=Dt.name,St.compression=0,St.decoded=!1,St.type=Dt.pixelType,St.pLinear=Dt.pLinear,St.width=k.width,St.height=k.lines}for(var At={idx:new Array(3)},Ht=0;Ht<k.channels;++Ht)for(var St=ot[Ht],dt=0;dt<$e.length;++dt){var $t=$e[dt];St.name==$t.name&&(St.compression=$t.compression,$t.index>=0&&(At.idx[$t.index]=Ht),St.offset=Ht)}if(tt.acCompressedSize>0)switch(tt.acCompression){case 0:var Ft=new Uint16Array(tt.totalAcUncompressedCount);st(k.array,$,Me,tt.acCompressedSize,Ft,tt.totalAcUncompressedCount);break;case 1:var kt=k.array.slice(Me.value,Me.value+tt.totalAcUncompressedCount),sn=Dv(kt),Ft=new Uint16Array(sn.buffer);Me.value+=tt.totalAcUncompressedCount;break}if(tt.dcCompressedSize>0){var Ct={array:k.array,offset:Me,size:tt.dcCompressedSize},cn=new Uint16Array(ve(Ct).buffer);Me.value+=tt.dcCompressedSize}if(tt.rleRawSize>0){var kt=k.array.slice(Me.value,Me.value+tt.rleCompressedSize),sn=Dv(kt),on=Oe(sn.buffer);Me.value+=tt.rleCompressedSize}for(var En=0,fn=new Array(ot.length),dt=0;dt<fn.length;++dt)fn[dt]=new Array;for(var pn=0;pn<k.lines;++pn)for(var Rn=0;Rn<ot.length;++Rn)fn[Rn].push(En),En+=ot[Rn].width*k.type*2;Ue(At,fn,ot,Ft,cn,qe);for(var dt=0;dt<ot.length;++dt){var St=ot[dt];if(!St.decoded)switch(St.compression){case 2:for(var Ot=0,Yn=0,pn=0;pn<k.lines;++pn){for(var ti=fn[dt][Ot],_n=0;_n<St.width;++_n){for(var Pn=0;Pn<2*St.type;++Pn)qe[ti++]=on[Yn+Pn*St.width*St.height];Yn++}Ot++}break;default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(qe.buffer)}function gt(k,$){for(var Me=new Uint8Array(k),qe=0;Me[$.value+qe]!=0;)qe+=1;var tt=new TextDecoder().decode(Me.slice($.value,$.value+qe));return $.value=$.value+qe+1,tt}function ct(k,$,Me){var qe=new TextDecoder().decode(new Uint8Array(k).slice($.value,$.value+Me));return $.value=$.value+Me,qe}function _t(k,$){var Me=ke(k,$),qe=Xe(k,$);return[Me,qe]}function bt(k,$){var Me=Xe(k,$),qe=Xe(k,$);return[Me,qe]}function ke(k,$){var Me=k.getInt32($.value,!0);return $.value=$.value+4,Me}function Xe(k,$){var Me=k.getUint32($.value,!0);return $.value=$.value+4,Me}function lt(k,$){var Me=k[$.value];return $.value=$.value+1,Me}function le(k,$){var Me=k.getUint8($.value);return $.value=$.value+1,Me}const Te=function(k,$){let Me;return"getBigInt64"in DataView.prototype?Me=Number(k.getBigInt64($.value,!0)):Me=k.getUint32($.value+4,!0)+Number(k.getUint32($.value,!0)<<32),$.value+=8,Me};function ut(k,$){var Me=k.getFloat32($.value,!0);return $.value+=4,Me}function pe(k,$){return Lf.toHalfFloat(ut(k,$))}function _e(k){var $=(k&31744)>>10,Me=k&1023;return(k>>15?-1:1)*($?$===31?Me?NaN:1/0:Math.pow(2,$-15)*(1+Me/1024):6103515625e-14*(Me/1024))}function at(k,$){var Me=k.getUint16($.value,!0);return $.value+=2,Me}function Tt(k,$){return _e(at(k,$))}function it(k,$,Me,qe){for(var tt=Me.value,$e=[];Me.value<tt+qe-1;){var Mt=gt($,Me),X=ke(k,Me),ue=le(k,Me);Me.value+=3;var me=ke(k,Me),ye=ke(k,Me);$e.push({name:Mt,pixelType:X,pLinear:ue,xSampling:me,ySampling:ye})}return Me.value+=1,$e}function Ge(k,$){var Me=ut(k,$),qe=ut(k,$),tt=ut(k,$),$e=ut(k,$),Mt=ut(k,$),X=ut(k,$),ue=ut(k,$),me=ut(k,$);return{redX:Me,redY:qe,greenX:tt,greenY:$e,blueX:Mt,blueY:X,whiteX:ue,whiteY:me}}function xt(k,$){var Me=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],qe=le(k,$);return Me[qe]}function wt(k,$){var Me=Xe(k,$),qe=Xe(k,$),tt=Xe(k,$),$e=Xe(k,$);return{xMin:Me,yMin:qe,xMax:tt,yMax:$e}}function Ut(k,$){var Me=["INCREASING_Y"],qe=le(k,$);return Me[qe]}function Pt(k,$){var Me=ut(k,$),qe=ut(k,$);return[Me,qe]}function yn(k,$){var Me=ut(k,$),qe=ut(k,$),tt=ut(k,$);return[Me,qe,tt]}function An(k,$,Me,qe,tt){if(qe==="string"||qe==="stringvector"||qe==="iccProfile")return ct($,Me,tt);if(qe==="chlist")return it(k,$,Me,tt);if(qe==="chromaticities")return Ge(k,Me);if(qe==="compression")return xt(k,Me);if(qe==="box2i")return wt(k,Me);if(qe==="lineOrder")return Ut(k,Me);if(qe==="float")return ut(k,Me);if(qe==="v2f")return Pt(k,Me);if(qe==="v3f")return yn(k,Me);if(qe==="int")return ke(k,Me);if(qe==="rational")return _t(k,Me);if(qe==="timecode")return bt(k,Me);if(qe==="preview")return Me.value+=tt,"skipped";Me.value+=tt}function ai(k,$,Me){const qe={};if(k.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";qe.version=k.getUint8(4);const tt=k.getUint8(5);qe.spec={singleTile:!!(tt&2),longName:!!(tt&4),deepFormat:!!(tt&8),multiPart:!!(tt&16)},Me.value=8;for(var $e=!0;$e;){var Mt=gt($,Me);if(Mt==0)$e=!1;else{var X=gt($,Me),ue=Xe(k,Me),me=An(k,$,Me,X,ue);me===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${X}'.`):qe[Mt]=me}}if((tt&-5)!=0)throw console.error("EXRHeader:",qe),"THREE.EXRLoader: provided file is currently unsupported.";return qe}function ci(k,$,Me,qe,tt){const $e={size:0,viewer:$,array:Me,offset:qe,width:k.dataWindow.xMax-k.dataWindow.xMin+1,height:k.dataWindow.yMax-k.dataWindow.yMin+1,channels:k.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:k.channels[0].pixelType,uncompress:null,getter:null,format:null,[Dm?"colorSpace":"encoding"]:null};switch(k.compression){case"NO_COMPRESSION":$e.lines=1,$e.uncompress=j;break;case"RLE_COMPRESSION":$e.lines=1,$e.uncompress=V;break;case"ZIPS_COMPRESSION":$e.lines=1,$e.uncompress=ve;break;case"ZIP_COMPRESSION":$e.lines=16,$e.uncompress=ve;break;case"PIZ_COMPRESSION":$e.lines=32,$e.uncompress=Be;break;case"PXR24_COMPRESSION":$e.lines=16,$e.uncompress=De;break;case"DWAA_COMPRESSION":$e.lines=32,$e.uncompress=Ae;break;case"DWAB_COMPRESSION":$e.lines=256,$e.uncompress=Ae;break;default:throw"EXRLoader.parse: "+k.compression+" is unsupported"}if($e.scanlineBlockSize=$e.lines,$e.type==1)switch(tt){case Vi:$e.getter=Tt,$e.inputSize=2;break;case Ia:$e.getter=at,$e.inputSize=2;break}else if($e.type==2)switch(tt){case Vi:$e.getter=ut,$e.inputSize=4;break;case Ia:$e.getter=pe,$e.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+$e.type+" for "+k.compression+".";$e.blockCount=(k.dataWindow.yMax+1)/$e.scanlineBlockSize;for(var Mt=0;Mt<$e.blockCount;Mt++)Te($,qe);$e.outputChannels=$e.channels==3?4:$e.channels;const X=$e.width*$e.height*$e.outputChannels;switch(tt){case Vi:$e.byteArray=new Float32Array(X),$e.channels<$e.outputChannels&&$e.byteArray.fill(1,0,X);break;case Ia:$e.byteArray=new Uint16Array(X),$e.channels<$e.outputChannels&&$e.byteArray.fill(15360,0,X);break;default:console.error("THREE.EXRLoader: unsupported type: ",tt);break}return $e.bytesPerLine=$e.width*$e.inputSize*$e.channels,$e.outputChannels==4?$e.format=na:$e.format=dg,Dm?$e.colorSpace="srgb-linear":$e.encoding=3e3,$e}const Ti=new DataView(e),mi=new Uint8Array(e),Ai={value:0},ri=ai(Ti,e,Ai),Xt=ci(ri,Ti,mi,Ai,this.type),Un={value:0},Jt={R:0,G:1,B:2,A:3,Y:0};for(let k=0;k<Xt.height/Xt.scanlineBlockSize;k++){const $=Xe(Ti,Ai);Xt.size=Xe(Ti,Ai),Xt.lines=$+Xt.scanlineBlockSize>Xt.height?Xt.height-$:Xt.scanlineBlockSize;const qe=Xt.size<Xt.lines*Xt.bytesPerLine?Xt.uncompress(Xt):j(Xt);Ai.value+=Xt.size;for(let tt=0;tt<Xt.scanlineBlockSize;tt++){const $e=tt+k*Xt.scanlineBlockSize;if($e>=Xt.height)break;for(let Mt=0;Mt<Xt.channels;Mt++){const X=Jt[ri.channels[Mt].name];for(let ue=0;ue<Xt.width;ue++){Un.value=(tt*(Xt.channels*Xt.width)+Mt*Xt.width+ue)*Xt.inputSize;const me=(Xt.height-1-$e)*(Xt.width*Xt.outputChannels)+ue*Xt.outputChannels+X;Xt.byteArray[me]=Xt.getter(qe,Un)}}}}return{header:ri,width:Xt.width,height:Xt.height,data:Xt.byteArray,format:Xt.format,[Dm?"colorSpace":"encoding"]:Xt[Dm?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,i){function a(l,u){Dm?l.colorSpace=u.colorSpace:l.encoding=u.encoding,l.minFilter=Wn,l.magFilter=Wn,l.generateMipmaps=!1,l.flipY=!1,t&&t(l,u)}return super.load(e,a,n,i)}}function GI(){var s=Object.create(null);function e(i,a){var l=i.id,u=i.name,f=i.dependencies;f===void 0&&(f=[]);var p=i.init;p===void 0&&(p=function(){});var m=i.getTransferables;if(m===void 0&&(m=null),!s[l])try{f=f.map(function(_){return _&&_.isWorkerModule&&(e(_,function(x){if(x instanceof Error)throw x}),_=s[_.id].value),_}),p=n("<"+u+">.init",p),m&&(m=n("<"+u+">.getTransferables",m));var v=null;typeof p=="function"?v=p.apply(void 0,f):console.error("worker module init function failed to rehydrate"),s[l]={id:l,value:v,getTransferables:m},a(v)}catch(_){_&&_.noLog||console.error(_),a(_)}}function t(i,a){var l,u=i.id,f=i.args;(!s[u]||typeof s[u].value!="function")&&a(new Error("Worker module "+u+": not found or its 'init' did not return a function"));try{var p=(l=s[u]).value.apply(l,f);p&&typeof p.then=="function"?p.then(m,function(v){return a(v instanceof Error?v:new Error(""+v))}):m(p)}catch(v){a(v)}function m(v){try{var _=s[u].getTransferables&&s[u].getTransferables(v);(!_||!Array.isArray(_)||!_.length)&&(_=void 0),a(v,_)}catch(x){console.error(x),a(x)}}}function n(i,a){var l=void 0;self.troikaDefine=function(f){return l=f};var u=URL.createObjectURL(new Blob(["/** "+i.replace(/\*/g,"")+` **/

troikaDefine(
`+a+`
)`],{type:"application/javascript"}));try{importScripts(u)}catch(f){console.error(f)}return URL.revokeObjectURL(u),delete self.troikaDefine,l}self.addEventListener("message",function(i){var a=i.data,l=a.messageId,u=a.action,f=a.data;try{u==="registerModule"&&e(f,function(p){p instanceof Error?postMessage({messageId:l,success:!1,error:p.message}):postMessage({messageId:l,success:!0,result:{isCallable:typeof p=="function"}})}),u==="callModule"&&t(f,function(p,m){p instanceof Error?postMessage({messageId:l,success:!1,error:p.message}):postMessage({messageId:l,success:!0,result:p},m||void 0)})}catch(p){postMessage({messageId:l,success:!1,error:p.stack})}})}function VI(s){var e=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return e._getInitResult().then(function(i){if(typeof i=="function")return i.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var t=s.dependencies,n=s.init;t=Array.isArray(t)?t.map(function(a){return a&&(a=a.onMainThread||a,a._getInitResult&&(a=a._getInitResult())),a}):[];var i=Promise.all(t).then(function(a){return n.apply(null,a)});return e._getInitResult=function(){return i},i},e}var bR=function(){var s=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),s=!0}catch(t){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return bR=function(){return s},s},kI=0,XI=0,bx=!1,Zm=Object.create(null),Km=Object.create(null),sS=Object.create(null);function Qd(s){if((!s||typeof s.init!="function")&&!bx)throw new Error("requires `options.init` function");var e=s.dependencies,t=s.init,n=s.getTransferables,i=s.workerId,a=VI(s);i==null&&(i="#default");var l="workerModule"+ ++kI,u=s.name||l,f=null;e=e&&e.map(function(m){return typeof m=="function"&&!m.workerModuleData&&(bx=!0,m=Qd({workerId:i,name:"<"+u+"> function dependency: "+m.name,init:`function(){return (
`+kv(m)+`
)}`}),bx=!1),m&&m.workerModuleData&&(m=m.workerModuleData),m});function p(){for(var m=[],v=arguments.length;v--;)m[v]=arguments[v];if(!bR())return a.apply(void 0,m);if(!f){f=CT(i,"registerModule",p.workerModuleData);var _=function(){f=null,Km[i].delete(_)};(Km[i]||(Km[i]=new Set)).add(_)}return f.then(function(x){var b=x.isCallable;if(b)return CT(i,"callModule",{id:l,args:m});throw new Error("Worker module function was called but `init` did not return a callable function")})}return p.workerModuleData={isWorkerModule:!0,id:l,name:u,dependencies:e,init:kv(t),getTransferables:n&&kv(n)},p.onMainThread=a,p}function YI(s){Km[s]&&Km[s].forEach(function(e){e()}),Zm[s]&&(Zm[s].terminate(),delete Zm[s])}function kv(s){var e=s.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function qI(s){var e=Zm[s];if(!e){var t=kv(GI);e=Zm[s]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+s.replace(/\*/g,"")+` **/

;(`+t+")()"],{type:"application/javascript"}))),e.onmessage=function(n){var i=n.data,a=i.messageId,l=sS[a];if(!l)throw new Error("WorkerModule response with empty or unknown messageId");delete sS[a],l(i)}}return e}function CT(s,e,t){return new Promise(function(n,i){var a=++XI;sS[a]=function(l){l.success?n(l.result):i(new Error("Error in worker "+e+" call: "+l.error))},qI(s).postMessage({messageId:a,action:e,data:t})})}function ER(){var s=(function(e){function t(fe,ce,H,W,re,de,ge,oe){var he=1-ge;oe.x=he*he*fe+2*he*ge*H+ge*ge*re,oe.y=he*he*ce+2*he*ge*W+ge*ge*de}function n(fe,ce,H,W,re,de,ge,oe,he,Ee){var We=1-he;Ee.x=We*We*We*fe+3*We*We*he*H+3*We*he*he*re+he*he*he*ge,Ee.y=We*We*We*ce+3*We*We*he*W+3*We*he*he*de+he*he*he*oe}function i(fe,ce){for(var H=/([MLQCZ])([^MLQCZ]*)/g,W,re,de,ge,oe;W=H.exec(fe);){var he=W[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(Ee){return parseFloat(Ee)});switch(W[1]){case"M":ge=re=he[0],oe=de=he[1];break;case"L":(he[0]!==ge||he[1]!==oe)&&ce("L",ge,oe,ge=he[0],oe=he[1]);break;case"Q":{ce("Q",ge,oe,ge=he[2],oe=he[3],he[0],he[1]);break}case"C":{ce("C",ge,oe,ge=he[4],oe=he[5],he[0],he[1],he[2],he[3]);break}case"Z":(ge!==re||oe!==de)&&ce("L",ge,oe,re,de);break}}}function a(fe,ce,H){H===void 0&&(H=16);var W={x:0,y:0};i(fe,function(re,de,ge,oe,he,Ee,We,rt,st){switch(re){case"L":ce(de,ge,oe,he);break;case"Q":{for(var et=de,se=ge,Ie=1;Ie<H;Ie++)t(de,ge,Ee,We,oe,he,Ie/(H-1),W),ce(et,se,W.x,W.y),et=W.x,se=W.y;break}case"C":{for(var Oe=de,Ue=ge,Le=1;Le<H;Le++)n(de,ge,Ee,We,rt,st,oe,he,Le/(H-1),W),ce(Oe,Ue,W.x,W.y),Oe=W.x,Ue=W.y;break}}})}var l="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",u="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",f=new WeakMap,p={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function m(fe,ce){var H=fe.getContext?fe.getContext("webgl",p):fe,W=f.get(H);if(!W){let Oe=function(Ne){var yt=de[Ne];if(!yt&&(yt=de[Ne]=H.getExtension(Ne),!yt))throw new Error(Ne+" not supported");return yt},Ue=function(Ne,yt){var j=H.createShader(yt);return H.shaderSource(j,Ne),H.compileShader(j),j},Le=function(Ne,yt,j,V){if(!ge[Ne]){var ve={},Be={},De=H.createProgram();H.attachShader(De,Ue(yt,H.VERTEX_SHADER)),H.attachShader(De,Ue(j,H.FRAGMENT_SHADER)),H.linkProgram(De),ge[Ne]={program:De,transaction:function(gt){H.useProgram(De),gt({setUniform:function(_t,bt){for(var ke=[],Xe=arguments.length-2;Xe-- >0;)ke[Xe]=arguments[Xe+2];var lt=Be[bt]||(Be[bt]=H.getUniformLocation(De,bt));H["uniform"+_t].apply(H,[lt].concat(ke))},setAttribute:function(_t,bt,ke,Xe,lt){var le=ve[_t];le||(le=ve[_t]={buf:H.createBuffer(),loc:H.getAttribLocation(De,_t),data:null}),H.bindBuffer(H.ARRAY_BUFFER,le.buf),H.vertexAttribPointer(le.loc,bt,H.FLOAT,!1,0,0),H.enableVertexAttribArray(le.loc),re?H.vertexAttribDivisor(le.loc,Xe):Oe("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(le.loc,Xe),lt!==le.data&&(H.bufferData(H.ARRAY_BUFFER,lt,ke),le.data=lt)}})}}}ge[Ne].transaction(V)},ze=function(Ne,yt){he++;try{H.activeTexture(H.TEXTURE0+he);var j=oe[Ne];j||(j=oe[Ne]=H.createTexture(),H.bindTexture(H.TEXTURE_2D,j),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.NEAREST),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.NEAREST)),H.bindTexture(H.TEXTURE_2D,j),yt(j,he)}finally{he--}},Pe=function(Ne,yt,j){var V=H.createFramebuffer();Ee.push(V),H.bindFramebuffer(H.FRAMEBUFFER,V),H.activeTexture(H.TEXTURE0+yt),H.bindTexture(H.TEXTURE_2D,Ne),H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,Ne,0);try{j(V)}finally{H.deleteFramebuffer(V),H.bindFramebuffer(H.FRAMEBUFFER,Ee[--Ee.length-1]||null)}},Fe=function(){de={},ge={},oe={},he=-1,Ee.length=0};var We=Oe,rt=Ue,st=Le,et=ze,se=Pe,Ie=Fe,re=typeof WebGL2RenderingContext<"u"&&H instanceof WebGL2RenderingContext,de={},ge={},oe={},he=-1,Ee=[];H.canvas.addEventListener("webglcontextlost",function(Ne){Fe(),Ne.preventDefault()},!1),f.set(H,W={gl:H,isWebGL2:re,getExtension:Oe,withProgram:Le,withTexture:ze,withTextureFramebuffer:Pe,handleContextLoss:Fe})}ce(W)}function v(fe,ce,H,W,re,de,ge,oe){ge===void 0&&(ge=15),oe===void 0&&(oe=null),m(fe,function(he){var Ee=he.gl,We=he.withProgram,rt=he.withTexture;rt("copy",function(st,et){Ee.texImage2D(Ee.TEXTURE_2D,0,Ee.RGBA,re,de,0,Ee.RGBA,Ee.UNSIGNED_BYTE,ce),We("copy",l,u,function(se){var Ie=se.setUniform,Oe=se.setAttribute;Oe("aUV",2,Ee.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),Ie("1i","image",et),Ee.bindFramebuffer(Ee.FRAMEBUFFER,oe||null),Ee.disable(Ee.BLEND),Ee.colorMask(ge&8,ge&4,ge&2,ge&1),Ee.viewport(H,W,re,de),Ee.scissor(H,W,re,de),Ee.drawArrays(Ee.TRIANGLES,0,3)})})})}function _(fe,ce,H){var W=fe.width,re=fe.height;m(fe,function(de){var ge=de.gl,oe=new Uint8Array(W*re*4);ge.readPixels(0,0,W,re,ge.RGBA,ge.UNSIGNED_BYTE,oe),fe.width=ce,fe.height=H,v(ge,oe,0,0,W,re)})}var x=Object.freeze({__proto__:null,withWebGLContext:m,renderImageData:v,resizeWebGLCanvasWithoutClearing:_});function b(fe,ce,H,W,re,de){de===void 0&&(de=1);var ge=new Uint8Array(fe*ce),oe=W[2]-W[0],he=W[3]-W[1],Ee=[];a(H,function(Oe,Ue,Le,ze){Ee.push({x1:Oe,y1:Ue,x2:Le,y2:ze,minX:Math.min(Oe,Le),minY:Math.min(Ue,ze),maxX:Math.max(Oe,Le),maxY:Math.max(Ue,ze)})}),Ee.sort(function(Oe,Ue){return Oe.maxX-Ue.maxX});for(var We=0;We<fe;We++)for(var rt=0;rt<ce;rt++){var st=se(W[0]+oe*(We+.5)/fe,W[1]+he*(rt+.5)/ce),et=Math.pow(1-Math.abs(st)/re,de)/2;st<0&&(et=1-et),et=Math.max(0,Math.min(255,Math.round(et*255))),ge[rt*fe+We]=et}return ge;function se(Oe,Ue){for(var Le=1/0,ze=1/0,Pe=Ee.length;Pe--;){var Fe=Ee[Pe];if(Fe.maxX+ze<=Oe)break;if(Oe+ze>Fe.minX&&Ue-ze<Fe.maxY&&Ue+ze>Fe.minY){var Ne=E(Oe,Ue,Fe.x1,Fe.y1,Fe.x2,Fe.y2);Ne<Le&&(Le=Ne,ze=Math.sqrt(Le))}}return Ie(Oe,Ue)&&(ze=-ze),ze}function Ie(Oe,Ue){for(var Le=0,ze=Ee.length;ze--;){var Pe=Ee[ze];if(Pe.maxX<=Oe)break;var Fe=Pe.y1>Ue!=Pe.y2>Ue&&Oe<(Pe.x2-Pe.x1)*(Ue-Pe.y1)/(Pe.y2-Pe.y1)+Pe.x1;Fe&&(Le+=Pe.y1<Pe.y2?1:-1)}return Le!==0}}function R(fe,ce,H,W,re,de,ge,oe,he,Ee){de===void 0&&(de=1),oe===void 0&&(oe=0),he===void 0&&(he=0),Ee===void 0&&(Ee=0),T(fe,ce,H,W,re,de,ge,null,oe,he,Ee)}function T(fe,ce,H,W,re,de,ge,oe,he,Ee,We){de===void 0&&(de=1),he===void 0&&(he=0),Ee===void 0&&(Ee=0),We===void 0&&(We=0);for(var rt=b(fe,ce,H,W,re,de),st=new Uint8Array(rt.length*4),et=0;et<rt.length;et++)st[et*4+We]=rt[et];v(ge,st,he,Ee,fe,ce,1<<3-We,oe)}function E(fe,ce,H,W,re,de){var ge=re-H,oe=de-W,he=ge*ge+oe*oe,Ee=he?Math.max(0,Math.min(1,((fe-H)*ge+(ce-W)*oe)/he)):0,We=fe-(H+Ee*ge),rt=ce-(W+Ee*oe);return We*We+rt*rt}var w=Object.freeze({__proto__:null,generate:b,generateIntoCanvas:R,generateIntoFramebuffer:T}),D="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",U="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",I="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",O=new Float32Array([0,0,2,0,0,2]),P=null,B=!1,N={},z=new WeakMap;function q(fe){if(!B&&!ae(fe))throw new Error("WebGL generation not supported")}function Y(fe,ce,H,W,re,de,ge){if(de===void 0&&(de=1),ge===void 0&&(ge=null),!ge&&(ge=P,!ge)){var oe=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!oe)throw new Error("OffscreenCanvas or DOM canvas not supported");ge=P=oe.getContext("webgl",{depth:!1})}q(ge);var he=new Uint8Array(fe*ce*4);m(ge,function(st){var et=st.gl,se=st.withTexture,Ie=st.withTextureFramebuffer;se("readable",function(Oe,Ue){et.texImage2D(et.TEXTURE_2D,0,et.RGBA,fe,ce,0,et.RGBA,et.UNSIGNED_BYTE,null),Ie(Oe,Ue,function(Le){Z(fe,ce,H,W,re,de,et,Le,0,0,0),et.readPixels(0,0,fe,ce,et.RGBA,et.UNSIGNED_BYTE,he)})})});for(var Ee=new Uint8Array(fe*ce),We=0,rt=0;We<he.length;We+=4)Ee[rt++]=he[We];return Ee}function Q(fe,ce,H,W,re,de,ge,oe,he,Ee){de===void 0&&(de=1),oe===void 0&&(oe=0),he===void 0&&(he=0),Ee===void 0&&(Ee=0),Z(fe,ce,H,W,re,de,ge,null,oe,he,Ee)}function Z(fe,ce,H,W,re,de,ge,oe,he,Ee,We){de===void 0&&(de=1),he===void 0&&(he=0),Ee===void 0&&(Ee=0),We===void 0&&(We=0),q(ge);var rt=[];a(H,function(st,et,se,Ie){rt.push(st,et,se,Ie)}),rt=new Float32Array(rt),m(ge,function(st){var et=st.gl,se=st.isWebGL2,Ie=st.getExtension,Oe=st.withProgram,Ue=st.withTexture,Le=st.withTextureFramebuffer,ze=st.handleContextLoss;if(Ue("rawDistances",function(Pe,Fe){(fe!==Pe._lastWidth||ce!==Pe._lastHeight)&&et.texImage2D(et.TEXTURE_2D,0,et.RGBA,Pe._lastWidth=fe,Pe._lastHeight=ce,0,et.RGBA,et.UNSIGNED_BYTE,null),Oe("main",D,U,function(Ne){var yt=Ne.setAttribute,j=Ne.setUniform,V=!se&&Ie("ANGLE_instanced_arrays"),ve=!se&&Ie("EXT_blend_minmax");yt("aUV",2,et.STATIC_DRAW,0,O),yt("aLineSegment",4,et.DYNAMIC_DRAW,1,rt),j.apply(void 0,["4f","uGlyphBounds"].concat(W)),j("1f","uMaxDistance",re),j("1f","uExponent",de),Le(Pe,Fe,function(Be){et.enable(et.BLEND),et.colorMask(!0,!0,!0,!0),et.viewport(0,0,fe,ce),et.scissor(0,0,fe,ce),et.blendFunc(et.ONE,et.ONE),et.blendEquationSeparate(et.FUNC_ADD,se?et.MAX:ve.MAX_EXT),et.clear(et.COLOR_BUFFER_BIT),se?et.drawArraysInstanced(et.TRIANGLES,0,3,rt.length/4):V.drawArraysInstancedANGLE(et.TRIANGLES,0,3,rt.length/4)})}),Oe("post",l,I,function(Ne){Ne.setAttribute("aUV",2,et.STATIC_DRAW,0,O),Ne.setUniform("1i","tex",Fe),et.bindFramebuffer(et.FRAMEBUFFER,oe),et.disable(et.BLEND),et.colorMask(We===0,We===1,We===2,We===3),et.viewport(he,Ee,fe,ce),et.scissor(he,Ee,fe,ce),et.drawArrays(et.TRIANGLES,0,3)})}),et.isContextLost())throw ze(),new Error("webgl context lost")})}function ae(fe){var ce=!fe||fe===P?N:fe.canvas||fe,H=z.get(ce);if(H===void 0){B=!0;var W=null;try{var re=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],de=Y(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,fe);H=de&&re.length===de.length&&de.every(function(ge,oe){return ge===re[oe]}),H||(W="bad trial run results",console.info(re,de))}catch(ge){H=!1,W=ge.message}W&&console.warn("WebGL SDF generation not supported:",W),B=!1,z.set(ce,H)}return H}var G=Object.freeze({__proto__:null,generate:Y,generateIntoCanvas:Q,generateIntoFramebuffer:Z,isSupported:ae});function ee(fe,ce,H,W,re,de){re===void 0&&(re=Math.max(W[2]-W[0],W[3]-W[1])/2),de===void 0&&(de=1);try{return Y.apply(G,arguments)}catch(ge){return console.info("WebGL SDF generation failed, falling back to JS",ge),b.apply(w,arguments)}}function ie(fe,ce,H,W,re,de,ge,oe,he,Ee){re===void 0&&(re=Math.max(W[2]-W[0],W[3]-W[1])/2),de===void 0&&(de=1),oe===void 0&&(oe=0),he===void 0&&(he=0),Ee===void 0&&(Ee=0);try{return Q.apply(G,arguments)}catch(We){return console.info("WebGL SDF generation failed, falling back to JS",We),R.apply(w,arguments)}}return e.forEachPathCommand=i,e.generate=ee,e.generateIntoCanvas=ie,e.javascript=w,e.pathToLineSegments=a,e.webgl=G,e.webglUtils=x,Object.defineProperty(e,"__esModule",{value:!0}),e})({});return s}function WI(){var s=(function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},n={},i={};n.L=1,i[1]="L",Object.keys(t).forEach(function(ze,Pe){n[ze]=1<<Pe+1,i[n[ze]]=ze}),Object.freeze(n);var a=n.LRI|n.RLI|n.FSI,l=n.L|n.R|n.AL,u=n.B|n.S|n.WS|n.ON|n.FSI|n.LRI|n.RLI|n.PDI,f=n.BN|n.RLE|n.LRE|n.RLO|n.LRO|n.PDF,p=n.S|n.WS|n.B|a|n.PDI|f,m=null;function v(){if(!m){m=new Map;var ze=function(Fe){if(t.hasOwnProperty(Fe)){var Ne=0;t[Fe].split(",").forEach(function(yt){var j=yt.split("+"),V=j[0],ve=j[1];V=parseInt(V,36),ve=ve?parseInt(ve,36):0,m.set(Ne+=V,n[Fe]);for(var Be=0;Be<ve;Be++)m.set(++Ne,n[Fe])})}};for(var Pe in t)ze(Pe)}}function _(ze){return v(),m.get(ze.codePointAt(0))||n.L}function x(ze){return i[_(ze)]}var b={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function R(ze,Pe){var Fe=36,Ne=0,yt=new Map,j=Pe&&new Map,V;return ze.split(",").forEach(function ve(Be){if(Be.indexOf("+")!==-1)for(var De=+Be;De--;)ve(V);else{V=Be;var Ae=Be.split(">"),gt=Ae[0],ct=Ae[1];gt=String.fromCodePoint(Ne+=parseInt(gt,Fe)),ct=String.fromCodePoint(Ne+=parseInt(ct,Fe)),yt.set(gt,ct),Pe&&j.set(ct,gt)}}),{map:yt,reverseMap:j}}var T,E,w;function D(){if(!T){var ze=R(b.pairs,!0),Pe=ze.map,Fe=ze.reverseMap;T=Pe,E=Fe,w=R(b.canonical,!1).map}}function U(ze){return D(),T.get(ze)||null}function I(ze){return D(),E.get(ze)||null}function O(ze){return D(),w.get(ze)||null}var P=n.L,B=n.R,N=n.EN,z=n.ES,q=n.ET,Y=n.AN,Q=n.CS,Z=n.B,ae=n.S,G=n.ON,ee=n.BN,ie=n.NSM,fe=n.AL,ce=n.LRO,H=n.RLO,W=n.LRE,re=n.RLE,de=n.PDF,ge=n.LRI,oe=n.RLI,he=n.FSI,Ee=n.PDI;function We(ze,Pe){for(var Fe=125,Ne=new Uint32Array(ze.length),yt=0;yt<ze.length;yt++)Ne[yt]=_(ze[yt]);var j=new Map;function V(da,Wa){var Xi=Ne[da];Ne[da]=Wa,j.set(Xi,j.get(Xi)-1),Xi&u&&j.set(u,j.get(u)-1),j.set(Wa,(j.get(Wa)||0)+1),Wa&u&&j.set(u,(j.get(u)||0)+1)}for(var ve=new Uint8Array(ze.length),Be=new Map,De=[],Ae=null,gt=0;gt<ze.length;gt++)Ae||De.push(Ae={start:gt,end:ze.length-1,level:Pe==="rtl"?1:Pe==="ltr"?0:Tc(gt,!1)}),Ne[gt]&Z&&(Ae.end=gt,Ae=null);for(var ct=re|W|H|ce|a|Ee|de|Z,_t=function(da){return da+(da&1?1:2)},bt=function(da){return da+(da&1?2:1)},ke=0;ke<De.length;ke++){Ae=De[ke];var Xe=[{_level:Ae.level,_override:0,_isolate:0}],lt=void 0,le=0,Te=0,ut=0;j.clear();for(var pe=Ae.start;pe<=Ae.end;pe++){var _e=Ne[pe];if(lt=Xe[Xe.length-1],j.set(_e,(j.get(_e)||0)+1),_e&u&&j.set(u,(j.get(u)||0)+1),_e&ct)if(_e&(re|W)){ve[pe]=lt._level;var at=(_e===re?bt:_t)(lt._level);at<=Fe&&!le&&!Te?Xe.push({_level:at,_override:0,_isolate:0}):le||Te++}else if(_e&(H|ce)){ve[pe]=lt._level;var Tt=(_e===H?bt:_t)(lt._level);Tt<=Fe&&!le&&!Te?Xe.push({_level:Tt,_override:_e&H?B:P,_isolate:0}):le||Te++}else if(_e&a){_e&he&&(_e=Tc(pe+1,!0)===1?oe:ge),ve[pe]=lt._level,lt._override&&V(pe,lt._override);var it=(_e===oe?bt:_t)(lt._level);it<=Fe&&le===0&&Te===0?(ut++,Xe.push({_level:it,_override:0,_isolate:1,_isolInitIndex:pe})):le++}else if(_e&Ee){if(le>0)le--;else if(ut>0){for(Te=0;!Xe[Xe.length-1]._isolate;)Xe.pop();var Ge=Xe[Xe.length-1]._isolInitIndex;Ge!=null&&(Be.set(Ge,pe),Be.set(pe,Ge)),Xe.pop(),ut--}lt=Xe[Xe.length-1],ve[pe]=lt._level,lt._override&&V(pe,lt._override)}else _e&de?(le===0&&(Te>0?Te--:!lt._isolate&&Xe.length>1&&(Xe.pop(),lt=Xe[Xe.length-1])),ve[pe]=lt._level):_e&Z&&(ve[pe]=Ae.level);else ve[pe]=lt._level,lt._override&&_e!==ee&&V(pe,lt._override)}for(var xt=[],wt=null,Ut=Ae.start;Ut<=Ae.end;Ut++){var Pt=Ne[Ut];if(!(Pt&f)){var yn=ve[Ut],An=Pt&a,ai=Pt===Ee;wt&&yn===wt._level?(wt._end=Ut,wt._endsWithIsolInit=An):xt.push(wt={_start:Ut,_end:Ut,_level:yn,_startsWithPDI:ai,_endsWithIsolInit:An})}}for(var ci=[],Ti=0;Ti<xt.length;Ti++){var mi=xt[Ti];if(!mi._startsWithPDI||mi._startsWithPDI&&!Be.has(mi._start)){for(var Ai=[wt=mi],ri=void 0;wt&&wt._endsWithIsolInit&&(ri=Be.get(wt._end))!=null;)for(var Xt=Ti+1;Xt<xt.length;Xt++)if(xt[Xt]._start===ri){Ai.push(wt=xt[Xt]);break}for(var Un=[],Jt=0;Jt<Ai.length;Jt++)for(var k=Ai[Jt],$=k._start;$<=k._end;$++)Un.push($);for(var Me=ve[Un[0]],qe=Ae.level,tt=Un[0]-1;tt>=0;tt--)if(!(Ne[tt]&f)){qe=ve[tt];break}var $e=Un[Un.length-1],Mt=ve[$e],X=Ae.level;if(!(Ne[$e]&a)){for(var ue=$e+1;ue<=Ae.end;ue++)if(!(Ne[ue]&f)){X=ve[ue];break}}ci.push({_seqIndices:Un,_sosType:Math.max(qe,Me)%2?B:P,_eosType:Math.max(X,Mt)%2?B:P})}}for(var me=0;me<ci.length;me++){var ye=ci[me],te=ye._seqIndices,Je=ye._sosType,Qe=ye._eosType,ot=ve[te[0]]&1?B:P;if(j.get(ie))for(var dt=0;dt<te.length;dt++){var St=te[dt];if(Ne[St]&ie){for(var Dt=Je,At=dt-1;At>=0;At--)if(!(Ne[te[At]]&f)){Dt=Ne[te[At]];break}V(St,Dt&(a|Ee)?G:Dt)}}if(j.get(N))for(var Ht=0;Ht<te.length;Ht++){var $t=te[Ht];if(Ne[$t]&N)for(var kt=Ht-1;kt>=-1;kt--){var sn=kt===-1?Je:Ne[te[kt]];if(sn&l){sn===fe&&V($t,Y);break}}}if(j.get(fe))for(var Ft=0;Ft<te.length;Ft++){var Ct=te[Ft];Ne[Ct]&fe&&V(Ct,B)}if(j.get(z)||j.get(Q))for(var cn=1;cn<te.length-1;cn++){var on=te[cn];if(Ne[on]&(z|Q)){for(var En=0,fn=0,pn=cn-1;pn>=0&&(En=Ne[te[pn]],!!(En&f));pn--);for(var Rn=cn+1;Rn<te.length&&(fn=Ne[te[Rn]],!!(fn&f));Rn++);En===fn&&(Ne[on]===z?En===N:En&(N|Y))&&V(on,En)}}if(j.get(N))for(var Ot=0;Ot<te.length;Ot++){var Yn=te[Ot];if(Ne[Yn]&N){for(var ti=Ot-1;ti>=0&&Ne[te[ti]]&(q|f);ti--)V(te[ti],N);for(Ot++;Ot<te.length&&Ne[te[Ot]]&(q|f|N);Ot++)Ne[te[Ot]]!==N&&V(te[Ot],N)}}if(j.get(q)||j.get(z)||j.get(Q))for(var _n=0;_n<te.length;_n++){var Pn=te[_n];if(Ne[Pn]&(q|z|Q)){V(Pn,G);for(var Hr=_n-1;Hr>=0&&Ne[te[Hr]]&f;Hr--)V(te[Hr],G);for(var ki=_n+1;ki<te.length&&Ne[te[ki]]&f;ki++)V(te[ki],G)}}if(j.get(N))for(var is=0,El=Je;is<te.length;is++){var Io=te[is],Tl=Ne[Io];Tl&N?El===P&&V(Io,P):Tl&l&&(El=Tl)}if(j.get(u)){var as=B|N|Y,Ec=as|P,Al=[];{for(var Gr=[],ha=0;ha<te.length;ha++)if(Ne[te[ha]]&u){var rs=ze[te[ha]],Rl=void 0;if(U(rs)!==null)if(Gr.length<63)Gr.push({char:rs,seqIndex:ha});else break;else if((Rl=I(rs))!==null)for(var hr=Gr.length-1;hr>=0;hr--){var Vr=Gr[hr].char;if(Vr===Rl||Vr===I(O(rs))||U(O(Vr))===rs){Al.push([Gr[hr].seqIndex,ha]),Gr.length=hr;break}}}Al.sort(function(da,Wa){return da[0]-Wa[0]})}for(var Cl=0;Cl<Al.length;Cl++){for(var wl=Al[Cl],Bo=wl[0],ss=wl[1],dr=!1,Aa=0,$s=Bo+1;$s<ss;$s++){var os=te[$s];if(Ne[os]&Ec){dr=!0;var Ul=Ne[os]&as?B:P;if(Ul===ot){Aa=Ul;break}}}if(dr&&!Aa){Aa=Je;for(var kr=Bo-1;kr>=0;kr--){var Dl=te[kr];if(Ne[Dl]&Ec){var As=Ne[Dl]&as?B:P;As!==ot?Aa=As:Aa=ot;break}}}if(Aa){if(Ne[te[Bo]]=Ne[te[ss]]=Aa,Aa!==ot){for(var ls=Bo+1;ls<te.length;ls++)if(!(Ne[te[ls]]&f)){_(ze[te[ls]])&ie&&(Ne[te[ls]]=Aa);break}}if(Aa!==ot){for(var eo=ss+1;eo<te.length;eo++)if(!(Ne[te[eo]]&f)){_(ze[te[eo]])&ie&&(Ne[te[eo]]=Aa);break}}}}for(var gi=0;gi<te.length;gi++)if(Ne[te[gi]]&u){for(var us=gi,to=gi,Ba=Je,Rs=gi-1;Rs>=0;Rs--)if(Ne[te[Rs]]&f)us=Rs;else{Ba=Ne[te[Rs]]&as?B:P;break}for(var Nl=Qe,cs=gi+1;cs<te.length;cs++)if(Ne[te[cs]]&(u|f))to=cs;else{Nl=Ne[te[cs]]&as?B:P;break}for(var Cs=us;Cs<=to;Cs++)Ne[te[Cs]]=Ba===Nl?Ba:ot;gi=to}}}for(var Ki=Ae.start;Ki<=Ae.end;Ki++){var Jf=ve[Ki],Ri=Ne[Ki];if(Jf&1?Ri&(P|N|Y)&&ve[Ki]++:Ri&B?ve[Ki]++:Ri&(Y|N)&&(ve[Ki]+=2),Ri&f&&(ve[Ki]=Ki===0?Ae.level:ve[Ki-1]),Ki===Ae.end||_(ze[Ki])&(ae|Z))for(var Ol=Ki;Ol>=0&&_(ze[Ol])&p;Ol--)ve[Ol]=Ae.level}}return{levels:ve,paragraphs:De};function Tc(da,Wa){for(var Xi=da;Xi<ze.length;Xi++){var Xr=Ne[Xi];if(Xr&(B|fe))return 1;if(Xr&(Z|P)||Wa&&Xr===Ee)return 0;if(Xr&a){var Ac=_u(Xi);Xi=Ac===-1?ze.length:Ac}}return 0}function _u(da){for(var Wa=1,Xi=da+1;Xi<ze.length;Xi++){var Xr=Ne[Xi];if(Xr&Z)break;if(Xr&Ee){if(--Wa===0)return Xi}else Xr&a&&Wa++}return-1}}var rt="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",st;function et(){if(!st){var ze=R(rt,!0),Pe=ze.map,Fe=ze.reverseMap;Fe.forEach(function(Ne,yt){Pe.set(yt,Ne)}),st=Pe}}function se(ze){return et(),st.get(ze)||null}function Ie(ze,Pe,Fe,Ne){var yt=ze.length;Fe=Math.max(0,Fe==null?0:+Fe),Ne=Math.min(yt-1,Ne==null?yt-1:+Ne);for(var j=new Map,V=Fe;V<=Ne;V++)if(Pe[V]&1){var ve=se(ze[V]);ve!==null&&j.set(V,ve)}return j}function Oe(ze,Pe,Fe,Ne){var yt=ze.length;Fe=Math.max(0,Fe==null?0:+Fe),Ne=Math.min(yt-1,Ne==null?yt-1:+Ne);var j=[];return Pe.paragraphs.forEach(function(V){var ve=Math.max(Fe,V.start),Be=Math.min(Ne,V.end);if(ve<Be){for(var De=Pe.levels.slice(ve,Be+1),Ae=Be;Ae>=ve&&_(ze[Ae])&p;Ae--)De[Ae]=V.level;for(var gt=V.level,ct=1/0,_t=0;_t<De.length;_t++){var bt=De[_t];bt>gt&&(gt=bt),bt<ct&&(ct=bt|1)}for(var ke=gt;ke>=ct;ke--)for(var Xe=0;Xe<De.length;Xe++)if(De[Xe]>=ke){for(var lt=Xe;Xe+1<De.length&&De[Xe+1]>=ke;)Xe++;Xe>lt&&j.push([lt+ve,Xe+ve])}}}),j}function Ue(ze,Pe,Fe,Ne){var yt=Le(ze,Pe,Fe,Ne),j=[].concat(ze);return yt.forEach(function(V,ve){j[ve]=(Pe.levels[V]&1?se(ze[V]):null)||ze[V]}),j.join("")}function Le(ze,Pe,Fe,Ne){for(var yt=Oe(ze,Pe,Fe,Ne),j=[],V=0;V<ze.length;V++)j[V]=V;return yt.forEach(function(ve){for(var Be=ve[0],De=ve[1],Ae=j.slice(Be,De+1),gt=Ae.length;gt--;)j[De-gt]=Ae[gt]}),j}return e.closingToOpeningBracket=I,e.getBidiCharType=_,e.getBidiCharTypeName=x,e.getCanonicalBracket=O,e.getEmbeddingLevels=We,e.getMirroredCharacter=se,e.getMirroredCharactersMap=Ie,e.getReorderSegments=Oe,e.getReorderedIndices=Le,e.getReorderedString=Ue,e.openingToClosingBracket=U,Object.defineProperty(e,"__esModule",{value:!0}),e})({});return s}const TR=/\bvoid\s+main\s*\(\s*\)\s*{/g;function oS(s){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function t(n,i){let a=xn[i];return a?oS(a):n}return s.replace(e,t)}const qa=[];for(let s=0;s<256;s++)qa[s]=(s<16?"0":"")+s.toString(16);function jI(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(qa[s&255]+qa[s>>8&255]+qa[s>>16&255]+qa[s>>24&255]+"-"+qa[e&255]+qa[e>>8&255]+"-"+qa[e>>16&15|64]+qa[e>>24&255]+"-"+qa[t&63|128]+qa[t>>8&255]+"-"+qa[t>>16&255]+qa[t>>24&255]+qa[n&255]+qa[n>>8&255]+qa[n>>16&255]+qa[n>>24&255]).toUpperCase()}const bf=Object.assign||function(){let s=arguments[0];for(let e=1,t=arguments.length;e<t;e++){let n=arguments[e];if(n)for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(s[i]=n[i])}return s},ZI=Date.now(),wT=new WeakMap,UT=new Map;let KI=1e10;function lS(s,e){const t=eB(e);let n=wT.get(s);if(n||wT.set(s,n=Object.create(null)),n[t])return new n[t];const i=`_onBeforeCompile${t}`,a=function(p,m){s.onBeforeCompile.call(this,p,m);const v=this.customProgramCacheKey()+"|"+p.vertexShader+"|"+p.fragmentShader;let _=UT[v];if(!_){const x=QI(this,p,e,t);_=UT[v]=x}p.vertexShader=_.vertexShader,p.fragmentShader=_.fragmentShader,bf(p.uniforms,this.uniforms),e.timeUniform&&(p.uniforms[e.timeUniform]={get value(){return Date.now()-ZI}}),this[i]&&this[i](p)},l=function(){return u(e.chained?s:s.clone())},u=function(p){const m=Object.create(p,f);return Object.defineProperty(m,"baseMaterial",{value:s}),Object.defineProperty(m,"id",{value:KI++}),m.uuid=jI(),m.uniforms=bf({},p.uniforms,e.uniforms),m.defines=bf({},p.defines,e.defines),m.defines[`TROIKA_DERIVED_MATERIAL_${t}`]="",m.extensions=bf({},p.extensions,e.extensions),m._listeners=void 0,m},f={constructor:{value:l},isDerivedMaterial:{value:!0},type:{get:()=>s.type,set:p=>{s.type=p}},isDerivedFrom:{writable:!0,configurable:!0,value:function(p){const m=this.baseMaterial;return p===m||m.isDerivedMaterial&&m.isDerivedFrom(p)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return s.customProgramCacheKey()+"|"+t}},onBeforeCompile:{get(){return a},set(p){this[i]=p}},copy:{writable:!0,configurable:!0,value:function(p){return s.copy.call(this,p),!s.isShaderMaterial&&!s.isDerivedMaterial&&(bf(this.extensions,p.extensions),bf(this.defines,p.defines),bf(this.uniforms,CS.clone(p.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const p=new s.constructor;return u(p).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let p=this._depthMaterial;return p||(p=this._depthMaterial=lS(s.isDerivedMaterial?s.getDepthMaterial():new g_({depthPacking:MS}),e),p.defines.IS_DEPTH_MATERIAL="",p.uniforms=this.uniforms),p}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let p=this._distanceMaterial;return p||(p=this._distanceMaterial=lS(s.isDerivedMaterial?s.getDistanceMaterial():new v_,e),p.defines.IS_DISTANCE_MATERIAL="",p.uniforms=this.uniforms),p}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:p,_distanceMaterial:m}=this;p&&p.dispose(),m&&m.dispose(),s.dispose.call(this)}}};return n[t]=l,new l}function QI(s,{vertexShader:e,fragmentShader:t},n,i){let{vertexDefs:a,vertexMainIntro:l,vertexMainOutro:u,vertexTransform:f,fragmentDefs:p,fragmentMainIntro:m,fragmentMainOutro:v,fragmentColorTransform:_,customRewriter:x,timeUniform:b}=n;if(a=a||"",l=l||"",u=u||"",p=p||"",m=m||"",v=v||"",(f||x)&&(e=oS(e)),(_||x)&&(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),t=oS(t)),x){let R=x({vertexShader:e,fragmentShader:t});e=R.vertexShader,t=R.fragmentShader}if(_){let R=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,T=>(R.push(T),"")),v=`${_}
${R.join(`
`)}
${v}`}if(b){const R=`
uniform float ${b};
`;a=R+a,p=R+p}return f&&(e=`vec3 troika_position_${i};
vec3 troika_normal_${i};
vec2 troika_uv_${i};
${e}
`,a=`${a}
void troikaVertexTransform${i}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${f}
}
`,l=`
troika_position_${i} = vec3(position);
troika_normal_${i} = vec3(normal);
troika_uv_${i} = vec2(uv);
troikaVertexTransform${i}(troika_position_${i}, troika_normal_${i}, troika_uv_${i});
${l}
`,e=e.replace(/\b(position|normal|uv)\b/g,(R,T,E,w)=>/\battribute\s+vec[23]\s+$/.test(w.substr(0,E))?T:`troika_${T}_${i}`),s.map&&s.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${i}`))),e=DT(e,i,a,l,u),t=DT(t,i,p,m,v),{vertexShader:e,fragmentShader:t}}function DT(s,e,t,n,i){return(n||i||t)&&(s=s.replace(TR,`
${t}
void troikaOrigMain${e}() {`),s+=`
void main() {
  ${n}
  troikaOrigMain${e}();
  ${i}
}`),s}function JI(s,e){return s==="uniforms"?void 0:typeof e=="function"?e.toString():e}let $I=0;const NT=new Map;function eB(s){const e=JSON.stringify(s,JI);let t=NT.get(e);return t==null&&NT.set(e,t=++$I),t}function tB(){return typeof window>"u"&&(self.window=self),(function(s){var e={parse:function(i){var a=e._bin,l=new Uint8Array(i);if(a.readASCII(l,0,4)=="ttcf"){var u=4;a.readUshort(l,u),u+=2,a.readUshort(l,u),u+=2;var f=a.readUint(l,u);u+=4;for(var p=[],m=0;m<f;m++){var v=a.readUint(l,u);u+=4,p.push(e._readFont(l,v))}return p}return[e._readFont(l,0)]},_readFont:function(i,a){var l=e._bin,u=a;l.readFixed(i,a),a+=4;var f=l.readUshort(i,a);a+=2,l.readUshort(i,a),a+=2,l.readUshort(i,a),a+=2,l.readUshort(i,a),a+=2;for(var p=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],m={_data:i,_offset:u},v={},_=0;_<f;_++){var x=l.readASCII(i,a,4);a+=4,l.readUint(i,a),a+=4;var b=l.readUint(i,a);a+=4;var R=l.readUint(i,a);a+=4,v[x]={offset:b,length:R}}for(_=0;_<p.length;_++){var T=p[_];v[T]&&(m[T.trim()]=e[T.trim()].parse(i,v[T].offset,v[T].length,m))}return m},_tabOffset:function(i,a,l){for(var u=e._bin,f=u.readUshort(i,l+4),p=l+12,m=0;m<f;m++){var v=u.readASCII(i,p,4);p+=4,u.readUint(i,p),p+=4;var _=u.readUint(i,p);if(p+=4,u.readUint(i,p),p+=4,v==a)return _}return 0}};e._bin={readFixed:function(i,a){return(i[a]<<8|i[a+1])+(i[a+2]<<8|i[a+3])/65540},readF2dot14:function(i,a){return e._bin.readShort(i,a)/16384},readInt:function(i,a){return e._bin._view(i).getInt32(a)},readInt8:function(i,a){return e._bin._view(i).getInt8(a)},readShort:function(i,a){return e._bin._view(i).getInt16(a)},readUshort:function(i,a){return e._bin._view(i).getUint16(a)},readUshorts:function(i,a,l){for(var u=[],f=0;f<l;f++)u.push(e._bin.readUshort(i,a+2*f));return u},readUint:function(i,a){return e._bin._view(i).getUint32(a)},readUint64:function(i,a){return 4294967296*e._bin.readUint(i,a)+e._bin.readUint(i,a+4)},readASCII:function(i,a,l){for(var u="",f=0;f<l;f++)u+=String.fromCharCode(i[a+f]);return u},readUnicode:function(i,a,l){for(var u="",f=0;f<l;f++){var p=i[a++]<<8|i[a++];u+=String.fromCharCode(p)}return u},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(i,a,l){var u=e._bin._tdec;return u&&a==0&&l==i.length?u.decode(i):e._bin.readASCII(i,a,l)},readBytes:function(i,a,l){for(var u=[],f=0;f<l;f++)u.push(i[a+f]);return u},readASCIIArray:function(i,a,l){for(var u=[],f=0;f<l;f++)u.push(String.fromCharCode(i[a+f]));return u},_view:function(i){return i._dataView||(i._dataView=i.buffer?new DataView(i.buffer,i.byteOffset,i.byteLength):new DataView(new Uint8Array(i).buffer))}},e._lctf={},e._lctf.parse=function(i,a,l,u,f){var p=e._bin,m={},v=a;p.readFixed(i,a),a+=4;var _=p.readUshort(i,a);a+=2;var x=p.readUshort(i,a);a+=2;var b=p.readUshort(i,a);return a+=2,m.scriptList=e._lctf.readScriptList(i,v+_),m.featureList=e._lctf.readFeatureList(i,v+x),m.lookupList=e._lctf.readLookupList(i,v+b,f),m},e._lctf.readLookupList=function(i,a,l){var u=e._bin,f=a,p=[],m=u.readUshort(i,a);a+=2;for(var v=0;v<m;v++){var _=u.readUshort(i,a);a+=2;var x=e._lctf.readLookupTable(i,f+_,l);p.push(x)}return p},e._lctf.readLookupTable=function(i,a,l){var u=e._bin,f=a,p={tabs:[]};p.ltype=u.readUshort(i,a),a+=2,p.flag=u.readUshort(i,a),a+=2;var m=u.readUshort(i,a);a+=2;for(var v=p.ltype,_=0;_<m;_++){var x=u.readUshort(i,a);a+=2;var b=l(i,v,f+x,p);p.tabs.push(b)}return p},e._lctf.numOfOnes=function(i){for(var a=0,l=0;l<32;l++)(i>>>l&1)!=0&&a++;return a},e._lctf.readClassDef=function(i,a){var l=e._bin,u=[],f=l.readUshort(i,a);if(a+=2,f==1){var p=l.readUshort(i,a);a+=2;var m=l.readUshort(i,a);a+=2;for(var v=0;v<m;v++)u.push(p+v),u.push(p+v),u.push(l.readUshort(i,a)),a+=2}if(f==2){var _=l.readUshort(i,a);for(a+=2,v=0;v<_;v++)u.push(l.readUshort(i,a)),a+=2,u.push(l.readUshort(i,a)),a+=2,u.push(l.readUshort(i,a)),a+=2}return u},e._lctf.getInterval=function(i,a){for(var l=0;l<i.length;l+=3){var u=i[l],f=i[l+1];if(i[l+2],u<=a&&a<=f)return l}return-1},e._lctf.readCoverage=function(i,a){var l=e._bin,u={};u.fmt=l.readUshort(i,a),a+=2;var f=l.readUshort(i,a);return a+=2,u.fmt==1&&(u.tab=l.readUshorts(i,a,f)),u.fmt==2&&(u.tab=l.readUshorts(i,a,3*f)),u},e._lctf.coverageIndex=function(i,a){var l=i.tab;if(i.fmt==1)return l.indexOf(a);if(i.fmt==2){var u=e._lctf.getInterval(l,a);if(u!=-1)return l[u+2]+(a-l[u])}return-1},e._lctf.readFeatureList=function(i,a){var l=e._bin,u=a,f=[],p=l.readUshort(i,a);a+=2;for(var m=0;m<p;m++){var v=l.readASCII(i,a,4);a+=4;var _=l.readUshort(i,a);a+=2;var x=e._lctf.readFeatureTable(i,u+_);x.tag=v.trim(),f.push(x)}return f},e._lctf.readFeatureTable=function(i,a){var l=e._bin,u=a,f={},p=l.readUshort(i,a);a+=2,p>0&&(f.featureParams=u+p);var m=l.readUshort(i,a);a+=2,f.tab=[];for(var v=0;v<m;v++)f.tab.push(l.readUshort(i,a+2*v));return f},e._lctf.readScriptList=function(i,a){var l=e._bin,u=a,f={},p=l.readUshort(i,a);a+=2;for(var m=0;m<p;m++){var v=l.readASCII(i,a,4);a+=4;var _=l.readUshort(i,a);a+=2,f[v.trim()]=e._lctf.readScriptTable(i,u+_)}return f},e._lctf.readScriptTable=function(i,a){var l=e._bin,u=a,f={},p=l.readUshort(i,a);a+=2,p>0&&(f.default=e._lctf.readLangSysTable(i,u+p));var m=l.readUshort(i,a);a+=2;for(var v=0;v<m;v++){var _=l.readASCII(i,a,4);a+=4;var x=l.readUshort(i,a);a+=2,f[_.trim()]=e._lctf.readLangSysTable(i,u+x)}return f},e._lctf.readLangSysTable=function(i,a){var l=e._bin,u={};l.readUshort(i,a),a+=2,u.reqFeature=l.readUshort(i,a),a+=2;var f=l.readUshort(i,a);return a+=2,u.features=l.readUshorts(i,a,f),u},e.CFF={},e.CFF.parse=function(i,a,l){var u=e._bin;(i=new Uint8Array(i.buffer,a,l))[a=0],i[++a],i[++a],i[++a],a++;var f=[];a=e.CFF.readIndex(i,a,f);for(var p=[],m=0;m<f.length-1;m++)p.push(u.readASCII(i,a+f[m],f[m+1]-f[m]));a+=f[f.length-1];var v=[];a=e.CFF.readIndex(i,a,v);var _=[];for(m=0;m<v.length-1;m++)_.push(e.CFF.readDict(i,a+v[m],a+v[m+1]));a+=v[v.length-1];var x=_[0],b=[];a=e.CFF.readIndex(i,a,b);var R=[];for(m=0;m<b.length-1;m++)R.push(u.readASCII(i,a+b[m],b[m+1]-b[m]));if(a+=b[b.length-1],e.CFF.readSubrs(i,a,x),x.CharStrings){a=x.CharStrings,b=[],a=e.CFF.readIndex(i,a,b);var T=[];for(m=0;m<b.length-1;m++)T.push(u.readBytes(i,a+b[m],b[m+1]-b[m]));x.CharStrings=T}if(x.ROS){a=x.FDArray;var E=[];for(a=e.CFF.readIndex(i,a,E),x.FDArray=[],m=0;m<E.length-1;m++){var w=e.CFF.readDict(i,a+E[m],a+E[m+1]);e.CFF._readFDict(i,w,R),x.FDArray.push(w)}a+=E[E.length-1],a=x.FDSelect,x.FDSelect=[];var D=i[a];if(a++,D!=3)throw D;var U=u.readUshort(i,a);for(a+=2,m=0;m<U+1;m++)x.FDSelect.push(u.readUshort(i,a),i[a+2]),a+=3}return x.Encoding&&(x.Encoding=e.CFF.readEncoding(i,x.Encoding,x.CharStrings.length)),x.charset&&(x.charset=e.CFF.readCharset(i,x.charset,x.CharStrings.length)),e.CFF._readFDict(i,x,R),x},e.CFF._readFDict=function(i,a,l){var u;for(var f in a.Private&&(u=a.Private[1],a.Private=e.CFF.readDict(i,u,u+a.Private[0]),a.Private.Subrs&&e.CFF.readSubrs(i,u+a.Private.Subrs,a.Private)),a)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(f)!=-1&&(a[f]=l[a[f]-426+35])},e.CFF.readSubrs=function(i,a,l){var u=e._bin,f=[];a=e.CFF.readIndex(i,a,f);var p,m=f.length;p=m<1240?107:m<33900?1131:32768,l.Bias=p,l.Subrs=[];for(var v=0;v<f.length-1;v++)l.Subrs.push(u.readBytes(i,a+f[v],f[v+1]-f[v]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(i,a){for(var l=0;l<i.charset.length;l++)if(i.charset[l]==a)return l;return-1},e.CFF.glyphBySE=function(i,a){return a<0||a>255?-1:e.CFF.glyphByUnicode(i,e.CFF.tableSE[a])},e.CFF.readEncoding=function(i,a,l){e._bin;var u=[".notdef"],f=i[a];if(a++,f!=0)throw"error: unknown encoding format: "+f;var p=i[a];a++;for(var m=0;m<p;m++)u.push(i[a+m]);return u},e.CFF.readCharset=function(i,a,l){var u=e._bin,f=[".notdef"],p=i[a];if(a++,p==0)for(var m=0;m<l;m++){var v=u.readUshort(i,a);a+=2,f.push(v)}else{if(p!=1&&p!=2)throw"error: format: "+p;for(;f.length<l;){v=u.readUshort(i,a),a+=2;var _=0;for(p==1?(_=i[a],a++):(_=u.readUshort(i,a),a+=2),m=0;m<=_;m++)f.push(v),v++}}return f},e.CFF.readIndex=function(i,a,l){var u=e._bin,f=u.readUshort(i,a)+1,p=i[a+=2];if(a++,p==1)for(var m=0;m<f;m++)l.push(i[a+m]);else if(p==2)for(m=0;m<f;m++)l.push(u.readUshort(i,a+2*m));else if(p==3)for(m=0;m<f;m++)l.push(16777215&u.readUint(i,a+3*m-1));else if(f!=1)throw"unsupported offset size: "+p+", count: "+f;return(a+=f*p)-1},e.CFF.getCharString=function(i,a,l){var u=e._bin,f=i[a],p=i[a+1];i[a+2],i[a+3],i[a+4];var m=1,v=null,_=null;f<=20&&(v=f,m=1),f==12&&(v=100*f+p,m=2),21<=f&&f<=27&&(v=f,m=1),f==28&&(_=u.readShort(i,a+1),m=3),29<=f&&f<=31&&(v=f,m=1),32<=f&&f<=246&&(_=f-139,m=1),247<=f&&f<=250&&(_=256*(f-247)+p+108,m=2),251<=f&&f<=254&&(_=256*-(f-251)-p-108,m=2),f==255&&(_=u.readInt(i,a+1)/65535,m=5),l.val=_??"o"+v,l.size=m},e.CFF.readCharString=function(i,a,l){for(var u=a+l,f=e._bin,p=[];a<u;){var m=i[a],v=i[a+1];i[a+2],i[a+3],i[a+4];var _=1,x=null,b=null;m<=20&&(x=m,_=1),m==12&&(x=100*m+v,_=2),m!=19&&m!=20||(x=m,_=2),21<=m&&m<=27&&(x=m,_=1),m==28&&(b=f.readShort(i,a+1),_=3),29<=m&&m<=31&&(x=m,_=1),32<=m&&m<=246&&(b=m-139,_=1),247<=m&&m<=250&&(b=256*(m-247)+v+108,_=2),251<=m&&m<=254&&(b=256*-(m-251)-v-108,_=2),m==255&&(b=f.readInt(i,a+1)/65535,_=5),p.push(b??"o"+x),a+=_}return p},e.CFF.readDict=function(i,a,l){for(var u=e._bin,f={},p=[];a<l;){var m=i[a],v=i[a+1];i[a+2],i[a+3],i[a+4];var _=1,x=null,b=null;if(m==28&&(b=u.readShort(i,a+1),_=3),m==29&&(b=u.readInt(i,a+1),_=5),32<=m&&m<=246&&(b=m-139,_=1),247<=m&&m<=250&&(b=256*(m-247)+v+108,_=2),251<=m&&m<=254&&(b=256*-(m-251)-v-108,_=2),m==255)throw b=u.readInt(i,a+1)/65535,_=5,"unknown number";if(m==30){var R=[];for(_=1;;){var T=i[a+_];_++;var E=T>>4,w=15&T;if(E!=15&&R.push(E),w!=15&&R.push(w),w==15)break}for(var D="",U=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],I=0;I<R.length;I++)D+=U[R[I]];b=parseFloat(D)}m<=21&&(x=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][m],_=1,m==12&&(x=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][v],_=2)),x!=null?(f[x]=p.length==1?p[0]:p,p=[]):p.push(b),a+=_}return f},e.cmap={},e.cmap.parse=function(i,a,l){i=new Uint8Array(i.buffer,a,l),a=0;var u=e._bin,f={};u.readUshort(i,a),a+=2;var p=u.readUshort(i,a);a+=2;var m=[];f.tables=[];for(var v=0;v<p;v++){var _=u.readUshort(i,a);a+=2;var x=u.readUshort(i,a);a+=2;var b=u.readUint(i,a);a+=4;var R="p"+_+"e"+x,T=m.indexOf(b);if(T==-1){var E;T=f.tables.length,m.push(b);var w=u.readUshort(i,b);w==0?E=e.cmap.parse0(i,b):w==4?E=e.cmap.parse4(i,b):w==6?E=e.cmap.parse6(i,b):w==12?E=e.cmap.parse12(i,b):console.debug("unknown format: "+w,_,x,b),f.tables.push(E)}if(f[R]!=null)throw"multiple tables for one platform+encoding";f[R]=T}return f},e.cmap.parse0=function(i,a){var l=e._bin,u={};u.format=l.readUshort(i,a),a+=2;var f=l.readUshort(i,a);a+=2,l.readUshort(i,a),a+=2,u.map=[];for(var p=0;p<f-6;p++)u.map.push(i[a+p]);return u},e.cmap.parse4=function(i,a){var l=e._bin,u=a,f={};f.format=l.readUshort(i,a),a+=2;var p=l.readUshort(i,a);a+=2,l.readUshort(i,a),a+=2;var m=l.readUshort(i,a);a+=2;var v=m/2;f.searchRange=l.readUshort(i,a),a+=2,f.entrySelector=l.readUshort(i,a),a+=2,f.rangeShift=l.readUshort(i,a),a+=2,f.endCount=l.readUshorts(i,a,v),a+=2*v,a+=2,f.startCount=l.readUshorts(i,a,v),a+=2*v,f.idDelta=[];for(var _=0;_<v;_++)f.idDelta.push(l.readShort(i,a)),a+=2;for(f.idRangeOffset=l.readUshorts(i,a,v),a+=2*v,f.glyphIdArray=[];a<u+p;)f.glyphIdArray.push(l.readUshort(i,a)),a+=2;return f},e.cmap.parse6=function(i,a){var l=e._bin,u={};u.format=l.readUshort(i,a),a+=2,l.readUshort(i,a),a+=2,l.readUshort(i,a),a+=2,u.firstCode=l.readUshort(i,a),a+=2;var f=l.readUshort(i,a);a+=2,u.glyphIdArray=[];for(var p=0;p<f;p++)u.glyphIdArray.push(l.readUshort(i,a)),a+=2;return u},e.cmap.parse12=function(i,a){var l=e._bin,u={};u.format=l.readUshort(i,a),a+=2,a+=2,l.readUint(i,a),a+=4,l.readUint(i,a),a+=4;var f=l.readUint(i,a);a+=4,u.groups=[];for(var p=0;p<f;p++){var m=a+12*p,v=l.readUint(i,m+0),_=l.readUint(i,m+4),x=l.readUint(i,m+8);u.groups.push([v,_,x])}return u},e.glyf={},e.glyf.parse=function(i,a,l,u){for(var f=[],p=0;p<u.maxp.numGlyphs;p++)f.push(null);return f},e.glyf._parseGlyf=function(i,a){var l=e._bin,u=i._data,f=e._tabOffset(u,"glyf",i._offset)+i.loca[a];if(i.loca[a]==i.loca[a+1])return null;var p={};if(p.noc=l.readShort(u,f),f+=2,p.xMin=l.readShort(u,f),f+=2,p.yMin=l.readShort(u,f),f+=2,p.xMax=l.readShort(u,f),f+=2,p.yMax=l.readShort(u,f),f+=2,p.xMin>=p.xMax||p.yMin>=p.yMax)return null;if(p.noc>0){p.endPts=[];for(var m=0;m<p.noc;m++)p.endPts.push(l.readUshort(u,f)),f+=2;var v=l.readUshort(u,f);if(f+=2,u.length-f<v)return null;p.instructions=l.readBytes(u,f,v),f+=v;var _=p.endPts[p.noc-1]+1;for(p.flags=[],m=0;m<_;m++){var x=u[f];if(f++,p.flags.push(x),(8&x)!=0){var b=u[f];f++;for(var R=0;R<b;R++)p.flags.push(x),m++}}for(p.xs=[],m=0;m<_;m++){var T=(2&p.flags[m])!=0,E=(16&p.flags[m])!=0;T?(p.xs.push(E?u[f]:-u[f]),f++):E?p.xs.push(0):(p.xs.push(l.readShort(u,f)),f+=2)}for(p.ys=[],m=0;m<_;m++)T=(4&p.flags[m])!=0,E=(32&p.flags[m])!=0,T?(p.ys.push(E?u[f]:-u[f]),f++):E?p.ys.push(0):(p.ys.push(l.readShort(u,f)),f+=2);var w=0,D=0;for(m=0;m<_;m++)w+=p.xs[m],D+=p.ys[m],p.xs[m]=w,p.ys[m]=D}else{var U;p.parts=[];do{U=l.readUshort(u,f),f+=2;var I={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(p.parts.push(I),I.glyphIndex=l.readUshort(u,f),f+=2,1&U){var O=l.readShort(u,f);f+=2;var P=l.readShort(u,f);f+=2}else O=l.readInt8(u,f),f++,P=l.readInt8(u,f),f++;2&U?(I.m.tx=O,I.m.ty=P):(I.p1=O,I.p2=P),8&U?(I.m.a=I.m.d=l.readF2dot14(u,f),f+=2):64&U?(I.m.a=l.readF2dot14(u,f),f+=2,I.m.d=l.readF2dot14(u,f),f+=2):128&U&&(I.m.a=l.readF2dot14(u,f),f+=2,I.m.b=l.readF2dot14(u,f),f+=2,I.m.c=l.readF2dot14(u,f),f+=2,I.m.d=l.readF2dot14(u,f),f+=2)}while(32&U);if(256&U){var B=l.readUshort(u,f);for(f+=2,p.instr=[],m=0;m<B;m++)p.instr.push(u[f]),f++}}return p},e.GDEF={},e.GDEF.parse=function(i,a,l,u){var f=a;a+=4;var p=e._bin.readUshort(i,a);return{glyphClassDef:p===0?null:e._lctf.readClassDef(i,f+p)}},e.GPOS={},e.GPOS.parse=function(i,a,l,u){return e._lctf.parse(i,a,l,u,e.GPOS.subt)},e.GPOS.subt=function(i,a,l,u){var f=e._bin,p=l,m={};if(m.fmt=f.readUshort(i,l),l+=2,a==1||a==2||a==3||a==7||a==8&&m.fmt<=2){var v=f.readUshort(i,l);l+=2,m.coverage=e._lctf.readCoverage(i,v+p)}if(a==1&&m.fmt==1){var _=f.readUshort(i,l);l+=2,_!=0&&(m.pos=e.GPOS.readValueRecord(i,l,_))}else if(a==2&&m.fmt>=1&&m.fmt<=2){_=f.readUshort(i,l),l+=2;var x=f.readUshort(i,l);l+=2;var b=e._lctf.numOfOnes(_),R=e._lctf.numOfOnes(x);if(m.fmt==1){m.pairsets=[];var T=f.readUshort(i,l);l+=2;for(var E=0;E<T;E++){var w=p+f.readUshort(i,l);l+=2;var D=f.readUshort(i,w);w+=2;for(var U=[],I=0;I<D;I++){var O=f.readUshort(i,w);w+=2,_!=0&&(Y=e.GPOS.readValueRecord(i,w,_),w+=2*b),x!=0&&(Q=e.GPOS.readValueRecord(i,w,x),w+=2*R),U.push({gid2:O,val1:Y,val2:Q})}m.pairsets.push(U)}}if(m.fmt==2){var P=f.readUshort(i,l);l+=2;var B=f.readUshort(i,l);l+=2;var N=f.readUshort(i,l);l+=2;var z=f.readUshort(i,l);for(l+=2,m.classDef1=e._lctf.readClassDef(i,p+P),m.classDef2=e._lctf.readClassDef(i,p+B),m.matrix=[],E=0;E<N;E++){var q=[];for(I=0;I<z;I++){var Y=null,Q=null;_!=0&&(Y=e.GPOS.readValueRecord(i,l,_),l+=2*b),x!=0&&(Q=e.GPOS.readValueRecord(i,l,x),l+=2*R),q.push({val1:Y,val2:Q})}m.matrix.push(q)}}}else if(a==4&&m.fmt==1)m.markCoverage=e._lctf.readCoverage(i,f.readUshort(i,l)+p),m.baseCoverage=e._lctf.readCoverage(i,f.readUshort(i,l+2)+p),m.markClassCount=f.readUshort(i,l+4),m.markArray=e.GPOS.readMarkArray(i,f.readUshort(i,l+6)+p),m.baseArray=e.GPOS.readBaseArray(i,f.readUshort(i,l+8)+p,m.markClassCount);else if(a==6&&m.fmt==1)m.mark1Coverage=e._lctf.readCoverage(i,f.readUshort(i,l)+p),m.mark2Coverage=e._lctf.readCoverage(i,f.readUshort(i,l+2)+p),m.markClassCount=f.readUshort(i,l+4),m.mark1Array=e.GPOS.readMarkArray(i,f.readUshort(i,l+6)+p),m.mark2Array=e.GPOS.readBaseArray(i,f.readUshort(i,l+8)+p,m.markClassCount);else{if(a==9&&m.fmt==1){var Z=f.readUshort(i,l);l+=2;var ae=f.readUint(i,l);if(l+=4,u.ltype==9)u.ltype=Z;else if(u.ltype!=Z)throw"invalid extension substitution";return e.GPOS.subt(i,u.ltype,p+ae)}console.debug("unsupported GPOS table LookupType",a,"format",m.fmt)}return m},e.GPOS.readValueRecord=function(i,a,l){var u=e._bin,f=[];return f.push(1&l?u.readShort(i,a):0),a+=1&l?2:0,f.push(2&l?u.readShort(i,a):0),a+=2&l?2:0,f.push(4&l?u.readShort(i,a):0),a+=4&l?2:0,f.push(8&l?u.readShort(i,a):0),a+=8&l?2:0,f},e.GPOS.readBaseArray=function(i,a,l){var u=e._bin,f=[],p=a,m=u.readUshort(i,a);a+=2;for(var v=0;v<m;v++){for(var _=[],x=0;x<l;x++)_.push(e.GPOS.readAnchorRecord(i,p+u.readUshort(i,a))),a+=2;f.push(_)}return f},e.GPOS.readMarkArray=function(i,a){var l=e._bin,u=[],f=a,p=l.readUshort(i,a);a+=2;for(var m=0;m<p;m++){var v=e.GPOS.readAnchorRecord(i,l.readUshort(i,a+2)+f);v.markClass=l.readUshort(i,a),u.push(v),a+=4}return u},e.GPOS.readAnchorRecord=function(i,a){var l=e._bin,u={};return u.fmt=l.readUshort(i,a),u.x=l.readShort(i,a+2),u.y=l.readShort(i,a+4),u},e.GSUB={},e.GSUB.parse=function(i,a,l,u){return e._lctf.parse(i,a,l,u,e.GSUB.subt)},e.GSUB.subt=function(i,a,l,u){var f=e._bin,p=l,m={};if(m.fmt=f.readUshort(i,l),l+=2,a!=1&&a!=2&&a!=4&&a!=5&&a!=6)return null;if(a==1||a==2||a==4||a==5&&m.fmt<=2||a==6&&m.fmt<=2){var v=f.readUshort(i,l);l+=2,m.coverage=e._lctf.readCoverage(i,p+v)}if(a==1&&m.fmt>=1&&m.fmt<=2){if(m.fmt==1)m.delta=f.readShort(i,l),l+=2;else if(m.fmt==2){var _=f.readUshort(i,l);l+=2,m.newg=f.readUshorts(i,l,_),l+=2*m.newg.length}}else if(a==2&&m.fmt==1){_=f.readUshort(i,l),l+=2,m.seqs=[];for(var x=0;x<_;x++){var b=f.readUshort(i,l)+p;l+=2;var R=f.readUshort(i,b);m.seqs.push(f.readUshorts(i,b+2,R))}}else if(a==4)for(m.vals=[],_=f.readUshort(i,l),l+=2,x=0;x<_;x++){var T=f.readUshort(i,l);l+=2,m.vals.push(e.GSUB.readLigatureSet(i,p+T))}else if(a==5&&m.fmt==2){if(m.fmt==2){var E=f.readUshort(i,l);l+=2,m.cDef=e._lctf.readClassDef(i,p+E),m.scset=[];var w=f.readUshort(i,l);for(l+=2,x=0;x<w;x++){var D=f.readUshort(i,l);l+=2,m.scset.push(D==0?null:e.GSUB.readSubClassSet(i,p+D))}}}else if(a==6&&m.fmt==3){if(m.fmt==3){for(x=0;x<3;x++){_=f.readUshort(i,l),l+=2;for(var U=[],I=0;I<_;I++)U.push(e._lctf.readCoverage(i,p+f.readUshort(i,l+2*I)));l+=2*_,x==0&&(m.backCvg=U),x==1&&(m.inptCvg=U),x==2&&(m.ahedCvg=U)}_=f.readUshort(i,l),l+=2,m.lookupRec=e.GSUB.readSubstLookupRecords(i,l,_)}}else{if(a==7&&m.fmt==1){var O=f.readUshort(i,l);l+=2;var P=f.readUint(i,l);if(l+=4,u.ltype==9)u.ltype=O;else if(u.ltype!=O)throw"invalid extension substitution";return e.GSUB.subt(i,u.ltype,p+P)}console.debug("unsupported GSUB table LookupType",a,"format",m.fmt)}return m},e.GSUB.readSubClassSet=function(i,a){var l=e._bin.readUshort,u=a,f=[],p=l(i,a);a+=2;for(var m=0;m<p;m++){var v=l(i,a);a+=2,f.push(e.GSUB.readSubClassRule(i,u+v))}return f},e.GSUB.readSubClassRule=function(i,a){var l=e._bin.readUshort,u={},f=l(i,a),p=l(i,a+=2);a+=2,u.input=[];for(var m=0;m<f-1;m++)u.input.push(l(i,a)),a+=2;return u.substLookupRecords=e.GSUB.readSubstLookupRecords(i,a,p),u},e.GSUB.readSubstLookupRecords=function(i,a,l){for(var u=e._bin.readUshort,f=[],p=0;p<l;p++)f.push(u(i,a),u(i,a+2)),a+=4;return f},e.GSUB.readChainSubClassSet=function(i,a){var l=e._bin,u=a,f=[],p=l.readUshort(i,a);a+=2;for(var m=0;m<p;m++){var v=l.readUshort(i,a);a+=2,f.push(e.GSUB.readChainSubClassRule(i,u+v))}return f},e.GSUB.readChainSubClassRule=function(i,a){for(var l=e._bin,u={},f=["backtrack","input","lookahead"],p=0;p<f.length;p++){var m=l.readUshort(i,a);a+=2,p==1&&m--,u[f[p]]=l.readUshorts(i,a,m),a+=2*u[f[p]].length}return m=l.readUshort(i,a),a+=2,u.subst=l.readUshorts(i,a,2*m),a+=2*u.subst.length,u},e.GSUB.readLigatureSet=function(i,a){var l=e._bin,u=a,f=[],p=l.readUshort(i,a);a+=2;for(var m=0;m<p;m++){var v=l.readUshort(i,a);a+=2,f.push(e.GSUB.readLigature(i,u+v))}return f},e.GSUB.readLigature=function(i,a){var l=e._bin,u={chain:[]};u.nglyph=l.readUshort(i,a),a+=2;var f=l.readUshort(i,a);a+=2;for(var p=0;p<f-1;p++)u.chain.push(l.readUshort(i,a)),a+=2;return u},e.head={},e.head.parse=function(i,a,l){var u=e._bin,f={};return u.readFixed(i,a),a+=4,f.fontRevision=u.readFixed(i,a),a+=4,u.readUint(i,a),a+=4,u.readUint(i,a),a+=4,f.flags=u.readUshort(i,a),a+=2,f.unitsPerEm=u.readUshort(i,a),a+=2,f.created=u.readUint64(i,a),a+=8,f.modified=u.readUint64(i,a),a+=8,f.xMin=u.readShort(i,a),a+=2,f.yMin=u.readShort(i,a),a+=2,f.xMax=u.readShort(i,a),a+=2,f.yMax=u.readShort(i,a),a+=2,f.macStyle=u.readUshort(i,a),a+=2,f.lowestRecPPEM=u.readUshort(i,a),a+=2,f.fontDirectionHint=u.readShort(i,a),a+=2,f.indexToLocFormat=u.readShort(i,a),a+=2,f.glyphDataFormat=u.readShort(i,a),a+=2,f},e.hhea={},e.hhea.parse=function(i,a,l){var u=e._bin,f={};return u.readFixed(i,a),a+=4,f.ascender=u.readShort(i,a),a+=2,f.descender=u.readShort(i,a),a+=2,f.lineGap=u.readShort(i,a),a+=2,f.advanceWidthMax=u.readUshort(i,a),a+=2,f.minLeftSideBearing=u.readShort(i,a),a+=2,f.minRightSideBearing=u.readShort(i,a),a+=2,f.xMaxExtent=u.readShort(i,a),a+=2,f.caretSlopeRise=u.readShort(i,a),a+=2,f.caretSlopeRun=u.readShort(i,a),a+=2,f.caretOffset=u.readShort(i,a),a+=2,a+=8,f.metricDataFormat=u.readShort(i,a),a+=2,f.numberOfHMetrics=u.readUshort(i,a),a+=2,f},e.hmtx={},e.hmtx.parse=function(i,a,l,u){for(var f=e._bin,p={aWidth:[],lsBearing:[]},m=0,v=0,_=0;_<u.maxp.numGlyphs;_++)_<u.hhea.numberOfHMetrics&&(m=f.readUshort(i,a),a+=2,v=f.readShort(i,a),a+=2),p.aWidth.push(m),p.lsBearing.push(v);return p},e.kern={},e.kern.parse=function(i,a,l,u){var f=e._bin,p=f.readUshort(i,a);if(a+=2,p==1)return e.kern.parseV1(i,a-2,l,u);var m=f.readUshort(i,a);a+=2;for(var v={glyph1:[],rval:[]},_=0;_<m;_++){a+=2,l=f.readUshort(i,a),a+=2;var x=f.readUshort(i,a);a+=2;var b=x>>>8;if((b&=15)!=0)throw"unknown kern table format: "+b;a=e.kern.readFormat0(i,a,v)}return v},e.kern.parseV1=function(i,a,l,u){var f=e._bin;f.readFixed(i,a),a+=4;var p=f.readUint(i,a);a+=4;for(var m={glyph1:[],rval:[]},v=0;v<p;v++){f.readUint(i,a),a+=4;var _=f.readUshort(i,a);a+=2,f.readUshort(i,a),a+=2;var x=_>>>8;if((x&=15)!=0)throw"unknown kern table format: "+x;a=e.kern.readFormat0(i,a,m)}return m},e.kern.readFormat0=function(i,a,l){var u=e._bin,f=-1,p=u.readUshort(i,a);a+=2,u.readUshort(i,a),a+=2,u.readUshort(i,a),a+=2,u.readUshort(i,a),a+=2;for(var m=0;m<p;m++){var v=u.readUshort(i,a);a+=2;var _=u.readUshort(i,a);a+=2;var x=u.readShort(i,a);a+=2,v!=f&&(l.glyph1.push(v),l.rval.push({glyph2:[],vals:[]}));var b=l.rval[l.rval.length-1];b.glyph2.push(_),b.vals.push(x),f=v}return a},e.loca={},e.loca.parse=function(i,a,l,u){var f=e._bin,p=[],m=u.head.indexToLocFormat,v=u.maxp.numGlyphs+1;if(m==0)for(var _=0;_<v;_++)p.push(f.readUshort(i,a+(_<<1))<<1);if(m==1)for(_=0;_<v;_++)p.push(f.readUint(i,a+(_<<2)));return p},e.maxp={},e.maxp.parse=function(i,a,l){var u=e._bin,f={},p=u.readUint(i,a);return a+=4,f.numGlyphs=u.readUshort(i,a),a+=2,p==65536&&(f.maxPoints=u.readUshort(i,a),a+=2,f.maxContours=u.readUshort(i,a),a+=2,f.maxCompositePoints=u.readUshort(i,a),a+=2,f.maxCompositeContours=u.readUshort(i,a),a+=2,f.maxZones=u.readUshort(i,a),a+=2,f.maxTwilightPoints=u.readUshort(i,a),a+=2,f.maxStorage=u.readUshort(i,a),a+=2,f.maxFunctionDefs=u.readUshort(i,a),a+=2,f.maxInstructionDefs=u.readUshort(i,a),a+=2,f.maxStackElements=u.readUshort(i,a),a+=2,f.maxSizeOfInstructions=u.readUshort(i,a),a+=2,f.maxComponentElements=u.readUshort(i,a),a+=2,f.maxComponentDepth=u.readUshort(i,a),a+=2),f},e.name={},e.name.parse=function(i,a,l){var u=e._bin,f={};u.readUshort(i,a),a+=2;var p=u.readUshort(i,a);a+=2,u.readUshort(i,a);for(var m,v=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],_=a+=2,x=0;x<p;x++){var b=u.readUshort(i,a);a+=2;var R=u.readUshort(i,a);a+=2;var T=u.readUshort(i,a);a+=2;var E=u.readUshort(i,a);a+=2;var w=u.readUshort(i,a);a+=2;var D=u.readUshort(i,a);a+=2;var U,I=v[E],O=_+12*p+D;if(b==0)U=u.readUnicode(i,O,w/2);else if(b==3&&R==0)U=u.readUnicode(i,O,w/2);else if(R==0)U=u.readASCII(i,O,w);else if(R==1)U=u.readUnicode(i,O,w/2);else if(R==3)U=u.readUnicode(i,O,w/2);else{if(b!=1)throw"unknown encoding "+R+", platformID: "+b;U=u.readASCII(i,O,w),console.debug("reading unknown MAC encoding "+R+" as ASCII")}var P="p"+b+","+T.toString(16);f[P]==null&&(f[P]={}),f[P][I!==void 0?I:E]=U,f[P]._lang=T}for(var B in f)if(f[B].postScriptName!=null&&f[B]._lang==1033)return f[B];for(var B in f)if(f[B].postScriptName!=null&&f[B]._lang==0)return f[B];for(var B in f)if(f[B].postScriptName!=null&&f[B]._lang==3084)return f[B];for(var B in f)if(f[B].postScriptName!=null)return f[B];for(var B in f){m=B;break}return console.debug("returning name table with languageID "+f[m]._lang),f[m]},e["OS/2"]={},e["OS/2"].parse=function(i,a,l){var u=e._bin.readUshort(i,a);a+=2;var f={};if(u==0)e["OS/2"].version0(i,a,f);else if(u==1)e["OS/2"].version1(i,a,f);else if(u==2||u==3||u==4)e["OS/2"].version2(i,a,f);else{if(u!=5)throw"unknown OS/2 table version: "+u;e["OS/2"].version5(i,a,f)}return f},e["OS/2"].version0=function(i,a,l){var u=e._bin;return l.xAvgCharWidth=u.readShort(i,a),a+=2,l.usWeightClass=u.readUshort(i,a),a+=2,l.usWidthClass=u.readUshort(i,a),a+=2,l.fsType=u.readUshort(i,a),a+=2,l.ySubscriptXSize=u.readShort(i,a),a+=2,l.ySubscriptYSize=u.readShort(i,a),a+=2,l.ySubscriptXOffset=u.readShort(i,a),a+=2,l.ySubscriptYOffset=u.readShort(i,a),a+=2,l.ySuperscriptXSize=u.readShort(i,a),a+=2,l.ySuperscriptYSize=u.readShort(i,a),a+=2,l.ySuperscriptXOffset=u.readShort(i,a),a+=2,l.ySuperscriptYOffset=u.readShort(i,a),a+=2,l.yStrikeoutSize=u.readShort(i,a),a+=2,l.yStrikeoutPosition=u.readShort(i,a),a+=2,l.sFamilyClass=u.readShort(i,a),a+=2,l.panose=u.readBytes(i,a,10),a+=10,l.ulUnicodeRange1=u.readUint(i,a),a+=4,l.ulUnicodeRange2=u.readUint(i,a),a+=4,l.ulUnicodeRange3=u.readUint(i,a),a+=4,l.ulUnicodeRange4=u.readUint(i,a),a+=4,l.achVendID=[u.readInt8(i,a),u.readInt8(i,a+1),u.readInt8(i,a+2),u.readInt8(i,a+3)],a+=4,l.fsSelection=u.readUshort(i,a),a+=2,l.usFirstCharIndex=u.readUshort(i,a),a+=2,l.usLastCharIndex=u.readUshort(i,a),a+=2,l.sTypoAscender=u.readShort(i,a),a+=2,l.sTypoDescender=u.readShort(i,a),a+=2,l.sTypoLineGap=u.readShort(i,a),a+=2,l.usWinAscent=u.readUshort(i,a),a+=2,l.usWinDescent=u.readUshort(i,a),a+=2},e["OS/2"].version1=function(i,a,l){var u=e._bin;return a=e["OS/2"].version0(i,a,l),l.ulCodePageRange1=u.readUint(i,a),a+=4,l.ulCodePageRange2=u.readUint(i,a),a+=4},e["OS/2"].version2=function(i,a,l){var u=e._bin;return a=e["OS/2"].version1(i,a,l),l.sxHeight=u.readShort(i,a),a+=2,l.sCapHeight=u.readShort(i,a),a+=2,l.usDefault=u.readUshort(i,a),a+=2,l.usBreak=u.readUshort(i,a),a+=2,l.usMaxContext=u.readUshort(i,a),a+=2},e["OS/2"].version5=function(i,a,l){var u=e._bin;return a=e["OS/2"].version2(i,a,l),l.usLowerOpticalPointSize=u.readUshort(i,a),a+=2,l.usUpperOpticalPointSize=u.readUshort(i,a),a+=2},e.post={},e.post.parse=function(i,a,l){var u=e._bin,f={};return f.version=u.readFixed(i,a),a+=4,f.italicAngle=u.readFixed(i,a),a+=4,f.underlinePosition=u.readShort(i,a),a+=2,f.underlineThickness=u.readShort(i,a),a+=2,f},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(i,a){var l=i.cmap,u=-1;if(l.p0e4!=null?u=l.p0e4:l.p3e1!=null?u=l.p3e1:l.p1e0!=null?u=l.p1e0:l.p0e3!=null&&(u=l.p0e3),u==-1)throw"no familiar platform and encoding!";var f=l.tables[u];if(f.format==0)return a>=f.map.length?0:f.map[a];if(f.format==4){for(var p=-1,m=0;m<f.endCount.length;m++)if(a<=f.endCount[m]){p=m;break}return p==-1||f.startCount[p]>a?0:65535&(f.idRangeOffset[p]!=0?f.glyphIdArray[a-f.startCount[p]+(f.idRangeOffset[p]>>1)-(f.idRangeOffset.length-p)]:a+f.idDelta[p])}if(f.format==12){if(a>f.groups[f.groups.length-1][1])return 0;for(m=0;m<f.groups.length;m++){var v=f.groups[m];if(v[0]<=a&&a<=v[1])return v[2]+(a-v[0])}return 0}throw"unknown cmap table format "+f.format},e.U.glyphToPath=function(i,a){var l={cmds:[],crds:[]};if(i.SVG&&i.SVG.entries[a]){var u=i.SVG.entries[a];return u==null?l:(typeof u=="string"&&(u=e.SVG.toPath(u),i.SVG.entries[a]=u),u)}if(i.CFF){var f={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:i.CFF.Private?i.CFF.Private.defaultWidthX:0,open:!1},p=i.CFF,m=i.CFF.Private;if(p.ROS){for(var v=0;p.FDSelect[v+2]<=a;)v+=2;m=p.FDArray[p.FDSelect[v+1]].Private}e.U._drawCFF(i.CFF.CharStrings[a],f,p,m,l)}else i.glyf&&e.U._drawGlyf(a,i,l);return l},e.U._drawGlyf=function(i,a,l){var u=a.glyf[i];u==null&&(u=a.glyf[i]=e.glyf._parseGlyf(a,i)),u!=null&&(u.noc>-1?e.U._simpleGlyph(u,l):e.U._compoGlyph(u,a,l))},e.U._simpleGlyph=function(i,a){for(var l=0;l<i.noc;l++){for(var u=l==0?0:i.endPts[l-1]+1,f=i.endPts[l],p=u;p<=f;p++){var m=p==u?f:p-1,v=p==f?u:p+1,_=1&i.flags[p],x=1&i.flags[m],b=1&i.flags[v],R=i.xs[p],T=i.ys[p];if(p==u)if(_){if(!x){e.U.P.moveTo(a,R,T);continue}e.U.P.moveTo(a,i.xs[m],i.ys[m])}else x?e.U.P.moveTo(a,i.xs[m],i.ys[m]):e.U.P.moveTo(a,(i.xs[m]+R)/2,(i.ys[m]+T)/2);_?x&&e.U.P.lineTo(a,R,T):b?e.U.P.qcurveTo(a,R,T,i.xs[v],i.ys[v]):e.U.P.qcurveTo(a,R,T,(R+i.xs[v])/2,(T+i.ys[v])/2)}e.U.P.closePath(a)}},e.U._compoGlyph=function(i,a,l){for(var u=0;u<i.parts.length;u++){var f={cmds:[],crds:[]},p=i.parts[u];e.U._drawGlyf(p.glyphIndex,a,f);for(var m=p.m,v=0;v<f.crds.length;v+=2){var _=f.crds[v],x=f.crds[v+1];l.crds.push(_*m.a+x*m.b+m.tx),l.crds.push(_*m.c+x*m.d+m.ty)}for(v=0;v<f.cmds.length;v++)l.cmds.push(f.cmds[v])}},e.U._getGlyphClass=function(i,a){var l=e._lctf.getInterval(a,i);return l==-1?0:a[l+2]},e.U._applySubs=function(i,a,l,u){for(var f=i.length-a-1,p=0;p<l.tabs.length;p++)if(l.tabs[p]!=null){var m,v=l.tabs[p];if(!v.coverage||(m=e._lctf.coverageIndex(v.coverage,i[a]))!=-1){if(l.ltype==1)i[a],v.fmt==1?i[a]=i[a]+v.delta:i[a]=v.newg[m];else if(l.ltype==4)for(var _=v.vals[m],x=0;x<_.length;x++){var b=_[x],R=b.chain.length;if(!(R>f)){for(var T=!0,E=0,w=0;w<R;w++){for(;i[a+E+(1+w)]==-1;)E++;b.chain[w]!=i[a+E+(1+w)]&&(T=!1)}if(T){for(i[a]=b.nglyph,w=0;w<R+E;w++)i[a+w+1]=-1;break}}}else if(l.ltype==5&&v.fmt==2)for(var D=e._lctf.getInterval(v.cDef,i[a]),U=v.cDef[D+2],I=v.scset[U],O=0;O<I.length;O++){var P=I[O],B=P.input;if(!(B.length>f)){for(T=!0,w=0;w<B.length;w++){var N=e._lctf.getInterval(v.cDef,i[a+1+w]);if(D==-1&&v.cDef[N+2]!=B[w]){T=!1;break}}if(T){var z=P.substLookupRecords;for(x=0;x<z.length;x+=2)z[x],z[x+1]}}}else if(l.ltype==6&&v.fmt==3){if(!e.U._glsCovered(i,v.backCvg,a-v.backCvg.length)||!e.U._glsCovered(i,v.inptCvg,a)||!e.U._glsCovered(i,v.ahedCvg,a+v.inptCvg.length))continue;var q=v.lookupRec;for(O=0;O<q.length;O+=2){D=q[O];var Y=u[q[O+1]];e.U._applySubs(i,a+D,Y,u)}}}}},e.U._glsCovered=function(i,a,l){for(var u=0;u<a.length;u++)if(e._lctf.coverageIndex(a[u],i[l+u])==-1)return!1;return!0},e.U.glyphsToPath=function(i,a,l){for(var u={cmds:[],crds:[]},f=0,p=0;p<a.length;p++){var m=a[p];if(m!=-1){for(var v=p<a.length-1&&a[p+1]!=-1?a[p+1]:0,_=e.U.glyphToPath(i,m),x=0;x<_.crds.length;x+=2)u.crds.push(_.crds[x]+f),u.crds.push(_.crds[x+1]);for(l&&u.cmds.push(l),x=0;x<_.cmds.length;x++)u.cmds.push(_.cmds[x]);l&&u.cmds.push("X"),f+=i.hmtx.aWidth[m],p<a.length-1&&(f+=e.U.getPairAdjustment(i,m,v))}}return u},e.U.P={},e.U.P.moveTo=function(i,a,l){i.cmds.push("M"),i.crds.push(a,l)},e.U.P.lineTo=function(i,a,l){i.cmds.push("L"),i.crds.push(a,l)},e.U.P.curveTo=function(i,a,l,u,f,p,m){i.cmds.push("C"),i.crds.push(a,l,u,f,p,m)},e.U.P.qcurveTo=function(i,a,l,u,f){i.cmds.push("Q"),i.crds.push(a,l,u,f)},e.U.P.closePath=function(i){i.cmds.push("Z")},e.U._drawCFF=function(i,a,l,u,f){for(var p=a.stack,m=a.nStems,v=a.haveWidth,_=a.width,x=a.open,b=0,R=a.x,T=a.y,E=0,w=0,D=0,U=0,I=0,O=0,P=0,B=0,N=0,z=0,q={val:0,size:0};b<i.length;){e.CFF.getCharString(i,b,q);var Y=q.val;if(b+=q.size,Y=="o1"||Y=="o18")p.length%2!=0&&!v&&(_=p.shift()+u.nominalWidthX),m+=p.length>>1,p.length=0,v=!0;else if(Y=="o3"||Y=="o23")p.length%2!=0&&!v&&(_=p.shift()+u.nominalWidthX),m+=p.length>>1,p.length=0,v=!0;else if(Y=="o4")p.length>1&&!v&&(_=p.shift()+u.nominalWidthX,v=!0),x&&e.U.P.closePath(f),T+=p.pop(),e.U.P.moveTo(f,R,T),x=!0;else if(Y=="o5")for(;p.length>0;)R+=p.shift(),T+=p.shift(),e.U.P.lineTo(f,R,T);else if(Y=="o6"||Y=="o7")for(var Q=p.length,Z=Y=="o6",ae=0;ae<Q;ae++){var G=p.shift();Z?R+=G:T+=G,Z=!Z,e.U.P.lineTo(f,R,T)}else if(Y=="o8"||Y=="o24"){Q=p.length;for(var ee=0;ee+6<=Q;)E=R+p.shift(),w=T+p.shift(),D=E+p.shift(),U=w+p.shift(),R=D+p.shift(),T=U+p.shift(),e.U.P.curveTo(f,E,w,D,U,R,T),ee+=6;Y=="o24"&&(R+=p.shift(),T+=p.shift(),e.U.P.lineTo(f,R,T))}else{if(Y=="o11")break;if(Y=="o1234"||Y=="o1235"||Y=="o1236"||Y=="o1237")Y=="o1234"&&(w=T,D=(E=R+p.shift())+p.shift(),z=U=w+p.shift(),O=U,B=T,R=(P=(I=(N=D+p.shift())+p.shift())+p.shift())+p.shift(),e.U.P.curveTo(f,E,w,D,U,N,z),e.U.P.curveTo(f,I,O,P,B,R,T)),Y=="o1235"&&(E=R+p.shift(),w=T+p.shift(),D=E+p.shift(),U=w+p.shift(),N=D+p.shift(),z=U+p.shift(),I=N+p.shift(),O=z+p.shift(),P=I+p.shift(),B=O+p.shift(),R=P+p.shift(),T=B+p.shift(),p.shift(),e.U.P.curveTo(f,E,w,D,U,N,z),e.U.P.curveTo(f,I,O,P,B,R,T)),Y=="o1236"&&(E=R+p.shift(),w=T+p.shift(),D=E+p.shift(),z=U=w+p.shift(),O=U,P=(I=(N=D+p.shift())+p.shift())+p.shift(),B=O+p.shift(),R=P+p.shift(),e.U.P.curveTo(f,E,w,D,U,N,z),e.U.P.curveTo(f,I,O,P,B,R,T)),Y=="o1237"&&(E=R+p.shift(),w=T+p.shift(),D=E+p.shift(),U=w+p.shift(),N=D+p.shift(),z=U+p.shift(),I=N+p.shift(),O=z+p.shift(),P=I+p.shift(),B=O+p.shift(),Math.abs(P-R)>Math.abs(B-T)?R=P+p.shift():T=B+p.shift(),e.U.P.curveTo(f,E,w,D,U,N,z),e.U.P.curveTo(f,I,O,P,B,R,T));else if(Y=="o14"){if(p.length>0&&!v&&(_=p.shift()+l.nominalWidthX,v=!0),p.length==4){var ie=p.shift(),fe=p.shift(),ce=p.shift(),H=p.shift(),W=e.CFF.glyphBySE(l,ce),re=e.CFF.glyphBySE(l,H);e.U._drawCFF(l.CharStrings[W],a,l,u,f),a.x=ie,a.y=fe,e.U._drawCFF(l.CharStrings[re],a,l,u,f)}x&&(e.U.P.closePath(f),x=!1)}else if(Y=="o19"||Y=="o20")p.length%2!=0&&!v&&(_=p.shift()+u.nominalWidthX),m+=p.length>>1,p.length=0,v=!0,b+=m+7>>3;else if(Y=="o21")p.length>2&&!v&&(_=p.shift()+u.nominalWidthX,v=!0),T+=p.pop(),R+=p.pop(),x&&e.U.P.closePath(f),e.U.P.moveTo(f,R,T),x=!0;else if(Y=="o22")p.length>1&&!v&&(_=p.shift()+u.nominalWidthX,v=!0),R+=p.pop(),x&&e.U.P.closePath(f),e.U.P.moveTo(f,R,T),x=!0;else if(Y=="o25"){for(;p.length>6;)R+=p.shift(),T+=p.shift(),e.U.P.lineTo(f,R,T);E=R+p.shift(),w=T+p.shift(),D=E+p.shift(),U=w+p.shift(),R=D+p.shift(),T=U+p.shift(),e.U.P.curveTo(f,E,w,D,U,R,T)}else if(Y=="o26")for(p.length%2&&(R+=p.shift());p.length>0;)E=R,w=T+p.shift(),R=D=E+p.shift(),T=(U=w+p.shift())+p.shift(),e.U.P.curveTo(f,E,w,D,U,R,T);else if(Y=="o27")for(p.length%2&&(T+=p.shift());p.length>0;)w=T,D=(E=R+p.shift())+p.shift(),U=w+p.shift(),R=D+p.shift(),T=U,e.U.P.curveTo(f,E,w,D,U,R,T);else if(Y=="o10"||Y=="o29"){var de=Y=="o10"?u:l;if(p.length==0)console.debug("error: empty stack");else{var ge=p.pop(),oe=de.Subrs[ge+de.Bias];a.x=R,a.y=T,a.nStems=m,a.haveWidth=v,a.width=_,a.open=x,e.U._drawCFF(oe,a,l,u,f),R=a.x,T=a.y,m=a.nStems,v=a.haveWidth,_=a.width,x=a.open}}else if(Y=="o30"||Y=="o31"){var he=p.length,Ee=(ee=0,Y=="o31");for(ee+=he-(Q=-3&he);ee<Q;)Ee?(w=T,D=(E=R+p.shift())+p.shift(),T=(U=w+p.shift())+p.shift(),Q-ee==5?(R=D+p.shift(),ee++):R=D,Ee=!1):(E=R,w=T+p.shift(),D=E+p.shift(),U=w+p.shift(),R=D+p.shift(),Q-ee==5?(T=U+p.shift(),ee++):T=U,Ee=!0),e.U.P.curveTo(f,E,w,D,U,R,T),ee+=4}else{if((Y+"").charAt(0)=="o")throw console.debug("Unknown operation: "+Y,i),Y;p.push(Y)}}}a.x=R,a.y=T,a.nStems=m,a.haveWidth=v,a.width=_,a.open=x};var t=e,n={Typr:t};return s.Typr=t,s.default=n,Object.defineProperty(s,"__esModule",{value:!0}),s})({}).Typr}function nB(){return(function(s){var e=Uint8Array,t=Uint16Array,n=Uint32Array,i=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),l=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),u=function(Y,Q){for(var Z=new t(31),ae=0;ae<31;++ae)Z[ae]=Q+=1<<Y[ae-1];var G=new n(Z[30]);for(ae=1;ae<30;++ae)for(var ee=Z[ae];ee<Z[ae+1];++ee)G[ee]=ee-Z[ae]<<5|ae;return[Z,G]},f=u(i,2),p=f[0],m=f[1];p[28]=258,m[258]=28;for(var v=u(a,0)[0],_=new t(32768),x=0;x<32768;++x){var b=(43690&x)>>>1|(21845&x)<<1;b=(61680&(b=(52428&b)>>>2|(13107&b)<<2))>>>4|(3855&b)<<4,_[x]=((65280&b)>>>8|(255&b)<<8)>>>1}var R=function(Y,Q,Z){for(var ae=Y.length,G=0,ee=new t(Q);G<ae;++G)++ee[Y[G]-1];var ie,fe=new t(Q);for(G=0;G<Q;++G)fe[G]=fe[G-1]+ee[G-1]<<1;{ie=new t(1<<Q);var ce=15-Q;for(G=0;G<ae;++G)if(Y[G])for(var H=G<<4|Y[G],W=Q-Y[G],re=fe[Y[G]-1]++<<W,de=re|(1<<W)-1;re<=de;++re)ie[_[re]>>>ce]=H}return ie},T=new e(288);for(x=0;x<144;++x)T[x]=8;for(x=144;x<256;++x)T[x]=9;for(x=256;x<280;++x)T[x]=7;for(x=280;x<288;++x)T[x]=8;var E=new e(32);for(x=0;x<32;++x)E[x]=5;var w=R(T,9),D=R(E,5),U=function(Y){for(var Q=Y[0],Z=1;Z<Y.length;++Z)Y[Z]>Q&&(Q=Y[Z]);return Q},I=function(Y,Q,Z){var ae=Q/8|0;return(Y[ae]|Y[ae+1]<<8)>>(7&Q)&Z},O=function(Y,Q){var Z=Q/8|0;return(Y[Z]|Y[Z+1]<<8|Y[Z+2]<<16)>>(7&Q)},P=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],B=function(Y,Q,Z){var ae=new Error(Q||P[Y]);if(ae.code=Y,Error.captureStackTrace&&Error.captureStackTrace(ae,B),!Z)throw ae;return ae},N=function(Y,Q,Z){var ae=Y.length;if(!ae||Z&&!Z.l&&ae<5)return Q||new e(0);var G=!Q||Z,ee=!Z||Z.i;Z||(Z={}),Q||(Q=new e(3*ae));var ie,fe=function(lt){var le=Q.length;if(lt>le){var Te=new e(Math.max(2*le,lt));Te.set(Q),Q=Te}},ce=Z.f||0,H=Z.p||0,W=Z.b||0,re=Z.l,de=Z.d,ge=Z.m,oe=Z.n,he=8*ae;do{if(!re){Z.f=ce=I(Y,H,1);var Ee=I(Y,H+1,3);if(H+=3,!Ee){var We=Y[(Fe=((ie=H)/8|0)+(7&ie&&1)+4)-4]|Y[Fe-3]<<8,rt=Fe+We;if(rt>ae){ee&&B(0);break}G&&fe(W+We),Q.set(Y.subarray(Fe,rt),W),Z.b=W+=We,Z.p=H=8*rt;continue}if(Ee==1)re=w,de=D,ge=9,oe=5;else if(Ee==2){var st=I(Y,H,31)+257,et=I(Y,H+10,15)+4,se=st+I(Y,H+5,31)+1;H+=14;for(var Ie=new e(se),Oe=new e(19),Ue=0;Ue<et;++Ue)Oe[l[Ue]]=I(Y,H+3*Ue,7);H+=3*et;var Le=U(Oe),ze=(1<<Le)-1,Pe=R(Oe,Le);for(Ue=0;Ue<se;){var Fe,Ne=Pe[I(Y,H,ze)];if(H+=15&Ne,(Fe=Ne>>>4)<16)Ie[Ue++]=Fe;else{var yt=0,j=0;for(Fe==16?(j=3+I(Y,H,3),H+=2,yt=Ie[Ue-1]):Fe==17?(j=3+I(Y,H,7),H+=3):Fe==18&&(j=11+I(Y,H,127),H+=7);j--;)Ie[Ue++]=yt}}var V=Ie.subarray(0,st),ve=Ie.subarray(st);ge=U(V),oe=U(ve),re=R(V,ge),de=R(ve,oe)}else B(1);if(H>he){ee&&B(0);break}}G&&fe(W+131072);for(var Be=(1<<ge)-1,De=(1<<oe)-1,Ae=H;;Ae=H){var gt=(yt=re[O(Y,H)&Be])>>>4;if((H+=15&yt)>he){ee&&B(0);break}if(yt||B(2),gt<256)Q[W++]=gt;else{if(gt==256){Ae=H,re=null;break}var ct=gt-254;if(gt>264){var _t=i[Ue=gt-257];ct=I(Y,H,(1<<_t)-1)+p[Ue],H+=_t}var bt=de[O(Y,H)&De],ke=bt>>>4;if(bt||B(3),H+=15&bt,ve=v[ke],ke>3&&(_t=a[ke],ve+=O(Y,H)&(1<<_t)-1,H+=_t),H>he){ee&&B(0);break}G&&fe(W+131072);for(var Xe=W+ct;W<Xe;W+=4)Q[W]=Q[W-ve],Q[W+1]=Q[W+1-ve],Q[W+2]=Q[W+2-ve],Q[W+3]=Q[W+3-ve];W=Xe}}Z.l=re,Z.p=Ae,Z.b=W,re&&(ce=1,Z.m=ge,Z.d=de,Z.n=oe)}while(!ce);return W==Q.length?Q:(function(lt,le,Te){(Te==null||Te>lt.length)&&(Te=lt.length);var ut=new(lt instanceof t?t:lt instanceof n?n:e)(Te-le);return ut.set(lt.subarray(le,Te)),ut})(Q,0,W)},z=new e(0),q=typeof TextDecoder<"u"&&new TextDecoder;try{q.decode(z,{stream:!0})}catch{}return s.convert_streams=function(Y){var Q=new DataView(Y),Z=0;function ae(){var st=Q.getUint16(Z);return Z+=2,st}function G(){var st=Q.getUint32(Z);return Z+=4,st}function ee(st){We.setUint16(rt,st),rt+=2}function ie(st){We.setUint32(rt,st),rt+=4}for(var fe={signature:G(),flavor:G(),length:G(),numTables:ae(),reserved:ae(),totalSfntSize:G(),majorVersion:ae(),minorVersion:ae(),metaOffset:G(),metaLength:G(),metaOrigLength:G(),privOffset:G(),privLength:G()},ce=0;Math.pow(2,ce)<=fe.numTables;)ce++;ce--;for(var H=16*Math.pow(2,ce),W=16*fe.numTables-H,re=12,de=[],ge=0;ge<fe.numTables;ge++)de.push({tag:G(),offset:G(),compLength:G(),origLength:G(),origChecksum:G()}),re+=16;var oe,he=new Uint8Array(12+16*de.length+de.reduce((function(st,et){return st+et.origLength+4}),0)),Ee=he.buffer,We=new DataView(Ee),rt=0;return ie(fe.flavor),ee(fe.numTables),ee(H),ee(ce),ee(W),de.forEach((function(st){ie(st.tag),ie(st.origChecksum),ie(re),ie(st.origLength),st.outOffset=re,(re+=st.origLength)%4!=0&&(re+=4-re%4)})),de.forEach((function(st){var et,se=Y.slice(st.offset,st.offset+st.compLength);if(st.compLength!=st.origLength){var Ie=new Uint8Array(st.origLength);et=new Uint8Array(se,2),N(et,Ie)}else Ie=new Uint8Array(se);he.set(Ie,st.outOffset);var Oe=0;(re=st.outOffset+st.origLength)%4!=0&&(Oe=4-re%4),he.set(new Uint8Array(Oe).buffer,st.outOffset+st.origLength),oe=re+Oe})),Ee.slice(0,oe)},Object.defineProperty(s,"__esModule",{value:!0}),s})({}).convert_streams}function iB(s,e){const t={M:2,L:2,Q:4,C:6,Z:0},n={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},i=1,a=2,l=4,u=8,f=16,p=32;let m;function v(P){if(!m){const B={R:a,L:i,D:l,C:f,U:p,T:u};m=new Map;for(let N in n){let z=0;n[N].split(",").forEach(q=>{let[Y,Q]=q.split("+");Y=parseInt(Y,36),Q=Q?parseInt(Q,36):0,m.set(z+=Y,B[N]);for(let Z=Q;Z--;)m.set(++z,B[N])})}}return m.get(P)||p}const _=1,x=2,b=3,R=4,T=[null,"isol","init","fina","medi"];function E(P){const B=new Uint8Array(P.length);let N=p,z=_,q=-1;for(let Y=0;Y<P.length;Y++){const Q=P.codePointAt(Y);let Z=v(Q)|0,ae=_;Z&u||(N&(i|l|f)?Z&(a|l|f)?(ae=b,(z===_||z===b)&&B[q]++):Z&(i|p)&&(z===x||z===R)&&B[q]--:N&(a|p)&&(z===x||z===R)&&B[q]--,z=B[Y]=ae,N=Z,q=Y,Q>65535&&Y++)}return B}function w(P,B){const N=[];for(let q=0;q<B.length;q++){const Y=B.codePointAt(q);Y>65535&&q++,N.push(s.U.codeToGlyph(P,Y))}const z=P.GSUB;if(z){const{lookupList:q,featureList:Y}=z;let Q;const Z=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,ae=[];Y.forEach(G=>{if(Z.test(G.tag))for(let ee=0;ee<G.tab.length;ee++){if(ae[G.tab[ee]])continue;ae[G.tab[ee]]=!0;const ie=q[G.tab[ee]],fe=/^(isol|init|fina|medi)$/.test(G.tag);fe&&!Q&&(Q=E(B));for(let ce=0;ce<N.length;ce++)(!Q||!fe||T[Q[ce]]===G.tag)&&s.U._applySubs(N,ce,ie,q)}})}return N}function D(P,B){const N=new Int16Array(B.length*3);let z=0;for(;z<B.length;z++){const Z=B[z];if(Z===-1)continue;N[z*3+2]=P.hmtx.aWidth[Z];const ae=P.GPOS;if(ae){const G=ae.lookupList;for(let ee=0;ee<G.length;ee++){const ie=G[ee];for(let fe=0;fe<ie.tabs.length;fe++){const ce=ie.tabs[fe];if(ie.ltype===1){if(s._lctf.coverageIndex(ce.coverage,Z)!==-1&&ce.pos){Q(ce.pos,z);break}}else if(ie.ltype===2){let H=null,W=q();if(W!==-1){const re=s._lctf.coverageIndex(ce.coverage,B[W]);if(re!==-1){if(ce.fmt===1){const de=ce.pairsets[re];for(let ge=0;ge<de.length;ge++)de[ge].gid2===Z&&(H=de[ge])}else if(ce.fmt===2){const de=s.U._getGlyphClass(B[W],ce.classDef1),ge=s.U._getGlyphClass(Z,ce.classDef2);H=ce.matrix[de][ge]}if(H){H.val1&&Q(H.val1,W),H.val2&&Q(H.val2,z);break}}}}else if(ie.ltype===4){const H=s._lctf.coverageIndex(ce.markCoverage,Z);if(H!==-1){const W=q(Y),re=W===-1?-1:s._lctf.coverageIndex(ce.baseCoverage,B[W]);if(re!==-1){const de=ce.markArray[H],ge=ce.baseArray[re][de.markClass];N[z*3]=ge.x-de.x+N[W*3]-N[W*3+2],N[z*3+1]=ge.y-de.y+N[W*3+1];break}}}else if(ie.ltype===6){const H=s._lctf.coverageIndex(ce.mark1Coverage,Z);if(H!==-1){const W=q();if(W!==-1){const re=B[W];if(U(P,re)===3){const de=s._lctf.coverageIndex(ce.mark2Coverage,re);if(de!==-1){const ge=ce.mark1Array[H],oe=ce.mark2Array[de][ge.markClass];N[z*3]=oe.x-ge.x+N[W*3]-N[W*3+2],N[z*3+1]=oe.y-ge.y+N[W*3+1];break}}}}}}}}else if(P.kern&&!P.cff){const G=q();if(G!==-1){const ee=P.kern.glyph1.indexOf(B[G]);if(ee!==-1){const ie=P.kern.rval[ee].glyph2.indexOf(Z);ie!==-1&&(N[G*3+2]+=P.kern.rval[ee].vals[ie])}}}}return N;function q(Z){for(let ae=z-1;ae>=0;ae--)if(B[ae]!==-1&&(!Z||Z(B[ae])))return ae;return-1}function Y(Z){return U(P,Z)===1}function Q(Z,ae){for(let G=0;G<3;G++)N[ae*3+G]+=Z[G]||0}}function U(P,B){const N=P.GDEF&&P.GDEF.glyphClassDef;return N?s.U._getGlyphClass(B,N):0}function I(...P){for(let B=0;B<P.length;B++)if(typeof P[B]=="number")return P[B]}function O(P){const B=Object.create(null),N=P["OS/2"],z=P.hhea,q=P.head.unitsPerEm,Y=I(N&&N.sTypoAscender,z&&z.ascender,q),Q={unitsPerEm:q,ascender:Y,descender:I(N&&N.sTypoDescender,z&&z.descender,0),capHeight:I(N&&N.sCapHeight,Y),xHeight:I(N&&N.sxHeight,Y),lineGap:I(N&&N.sTypoLineGap,z&&z.lineGap),supportsCodePoint(Z){return s.U.codeToGlyph(P,Z)>0},forEachGlyph(Z,ae,G,ee){let ie=0;const fe=1/Q.unitsPerEm*ae,ce=w(P,Z);let H=0;const W=D(P,ce);return ce.forEach((re,de)=>{if(re!==-1){let ge=B[re];if(!ge){const{cmds:oe,crds:he}=s.U.glyphToPath(P,re);let Ee="",We=0;for(let Ie=0,Oe=oe.length;Ie<Oe;Ie++){const Ue=t[oe[Ie]];Ee+=oe[Ie];for(let Le=1;Le<=Ue;Le++)Ee+=(Le>1?",":"")+he[We++]}let rt,st,et,se;if(he.length){rt=st=1/0,et=se=-1/0;for(let Ie=0,Oe=he.length;Ie<Oe;Ie+=2){let Ue=he[Ie],Le=he[Ie+1];Ue<rt&&(rt=Ue),Le<st&&(st=Le),Ue>et&&(et=Ue),Le>se&&(se=Le)}}else rt=et=st=se=0;ge=B[re]={index:re,advanceWidth:P.hmtx.aWidth[re],xMin:rt,yMin:st,xMax:et,yMax:se,path:Ee}}ee.call(null,ge,ie+W[de*3]*fe,W[de*3+1]*fe,H),ie+=W[de*3+2]*fe,G&&(ie+=G*ae)}H+=Z.codePointAt(H)>65535?2:1}),ie}};return Q}return function(B){const N=new Uint8Array(B,0,4),z=s._bin.readASCII(N,0,4);if(z==="wOFF")B=e(B);else if(z==="wOF2")throw new Error("woff2 fonts not supported");return O(s.parse(B)[0])}}const aB=Qd({name:"Typr Font Parser",dependencies:[tB,nB,iB],init(s,e,t){const n=s(),i=e();return t(n,i)}});function rB(){return(function(s){var e=function(){this.buckets=new Map};e.prototype.add=function(D){var U=D>>5;this.buckets.set(U,(this.buckets.get(U)||0)|1<<(31&D))},e.prototype.has=function(D){var U=this.buckets.get(D>>5);return U!==void 0&&(U&1<<(31&D))!=0},e.prototype.serialize=function(){var D=[];return this.buckets.forEach((function(U,I){D.push((+I).toString(36)+":"+U.toString(36))})),D.join(",")},e.prototype.deserialize=function(D){var U=this;this.buckets.clear(),D.split(",").forEach((function(I){var O=I.split(":");U.buckets.set(parseInt(O[0],36),parseInt(O[1],36))}))};var t=Math.pow(2,8),n=t-1,i=~n;function a(D){var U=(function(O){return O&i})(D).toString(16),I=(function(O){return(O&i)+t-1})(D).toString(16);return"codepoint-index/plane"+(D>>16)+"/"+U+"-"+I+".json"}function l(D,U){var I=D&n,O=U.codePointAt(I/6|0);return((O=(O||48)-48)&1<<I%6)!=0}function u(D,U){var I;(I=D,I.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map((function(O){return O.split("-").map((function(P){return parseInt(P.trim(),16)}))}))).forEach((function(O){var P=O[0],B=O[1];B===void 0&&(B=P),U(P,B)}))}function f(D,U){u(D,(function(I,O){for(var P=I;P<=O;P++)U(P)}))}var p={},m={},v=new WeakMap,_="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function x(D){var U=v.get(D);return U||(U=new e,f(D.ranges,(function(I){return U.add(I)})),v.set(D,U)),U}var b,R=new Map;function T(D,U,I){return D[U]?U:D[I]?I:(function(O){for(var P in O)return P})(D)}function E(D,U){var I=U;if(!D.includes(I)){I=1/0;for(var O=0;O<D.length;O++)Math.abs(D[O]-U)<Math.abs(I-U)&&(I=D[O])}return I}function w(D){return b||(b=new Set,f("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",(function(U){b.add(U)}))),b.has(D)}return s.CodePointSet=e,s.clearCache=function(){p={},m={}},s.getFontsForString=function(D,U){U===void 0&&(U={});var I,O=U.lang;O===void 0&&(O=new RegExp("\\p{Script=Hangul}","u").test(I=D)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(I)?"ja":"en");var P=U.category;P===void 0&&(P="sans-serif");var B=U.style;B===void 0&&(B="normal");var N=U.weight;N===void 0&&(N=400);var z=(U.dataUrl||_).replace(/\/$/g,""),q=new Map,Y=new Uint8Array(D.length),Q={},Z={},ae=new Array(D.length),G=new Map,ee=!1;function ie(H){var W=R.get(H);return W||(W=fetch(z+"/"+H).then((function(re){if(!re.ok)throw new Error(re.statusText);return re.json().then((function(de){if(!Array.isArray(de)||de[0]!==1)throw new Error("Incorrect schema version; need 1, got "+de[0]);return de[1]}))})).catch((function(re){if(z!==_)return ee||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+z+'", trying default CDN. '+re.message),ee=!0),z=_,R.delete(H),ie(H);throw re})),R.set(H,W)),W}for(var fe=function(H){var W=D.codePointAt(H),re=a(W);ae[H]=re,p[re]||G.has(re)||G.set(re,ie(re).then((function(de){p[re]=de}))),W>65535&&(H++,ce=H)},ce=0;ce<D.length;ce++)fe(ce);return Promise.all(G.values()).then((function(){G.clear();for(var H=function(re){var de=D.codePointAt(re),ge=null,oe=p[ae[re]],he=void 0;for(var Ee in oe){var We=Z[Ee];if(We===void 0&&(We=Z[Ee]=new RegExp(Ee).test(O||"en")),We){for(var rt in he=Ee,oe[Ee])if(l(de,oe[Ee][rt])){ge=rt;break}break}}if(!ge){e:for(var st in oe)if(st!==he){for(var et in oe[st])if(l(de,oe[st][et])){ge=et;break e}}}ge||(console.debug("No font coverage for U+"+de.toString(16)),ge="latin"),ae[re]=ge,m[ge]||G.has(ge)||G.set(ge,ie("font-meta/"+ge+".json").then((function(se){m[ge]=se}))),de>65535&&(re++,W=re)},W=0;W<D.length;W++)H(W);return Promise.all(G.values())})).then((function(){for(var H,W=null,re=0;re<D.length;re++){var de=D.codePointAt(re);if(W&&(w(de)||x(W).has(de)))Y[re]=Y[re-1];else{W=m[ae[re]];var ge=Q[W.id];if(!ge){var oe=W.typeforms,he=T(oe,P,"sans-serif"),Ee=T(oe[he],B,"normal"),We=E((H=oe[he])===null||H===void 0?void 0:H[Ee],N);ge=Q[W.id]=z+"/font-files/"+W.id+"/"+he+"."+Ee+"."+We+".woff"}var rt=q.get(ge);rt==null&&(rt=q.size,q.set(ge,rt)),Y[re]=rt}de>65535&&(re++,Y[re]=Y[re-1])}return{fontUrls:Array.from(q.keys()),chars:Y}}))},Object.defineProperty(s,"__esModule",{value:!0}),s})({})}function sB(s,e){const t=Object.create(null),n=Object.create(null);function i(l,u){const f=p=>{console.error(`Failure loading font ${l}`,p)};try{const p=new XMLHttpRequest;p.open("get",l,!0),p.responseType="arraybuffer",p.onload=function(){if(p.status>=400)f(new Error(p.statusText));else if(p.status>0)try{const m=s(p.response);m.src=l,u(m)}catch(m){f(m)}},p.onerror=f,p.send()}catch(p){f(p)}}function a(l,u){let f=t[l];f?u(f):n[l]?n[l].push(u):(n[l]=[u],i(l,p=>{p.src=l,t[l]=p,n[l].forEach(m=>m(p)),delete n[l]}))}return function(l,u,{lang:f,fonts:p=[],style:m="normal",weight:v="normal",unicodeFontsURL:_}={}){const x=new Uint8Array(l.length),b=[];l.length||w();const R=new Map,T=[];if(m!=="italic"&&(m="normal"),typeof v!="number"&&(v=v==="bold"?700:400),p&&!Array.isArray(p)&&(p=[p]),p=p.slice().filter(U=>!U.lang||U.lang.test(f)).reverse(),p.length){let P=0;(function B(N=0){for(let z=N,q=l.length;z<q;z++){const Y=l.codePointAt(z);if(P===1&&b[x[z-1]].supportsCodePoint(Y)||z>0&&/\s/.test(l[z]))x[z]=x[z-1],P===2&&(T[T.length-1][1]=z);else for(let Q=x[z],Z=p.length;Q<=Z;Q++)if(Q===Z){const ae=P===2?T[T.length-1]:T[T.length]=[z,z];ae[1]=z,P=2}else{x[z]=Q;const{src:ae,unicodeRange:G}=p[Q];if(!G||D(Y,G)){const ee=t[ae];if(!ee){a(ae,()=>{B(z)});return}if(ee.supportsCodePoint(Y)){let ie=R.get(ee);typeof ie!="number"&&(ie=b.length,b.push(ee),R.set(ee,ie)),x[z]=ie,P=1;break}}}Y>65535&&z+1<q&&(x[z+1]=x[z],z++,P===2&&(T[T.length-1][1]=z))}E()})()}else T.push([0,l.length-1]),E();function E(){if(T.length){const U=T.map(I=>l.substring(I[0],I[1]+1)).join(`
`);e.getFontsForString(U,{lang:f||void 0,style:m,weight:v,dataUrl:_}).then(({fontUrls:I,chars:O})=>{const P=b.length;let B=0;T.forEach(z=>{for(let q=0,Y=z[1]-z[0];q<=Y;q++)x[z[0]+q]=O[B++]+P;B++});let N=0;I.forEach((z,q)=>{a(z,Y=>{b[q+P]=Y,++N===I.length&&w()})})})}else w()}function w(){u({chars:x,fonts:b})}function D(U,I){for(let O=0;O<I.length;O++){const[P,B=P]=I[O];if(P<=U&&U<=B)return!0}return!1}}}const oB=Qd({name:"FontResolver",dependencies:[sB,aB,rB],init(s,e,t){return s(e,t())}});function lB(s,e){const n=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,i="[^\\S\\u00A0]",a=new RegExp(`${i}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function l({text:b,lang:R,fonts:T,style:E,weight:w,preResolvedFonts:D,unicodeFontsURL:U},I){const O=({chars:P,fonts:B})=>{let N,z;const q=[];for(let Y=0;Y<P.length;Y++)P[Y]!==z?(z=P[Y],q.push(N={start:Y,end:Y,fontObj:B[P[Y]]})):N.end=Y;I(q)};D?O(D):s(b,O,{lang:R,fonts:T,style:E,weight:w,unicodeFontsURL:U})}function u({text:b="",font:R,lang:T,sdfGlyphSize:E=64,fontSize:w=400,fontWeight:D=1,fontStyle:U="normal",letterSpacing:I=0,lineHeight:O="normal",maxWidth:P=1/0,direction:B,textAlign:N="left",textIndent:z=0,whiteSpace:q="normal",overflowWrap:Y="normal",anchorX:Q=0,anchorY:Z=0,metricsOnly:ae=!1,unicodeFontsURL:G,preResolvedFonts:ee=null,includeCaretPositions:ie=!1,chunkedBoundsSize:fe=8192,colorRanges:ce=null},H){const W=v(),re={fontLoad:0,typesetting:0};b.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),b=b.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),w=+w,I=+I,P=+P,O=O||"normal",z=+z,l({text:b,lang:T,style:U,weight:D,fonts:typeof R=="string"?[{src:R}]:R,unicodeFontsURL:G,preResolvedFonts:ee},de=>{re.fontLoad=v()-W;const ge=isFinite(P);let oe=null,he=null,Ee=null,We=null,rt=null,st=null,et=null,se=null,Ie=0,Oe=0,Ue=q!=="nowrap";const Le=new Map,ze=v();let Pe=z,Fe=0,Ne=new _;const yt=[Ne];de.forEach(De=>{const{fontObj:Ae}=De,{ascender:gt,descender:ct,unitsPerEm:_t,lineGap:bt,capHeight:ke,xHeight:Xe}=Ae;let lt=Le.get(Ae);if(!lt){const _e=w/_t,at=O==="normal"?(gt-ct+bt)*_e:O*w,Tt=(at-(gt-ct)*_e)/2,it=Math.min(at,(gt-ct)*_e),Ge=(gt+ct)/2*_e+it/2;lt={index:Le.size,src:Ae.src,fontObj:Ae,fontSizeMult:_e,unitsPerEm:_t,ascender:gt*_e,descender:ct*_e,capHeight:ke*_e,xHeight:Xe*_e,lineHeight:at,baseline:-Tt-gt*_e,caretTop:Ge,caretBottom:Ge-it},Le.set(Ae,lt)}const{fontSizeMult:le}=lt,Te=b.slice(De.start,De.end+1);let ut,pe;Ae.forEachGlyph(Te,w,I,(_e,at,Tt,it)=>{at+=Fe,it+=De.start,ut=at,pe=_e;const Ge=b.charAt(it),xt=_e.advanceWidth*le,wt=Ne.count;let Ut;if("isEmpty"in _e||(_e.isWhitespace=!!Ge&&new RegExp(i).test(Ge),_e.canBreakAfter=!!Ge&&a.test(Ge),_e.isEmpty=_e.xMin===_e.xMax||_e.yMin===_e.yMax||n.test(Ge)),!_e.isWhitespace&&!_e.isEmpty&&Oe++,Ue&&ge&&!_e.isWhitespace&&at+xt+Pe>P&&wt){if(Ne.glyphAt(wt-1).glyphObj.canBreakAfter)Ut=new _,Pe=-at;else for(let yn=wt;yn--;)if(yn===0&&Y==="break-word"){Ut=new _,Pe=-at;break}else if(Ne.glyphAt(yn).glyphObj.canBreakAfter){Ut=Ne.splitAt(yn+1);const An=Ut.glyphAt(0).x;Pe-=An;for(let ai=Ut.count;ai--;)Ut.glyphAt(ai).x-=An;break}Ut&&(Ne.isSoftWrapped=!0,Ne=Ut,yt.push(Ne),Ie=P)}let Pt=Ne.glyphAt(Ne.count);Pt.glyphObj=_e,Pt.x=at+Pe,Pt.y=Tt,Pt.width=xt,Pt.charIndex=it,Pt.fontData=lt,Ge===`
`&&(Ne=new _,yt.push(Ne),Pe=-(at+xt+I*w)+z)}),Fe=ut+pe.advanceWidth*le+I*w});let j=0;yt.forEach(De=>{let Ae=!0;for(let gt=De.count;gt--;){const ct=De.glyphAt(gt);Ae&&!ct.glyphObj.isWhitespace&&(De.width=ct.x+ct.width,De.width>Ie&&(Ie=De.width),Ae=!1);let{lineHeight:_t,capHeight:bt,xHeight:ke,baseline:Xe}=ct.fontData;_t>De.lineHeight&&(De.lineHeight=_t);const lt=Xe-De.baseline;lt<0&&(De.baseline+=lt,De.cap+=lt,De.ex+=lt),De.cap=Math.max(De.cap,De.baseline+bt),De.ex=Math.max(De.ex,De.baseline+ke)}De.baseline-=j,De.cap-=j,De.ex-=j,j+=De.lineHeight});let V=0,ve=0;if(Q&&(typeof Q=="number"?V=-Q:typeof Q=="string"&&(V=-Ie*(Q==="left"?0:Q==="center"?.5:Q==="right"?1:p(Q)))),Z&&(typeof Z=="number"?ve=-Z:typeof Z=="string"&&(ve=Z==="top"?0:Z==="top-baseline"?-yt[0].baseline:Z==="top-cap"?-yt[0].cap:Z==="top-ex"?-yt[0].ex:Z==="middle"?j/2:Z==="bottom"?j:Z==="bottom-baseline"?-yt[yt.length-1].baseline:p(Z)*j)),!ae){const De=e.getEmbeddingLevels(b,B);oe=new Uint16Array(Oe),he=new Uint8Array(Oe),Ee=new Float32Array(Oe*2),We={},et=[1/0,1/0,-1/0,-1/0],se=[],ie&&(st=new Float32Array(b.length*4)),ce&&(rt=new Uint8Array(Oe*3));let Ae=0,gt=-1,ct=-1,_t,bt;if(yt.forEach((ke,Xe)=>{let{count:lt,width:le}=ke;if(lt>0){let Te=0;for(let it=lt;it--&&ke.glyphAt(it).glyphObj.isWhitespace;)Te++;let ut=0,pe=0;if(N==="center")ut=(Ie-le)/2;else if(N==="right")ut=Ie-le;else if(N==="justify"&&ke.isSoftWrapped){let it=0;for(let Ge=lt-Te;Ge--;)ke.glyphAt(Ge).glyphObj.isWhitespace&&it++;pe=(Ie-le)/it}if(pe||ut){let it=0;for(let Ge=0;Ge<lt;Ge++){let xt=ke.glyphAt(Ge);const wt=xt.glyphObj;xt.x+=ut+it,pe!==0&&wt.isWhitespace&&Ge<lt-Te&&(it+=pe,xt.width+=pe)}}const _e=e.getReorderSegments(b,De,ke.glyphAt(0).charIndex,ke.glyphAt(ke.count-1).charIndex);for(let it=0;it<_e.length;it++){const[Ge,xt]=_e[it];let wt=1/0,Ut=-1/0;for(let Pt=0;Pt<lt;Pt++)if(ke.glyphAt(Pt).charIndex>=Ge){let yn=Pt,An=Pt;for(;An<lt;An++){let ai=ke.glyphAt(An);if(ai.charIndex>xt)break;An<lt-Te&&(wt=Math.min(wt,ai.x),Ut=Math.max(Ut,ai.x+ai.width))}for(let ai=yn;ai<An;ai++){const ci=ke.glyphAt(ai);ci.x=Ut-(ci.x+ci.width-wt)}break}}let at;const Tt=it=>at=it;for(let it=0;it<lt;it++){const Ge=ke.glyphAt(it);at=Ge.glyphObj;const xt=at.index,wt=De.levels[Ge.charIndex]&1;if(wt){const Ut=e.getMirroredCharacter(b[Ge.charIndex]);Ut&&Ge.fontData.fontObj.forEachGlyph(Ut,0,0,Tt)}if(ie){const{charIndex:Ut,fontData:Pt}=Ge,yn=Ge.x+V,An=Ge.x+Ge.width+V;st[Ut*4]=wt?An:yn,st[Ut*4+1]=wt?yn:An,st[Ut*4+2]=ke.baseline+Pt.caretBottom+ve,st[Ut*4+3]=ke.baseline+Pt.caretTop+ve;const ai=Ut-gt;ai>1&&m(st,gt,ai),gt=Ut}if(ce){const{charIndex:Ut}=Ge;for(;Ut>ct;)ct++,ce.hasOwnProperty(ct)&&(bt=ce[ct])}if(!at.isWhitespace&&!at.isEmpty){const Ut=Ae++,{fontSizeMult:Pt,src:yn,index:An}=Ge.fontData,ai=We[yn]||(We[yn]={});ai[xt]||(ai[xt]={path:at.path,pathBounds:[at.xMin,at.yMin,at.xMax,at.yMax]});const ci=Ge.x+V,Ti=Ge.y+ke.baseline+ve;Ee[Ut*2]=ci,Ee[Ut*2+1]=Ti;const mi=ci+at.xMin*Pt,Ai=Ti+at.yMin*Pt,ri=ci+at.xMax*Pt,Xt=Ti+at.yMax*Pt;mi<et[0]&&(et[0]=mi),Ai<et[1]&&(et[1]=Ai),ri>et[2]&&(et[2]=ri),Xt>et[3]&&(et[3]=Xt),Ut%fe===0&&(_t={start:Ut,end:Ut,rect:[1/0,1/0,-1/0,-1/0]},se.push(_t)),_t.end++;const Un=_t.rect;if(mi<Un[0]&&(Un[0]=mi),Ai<Un[1]&&(Un[1]=Ai),ri>Un[2]&&(Un[2]=ri),Xt>Un[3]&&(Un[3]=Xt),oe[Ut]=xt,he[Ut]=An,ce){const Jt=Ut*3;rt[Jt]=bt>>16&255,rt[Jt+1]=bt>>8&255,rt[Jt+2]=bt&255}}}}}),st){const ke=b.length-gt;ke>1&&m(st,gt,ke)}}const Be=[];Le.forEach(({index:De,src:Ae,unitsPerEm:gt,ascender:ct,descender:_t,lineHeight:bt,capHeight:ke,xHeight:Xe})=>{Be[De]={src:Ae,unitsPerEm:gt,ascender:ct,descender:_t,lineHeight:bt,capHeight:ke,xHeight:Xe}}),re.typesetting=v()-ze,H({glyphIds:oe,glyphFontIndices:he,glyphPositions:Ee,glyphData:We,fontData:Be,caretPositions:st,glyphColors:rt,chunkedBounds:se,fontSize:w,topBaseline:ve+yt[0].baseline,blockBounds:[V,ve-j,V+Ie,ve],visibleBounds:et,timings:re})})}function f(b,R){u({...b,metricsOnly:!0},T=>{const[E,w,D,U]=T.blockBounds;R({width:D-E,height:U-w})})}function p(b){let R=b.match(/^([\d.]+)%$/),T=R?parseFloat(R[1]):NaN;return isNaN(T)?0:T/100}function m(b,R,T){const E=b[R*4],w=b[R*4+1],D=b[R*4+2],U=b[R*4+3],I=(w-E)/T;for(let O=0;O<T;O++){const P=(R+O)*4;b[P]=E+I*O,b[P+1]=E+I*(O+1),b[P+2]=D,b[P+3]=U}}function v(){return(self.performance||Date).now()}function _(){this.data=[]}const x=["glyphObj","x","y","width","charIndex","fontData"];return _.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/x.length)},glyphAt(b){let R=_.flyweight;return R.data=this.data,R.index=b,R},splitAt(b){let R=new _;return R.data=this.data.splice(b*x.length),R}},_.flyweight=x.reduce((b,R,T,E)=>(Object.defineProperty(b,R,{get(){return this.data[this.index*x.length+T]},set(w){this.data[this.index*x.length+T]=w}}),b),{data:null,index:0}),{typeset:u,measure:f}}const Hf=()=>(self.performance||Date).now(),M_=ER();let OT;function uB(s,e,t,n,i,a,l,u,f,p,m=!0){return m?fB(s,e,t,n,i,a,l,u,f,p).then(null,v=>(OT||(console.warn("WebGL SDF generation failed, falling back to JS",v),OT=!0),zT(s,e,t,n,i,a,l,u,f,p))):zT(s,e,t,n,i,a,l,u,f,p)}const Xv=[],cB=5;let uS=0;function AR(){const s=Hf();for(;Xv.length&&Hf()-s<cB;)Xv.shift()();uS=Xv.length?setTimeout(AR,0):0}const fB=(...s)=>new Promise((e,t)=>{Xv.push(()=>{const n=Hf();try{M_.webgl.generateIntoCanvas(...s),e({timing:Hf()-n})}catch(i){t(i)}}),uS||(uS=setTimeout(AR,0))}),hB=4,dB=2e3,LT={};let pB=0;function zT(s,e,t,n,i,a,l,u,f,p){const m="TroikaTextSDFGenerator_JS_"+pB++%hB;let v=LT[m];return v||(v=LT[m]={workerModule:Qd({name:m,workerId:m,dependencies:[ER,Hf],init(_,x){const b=_().javascript.generate;return function(...R){const T=x();return{textureData:b(...R),timing:x()-T}}},getTransferables(_){return[_.textureData.buffer]}}),requests:0,idleTimer:null}),v.requests++,clearTimeout(v.idleTimer),v.workerModule(s,e,t,n,i,a).then(({textureData:_,timing:x})=>{const b=Hf(),R=new Uint8Array(_.length*4);for(let T=0;T<_.length;T++)R[T*4+p]=_[T];return M_.webglUtils.renderImageData(l,R,u,f,s,e,1<<3-p),x+=Hf()-b,--v.requests===0&&(v.idleTimer=setTimeout(()=>{YI(m)},dB)),{timing:x}})}function mB(s){s._warm||(M_.webgl.isSupported(s),s._warm=!0)}const gB=M_.webglUtils.resizeWebGLCanvasWithoutClearing,Pm={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},vB=new Nt;function xd(){return(self.performance||Date).now()}const IT=Object.create(null);function RR(s,e){s=xB({},s);const t=xd(),n=[];if(s.font&&n.push({label:"user",src:SB(s.font)}),s.font=n,s.text=""+s.text,s.sdfGlyphSize=s.sdfGlyphSize||Pm.sdfGlyphSize,s.unicodeFontsURL=s.unicodeFontsURL||Pm.unicodeFontsURL,s.colorRanges!=null){let _={};for(let x in s.colorRanges)if(s.colorRanges.hasOwnProperty(x)){let b=s.colorRanges[x];typeof b!="number"&&(b=vB.set(b).getHex()),_[x]=b}s.colorRanges=_}Object.freeze(s);const{textureWidth:i,sdfExponent:a}=Pm,{sdfGlyphSize:l}=s,u=i/l*4;let f=IT[l];if(!f){const _=document.createElement("canvas");_.width=i,_.height=l*256/u,f=IT[l]={glyphCount:0,sdfGlyphSize:l,sdfCanvas:_,sdfTexture:new Zn(_,void 0,void 0,void 0,Wn,Wn),contextLost:!1,glyphsByFont:new Map},f.sdfTexture.generateMipmaps=!1,yB(f)}const{sdfTexture:p,sdfCanvas:m}=f;UR(s).then(_=>{const{glyphIds:x,glyphFontIndices:b,fontData:R,glyphPositions:T,fontSize:E,timings:w}=_,D=[],U=new Float32Array(x.length*4);let I=0,O=0;const P=xd(),B=R.map(Q=>{let Z=f.glyphsByFont.get(Q.src);return Z||f.glyphsByFont.set(Q.src,Z=new Map),Z});x.forEach((Q,Z)=>{const ae=b[Z],{src:G,unitsPerEm:ee}=R[ae];let ie=B[ae].get(Q);if(!ie){const{path:re,pathBounds:de}=_.glyphData[G][Q],ge=Math.max(de[2]-de[0],de[3]-de[1])/l*(Pm.sdfMargin*l+.5),oe=f.glyphCount++,he=[de[0]-ge,de[1]-ge,de[2]+ge,de[3]+ge];B[ae].set(Q,ie={path:re,atlasIndex:oe,sdfViewBox:he}),D.push(ie)}const{sdfViewBox:fe}=ie,ce=T[O++],H=T[O++],W=E/ee;U[I++]=ce+fe[0]*W,U[I++]=H+fe[1]*W,U[I++]=ce+fe[2]*W,U[I++]=H+fe[3]*W,x[Z]=ie.atlasIndex}),w.quads=(w.quads||0)+(xd()-P);const N=xd();w.sdf={};const z=m.height,q=Math.ceil(f.glyphCount/u),Y=Math.pow(2,Math.ceil(Math.log2(q*l)));Y>z&&(console.info(`Increasing SDF texture size ${z}->${Y}`),gB(m,i,Y),p.dispose()),Promise.all(D.map(Q=>CR(Q,f,s.gpuAccelerateSDF).then(({timing:Z})=>{w.sdf[Q.atlasIndex]=Z}))).then(()=>{D.length&&!f.contextLost&&(wR(f),p.needsUpdate=!0),w.sdfTotal=xd()-N,w.total=xd()-t,e(Object.freeze({parameters:s,sdfTexture:p,sdfGlyphSize:l,sdfExponent:a,glyphBounds:U,glyphAtlasIndices:x,glyphColors:_.glyphColors,caretPositions:_.caretPositions,chunkedBounds:_.chunkedBounds,ascender:_.ascender,descender:_.descender,lineHeight:_.lineHeight,capHeight:_.capHeight,xHeight:_.xHeight,topBaseline:_.topBaseline,blockBounds:_.blockBounds,visibleBounds:_.visibleBounds,timings:_.timings}))})}),Promise.resolve().then(()=>{f.contextLost||mB(m)})}function CR({path:s,atlasIndex:e,sdfViewBox:t},{sdfGlyphSize:n,sdfCanvas:i,contextLost:a},l){if(a)return Promise.resolve({timing:-1});const{textureWidth:u,sdfExponent:f}=Pm,p=Math.max(t[2]-t[0],t[3]-t[1]),m=Math.floor(e/4),v=m%(u/n)*n,_=Math.floor(m/(u/n))*n,x=e%4;return uB(n,n,s,t,p,f,i,v,_,x,l)}function yB(s){const e=s.sdfCanvas;e.addEventListener("webglcontextlost",t=>{console.log("Context Lost",t),t.preventDefault(),s.contextLost=!0}),e.addEventListener("webglcontextrestored",t=>{console.log("Context Restored",t),s.contextLost=!1;const n=[];s.glyphsByFont.forEach(i=>{i.forEach(a=>{n.push(CR(a,s,!0))})}),Promise.all(n).then(()=>{wR(s),s.sdfTexture.needsUpdate=!0})})}function _B({font:s,characters:e,sdfGlyphSize:t},n){let i=Array.isArray(e)?e.join(`
`):""+e;RR({font:s,sdfGlyphSize:t,text:i},n)}function xB(s,e){for(let t in e)e.hasOwnProperty(t)&&(s[t]=e[t]);return s}let Ov;function SB(s){return Ov||(Ov=typeof document>"u"?{}:document.createElement("a")),Ov.href=s,Ov.href}function wR(s){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:t}=s,{width:n,height:i}=e,a=s.sdfCanvas.getContext("webgl");let l=t.image.data;(!l||l.length!==n*i*4)&&(l=new Uint8Array(n*i*4),t.image={width:n,height:i,data:l},t.flipY=!1,t.isDataTexture=!0),a.readPixels(0,0,n,i,a.RGBA,a.UNSIGNED_BYTE,l)}}const MB=Qd({name:"Typesetter",dependencies:[lB,oB,WI],init(s,e,t){return s(e,t())}}),UR=Qd({name:"Typesetter",dependencies:[MB],init(s){return function(e){return new Promise(t=>{s.typeset(e,t)})}},getTransferables(s){const e=[];for(let t in s)s[t]&&s[t].buffer&&e.push(s[t].buffer);return e}});UR.onMainThread;const BT={};function bB(s){let e=BT[s];return e||(e=BT[s]=new zo(1,1,s,s).translate(.5,.5,0)),e}const EB="aTroikaGlyphBounds",PT="aTroikaGlyphIndex",TB="aTroikaGlyphColor";class AB extends QS{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Ma,this.boundingBox=new ca}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let t=bB(e);["position","normal","uv"].forEach(n=>{this.attributes[n]=t.attributes[n].clone()}),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,n,i,a){this.updateAttributeData(EB,e,4),this.updateAttributeData(PT,t,1),this.updateAttributeData(TB,a,3),this._blockBounds=n,this._chunkedBounds=i,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:t,boundingBox:n}=this;if(t){const{PI:i,floor:a,min:l,max:u,sin:f,cos:p}=Math,m=i/2,v=i*2,_=Math.abs(t),x=e[0]/_,b=e[2]/_,R=a((x+m)/v)!==a((b+m)/v)?-_:l(f(x)*_,f(b)*_),T=a((x-m)/v)!==a((b-m)/v)?_:u(f(x)*_,f(b)*_),E=a((x+i)/v)!==a((b+i)/v)?_*2:u(_-p(x)*_,_-p(b)*_);n.min.set(R,e[1],t<0?-E:0),n.max.set(T,e[3],t<0?0:E)}else n.min.set(e[0],e[1],0),n.max.set(e[2],e[3],0);n.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(PT).count,n=this._chunkedBounds;if(n)for(let i=n.length;i--;){t=n[i].end;let a=n[i].rect;if(a[1]<e.w&&a[3]>e.y&&a[0]<e.z&&a[2]>e.x)break}this.instanceCount=t}updateAttributeData(e,t,n){const i=this.getAttribute(e);t?i&&i.array.length===t.length?(i.array.set(t),i.needsUpdate=!0):(this.setAttribute(e,new xc(t,n)),delete this._maxInstanceCount,this.dispose()):i&&this.deleteAttribute(e)}}const RB=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,CB=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,wB=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,UB=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function DB(s){const e=lS(s,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new ht},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new kn(0,0,0,0)},uTroikaClipRect:{value:new kn(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new ht},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Nt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new dn},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:RB,vertexTransform:CB,fragmentDefs:wB,fragmentColorTransform:UB,customRewriter({vertexShader:t,fragmentShader:n}){let i=/\buniform\s+vec3\s+diffuse\b/;return i.test(n)&&(n=n.replace(i,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),i.test(t)||(t=t.replace(TR,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:t,fragmentShader:n}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const dM=new zr({color:16777215,side:ur,transparent:!0}),FT=8421504,HT=new Qt,Lv=new ne,Ex=new ne,Nm=[],NB=new ne,Tx="+x+y";function GT(s){return Array.isArray(s)?s[0]:s}let DR=()=>{const s=new Si(new zo(1,1),dM);return DR=()=>s,s},NR=()=>{const s=new Si(new zo(1,1,32,1),dM);return NR=()=>s,s};const OB={type:"syncstart"},LB={type:"synccomplete"},OR=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],zB=OR.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let LR=class extends Si{constructor(){const e=new AB;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=FT,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=Tx,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(OB),RR({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);const n=this._queuedSyncs;n&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{n.forEach(i=>i&&i())})),this.dispatchEvent(LB),e&&e()})))}onBeforeRender(e,t,n,i,a,l){this.sync(),a.isTroikaTextMaterial&&this._prepareForRender(a)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return DB(e)}get material(){let e=this._derivedMaterial;const t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=dM.clone());if((!e||!e.isDerivedFrom(t))&&(e=this._derivedMaterial=this.createDerivedMaterial(t),t.addEventListener("dispose",function n(){t.removeEventListener("dispose",n),e.dispose()})),this.hasOutline()){let n=e._outlineMtl;return n||(n=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),n.isTextOutlineMaterial=!0,n.depthWrite=!1,n.map=null,e.addEventListener("dispose",function i(){e.removeEventListener("dispose",i),n.dispose()})),[n,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return GT(this.material).getDepthMaterial()}set customDepthMaterial(e){}get customDistanceMaterial(){return GT(this.material).getDistanceMaterial()}set customDistanceMaterial(e){}_prepareForRender(e){const t=e.isTextOutlineMaterial,n=e.uniforms,i=this.textRenderInfo;if(i){const{sdfTexture:u,blockBounds:f}=i;n.uTroikaSDFTexture.value=u,n.uTroikaSDFTextureSize.value.set(u.image.width,u.image.height),n.uTroikaSDFGlyphSize.value=i.sdfGlyphSize,n.uTroikaSDFExponent.value=i.sdfExponent,n.uTroikaTotalBounds.value.fromArray(f),n.uTroikaUseGlyphColors.value=!t&&!!i.glyphColors;let p=0,m=0,v=0,_,x,b,R=0,T=0;if(t){let{outlineWidth:w,outlineOffsetX:D,outlineOffsetY:U,outlineBlur:I,outlineOpacity:O}=this;p=this._parsePercent(w)||0,m=Math.max(0,this._parsePercent(I)||0),_=O,R=this._parsePercent(D)||0,T=this._parsePercent(U)||0}else v=Math.max(0,this._parsePercent(this.strokeWidth)||0),v&&(b=this.strokeColor,n.uTroikaStrokeColor.value.set(b??FT),x=this.strokeOpacity,x==null&&(x=1)),_=this.fillOpacity;n.uTroikaEdgeOffset.value=p,n.uTroikaPositionOffset.value.set(R,T),n.uTroikaBlurRadius.value=m,n.uTroikaStrokeWidth.value=v,n.uTroikaStrokeOpacity.value=x,n.uTroikaFillOpacity.value=_??1,n.uTroikaCurveRadius.value=this.curveRadius||0;let E=this.clipRect;if(E&&Array.isArray(E)&&E.length===4)n.uTroikaClipRect.value.fromArray(E);else{const w=(this.fontSize||.1)*100;n.uTroikaClipRect.value.set(f[0]-w,f[1]-w,f[2]+w,f[3]+w)}this.geometry.applyClipRect(n.uTroikaClipRect.value)}n.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const a=t?this.outlineColor||0:this.color;if(a==null)delete e.color;else{const u=e.hasOwnProperty("color")?e.color:e.color=new Nt;(a!==u._input||typeof a=="object")&&u.set(u._input=a)}let l=this.orientation||Tx;if(l!==e._orientation){let u=n.uTroikaOrient.value;l=l.replace(/[^-+xyz]/g,"");let f=l!==Tx&&l.match(/^([-+])([xyz])([-+])([xyz])$/);if(f){let[,p,m,v,_]=f;Lv.set(0,0,0)[m]=p==="-"?1:-1,Ex.set(0,0,0)[_]=v==="-"?-1:1,HT.lookAt(NB,Lv.cross(Ex),Ex),u.setFromMatrix4(HT)}else u.identity();e._orientation=l}}_parsePercent(e){if(typeof e=="string"){let t=e.match(/^(-?[\d.]+)%$/),n=t?parseFloat(t[1]):NaN;e=(isNaN(n)?0:n/100)*this.fontSize}return e}localPositionToTextCoords(e,t=new ht){t.copy(e);const n=this.curveRadius;return n&&(t.x=Math.atan2(e.x,Math.abs(n)-Math.abs(e.z))*Math.abs(n)),t}worldPositionToTextCoords(e,t=new ht){return Lv.copy(e),this.localPositionToTextCoords(this.worldToLocal(Lv),t)}raycast(e,t){const{textRenderInfo:n,curveRadius:i}=this;if(n){const a=n.blockBounds,l=i?NR():DR(),u=l.geometry,{position:f,uv:p}=u.attributes;for(let m=0;m<p.count;m++){let v=a[0]+p.getX(m)*(a[2]-a[0]);const _=a[1]+p.getY(m)*(a[3]-a[1]);let x=0;i&&(x=i-Math.cos(v/i)*i,v=Math.sin(v/i)*i),f.setXYZ(m,v,_,x)}u.boundingSphere=this.geometry.boundingSphere,u.boundingBox=this.geometry.boundingBox,l.matrixWorld=this.matrixWorld,l.material.side=this.material.side,Nm.length=0,l.raycast(e,Nm);for(let m=0;m<Nm.length;m++)Nm[m].object=this,t.push(Nm[m])}}copy(e){const t=this.geometry;return super.copy(e),this.geometry=t,zB.forEach(n=>{this[n]=e[n]}),this}clone(){return new this.constructor().copy(this)}};OR.forEach(s=>{const e="_private_"+s;Object.defineProperty(LR.prototype,s,{get(){return this[e]},set(t){t!==this[e]&&(this[e]=t,this._needsSync=!0)}})});new ca;new Nt;const IB=Ye.forwardRef(({sdfGlyphSize:s=64,anchorX:e="center",anchorY:t="middle",font:n,fontSize:i=1,children:a,characters:l,onSync:u,...f},p)=>{const m=xa(({invalidate:b})=>b),[v]=Ye.useState(()=>new LR),[_,x]=Ye.useMemo(()=>{const b=[];let R="";return Ye.Children.forEach(a,T=>{typeof T=="string"||typeof T=="number"?R+=T:b.push(T)}),[b,R]},[a]);return K2(()=>new Promise(b=>_B({font:n,characters:l},b)),["troika-text",n,l]),Ye.useLayoutEffect(()=>{v.sync(()=>{m(),u&&u(v)})}),Ye.useEffect(()=>()=>v.dispose(),[v]),Ye.createElement("primitive",lg({object:v,ref:p,font:n,text:x,anchorX:e,anchorY:t,fontSize:i,sdfGlyphSize:s},f),_)}),Ax=s=>s===Object(s)&&!Array.isArray(s)&&typeof s!="function";function b_(s,e){const t=xa(a=>a.gl),n=Ts(Eg,Ax(s)?Object.values(s):s);return Ye.useLayoutEffect(()=>{e?.(n)},[e]),Ye.useEffect(()=>{if("initTexture"in t){let a=[];Array.isArray(n)?a=n:n instanceof Zn?a=[n]:Ax(n)&&(a=Object.values(n)),a.forEach(l=>{l instanceof Zn&&t.initTexture(l)})}},[t,n]),Ye.useMemo(()=>{if(Ax(s)){const a={};let l=0;for(const u in s)a[u]=n[l++];return a}else return n},[s,n])}b_.preload=s=>Ts.preload(Eg,s);b_.clear=s=>Ts.clear(Eg,s);const BB=Ye.forwardRef(({makeDefault:s,camera:e,regress:t,domElement:n,enableDamping:i=!0,keyEvents:a=!1,onChange:l,onStart:u,onEnd:f,...p},m)=>{const v=xa(O=>O.invalidate),_=xa(O=>O.camera),x=xa(O=>O.gl),b=xa(O=>O.events),R=xa(O=>O.setEvents),T=xa(O=>O.set),E=xa(O=>O.get),w=xa(O=>O.performance),D=e||_,U=n||b.connected||x.domElement,I=Ye.useMemo(()=>new PI(D),[D]);return Kd(()=>{I.enabled&&I.update()},-1),Ye.useEffect(()=>(a&&I.connect(a===!0?U:a),I.connect(U),()=>{I.dispose()}),[a,U,t,I,v]),Ye.useEffect(()=>{const O=N=>{v(),t&&w.regress(),l&&l(N)},P=N=>{u&&u(N)},B=N=>{f&&f(N)};return I.addEventListener("change",O),I.addEventListener("start",P),I.addEventListener("end",B),()=>{I.removeEventListener("start",P),I.removeEventListener("end",B),I.removeEventListener("change",O)}},[l,u,f,I,v,R]),Ye.useEffect(()=>{if(s){const O=E().controls;return T({controls:I}),()=>T({controls:O})}},[s,I]),Ye.createElement("primitive",lg({ref:m,object:I,enableDamping:i},p))}),zR=(s,e,t)=>{let n;switch(s){case Pr:n=new Uint8ClampedArray(e*t*4);break;case Ia:n=new Uint16Array(e*t*4);break;case Ml:n=new Uint32Array(e*t*4);break;case Vy:n=new Int8Array(e*t*4);break;case ky:n=new Int16Array(e*t*4);break;case hg:n=new Int32Array(e*t*4);break;case Vi:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let zv;const PB=(s,e,t,n)=>{if(zv!==void 0)return zv;const i=new Ks(1,1,n);e.setRenderTarget(i);const a=new Si(new zo,new zr({color:16777215}));e.render(a,t),e.setRenderTarget(null);const l=zR(s,i.width,i.height);return e.readRenderTargetPixels(i,0,0,i.width,i.height,l),i.dispose(),a.geometry.dispose(),a.material.dispose(),zv=l[0]!==0,zv};class pM{_renderer;_rendererIsDisposable=!1;_material;_scene;_camera;_quad;_renderTarget;_width;_height;_type;_colorSpace;_supportsReadPixels=!0;constructor(e){this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:na,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:e.renderTargetOptions?.anisotropy!==void 0?e.renderTargetOptions?.anisotropy:1,generateMipmaps:e.renderTargetOptions?.generateMipmaps!==void 0?e.renderTargetOptions?.generateMipmaps:!1,magFilter:e.renderTargetOptions?.magFilter!==void 0?e.renderTargetOptions?.magFilter:Wn,minFilter:e.renderTargetOptions?.minFilter!==void 0?e.renderTargetOptions?.minFilter:Wn,samples:e.renderTargetOptions?.samples!==void 0?e.renderTargetOptions?.samples:void 0,wrapS:e.renderTargetOptions?.wrapS!==void 0?e.renderTargetOptions?.wrapS:ta,wrapT:e.renderTargetOptions?.wrapT!==void 0?e.renderTargetOptions?.wrapT:ta};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=pM.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new gg,this._camera=new _l,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!PB(this._type,this._renderer,this._camera,t)){let n;this._type===Ia&&(n=this._renderer.extensions.has("EXT_color_buffer_float")?Vi:void 0),n!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Vi}`),this._type=n):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Si(new zo,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new Ks(this.width,this.height,t),this._renderTarget.texture.mapping=e.renderTargetOptions?.mapping!==void 0?e.renderTargetOptions?.mapping:gc}static instantiateRenderer(){const e=new sM;return e.setSize(128,128),e}render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)};toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=zR(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new No(this.toArray(),this.width,this.height,na,this._type,e?.mapping||gc,e?.wrapS||ta,e?.wrapT||ta,e?.magFilter||Wn,e?.minFilter||Wn,e?.anisotropy||1,fa);return t.generateMipmaps=e?.generateMipmaps!==void 0?e?.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof Fr&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof Zn&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof Zn&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class IR extends Error{}class BR extends Error{}const Om=(s,e,t)=>{const n=new RegExp(`${e}="([^"]*)"`,"i").exec(s);if(n)return n[1];const i=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(s);if(i){const a=i[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return a&&a.length===3?a.map(l=>l.replace(/<\/?rdf:li>/g,"")):i[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},FB=s=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(s):e=s.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const n=e.indexOf("x:xmpmeta>",t),i=e.slice(t,n+10);try{const a=Om(i,"hdrgm:GainMapMin","0"),l=Om(i,"hdrgm:GainMapMax"),u=Om(i,"hdrgm:Gamma","1"),f=Om(i,"hdrgm:OffsetSDR","0.015625"),p=Om(i,"hdrgm:OffsetHDR","0.015625"),m=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(i),v=m?m[1]:"0",_=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(i);if(!_)throw new Error("Incomplete gainmap metadata");const x=_[1];return{gainMapMin:Array.isArray(a)?a.map(b=>parseFloat(b)):[parseFloat(a),parseFloat(a),parseFloat(a)],gainMapMax:Array.isArray(l)?l.map(b=>parseFloat(b)):[parseFloat(l),parseFloat(l),parseFloat(l)],gamma:Array.isArray(u)?u.map(b=>parseFloat(b)):[parseFloat(u),parseFloat(u),parseFloat(u)],offsetSdr:Array.isArray(f)?f.map(b=>parseFloat(b)):[parseFloat(f),parseFloat(f),parseFloat(f)],offsetHdr:Array.isArray(p)?p.map(b=>parseFloat(b)):[parseFloat(p),parseFloat(p),parseFloat(p)],hdrCapacityMin:parseFloat(v),hdrCapacityMax:parseFloat(x)}}catch{}t=e.indexOf("<x:xmpmeta",n)}};class HB{options;constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const i=this.options.debug,a=new DataView(e.buffer);if(a.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const l=a.byteLength;let u=2,f=0,p;for(;u<l;){if(++f>250){n(new Error(`Found no marker after ${f} loops `));return}if(a.getUint8(u)!==255){n(new Error(`Not a valid marker at offset 0x${u.toString(16)}, found: 0x${a.getUint8(u).toString(16)}`));return}if(p=a.getUint8(u+1),i&&console.log(`Marker: ${p.toString(16)}`),p===226){i&&console.log("Found APP2 marker (0xffe2)");const m=u+4;if(a.getUint32(m)===1297106432){const v=m+4;let _;if(a.getUint16(v)===18761)_=!1;else if(a.getUint16(v)===19789)_=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(a.getUint16(v+2,!_)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const x=a.getUint32(v+4,!_);if(x<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const b=v+x,R=a.getUint16(b,!_),T=b+2;let E=0;for(let I=T;I<T+12*R;I+=12)a.getUint16(I,!_)===45057&&(E=a.getUint32(I+8,!_));const D=b+2+R*12+4,U=[];for(let I=D;I<D+E*16;I+=16){const O={MPType:a.getUint32(I,!_),size:a.getUint32(I+4,!_),dataOffset:a.getUint32(I+8,!_),dependantImages:a.getUint32(I+12,!_),start:-1,end:-1,isFII:!1};O.dataOffset?(O.start=v+O.dataOffset,O.isFII=!1):(O.start=0,O.isFII=!0),O.end=O.start+O.size,U.push(O)}if(this.options.extractNonFII&&U.length){const I=new Blob([a]),O=[];for(const P of U){if(P.isFII&&!this.options.extractFII)continue;const B=I.slice(P.start,P.end+1,"image/jpeg");O.push(B)}t(O)}}}u+=2+a.getUint16(u+2)}})}}const GB=async s=>{const e=FB(s);if(!e)throw new BR("Gain map XMP metadata not found");const n=await new HB({extractFII:!0,extractNonFII:!0}).extract(s);if(n.length!==2)throw new IR("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},VT=s=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=i=>{t(i)},n.src=URL.createObjectURL(s)});class VB extends fr{_renderer;_renderTargetOptions;_internalLoadingManager;_config;constructor(e,t){super(t),this._config=e,e.renderer&&(this._renderer=e.renderer),this._internalLoadingManager=new y_}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Zn,sdr:new Zn});return this._config.createQuadRenderer({width:16,height:16,type:Ia,colorSpace:fa,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(e,t,n){const i=t?new Blob([t],{type:"image/jpeg"}):void 0,a=new Blob([e],{type:"image/jpeg"});let l,u,f=!1;if(typeof createImageBitmap>"u"){const p=await Promise.all([i?VT(i):Promise.resolve(void 0),VT(a)]);u=p[0],l=p[1],f=n==="flipY"}else{const p=await Promise.all([i?createImageBitmap(i,{imageOrientation:n||"flipY"}):Promise.resolve(void 0),createImageBitmap(a,{imageOrientation:n||"flipY"})]);u=p[0],l=p[1]}return{sdrImage:l,gainMapImage:u,needsFlip:f}}createTextures(e,t,n){const i=new Zn(t||new ImageData(2,2),gc,ta,ta,Wn,Gx,na,Pr,1,fa);i.flipY=n,i.needsUpdate=!0;const a=new Zn(e,gc,ta,ta,Wn,Gx,na,Pr,1,zi);return a.flipY=n,a.needsUpdate=!0,{gainMap:i,sdr:a}}updateQuadRenderer(e,t,n,i,a){e.width=t.width,e.height=t.height,e.material.gainMap=n,e.material.sdr=i,e.material.gainMapMin=a.gainMapMin,e.material.gainMapMax=a.gainMapMax,e.material.offsetHdr=a.offsetHdr,e.material.offsetSdr=a.offsetSdr,e.material.gamma=a.gamma,e.material.hdrCapacityMin=a.hdrCapacityMin,e.material.hdrCapacityMax=a.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,a.hdrCapacityMax),e.material.needsUpdate=!0}}const kB=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,XB=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class YB extends Fr{_maxDisplayBoost;_hdrCapacityMin;_hdrCapacityMax;constructor({gamma:e,offsetHdr:t,offsetSdr:n,gainMapMin:i,gainMapMax:a,maxDisplayBoost:l,hdrCapacityMin:u,hdrCapacityMax:f,sdr:p,gainMap:m}){super({name:"GainMapDecoderMaterial",vertexShader:kB,fragmentShader:XB,uniforms:{sdr:{value:p},gainMap:{value:m},gamma:{value:new ne(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new ne().fromArray(t)},offsetSdr:{value:new ne().fromArray(n)},gainMapMin:{value:new ne().fromArray(i)},gainMapMax:{value:new ne().fromArray(a)},weightFactor:{value:(Math.log2(l)-u)/(f-u)}},blending:vl,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=l,this._hdrCapacityMin=u,this._hdrCapacityMax=f,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class PR extends VB{constructor(e,t){super({renderer:e,createMaterial:n=>new YB(n),createQuadRenderer:n=>new pM(n)},t)}async render(e,t,n,i){const{sdrImage:a,gainMapImage:l,needsFlip:u}=await this.processImages(n,i,"flipY"),{gainMap:f,sdr:p}=this.createTextures(a,l,u);this.updateQuadRenderer(e,a,f,p,t),e.render()}}class qB extends PR{load([e,t,n],i,a,l){const u=this.prepareQuadRenderer();let f,p,m;const v=async()=>{if(f&&p&&m){try{await this.render(u,m,f,p)}catch(N){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof l=="function"&&l(N),u.disposeOnDemandRenderer();return}typeof i=="function"&&i(u),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),u.disposeOnDemandRenderer()}};let _=!0,x=0,b=0,R=!0,T=0,E=0,w=!0,D=0,U=0;const I=()=>{if(typeof a=="function"){const N=x+T+D,z=b+E+U,q=_&&R&&w;a(new ProgressEvent("progress",{lengthComputable:q,loaded:z,total:N}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const O=new Br(this._internalLoadingManager);O.setResponseType("arraybuffer"),O.setRequestHeader(this.requestHeader),O.setPath(this.path),O.setWithCredentials(this.withCredentials),O.load(e,async N=>{if(typeof N=="string")throw new Error("Invalid sdr buffer");f=N,await v()},N=>{_=N.lengthComputable,b=N.loaded,x=N.total,I()},N=>{this.manager.itemError(e),typeof l=="function"&&l(N)});const P=new Br(this._internalLoadingManager);P.setResponseType("arraybuffer"),P.setRequestHeader(this.requestHeader),P.setPath(this.path),P.setWithCredentials(this.withCredentials),P.load(t,async N=>{if(typeof N=="string")throw new Error("Invalid gainmap buffer");p=N,await v()},N=>{R=N.lengthComputable,E=N.loaded,T=N.total,I()},N=>{this.manager.itemError(t),typeof l=="function"&&l(N)});const B=new Br(this._internalLoadingManager);return B.setRequestHeader(this.requestHeader),B.setPath(this.path),B.setWithCredentials(this.withCredentials),B.load(n,async N=>{if(typeof N!="string")throw new Error("Invalid metadata string");m=JSON.parse(N),await v()},N=>{w=N.lengthComputable,U=N.loaded,D=N.total,I()},N=>{this.manager.itemError(n),typeof l=="function"&&l(N)}),u}}class WB extends PR{load(e,t,n,i){const a=this.prepareQuadRenderer(),l=new Br(this._internalLoadingManager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(this.withCredentials),this.manager.itemStart(e),l.load(e,async u=>{if(typeof u=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const f=new Uint8Array(u);let p,m,v;try{const _=await GB(f);p=_.sdr,m=_.gainMap,v=_.metadata}catch(_){if(_ instanceof BR||_ instanceof IR)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),v={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},p=f;else throw _}try{await this.render(a,v,p.buffer,m?.buffer)}catch(_){this.manager.itemError(e),typeof i=="function"&&i(_),a.disposeOnDemandRenderer();return}typeof t=="function"&&t(a),this.manager.itemEnd(e),a.disposeOnDemandRenderer()},n,u=>{this.manager.itemError(e),typeof i=="function"&&i(u)}),a}}const ug={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},FR="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Ad=s=>Array.isArray(s),mM=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function E_({files:s=mM,path:e="",preset:t=void 0,colorSpace:n=void 0,extensions:i}={}){t&&(gM(t),s=ug[t],e=FR);const a=Ad(s),{extension:l,isCubemap:u}=vM(s),f=yM(l);if(!f)throw new Error("useEnvironment: Unrecognized file extension: "+s);const p=xa(x=>x.gl);Ye.useLayoutEffect(()=>{if(l!=="webp"&&l!=="jpg"&&l!=="jpeg")return;function x(){Ts.clear(f,a?[s]:s)}p.domElement.addEventListener("webglcontextlost",x,{once:!0})},[s,p.domElement]);const m=Ts(f,a?[s]:s,x=>{(l==="webp"||l==="jpg"||l==="jpeg")&&x.setRenderer(p),x.setPath==null||x.setPath(e),i&&i(x)});let v=a?m[0]:m;if(l==="jpg"||l==="jpeg"||l==="webp"){var _;v=(_=v.renderTarget)==null?void 0:_.texture}return v.mapping=u?Sl:Cd,v.colorSpace=n??(u?"srgb":"srgb-linear"),v}const jB={files:mM,path:"",preset:void 0,extensions:void 0};E_.preload=s=>{const e={...jB,...s};let{files:t,path:n=""}=e;const{preset:i,extensions:a}=e;i&&(gM(i),t=ug[i],n=FR);const{extension:l}=vM(t);if(l==="webp"||l==="jpg"||l==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const u=yM(l);if(!u)throw new Error("useEnvironment: Unrecognized file extension: "+t);Ts.preload(u,Ad(t)?[t]:t,f=>{f.setPath==null||f.setPath(n),a&&a(f)})};const ZB={files:mM,preset:void 0};E_.clear=s=>{const e={...ZB,...s};let{files:t}=e;const{preset:n}=e;n&&(gM(n),t=ug[n]);const{extension:i}=vM(t),a=yM(i);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+t);Ts.clear(a,Ad(t)?[t]:t)};function gM(s){if(!(s in ug))throw new Error("Preset must be one of: "+Object.keys(ug).join(", "))}function vM(s){var e;const t=Ad(s)&&s.length===6,n=Ad(s)&&s.length===3&&s.some(l=>l.endsWith("json")),i=Ad(s)?s[0]:s;return{extension:t?"cube":n?"webp":i.startsWith("data:application/exr")?"exr":i.startsWith("data:application/hdr")?"hdr":i.startsWith("data:image/jpeg")?"jpg":(e=i.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:n}}function yM(s){return s==="cube"?C2:s==="hdr"?FI:s==="exr"?HI:s==="jpg"||s==="jpeg"?WB:s==="webp"?qB:null}const KB=s=>s.current&&s.current.isScene,QB=s=>KB(s)?s.current:s;function _M(s,e,t,n,i={}){var a,l,u,f;i={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...i};const p=QB(e||t),m=p.background,v=p.environment,_={backgroundBlurriness:p.backgroundBlurriness,backgroundIntensity:p.backgroundIntensity,backgroundRotation:(a=(l=p.backgroundRotation)==null||l.clone==null?void 0:l.clone())!==null&&a!==void 0?a:[0,0,0],environmentIntensity:p.environmentIntensity,environmentRotation:(u=(f=p.environmentRotation)==null||f.clone==null?void 0:f.clone())!==null&&u!==void 0?u:[0,0,0]};return s!=="only"&&(p.environment=n),s&&(p.background=n),ml(p,i),()=>{s!=="only"&&(p.environment=v),s&&(p.background=m),ml(p,_)}}function xM({scene:s,background:e=!1,map:t,...n}){const i=xa(a=>a.scene);return Ye.useLayoutEffect(()=>{if(t)return _M(e,s,i,t,n)}),null}function HR({background:s=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:i,backgroundRotation:a,environmentIntensity:l,environmentRotation:u,...f}){const p=E_(f),m=xa(v=>v.scene);return Ye.useLayoutEffect(()=>_M(s,e,m,p,{backgroundBlurriness:t??n,backgroundIntensity:i,backgroundRotation:a,environmentIntensity:l,environmentRotation:u})),Ye.useEffect(()=>()=>{p.dispose()},[p]),null}function JB({children:s,near:e=.1,far:t=1e3,resolution:n=256,frames:i=1,map:a,background:l=!1,blur:u,backgroundBlurriness:f,backgroundIntensity:p,backgroundRotation:m,environmentIntensity:v,environmentRotation:_,scene:x,files:b,path:R,preset:T=void 0,extensions:E}){const w=xa(B=>B.gl),D=xa(B=>B.scene),U=Ye.useRef(null),[I]=Ye.useState(()=>new gg),O=Ye.useMemo(()=>{const B=new wS(n);return B.texture.type=Ia,B},[n]);Ye.useEffect(()=>()=>{O.dispose()},[O]),Ye.useLayoutEffect(()=>{if(i===1){const B=w.autoClear;w.autoClear=!0,U.current.update(w,I),w.autoClear=B}return _M(l,x,D,O.texture,{backgroundBlurriness:u??f,backgroundIntensity:p,backgroundRotation:m,environmentIntensity:v,environmentRotation:_})},[s,I,O.texture,x,D,l,i,w]);let P=1;return Kd(()=>{if(i===1/0||P<i){const B=w.autoClear;w.autoClear=!0,U.current.update(w,I),w.autoClear=B,P++}}),Ye.createElement(Ye.Fragment,null,nI(Ye.createElement(Ye.Fragment,null,s,Ye.createElement("cubeCamera",{ref:U,args:[e,t,O]}),b||T?Ye.createElement(HR,{background:!0,files:b,preset:T,path:R,extensions:E}):a?Ye.createElement(xM,{background:!0,map:a,extensions:E}):null),I))}function $B(s){var e,t,n,i;const a=E_(s),l=s.map||a;Ye.useMemo(()=>uR({GroundProjectedEnvImpl:UI}),[]),Ye.useEffect(()=>()=>{a.dispose()},[a]);const u=Ye.useMemo(()=>[l],[l]),f=(e=s.ground)==null?void 0:e.height,p=(t=s.ground)==null?void 0:t.radius,m=(n=(i=s.ground)==null?void 0:i.scale)!==null&&n!==void 0?n:1e3;return Ye.createElement(Ye.Fragment,null,Ye.createElement(xM,lg({},s,{map:l})),Ye.createElement("groundProjectedEnvImpl",{args:u,scale:m,height:f,radius:p}))}function eP(s){return s.ground?Ye.createElement($B,s):s.map?Ye.createElement(xM,s):s.children?Ye.createElement(JB,s):Ye.createElement(HR,s)}function kT(s,e){if(e===IA)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),s;if(e===Cy||e===SS){let t=s.getIndex();if(t===null){const l=[],u=s.getAttribute("position");if(u!==void 0){for(let f=0;f<u.count;f++)l.push(f);s.setIndex(l),t=s.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),s}const n=t.count-2,i=[];if(e===Cy)for(let l=1;l<=n;l++)i.push(t.getX(0)),i.push(t.getX(l)),i.push(t.getX(l+1));else for(let l=0;l<n;l++)l%2===0?(i.push(t.getX(l)),i.push(t.getX(l+1)),i.push(t.getX(l+2))):(i.push(t.getX(l+2)),i.push(t.getX(l+1)),i.push(t.getX(l)));i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=s.clone();return a.setIndex(i),a.clearGroups(),a}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),s}class T_ extends fr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new rP(t)}),this.register(function(t){return new sP(t)}),this.register(function(t){return new mP(t)}),this.register(function(t){return new gP(t)}),this.register(function(t){return new vP(t)}),this.register(function(t){return new lP(t)}),this.register(function(t){return new uP(t)}),this.register(function(t){return new cP(t)}),this.register(function(t){return new fP(t)}),this.register(function(t){return new aP(t)}),this.register(function(t){return new hP(t)}),this.register(function(t){return new oP(t)}),this.register(function(t){return new pP(t)}),this.register(function(t){return new dP(t)}),this.register(function(t){return new nP(t)}),this.register(function(t){return new yP(t)}),this.register(function(t){return new _P(t)})}load(e,t,n,i){const a=this;let l;if(this.resourcePath!=="")l=this.resourcePath;else if(this.path!==""){const p=mc.extractUrlBase(e);l=mc.resolveURL(p,this.path)}else l=mc.extractUrlBase(e);this.manager.itemStart(e);const u=function(p){i?i(p):console.error(p),a.manager.itemError(e),a.manager.itemEnd(e)},f=new Br(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(e,function(p){try{a.parse(p,l,function(m){t(m),a.manager.itemEnd(e)},u)}catch(m){u(m)}},n,u)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i){let a;const l={},u={},f=new TextDecoder;if(typeof e=="string")a=JSON.parse(e);else if(e instanceof ArrayBuffer)if(f.decode(new Uint8Array(e,0,4))===GR){try{l[Ln.KHR_BINARY_GLTF]=new xP(e)}catch(v){i&&i(v);return}a=JSON.parse(l[Ln.KHR_BINARY_GLTF].content)}else a=JSON.parse(f.decode(e));else a=e;if(a.asset===void 0||a.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const p=new OP(a,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});p.fileLoader.setRequestHeader(this.requestHeader);for(let m=0;m<this.pluginCallbacks.length;m++){const v=this.pluginCallbacks[m](p);v.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),u[v.name]=v,l[v.name]=!0}if(a.extensionsUsed)for(let m=0;m<a.extensionsUsed.length;++m){const v=a.extensionsUsed[m],_=a.extensionsRequired||[];switch(v){case Ln.KHR_MATERIALS_UNLIT:l[v]=new iP;break;case Ln.KHR_DRACO_MESH_COMPRESSION:l[v]=new SP(a,this.dracoLoader);break;case Ln.KHR_TEXTURE_TRANSFORM:l[v]=new MP;break;case Ln.KHR_MESH_QUANTIZATION:l[v]=new bP;break;default:_.indexOf(v)>=0&&u[v]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+v+'".')}}p.setExtensions(l),p.setPlugins(u),p.parse(n,i)}parseAsync(e,t){const n=this;return new Promise(function(i,a){n.parse(e,t,i,a)})}}function tP(){let s={};return{get:function(e){return s[e]},add:function(e,t){s[e]=t},remove:function(e){delete s[e]},removeAll:function(){s={}}}}const Ln={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class nP{constructor(e){this.parser=e,this.name=Ln.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){const a=t[n];a.extensions&&a.extensions[this.name]&&a.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,a.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const a=t.json,f=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e];let p;const m=new Nt(16777215);f.color!==void 0&&m.setRGB(f.color[0],f.color[1],f.color[2],fa);const v=f.range!==void 0?f.range:0;switch(f.type){case"directional":p=new KS(m),p.target.position.set(0,0,-1),p.add(p.target);break;case"point":p=new ZS(m),p.distance=v;break;case"spot":p=new jS(m),p.distance=v,f.spot=f.spot||{},f.spot.innerConeAngle=f.spot.innerConeAngle!==void 0?f.spot.innerConeAngle:0,f.spot.outerConeAngle=f.spot.outerConeAngle!==void 0?f.spot.outerConeAngle:Math.PI/4,p.angle=f.spot.outerConeAngle,p.penumbra=1-f.spot.innerConeAngle/f.spot.outerConeAngle,p.target.position.set(0,0,-1),p.add(p.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+f.type)}return p.position.set(0,0,0),pl(p,f),f.intensity!==void 0&&(p.intensity=f.intensity),p.name=t.createUniqueName(f.name||"light_"+e),i=Promise.resolve(p),t.cache.add(n,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,a=n.json.nodes[e],u=(a.extensions&&a.extensions[this.name]||{}).light;return u===void 0?null:this._loadLight(u).then(function(f){return n._getNodeRef(t.cache,u,f)})}}class iP{constructor(){this.name=Ln.KHR_MATERIALS_UNLIT}getMaterialType(){return zr}extendParams(e,t,n){const i=[];e.color=new Nt(1,1,1),e.opacity=1;const a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){const l=a.baseColorFactor;e.color.setRGB(l[0],l[1],l[2],fa),e.opacity=l[3]}a.baseColorTexture!==void 0&&i.push(n.assignTexture(e,"map",a.baseColorTexture,zi))}return Promise.all(i)}}class aP{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=i.extensions[this.name].emissiveStrength;return a!==void 0&&(t.emissiveIntensity=a),Promise.resolve()}}class rP{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Qs}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],l=i.extensions[this.name];if(l.clearcoatFactor!==void 0&&(t.clearcoat=l.clearcoatFactor),l.clearcoatTexture!==void 0&&a.push(n.assignTexture(t,"clearcoatMap",l.clearcoatTexture)),l.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=l.clearcoatRoughnessFactor),l.clearcoatRoughnessTexture!==void 0&&a.push(n.assignTexture(t,"clearcoatRoughnessMap",l.clearcoatRoughnessTexture)),l.clearcoatNormalTexture!==void 0&&(a.push(n.assignTexture(t,"clearcoatNormalMap",l.clearcoatNormalTexture)),l.clearcoatNormalTexture.scale!==void 0)){const u=l.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new ht(u,u)}return Promise.all(a)}}class sP{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Qs}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=i.extensions[this.name];return t.dispersion=a.dispersion!==void 0?a.dispersion:0,Promise.resolve()}}class oP{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Qs}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],l=i.extensions[this.name];return l.iridescenceFactor!==void 0&&(t.iridescence=l.iridescenceFactor),l.iridescenceTexture!==void 0&&a.push(n.assignTexture(t,"iridescenceMap",l.iridescenceTexture)),l.iridescenceIor!==void 0&&(t.iridescenceIOR=l.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),l.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=l.iridescenceThicknessMinimum),l.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=l.iridescenceThicknessMaximum),l.iridescenceThicknessTexture!==void 0&&a.push(n.assignTexture(t,"iridescenceThicknessMap",l.iridescenceThicknessTexture)),Promise.all(a)}}class lP{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Qs}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[];t.sheenColor=new Nt(0,0,0),t.sheenRoughness=0,t.sheen=1;const l=i.extensions[this.name];if(l.sheenColorFactor!==void 0){const u=l.sheenColorFactor;t.sheenColor.setRGB(u[0],u[1],u[2],fa)}return l.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=l.sheenRoughnessFactor),l.sheenColorTexture!==void 0&&a.push(n.assignTexture(t,"sheenColorMap",l.sheenColorTexture,zi)),l.sheenRoughnessTexture!==void 0&&a.push(n.assignTexture(t,"sheenRoughnessMap",l.sheenRoughnessTexture)),Promise.all(a)}}class uP{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Qs}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],l=i.extensions[this.name];return l.transmissionFactor!==void 0&&(t.transmission=l.transmissionFactor),l.transmissionTexture!==void 0&&a.push(n.assignTexture(t,"transmissionMap",l.transmissionTexture)),Promise.all(a)}}class cP{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Qs}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],l=i.extensions[this.name];t.thickness=l.thicknessFactor!==void 0?l.thicknessFactor:0,l.thicknessTexture!==void 0&&a.push(n.assignTexture(t,"thicknessMap",l.thicknessTexture)),t.attenuationDistance=l.attenuationDistance||1/0;const u=l.attenuationColor||[1,1,1];return t.attenuationColor=new Nt().setRGB(u[0],u[1],u[2],fa),Promise.all(a)}}class fP{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Qs}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=i.extensions[this.name];return t.ior=a.ior!==void 0?a.ior:1.5,Promise.resolve()}}class hP{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Qs}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],l=i.extensions[this.name];t.specularIntensity=l.specularFactor!==void 0?l.specularFactor:1,l.specularTexture!==void 0&&a.push(n.assignTexture(t,"specularIntensityMap",l.specularTexture));const u=l.specularColorFactor||[1,1,1];return t.specularColor=new Nt().setRGB(u[0],u[1],u[2],fa),l.specularColorTexture!==void 0&&a.push(n.assignTexture(t,"specularColorMap",l.specularColorTexture,zi)),Promise.all(a)}}class dP{constructor(e){this.parser=e,this.name=Ln.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Qs}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],l=i.extensions[this.name];return t.bumpScale=l.bumpFactor!==void 0?l.bumpFactor:1,l.bumpTexture!==void 0&&a.push(n.assignTexture(t,"bumpMap",l.bumpTexture)),Promise.all(a)}}class pP{constructor(e){this.parser=e,this.name=Ln.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Qs}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],l=i.extensions[this.name];return l.anisotropyStrength!==void 0&&(t.anisotropy=l.anisotropyStrength),l.anisotropyRotation!==void 0&&(t.anisotropyRotation=l.anisotropyRotation),l.anisotropyTexture!==void 0&&a.push(n.assignTexture(t,"anisotropyMap",l.anisotropyTexture)),Promise.all(a)}}class mP{constructor(e){this.parser=e,this.name=Ln.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const a=i.extensions[this.name],l=t.options.ktx2Loader;if(!l){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,a.source,l)}}class gP{constructor(e){this.parser=e,this.name=Ln.EXT_TEXTURE_WEBP}loadTexture(e){const t=this.name,n=this.parser,i=n.json,a=i.textures[e];if(!a.extensions||!a.extensions[t])return null;const l=a.extensions[t],u=i.images[l.source];let f=n.textureLoader;if(u.uri){const p=n.options.manager.getHandler(u.uri);p!==null&&(f=p)}return n.loadTextureImage(e,l.source,f)}}class vP{constructor(e){this.parser=e,this.name=Ln.EXT_TEXTURE_AVIF}loadTexture(e){const t=this.name,n=this.parser,i=n.json,a=i.textures[e];if(!a.extensions||!a.extensions[t])return null;const l=a.extensions[t],u=i.images[l.source];let f=n.textureLoader;if(u.uri){const p=n.options.manager.getHandler(u.uri);p!==null&&(f=p)}return n.loadTextureImage(e,l.source,f)}}class yP{constructor(e){this.name=Ln.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const i=n.extensions[this.name],a=this.parser.getDependency("buffer",i.buffer),l=this.parser.options.meshoptDecoder;if(!l||!l.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return a.then(function(u){const f=i.byteOffset||0,p=i.byteLength||0,m=i.count,v=i.byteStride,_=new Uint8Array(u,f,p);return l.decodeGltfBufferAsync?l.decodeGltfBufferAsync(m,v,_,i.mode,i.filter).then(function(x){return x.buffer}):l.ready.then(function(){const x=new ArrayBuffer(m*v);return l.decodeGltfBuffer(new Uint8Array(x),m,v,_,i.mode,i.filter),x})})}else return null}}class _P{constructor(e){this.name=Ln.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const i=t.meshes[n.mesh];for(const p of i.primitives)if(p.mode!==Ws.TRIANGLES&&p.mode!==Ws.TRIANGLE_STRIP&&p.mode!==Ws.TRIANGLE_FAN&&p.mode!==void 0)return null;const l=n.extensions[this.name].attributes,u=[],f={};for(const p in l)u.push(this.parser.getDependency("accessor",l[p]).then(m=>(f[p]=m,f[p])));return u.length<1?null:(u.push(this.parser.createNodeMesh(e)),Promise.all(u).then(p=>{const m=p.pop(),v=m.isGroup?m.children:[m],_=p[0].count,x=[];for(const b of v){const R=new Qt,T=new ne,E=new ua,w=new ne(1,1,1),D=new NS(b.geometry,b.material,_);for(let U=0;U<_;U++)f.TRANSLATION&&T.fromBufferAttribute(f.TRANSLATION,U),f.ROTATION&&E.fromBufferAttribute(f.ROTATION,U),f.SCALE&&w.fromBufferAttribute(f.SCALE,U),D.setMatrixAt(U,R.compose(T,E,w));for(const U in f)if(U==="_COLOR_0"){const I=f[U];D.instanceColor=new xc(I.array,I.itemSize,I.normalized)}else U!=="TRANSLATION"&&U!=="ROTATION"&&U!=="SCALE"&&b.geometry.setAttribute(U,f[U]);Xn.prototype.copy.call(D,b),this.parser.assignFinalMaterial(D),x.push(D)}return m.isGroup?(m.clear(),m.add(...x),m):x[0]}))}}const GR="glTF",Lm=12,XT={JSON:1313821514,BIN:5130562};class xP{constructor(e){this.name=Ln.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Lm),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==GR)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-Lm,a=new DataView(e,Lm);let l=0;for(;l<i;){const u=a.getUint32(l,!0);l+=4;const f=a.getUint32(l,!0);if(l+=4,f===XT.JSON){const p=new Uint8Array(e,Lm+l,u);this.content=n.decode(p)}else if(f===XT.BIN){const p=Lm+l;this.body=e.slice(p,p+u)}l+=u}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class SP{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ln.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,i=this.dracoLoader,a=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,u={},f={},p={};for(const m in l){const v=cS[m]||m.toLowerCase();u[v]=l[m]}for(const m in e.attributes){const v=cS[m]||m.toLowerCase();if(l[m]!==void 0){const _=n.accessors[e.attributes[m]],x=Rd[_.componentType];p[v]=x.name,f[v]=_.normalized===!0}}return t.getDependency("bufferView",a).then(function(m){return new Promise(function(v,_){i.decodeDracoFile(m,function(x){for(const b in x.attributes){const R=x.attributes[b],T=f[b];T!==void 0&&(R.normalized=T)}v(x)},u,p,fa,_)})})}}class MP{constructor(){this.name=Ln.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class bP{constructor(){this.name=Ln.KHR_MESH_QUANTIZATION}}class VR extends Wd{constructor(e,t,n,i){super(e,t,n,i)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,a=e*i*3+i;for(let l=0;l!==i;l++)t[l]=n[a+l];return t}interpolate_(e,t,n,i){const a=this.resultBuffer,l=this.sampleValues,u=this.valueSize,f=u*2,p=u*3,m=i-t,v=(n-t)/m,_=v*v,x=_*v,b=e*p,R=b-p,T=-2*x+3*_,E=x-_,w=1-T,D=E-_+v;for(let U=0;U!==u;U++){const I=l[R+U+u],O=l[R+U+f]*m,P=l[b+U+u],B=l[b+U]*m;a[U]=w*I+D*O+T*P+E*B}return a}}const EP=new ua;class TP extends VR{interpolate_(e,t,n,i){const a=super.interpolate_(e,t,n,i);return EP.fromArray(a).normalize().toArray(a),a}}const Ws={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Rd={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},YT={9728:Sa,9729:Wn,9984:Gy,9985:Ed,9986:Df,9987:Zs},qT={33071:ta,33648:wd,10497:yc},Rx={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},cS={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},fc={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},AP={CUBICSPLINE:void 0,LINEAR:zd,STEP:Ld},Cx={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function RP(s){return s.DefaultMaterial===void 0&&(s.DefaultMaterial=new qd({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:xl})),s.DefaultMaterial}function Ef(s,e,t){for(const n in t.extensions)s[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function pl(s,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(s.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function CP(s,e,t){let n=!1,i=!1,a=!1;for(let p=0,m=e.length;p<m;p++){const v=e[p];if(v.POSITION!==void 0&&(n=!0),v.NORMAL!==void 0&&(i=!0),v.COLOR_0!==void 0&&(a=!0),n&&i&&a)break}if(!n&&!i&&!a)return Promise.resolve(s);const l=[],u=[],f=[];for(let p=0,m=e.length;p<m;p++){const v=e[p];if(n){const _=v.POSITION!==void 0?t.getDependency("accessor",v.POSITION):s.attributes.position;l.push(_)}if(i){const _=v.NORMAL!==void 0?t.getDependency("accessor",v.NORMAL):s.attributes.normal;u.push(_)}if(a){const _=v.COLOR_0!==void 0?t.getDependency("accessor",v.COLOR_0):s.attributes.color;f.push(_)}}return Promise.all([Promise.all(l),Promise.all(u),Promise.all(f)]).then(function(p){const m=p[0],v=p[1],_=p[2];return n&&(s.morphAttributes.position=m),i&&(s.morphAttributes.normal=v),a&&(s.morphAttributes.color=_),s.morphTargetsRelative=!0,s})}function wP(s,e){if(s.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)s.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(s.morphTargetInfluences.length===t.length){s.morphTargetDictionary={};for(let n=0,i=t.length;n<i;n++)s.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function UP(s){let e;const t=s.extensions&&s.extensions[Ln.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+wx(t.attributes):e=s.indices+":"+wx(s.attributes)+":"+s.mode,s.targets!==void 0)for(let n=0,i=s.targets.length;n<i;n++)e+=":"+wx(s.targets[n]);return e}function wx(s){let e="";const t=Object.keys(s).sort();for(let n=0,i=t.length;n<i;n++)e+=t[n]+":"+s[t[n]]+";";return e}function fS(s){switch(s){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function DP(s){return s.search(/\.jpe?g($|\?)/i)>0||s.search(/^data\:image\/jpeg/)===0?"image/jpeg":s.search(/\.webp($|\?)/i)>0||s.search(/^data\:image\/webp/)===0?"image/webp":s.search(/\.ktx2($|\?)/i)>0||s.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const NP=new Qt;class OP{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new tP,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,i=-1,a=!1,l=-1;if(typeof navigator<"u"){const u=navigator.userAgent;n=/^((?!chrome|android).)*safari/i.test(u)===!0;const f=u.match(/Version\/(\d+)/);i=n&&f?parseInt(f[1],10):-1,a=u.indexOf("Firefox")>-1,l=a?u.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||n&&i<17||a&&l<98?this.textureLoader=new Eg(this.options.manager):this.textureLoader=new z2(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Br(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,i=this.json,a=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(l){return l._markDefs&&l._markDefs()}),Promise.all(this._invokeAll(function(l){return l.beforeRoot&&l.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(l){const u={scene:l[0][i.scene||0],scenes:l[0],animations:l[1],cameras:l[2],asset:i.asset,parser:n,userData:{}};return Ef(a,u,i),pl(u,i),Promise.all(n._invokeAll(function(f){return f.afterRoot&&f.afterRoot(u)})).then(function(){for(const f of u.scenes)f.updateMatrixWorld();e(u)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let i=0,a=t.length;i<a;i++){const l=t[i].joints;for(let u=0,f=l.length;u<f;u++)e[l[u]].isBone=!0}for(let i=0,a=e.length;i<a;i++){const l=e[i];l.mesh!==void 0&&(this._addNodeRef(this.meshCache,l.mesh),l.skin!==void 0&&(n[l.mesh].isSkinnedMesh=!0)),l.camera!==void 0&&this._addNodeRef(this.cameraCache,l.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const i=n.clone(),a=(l,u)=>{const f=this.associations.get(l);f!=null&&this.associations.set(u,f);for(const[p,m]of l.children.entries())a(m,u.children[p])};return a(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const i=e(t[n]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const a=e(t[i]);a&&n.push(a)}return n}getDependency(e,t){const n=e+":"+t;let i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(a){return a.loadNode&&a.loadNode(t)});break;case"mesh":i=this._invokeOne(function(a){return a.loadMesh&&a.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(a){return a.loadBufferView&&a.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(a){return a.loadMaterial&&a.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(a){return a.loadTexture&&a.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(a){return a.loadAnimation&&a.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(a){return a!=this&&a.getDependency&&a.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(a,l){return n.getDependency(e,l)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Ln.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(a,l){n.load(mc.resolveURL(t.uri,i.path),a,void 0,function(){l(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const i=t.byteLength||0,a=t.byteOffset||0;return n.slice(a,a+i)})}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const l=Rx[i.type],u=Rd[i.componentType],f=i.normalized===!0,p=new u(i.count*l);return Promise.resolve(new ii(p,l,f))}const a=[];return i.bufferView!==void 0?a.push(this.getDependency("bufferView",i.bufferView)):a.push(null),i.sparse!==void 0&&(a.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(a).then(function(l){const u=l[0],f=Rx[i.type],p=Rd[i.componentType],m=p.BYTES_PER_ELEMENT,v=m*f,_=i.byteOffset||0,x=i.bufferView!==void 0?n.bufferViews[i.bufferView].byteStride:void 0,b=i.normalized===!0;let R,T;if(x&&x!==v){const E=Math.floor(_/x),w="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+E+":"+i.count;let D=t.cache.get(w);D||(R=new p(u,E*x,i.count*x/m),D=new vg(R,x/m),t.cache.add(w,D)),T=new _c(D,f,_%x/m,b)}else u===null?R=new p(i.count*f):R=new p(u,_,i.count*f),T=new ii(R,f,b);if(i.sparse!==void 0){const E=Rx.SCALAR,w=Rd[i.sparse.indices.componentType],D=i.sparse.indices.byteOffset||0,U=i.sparse.values.byteOffset||0,I=new w(l[1],D,i.sparse.count*E),O=new p(l[2],U,i.sparse.count*f);u!==null&&(T=new ii(T.array.slice(),T.itemSize,T.normalized)),T.normalized=!1;for(let P=0,B=I.length;P<B;P++){const N=I[P];if(T.setX(N,O[P*f]),f>=2&&T.setY(N,O[P*f+1]),f>=3&&T.setZ(N,O[P*f+2]),f>=4&&T.setW(N,O[P*f+3]),f>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}T.normalized=b}return T})}loadTexture(e){const t=this.json,n=this.options,a=t.textures[e].source,l=t.images[a];let u=this.textureLoader;if(l.uri){const f=n.manager.getHandler(l.uri);f!==null&&(u=f)}return this.loadTextureImage(e,a,u)}loadTextureImage(e,t,n){const i=this,a=this.json,l=a.textures[e],u=a.images[t],f=(u.uri||u.bufferView)+":"+l.sampler;if(this.textureCache[f])return this.textureCache[f];const p=this.loadImageSource(t,n).then(function(m){m.flipY=!1,m.name=l.name||u.name||"",m.name===""&&typeof u.uri=="string"&&u.uri.startsWith("data:image/")===!1&&(m.name=u.uri);const _=(a.samplers||{})[l.sampler]||{};return m.magFilter=YT[_.magFilter]||Wn,m.minFilter=YT[_.minFilter]||Zs,m.wrapS=qT[_.wrapS]||yc,m.wrapT=qT[_.wrapT]||yc,m.generateMipmaps=!m.isCompressedTexture&&m.minFilter!==Sa&&m.minFilter!==Wn,i.associations.set(m,{textures:e}),m}).catch(function(){return null});return this.textureCache[f]=p,p}loadImageSource(e,t){const n=this,i=this.json,a=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(v=>v.clone());const l=i.images[e],u=self.URL||self.webkitURL;let f=l.uri||"",p=!1;if(l.bufferView!==void 0)f=n.getDependency("bufferView",l.bufferView).then(function(v){p=!0;const _=new Blob([v],{type:l.mimeType});return f=u.createObjectURL(_),f});else if(l.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const m=Promise.resolve(f).then(function(v){return new Promise(function(_,x){let b=_;t.isImageBitmapLoader===!0&&(b=function(R){const T=new Zn(R);T.needsUpdate=!0,_(T)}),t.load(mc.resolveURL(v,a.path),b,void 0,x)})}).then(function(v){return p===!0&&u.revokeObjectURL(f),pl(v,l),v.userData.mimeType=l.mimeType||DP(l.uri),v}).catch(function(v){throw console.error("THREE.GLTFLoader: Couldn't load texture",f),v});return this.sourceCache[e]=m,m}assignTexture(e,t,n,i){const a=this;return this.getDependency("texture",n.index).then(function(l){if(!l)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(l=l.clone(),l.channel=n.texCoord),a.extensions[Ln.KHR_TEXTURE_TRANSFORM]){const u=n.extensions!==void 0?n.extensions[Ln.KHR_TEXTURE_TRANSFORM]:void 0;if(u){const f=a.associations.get(l);l=a.extensions[Ln.KHR_TEXTURE_TRANSFORM].extendTexture(l,u),a.associations.set(l,f)}}return i!==void 0&&(l.colorSpace=i),e[t]=l,l})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=t.attributes.tangent===void 0,a=t.attributes.color!==void 0,l=t.attributes.normal===void 0;if(e.isPoints){const u="PointsMaterial:"+n.uuid;let f=this.cache.get(u);f||(f=new n_,ba.prototype.copy.call(f,n),f.color.copy(n.color),f.map=n.map,f.sizeAttenuation=!1,this.cache.add(u,f)),n=f}else if(e.isLine){const u="LineBasicMaterial:"+n.uuid;let f=this.cache.get(u);f||(f=new cr,ba.prototype.copy.call(f,n),f.color.copy(n.color),f.map=n.map,this.cache.add(u,f)),n=f}if(i||a||l){let u="ClonedMaterial:"+n.uuid+":";i&&(u+="derivative-tangents:"),a&&(u+="vertex-colors:"),l&&(u+="flat-shading:");let f=this.cache.get(u);f||(f=n.clone(),a&&(f.vertexColors=!0),l&&(f.flatShading=!0),i&&(f.normalScale&&(f.normalScale.y*=-1),f.clearcoatNormalScale&&(f.clearcoatNormalScale.y*=-1)),this.cache.add(u,f),this.associations.set(f,this.associations.get(n))),n=f}e.material=n}getMaterialType(){return qd}loadMaterial(e){const t=this,n=this.json,i=this.extensions,a=n.materials[e];let l;const u={},f=a.extensions||{},p=[];if(f[Ln.KHR_MATERIALS_UNLIT]){const v=i[Ln.KHR_MATERIALS_UNLIT];l=v.getMaterialType(),p.push(v.extendParams(u,a,t))}else{const v=a.pbrMetallicRoughness||{};if(u.color=new Nt(1,1,1),u.opacity=1,Array.isArray(v.baseColorFactor)){const _=v.baseColorFactor;u.color.setRGB(_[0],_[1],_[2],fa),u.opacity=_[3]}v.baseColorTexture!==void 0&&p.push(t.assignTexture(u,"map",v.baseColorTexture,zi)),u.metalness=v.metallicFactor!==void 0?v.metallicFactor:1,u.roughness=v.roughnessFactor!==void 0?v.roughnessFactor:1,v.metallicRoughnessTexture!==void 0&&(p.push(t.assignTexture(u,"metalnessMap",v.metallicRoughnessTexture)),p.push(t.assignTexture(u,"roughnessMap",v.metallicRoughnessTexture))),l=this._invokeOne(function(_){return _.getMaterialType&&_.getMaterialType(e)}),p.push(Promise.all(this._invokeAll(function(_){return _.extendMaterialParams&&_.extendMaterialParams(e,u)})))}a.doubleSided===!0&&(u.side=ur);const m=a.alphaMode||Cx.OPAQUE;if(m===Cx.BLEND?(u.transparent=!0,u.depthWrite=!1):(u.transparent=!1,m===Cx.MASK&&(u.alphaTest=a.alphaCutoff!==void 0?a.alphaCutoff:.5)),a.normalTexture!==void 0&&l!==zr&&(p.push(t.assignTexture(u,"normalMap",a.normalTexture)),u.normalScale=new ht(1,1),a.normalTexture.scale!==void 0)){const v=a.normalTexture.scale;u.normalScale.set(v,v)}if(a.occlusionTexture!==void 0&&l!==zr&&(p.push(t.assignTexture(u,"aoMap",a.occlusionTexture)),a.occlusionTexture.strength!==void 0&&(u.aoMapIntensity=a.occlusionTexture.strength)),a.emissiveFactor!==void 0&&l!==zr){const v=a.emissiveFactor;u.emissive=new Nt().setRGB(v[0],v[1],v[2],fa)}return a.emissiveTexture!==void 0&&l!==zr&&p.push(t.assignTexture(u,"emissiveMap",a.emissiveTexture,zi)),Promise.all(p).then(function(){const v=new l(u);return a.name&&(v.name=a.name),pl(v,a),t.associations.set(v,{materials:e}),a.extensions&&Ef(i,v,a),v})}createUniqueName(e){const t=qn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function a(u){return n[Ln.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(u,t).then(function(f){return WT(f,u,t)})}const l=[];for(let u=0,f=e.length;u<f;u++){const p=e[u],m=UP(p),v=i[m];if(v)l.push(v.promise);else{let _;p.extensions&&p.extensions[Ln.KHR_DRACO_MESH_COMPRESSION]?_=a(p):_=WT(new vn,p,t),i[m]={primitive:p,promise:_},l.push(_)}}return Promise.all(l)}loadMesh(e){const t=this,n=this.json,i=this.extensions,a=n.meshes[e],l=a.primitives,u=[];for(let f=0,p=l.length;f<p;f++){const m=l[f].material===void 0?RP(this.cache):this.getDependency("material",l[f].material);u.push(m)}return u.push(t.loadGeometries(l)),Promise.all(u).then(function(f){const p=f.slice(0,f.length-1),m=f[f.length-1],v=[];for(let x=0,b=m.length;x<b;x++){const R=m[x],T=l[x];let E;const w=p[x];if(T.mode===Ws.TRIANGLES||T.mode===Ws.TRIANGLE_STRIP||T.mode===Ws.TRIANGLE_FAN||T.mode===void 0)E=a.isSkinnedMesh===!0?new DS(R,w):new Si(R,w),E.isSkinnedMesh===!0&&E.normalizeSkinWeights(),T.mode===Ws.TRIANGLE_STRIP?E.geometry=kT(E.geometry,SS):T.mode===Ws.TRIANGLE_FAN&&(E.geometry=kT(E.geometry,Cy));else if(T.mode===Ws.LINES)E=new Oo(R,w);else if(T.mode===Ws.LINE_STRIP)E=new yu(R,w);else if(T.mode===Ws.LINE_LOOP)E=new OS(R,w);else if(T.mode===Ws.POINTS)E=new LS(R,w);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+T.mode);Object.keys(E.geometry.morphAttributes).length>0&&wP(E,a),E.name=t.createUniqueName(a.name||"mesh_"+e),pl(E,a),T.extensions&&Ef(i,E,T),t.assignFinalMaterial(E),v.push(E)}for(let x=0,b=v.length;x<b;x++)t.associations.set(v[x],{meshes:e,primitives:x});if(v.length===1)return a.extensions&&Ef(i,v[0],a),v[0];const _=new gu;a.extensions&&Ef(i,_,a),t.associations.set(_,{meshes:e});for(let x=0,b=v.length;x<b;x++)_.add(v[x]);return _})}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Zi(Pd.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):n.type==="orthographic"&&(t=new _l(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),pl(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let i=0,a=t.joints.length;i<a;i++)n.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(i){const a=i.pop(),l=i,u=[],f=[];for(let p=0,m=l.length;p<m;p++){const v=l[p];if(v){u.push(v);const _=new Qt;a!==null&&_.fromArray(a.array,p*16),f.push(_)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[p])}return new yg(u,f)})}loadAnimation(e){const t=this.json,n=this,i=t.animations[e],a=i.name?i.name:"animation_"+e,l=[],u=[],f=[],p=[],m=[];for(let v=0,_=i.channels.length;v<_;v++){const x=i.channels[v],b=i.samplers[x.sampler],R=x.target,T=R.node,E=i.parameters!==void 0?i.parameters[b.input]:b.input,w=i.parameters!==void 0?i.parameters[b.output]:b.output;R.node!==void 0&&(l.push(this.getDependency("node",T)),u.push(this.getDependency("accessor",E)),f.push(this.getDependency("accessor",w)),p.push(b),m.push(R))}return Promise.all([Promise.all(l),Promise.all(u),Promise.all(f),Promise.all(p),Promise.all(m)]).then(function(v){const _=v[0],x=v[1],b=v[2],R=v[3],T=v[4],E=[];for(let D=0,U=_.length;D<U;D++){const I=_[D],O=x[D],P=b[D],B=R[D],N=T[D];if(I===void 0)continue;I.updateMatrix&&I.updateMatrix();const z=n._createAnimationTracks(I,O,P,B,N);if(z)for(let q=0;q<z.length;q++)E.push(z[q])}const w=new Vd(a,void 0,E);return pl(w,i),w})}createNodeMesh(e){const t=this.json,n=this,i=t.nodes[e];return i.mesh===void 0?null:n.getDependency("mesh",i.mesh).then(function(a){const l=n._getNodeRef(n.meshCache,i.mesh,a);return i.weights!==void 0&&l.traverse(function(u){if(u.isMesh)for(let f=0,p=i.weights.length;f<p;f++)u.morphTargetInfluences[f]=i.weights[f]}),l})}loadNode(e){const t=this.json,n=this,i=t.nodes[e],a=n._loadNodeShallow(e),l=[],u=i.children||[];for(let p=0,m=u.length;p<m;p++)l.push(n.getDependency("node",u[p]));const f=i.skin===void 0?Promise.resolve(null):n.getDependency("skin",i.skin);return Promise.all([a,Promise.all(l),f]).then(function(p){const m=p[0],v=p[1],_=p[2];_!==null&&m.traverse(function(x){x.isSkinnedMesh&&x.bind(_,NP)});for(let x=0,b=v.length;x<b;x++)m.add(v[x]);return m})}_loadNodeShallow(e){const t=this.json,n=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const a=t.nodes[e],l=a.name?i.createUniqueName(a.name):"",u=[],f=i._invokeOne(function(p){return p.createNodeMesh&&p.createNodeMesh(e)});return f&&u.push(f),a.camera!==void 0&&u.push(i.getDependency("camera",a.camera).then(function(p){return i._getNodeRef(i.cameraCache,a.camera,p)})),i._invokeAll(function(p){return p.createNodeAttachment&&p.createNodeAttachment(e)}).forEach(function(p){u.push(p)}),this.nodeCache[e]=Promise.all(u).then(function(p){let m;if(a.isBone===!0?m=new e_:p.length>1?m=new gu:p.length===1?m=p[0]:m=new Xn,m!==p[0])for(let v=0,_=p.length;v<_;v++)m.add(p[v]);if(a.name&&(m.userData.name=a.name,m.name=l),pl(m,a),a.extensions&&Ef(n,m,a),a.matrix!==void 0){const v=new Qt;v.fromArray(a.matrix),m.applyMatrix4(v)}else a.translation!==void 0&&m.position.fromArray(a.translation),a.rotation!==void 0&&m.quaternion.fromArray(a.rotation),a.scale!==void 0&&m.scale.fromArray(a.scale);if(!i.associations.has(m))i.associations.set(m,{});else if(a.mesh!==void 0&&i.meshCache.refs[a.mesh]>1){const v=i.associations.get(m);i.associations.set(m,{...v})}return i.associations.get(m).nodes=e,m}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],i=this,a=new gu;n.name&&(a.name=i.createUniqueName(n.name)),pl(a,n),n.extensions&&Ef(t,a,n);const l=n.nodes||[],u=[];for(let f=0,p=l.length;f<p;f++)u.push(i.getDependency("node",l[f]));return Promise.all(u).then(function(f){for(let m=0,v=f.length;m<v;m++)a.add(f[m]);const p=m=>{const v=new Map;for(const[_,x]of i.associations)(_ instanceof ba||_ instanceof Zn)&&v.set(_,x);return m.traverse(_=>{const x=i.associations.get(_);x!=null&&v.set(_,x)}),v};return i.associations=p(a),a})}_createAnimationTracks(e,t,n,i,a){const l=[],u=e.name?e.name:e.uuid,f=[];fc[a.path]===fc.weights?e.traverse(function(_){_.morphTargetInfluences&&f.push(_.name?_.name:_.uuid)}):f.push(u);let p;switch(fc[a.path]){case fc.weights:p=kf;break;case fc.rotation:p=Xf;break;case fc.translation:case fc.scale:p=Yf;break;default:n.itemSize===1?p=kf:p=Yf;break}const m=i.interpolation!==void 0?AP[i.interpolation]:zd,v=this._getArrayFromAccessor(n);for(let _=0,x=f.length;_<x;_++){const b=new p(f[_]+"."+fc[a.path],t.array,v,m);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(b),l.push(b)}return l}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=fS(t.constructor),i=new Float32Array(t.length);for(let a=0,l=t.length;a<l;a++)i[a]=t[a]*n;t=i}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const i=this instanceof Xf?TP:VR;return new i(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function LP(s,e,t){const n=e.attributes,i=new ca;if(n.POSITION!==void 0){const u=t.json.accessors[n.POSITION],f=u.min,p=u.max;if(f!==void 0&&p!==void 0){if(i.set(new ne(f[0],f[1],f[2]),new ne(p[0],p[1],p[2])),u.normalized){const m=fS(Rd[u.componentType]);i.min.multiplyScalar(m),i.max.multiplyScalar(m)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const a=e.targets;if(a!==void 0){const u=new ne,f=new ne;for(let p=0,m=a.length;p<m;p++){const v=a[p];if(v.POSITION!==void 0){const _=t.json.accessors[v.POSITION],x=_.min,b=_.max;if(x!==void 0&&b!==void 0){if(f.setX(Math.max(Math.abs(x[0]),Math.abs(b[0]))),f.setY(Math.max(Math.abs(x[1]),Math.abs(b[1]))),f.setZ(Math.max(Math.abs(x[2]),Math.abs(b[2]))),_.normalized){const R=fS(Rd[_.componentType]);f.multiplyScalar(R)}u.max(f)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(u)}s.boundingBox=i;const l=new Ma;i.getCenter(l.center),l.radius=i.min.distanceTo(i.max)/2,s.boundingSphere=l}function WT(s,e,t){const n=e.attributes,i=[];function a(l,u){return t.getDependency("accessor",l).then(function(f){s.setAttribute(u,f)})}for(const l in n){const u=cS[l]||l.toLowerCase();u in s.attributes||i.push(a(n[l],u))}if(e.indices!==void 0&&!s.index){const l=t.getDependency("accessor",e.indices).then(function(u){s.setIndex(u)});i.push(l)}return On.workingColorSpace!==fa&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${On.workingColorSpace}" not supported.`),pl(s,e),LP(s,e,t),Promise.all(i).then(function(){return e.targets!==void 0?CP(s,e.targets,t):s})}const zP=`
  uniform float time;
  varying vec2 vUv;
  varying float hValue;

  float random (in vec2 st) {
      return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
  }

  float noise (in vec2 st) {
      vec2 i = floor(st);
      vec2 f = fract(st);
      float a = random(i);
      float b = random(i + vec2(1.0, 0.0));
      float c = random(i + vec2(0.0, 1.0));
      float d = random(i + vec2(1.0, 1.0));
      vec2 u = f*f*(3.0-2.0*f);
      return mix(a, b, u.x) + (c - a)* u.y * (1.0 - u.x) + (d - b) * u.x * u.y;
  }

  void main() {
    vUv = uv;
    vec3 pos = position;
    pos *= vec3(0.8, 2.0, 0.725);
    hValue = position.y;
    float posXZlen = length(position.xz);

    pos.y *= 1.0 + (cos((posXZlen + 0.25) * 3.1415926) * 0.4 + noise(vec2(0.0, time)) * 0.3 + noise(vec2(position.x + time, position.z + time)) * 0.8) * position.y;
    pos.x += noise(vec2(time * 2.0, (position.y - time) * 4.0)) * hValue * 0.15;
    pos.z += noise(vec2((position.y - time) * 4.0, time * 2.0)) * hValue * 0.15;
    pos.x += sin(time * 1.5 + position.y * 2.0) * hValue * 0.08;
    pos.z += cos(time * 1.3 + position.y * 2.0) * hValue * 0.08;

    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
  }
`,IP=`
  uniform float strength;
  varying float hValue;
  varying vec2 vUv;

  vec3 heatmapGradient(float t) {
    return clamp(
      (pow(t, 1.5) * 0.8 + 0.2) *
        vec3(
          smoothstep(0.0, 0.35, t) + t * 0.5,
          smoothstep(0.5, 1.0, t),
          max(1.0 - t * 1.7, t * 7.0 - 6.0)
        ),
      0.0,
      1.0
    );
  }

  void main() {
    float v = abs(smoothstep(0.0, 0.4, hValue) - 1.0);
    float alpha = (1.0 - v) * 0.99;
    alpha -= 1.0 - smoothstep(1.0, 0.97, hValue);
    gl_FragColor = vec4(heatmapGradient(smoothstep(0.0, 0.3, hValue)) * vec3(0.95, 0.95, 0.4), alpha);
    gl_FragColor.rgb = mix(vec3(0.0, 0.0, 1.0), gl_FragColor.rgb, smoothstep(0.0, 0.3, hValue));
    gl_FragColor.rgb += vec3(1.0, 0.9, 0.5) * (1.25 - vUv.y);
    gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.66, 0.32, 0.03), smoothstep(0.95, 1.0, hValue));
    gl_FragColor *= strength;
  }
`;function BP({children:s,isLit:e=!0,...t}){const n=Ts(T_,"/candle.glb"),i=Ye.useMemo(()=>n.scene?.clone(!0)??null,[n.scene]),a=Ye.useRef(null),l=Ye.useRef(null),u=Ye.useRef(e?1:0),f=Ye.useMemo(()=>({time:{value:0},strength:{value:1}}),[]),p=Ye.useMemo(()=>new Fr({uniforms:f,vertexShader:zP,fragmentShader:IP,transparent:!0,side:ur}),[f]);return Ye.useEffect(()=>()=>{p.dispose()},[p]),Ye.useEffect(()=>{f.strength.value=e?1:0,u.current=e?1:0},[e,f]),Kd(({clock:m},v)=>{const _=m.elapsedTime;f.time.value=_;const x=e?1:0;f.strength.value=Pd.damp(f.strength.value,x,4,v);const b=a.current;if(!b)return;u.current=Pd.damp(u.current,x,4,v);const R=Math.sin(_*10)*.08+Math.sin(_*15.3)*.04+Math.sin(_*8.7)*.03,T=f.strength.value;b.intensity=Math.max(0,u.current+R*T*.5),b.position.y=3.5+Math.sin(_*5)*.1,b.position.x=Math.sin(_*3)*.05,b.position.z=Math.cos(_*2.7)*.05,b.visible=T>.02,l.current&&(l.current.visible=T>.02)}),i?Lt.jsxs("group",{...t,children:[Lt.jsx("primitive",{object:i}),Lt.jsx("mesh",{ref:l,scale:.4,position:[0,2.9,0],material:p,children:Lt.jsx("sphereGeometry",{args:[.5,32,32]})}),Lt.jsx("pointLight",{ref:a,distance:5,color:"#ffffffff",decay:1}),s]}):null}function PP(s){const e=Fy.c(12);let t,n;e[0]!==s?({children:t,...n}=s,e[0]=s,e[1]=t,e[2]=n):(t=e[1],n=e[2]);const i=Ts(T_,"/cake.glb");let a;e[3]!==i.scene?(a=i.scene?.clone(!0)??null,e[3]=i.scene,e[4]=a):a=e[4];const l=a;if(!l)return null;let u;e[5]!==l?(u=Lt.jsx("primitive",{object:l}),e[5]=l,e[6]=u):u=e[6];let f;e[7]===Symbol.for("react.memo_cache_sentinel")?(f=Lt.jsx(IB,{position:[0,3.4,0],fontSize:.5,color:"#f5c542",anchorX:"center",anchorY:"middle",children:"22"}),e[7]=f):f=e[7];let p;return e[8]!==t||e[9]!==n||e[10]!==u?(p=Lt.jsxs("group",{...n,children:[u,f,t]}),e[8]=t,e[9]=n,e[10]=u,e[11]=p):p=e[11],p}function FP(s){const e=Fy.c(11);let t,n;e[0]!==s?({children:t,...n}=s,e[0]=s,e[1]=t,e[2]=n):(t=e[1],n=e[2]);const i=Ts(T_,"/table.glb");let a;e[3]!==i.scene?(a=i.scene?.clone(!0)??null,e[3]=i.scene,e[4]=a):a=e[4];const l=a;if(!l)return null;let u;e[5]!==l?(u=Lt.jsx("primitive",{object:l}),e[5]=l,e[6]=u):u=e[6];let f;return e[7]!==t||e[8]!==n||e[9]!==u?(f=Lt.jsxs("group",{...n,children:[u,t]}),e[7]=t,e[8]=n,e[9]=u,e[10]=f):f=e[10],f}const HP=[.82,.82];function Iv({image:s,imageScale:e=HP,imageOffset:t,imageInset:n=.01,children:i,...a}){const{gl:l}=xa(),u=Ts(T_,"/picture_frame.glb"),f=b_(s);f.colorSpace=zi;const p=typeof l.capabilities.getMaxAnisotropy=="function"?l.capabilities.getMaxAnisotropy():1;f.anisotropy=p;const m=Ye.useMemo(()=>u.scene.clone(!0),[u.scene]),{frameSize:v,frameCenter:_}=Ye.useMemo(()=>{const P=new ca().setFromObject(m),B=new ne,N=new ne;return P.getSize(B),P.getCenter(N),{frameSize:B,frameCenter:N}},[m]),x=Ye.useMemo(()=>Array.isArray(e)?e:[e,e],[e]),[b,R]=x,T=v.x*b,E=v.y*R,[w,D,U]=t??[0,.05,-.27],I=[_.x+w,_.y+D,_.z+U],O=Ye.useMemo(()=>new qd({map:f,roughness:.08,metalness:0,side:ur}),[f]);return Ye.useEffect(()=>()=>{O.dispose()},[O]),Lt.jsx("group",{...a,children:Lt.jsxs("group",{rotation:[.04,0,0],children:[Lt.jsx("primitive",{object:m}),Lt.jsx("mesh",{position:I,rotation:[.435,Math.PI,0],material:O,children:Lt.jsx("planeGeometry",{args:[T,E]})}),i]})})}const GP=100,VP=10,hu=GP*VP,kP=-4,XP=()=>{const s=Math.random();return new Nt().setHSL(s,.65+Math.random()*.2,.6)};function YP({isActive:s,origin:e=[0,5,-14]}){const t=Ye.useRef(null),n=Ye.useRef(null),i=Ye.useRef(null),a=Ye.useMemo(()=>new ne(...e),[e]);i.current||(i.current={positions:new Float32Array(hu*3),velocities:new Float32Array(hu*3),origins:new Float32Array(hu*3),baseColors:new Float32Array(hu*3),colors:new Float32Array(hu*3),ages:new Float32Array(hu),lifetimes:new Float32Array(hu)});const l=u=>{const{positions:f,velocities:p,origins:m,baseColors:v,colors:_,ages:x,lifetimes:b}=i.current,R=u*3,T=a.clone().add(new ne((Math.random()-.5)*1e3,Math.random()*200,(Math.random()-.5)*1e3));m[R]=T.x,m[R+1]=T.y,m[R+2]=T.z;const E=Math.random()*Math.PI*2,w=Math.acos(Math.random()*2-1)*.9,D=1+Math.random()*1.4;p[R]=Math.sin(w)*Math.cos(E)*D,p[R+1]=Math.cos(w)*(D*1.2),p[R+2]=Math.sin(w)*Math.sin(E)*D;const U=XP();v[R]=U.r,v[R+1]=U.g,v[R+2]=U.b,_[R]=0,_[R+1]=0,_[R+2]=0,f[R]=T.x,f[R+1]=T.y,f[R+2]=T.z,b[u]=1.6+Math.random()*1.3,x[u]=-Math.random()*1.2};return Ye.useEffect(()=>{for(let u=0;u<hu;u+=1)l(u)},[]),Kd((u,f)=>{const p=t.current,m=n.current,v=i.current;if(!p||!m||!v)return;const{positions:_,velocities:x,origins:b,colors:R,baseColors:T,ages:E,lifetimes:w}=v,D=p.getAttribute("position"),U=p.getAttribute("color");if(!s){m.opacity=Pd.damp(m.opacity,0,5,f);return}m.opacity=Pd.damp(m.opacity,.85,2.5,f);for(let I=0;I<hu;I+=1){const O=I*3;if(E[I]+=f,E[I]<0){_[O]=b[O],_[O+1]=b[O+1],_[O+2]=b[O+2],R[O]=0,R[O+1]=0,R[O+2]=0;continue}if(E[I]>w[I]||_[O+1]<a.y-1.5){l(I);continue}const P=E[I];_[O]=b[O]+x[O]*P,_[O+1]=b[O+1]+x[O+1]*P+.5*kP*P*P,_[O+2]=b[O+2]+x[O+2]*P;const B=Math.max(0,1-P/w[I]);R[O]=T[O]*B,R[O+1]=T[O+1]*B,R[O+2]=T[O+2]*B}D.needsUpdate=!0,U.needsUpdate=!0}),Lt.jsx("group",{children:Lt.jsxs("points",{frustumCulled:!1,children:[Lt.jsxs("bufferGeometry",{ref:t,children:[Lt.jsx("bufferAttribute",{attach:"attributes-position",args:[i.current.positions,3]}),Lt.jsx("bufferAttribute",{attach:"attributes-color",args:[i.current.colors,3]})]}),Lt.jsx("pointsMaterial",{ref:n,size:1,transparent:!0,vertexColors:!0,depthWrite:!1,opacity:0,sizeAttenuation:!0})]})})}const kR=.5,Ux=4*kR,Dx=3*kR,qP=1.2,jT=.8,WP=.04;function jP({id:s,image:e,tablePosition:t,tableRotation:n,isActive:i,onToggle:a,children:l}){const u=Ye.useRef(null),{camera:f}=xa(),[p,m]=Ye.useState(!1);mI(p||i,"pointer");const v=b_(e);Ye.useEffect(()=>{v.colorSpace=zi,v.anisotropy=4},[v]);const _=Ye.useMemo(()=>new ne(...t),[t]),x=Ye.useMemo(()=>{const O=new ns(...n);return new ua().setFromEuler(O)},[n]);Ye.useEffect(()=>{const O=u.current;O&&(O.position.copy(_),O.quaternion.copy(x))},[_,x]),Ye.useEffect(()=>{i||m(!1)},[i]);const b=Ye.useMemo(()=>new ne,[]),R=Ye.useMemo(()=>new ua,[]),T=Ye.useMemo(()=>new ne,[]),E=Ye.useMemo(()=>new ne(0,-.05,0),[]);Kd((O,P)=>{const B=u.current;if(!B)return;const N=b,z=R;i?(N.copy(f.position),N.add(T.copy(f.getWorldDirection(T)).multiplyScalar(qP)),N.add(E),N.y<jT&&(N.y=jT),z.copy(f.quaternion)):(N.copy(_),p&&(N.y+=WP),z.copy(x));const q=1-Math.exp(-P*12),Y=1-Math.exp(-P*10);B.position.lerp(N,q),B.quaternion.slerp(z,Y)});const w=Ye.useCallback(O=>{O.stopPropagation(),i||m(!0)},[i]),D=Ye.useCallback(O=>{O.stopPropagation(),m(!1)},[]),U=Ye.useCallback(O=>{O.stopPropagation()},[]),I=Ye.useCallback(O=>{O.stopPropagation(),a(s)},[s,a]);return Lt.jsx("group",{ref:u,children:Lt.jsxs("group",{rotation:[0,0,0],children:[Lt.jsxs("mesh",{onPointerOver:w,onPointerOut:D,onPointerDown:U,onClick:I,castShadow:!0,receiveShadow:!0,children:[Lt.jsx("planeGeometry",{args:[Ux,Dx]}),Lt.jsx("meshStandardMaterial",{map:v,roughness:.35,metalness:.05,toneMapped:!1})]}),Lt.jsxs("mesh",{position:[0,0,-.001],rotation:[0,Math.PI,0],children:[Lt.jsx("planeGeometry",{args:[Ux,Dx]}),Lt.jsx("meshStandardMaterial",{color:"#f7f2ff"})]}),Lt.jsxs("mesh",{position:[0,0,-8e-4],children:[Lt.jsx("planeGeometry",{args:[Ux*.98,Dx*.98]}),Lt.jsx("meshStandardMaterial",{color:"#ffffff",side:ur,roughness:1,metalness:0})]}),l]})})}const Tf=(s,e,t)=>Math.min(t,Math.max(e,s)),Nx=(s,e,t)=>s+(e-s)*t,Bv=s=>1-Math.pow(1-s,3),ZT=10,KT=0,SM=3,Ox=30,QT=0,MM=.7,hS=SM-MM-.1,Lx=5,JT=0,XR=1.2,Py=Math.max(SM,hS+MM)+1,$T=Py+XR,zx=new ne(0,1,0),eA=3,ZP=1,tA=Math.PI/2,KP=2,QP=8,JP=Math.PI*0,$P=Math.PI/2,bM=1,e5=0,t5=Math.max(Py-e5,bM),nA=Math.max(t5-bM,0),Sd=["> William","...","> Hoy es tu cumpleaos","...","> so i made you this computer program","...","() () ()"],n5=100,i5=1e3,a5=480,r5=[{id:"confetti",image:"/carta1.jpeg",position:[1,.081,-2],rotation:[-Math.PI/2,0,Math.PI/3]}];function s5(s){const e=Fy.c(34),{isPlaying:t,onBackgroundFadeChange:n,onEnvironmentProgressChange:i,candleLit:a,onAnimationComplete:l,cards:u,activeCardId:f,onToggleCard:p}=s,m=Ye.useRef(null),v=Ye.useRef(null),_=Ye.useRef(null),x=Ye.useRef(null),b=Ye.useRef(!1),R=Ye.useRef(!1),T=Ye.useRef(!1),E=Ye.useRef(1),w=Ye.useRef(0);let D,U;e[0]!==n||e[1]!==i?(D=()=>{n?.(E.current),i?.(w.current)},U=[n,i],e[0]=n,e[1]=i,e[2]=D,e[3]=U):(D=e[2],U=e[3]),Ye.useEffect(D,U);let I;e[4]!==n?(I=H=>{const W=Tf(H,0,1);Math.abs(W-E.current)>.005&&(E.current=W,n?.(W))},e[4]=n,e[5]=I):I=e[5];const O=I;let P;e[6]!==i?(P=H=>{const W=Tf(H,0,1);Math.abs(W-w.current)>.005&&(w.current=W,i?.(W))},e[6]=i,e[7]=P):P=e[7];const B=P;let N;e[8]!==O||e[9]!==B||e[10]!==t||e[11]!==l?(N=H=>{const{clock:W}=H,re=m.current,de=v.current,ge=_.current;if(!re||!de||!ge)return;if(b.current||(re.position.set(0,ZT,0),re.rotation.set(0,0,0),de.position.set(0,0,Ox),de.rotation.set(0,0,0),ge.position.set(0,Lx,0),ge.visible=!1,b.current=!0),!t){O(1),B(0),x.current=null,R.current=!1,T.current=!1;return}if(R.current){O(0),B(1),T.current||(T.current=!0,l?.());return}x.current===null&&(x.current=W.elapsedTime);const oe=W.elapsedTime-x.current,he=Tf(oe,0,$T),Ee=Tf(he/SM,0,1),We=Bv(Ee);re.position.y=Nx(ZT,KT,We),re.position.x=0,re.position.z=0,re.rotation.y=We*Math.PI*2,re.rotation.x=0,re.rotation.z=0;let rt=Ox;if(he>=hS){const et=Tf((he-hS)/MM,0,1),se=Bv(et);rt=Nx(Ox,QT,se)}if(de.position.set(0,0,rt),de.rotation.set(0,0,0),he>=Py){ge.visible||(ge.visible=!0);const et=Tf((he-Py)/XR,0,1),se=Bv(et);ge.position.y=Nx(Lx,JT,se)}else ge.visible=!1,ge.position.set(0,Lx,0);if(he<nA)O(1),B(0);else{const et=Tf((he-nA)/bM,0,1),Ie=1-Bv(et);O(Ie),B(1-Ie)}he>=$T&&(re.position.set(0,KT,0),re.rotation.set(0,0,0),de.position.set(0,0,QT),ge.position.set(0,JT,0),ge.visible=!0,O(0),B(1),R.current=!0,T.current||(T.current=!0,l?.()))},e[8]=O,e[9]=B,e[10]=t,e[11]=l,e[12]=N):N=e[12],Kd(N);let z;e[13]===Symbol.for("react.memo_cache_sentinel")?(z=Lt.jsx(FP,{}),e[13]=z):z=e[13];let q;e[14]===Symbol.for("react.memo_cache_sentinel")?(q=Lt.jsx(Iv,{image:"/sans.jpeg",position:[0,.735,3],rotation:[0,5.6,0],scale:.75}),e[14]=q):q=e[14];let Y;e[15]===Symbol.for("react.memo_cache_sentinel")?(Y=Lt.jsx(Iv,{image:"/Isaac.jpeg",position:[0,.735,-3],rotation:[0,4,0],scale:.75}),e[15]=Y):Y=e[15];let Q;e[16]===Symbol.for("react.memo_cache_sentinel")?(Q=Lt.jsx(Iv,{image:"/Badbunny.jpeg",position:[-1.5,.735,2.5],rotation:[0,5.4,0],scale:.75}),e[16]=Q):Q=e[16];let Z;e[17]===Symbol.for("react.memo_cache_sentinel")?(Z=Lt.jsx(Iv,{image:"/zoro.jpeg",position:[-1.5,.735,-2.5],rotation:[0,4.2,0],scale:.75}),e[17]=Z):Z=e[17];let ae;if(e[18]!==f||e[19]!==u||e[20]!==p){let H;e[22]!==f||e[23]!==p?(H=W=>Lt.jsx(jP,{id:W.id,image:W.image,tablePosition:W.position,tableRotation:W.rotation,isActive:f===W.id,onToggle:p},W.id),e[22]=f,e[23]=p,e[24]=H):H=e[24],ae=u.map(H),e[18]=f,e[19]=u,e[20]=p,e[21]=ae}else ae=e[21];let G;e[25]!==ae?(G=Lt.jsxs("group",{ref:v,children:[z,q,Y,Q,Z,ae]}),e[25]=ae,e[26]=G):G=e[26];let ee;e[27]===Symbol.for("react.memo_cache_sentinel")?(ee=Lt.jsx("group",{ref:m,children:Lt.jsx(PP,{})}),e[27]=ee):ee=e[27];let ie;e[28]===Symbol.for("react.memo_cache_sentinel")?(ie=[0,1.1,0],e[28]=ie):ie=e[28];let fe;e[29]!==a?(fe=Lt.jsx("group",{ref:_,children:Lt.jsx(BP,{isLit:a,scale:.25,position:ie})}),e[29]=a,e[30]=fe):fe=e[30];let ce;return e[31]!==G||e[32]!==fe?(ce=Lt.jsxs(Lt.Fragment,{children:[G,ee,fe]}),e[31]=G,e[32]=fe,e[33]=ce):ce=e[33],ce}function o5(){const s=Fy.c(4),e=Ye.useRef(null),t=xa(l5);let n,i;s[0]!==t?(n=()=>{const l=new ne(Math.sin(tA)*eA,ZP,Math.cos(tA)*eA),u=zx.clone().add(l);t.position.copy(u),t.lookAt(zx);const f=e.current;f&&(f.target.copy(zx),f.update())},i=[t],s[0]=t,s[1]=n,s[2]=i):(n=s[1],i=s[2]),Ye.useEffect(n,i);let a;return s[3]===Symbol.for("react.memo_cache_sentinel")?(a=Lt.jsx(BB,{ref:e,enableDamping:!0,dampingFactor:.05,minDistance:KP,maxDistance:QP,minPolarAngle:JP,maxPolarAngle:$P}),s[3]=a):a=s[3],a}function l5(s){return s.camera}function u5({intensity:s}){const e=xa(t=>t.scene);return Ye.useEffect(()=>{"backgroundIntensity"in e&&(e.backgroundIntensity=s)},[e,s]),null}function c5(){const[s,e]=Ye.useState(!1),[t,n]=Ye.useState(1),[i,a]=Ye.useState(0),[l,u]=Ye.useState(0),[f,p]=Ye.useState(0),[m,v]=Ye.useState(!1),[_,x]=Ye.useState(!0),[b,R]=Ye.useState(!1),[T,E]=Ye.useState(!0),[w,D]=Ye.useState(!1),[U,I]=Ye.useState(null),O=Ye.useRef(null);Ye.useEffect(()=>{const Z=new Audio("/cancion.mp3");return Z.loop=!0,Z.preload="auto",O.current=Z,()=>{Z.pause(),O.current=null}},[]);const P=Ye.useCallback(()=>{const Z=O.current;Z&&Z.paused&&(Z.currentTime=0,Z.play().catch(()=>{}))},[]),B=l>=Sd.length,N=Ye.useMemo(()=>Sd.length===0?[""]:Sd.map((Z,ae)=>B||ae<l?Z:ae===l?Z.slice(0,Math.min(f,Z.length)):""),[f,l,B]),z=B?Math.max(N.length-1,0):l,q=Math.max(Math.min(z,N.length-1),0);Ye.useEffect(()=>{if(!s){u(0),p(0),v(!1),E(!0),D(!1),R(!1);return}if(B){if(!m){const G=window.setTimeout(()=>{v(!0)},i5);return()=>window.clearTimeout(G)}return}const Z=Sd[l]??"",ae=window.setTimeout(()=>{if(f<Z.length){p(ee=>ee+1);return}let G=l+1;for(;G<Sd.length&&Sd[G].length===0;)G+=1;u(G),p(0)},n5);return()=>window.clearTimeout(ae)},[s,f,l,B,m]),Ye.useEffect(()=>{const Z=window.setInterval(()=>{x(ae=>!ae)},a5);return()=>window.clearInterval(Z)},[]),Ye.useEffect(()=>{const Z=ae=>{if(!(ae.code!=="Space"&&ae.key!==" ")){if(ae.preventDefault(),!s){P(),e(!0);return}b&&T&&(E(!1),D(!0))}};return window.addEventListener("keydown",Z),()=>window.removeEventListener("keydown",Z)},[s,b,T,P]);const Y=Ye.useCallback(Z=>{I(ae=>ae===Z?null:Z)},[]),Q=s&&m;return Lt.jsxs("div",{className:"App",children:[Lt.jsx("div",{className:"background-overlay",style:{opacity:t},children:Lt.jsx("div",{className:"typed-text",children:N.map((Z,ae)=>{const G=_&&ae===q&&(!B||!m);return Lt.jsxs("span",{className:"typed-line",children:[Z||"",G&&Lt.jsx("span",{"aria-hidden":"true",className:"typed-cursor",children:"_"})]},`typed-line-${ae}`)})})}),b&&T&&Lt.jsx("div",{className:"hint-overlay",children:"press space to blow out the candle"}),Lt.jsx(pI,{gl:{alpha:!0},style:{background:"transparent"},onCreated:({gl:Z})=>{Z.setClearColor("#000000",0)},children:Lt.jsxs(Ye.Suspense,{fallback:null,children:[Lt.jsx(s5,{isPlaying:Q,candleLit:T,onBackgroundFadeChange:n,onEnvironmentProgressChange:a,onAnimationComplete:()=>R(!0),cards:r5,activeCardId:U,onToggleCard:Y}),Lt.jsx("ambientLight",{intensity:(1-i)*.8}),Lt.jsx("directionalLight",{intensity:.5,position:[2,10,0],color:[1,.9,.95]}),Lt.jsx(eP,{files:["/shanghai_bund_4k.hdr"],backgroundRotation:[0,3.3,0],environmentRotation:[0,3.3,0],background:!0,environmentIntensity:.1*i,backgroundIntensity:.05*i}),Lt.jsx(u5,{intensity:.05*i}),Lt.jsx(YP,{isActive:w,origin:[0,10,0]}),Lt.jsx(o5,{})]})})]})}YC.createRoot(document.getElementById("root")).render(Lt.jsx(Ye.StrictMode,{children:Lt.jsx(c5,{})}));
